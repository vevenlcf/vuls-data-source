{
  "name": "PostgreSQL for Microsoft Windows Payload Execution",
  "fullname": "exploit/windows/postgres/postgres_payload",
  "rank": 600,
  "disclosure_date": "2009-04-10T00:00:00Z",
  "type": "exploit",
  "author": [
    "Bernardo Damele A. G. \u003cbernardo.damele@gmail.com\u003e",
    "todb \u003ctodb@metasploit.com\u003e"
  ],
  "description": "On default Microsoft Windows installations of PostgreSQL the postgres\n        service account may write to the current directory (which is usually\n        \"C:\\Program Files\\PostgreSQL\\\u003cversion\u003e\\data\" where \u003cversion\u003e is the\n        major.minor version of PostgreSQL). UDF DLL's may be sourced from\n        there as well.\n\n        This module uploads a Windows DLL file via the pg_largeobject method\n        of binary injection and creates a UDF (user defined function) from\n        that DLL. Because the payload is run from DllMain, it does not need to\n        conform to specific Postgres API versions.",
  "references": [
    "URL-https://web.archive.org/web/20100803002909/http://lab.lonerunners.net/blog/sqli-writing-files-to-disk-under-postgresql"
  ],
  "platform": "Windows",
  "rport": 5432,
  "autofilter_ports": [
    5432
  ],
  "autofilter_services": [
    "postgres"
  ],
  "targets": [
    "Windows x86",
    "Windows x64"
  ],
  "mod_time": "2021-08-20T16:06:16Z",
  "path": "/modules/exploits/windows/postgres/postgres_payload.rb",
  "is_install_path": true,
  "ref_name": "windows/postgres/postgres_payload",
  "check": true,
  "post_auth": true,
  "needs_cleanup": true
}
