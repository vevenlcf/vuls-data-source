{
  "name": "Microsoft WMI Administration Tools ActiveX Buffer Overflow",
  "fullname": "exploit/windows/browser/wmi_admintools",
  "rank": 500,
  "disclosure_date": "2010-12-21T00:00:00Z",
  "type": "exploit",
  "author": [
    "WooYun",
    "MC \u003cmc@metasploit.com\u003e",
    "jduck \u003cjduck@metasploit.com\u003e"
  ],
  "description": "This module exploits a memory trust issue in the Microsoft WMI\n        Administration tools ActiveX control. When processing a specially crafted\n        HTML page, the WEBSingleView.ocx ActiveX Control (1.50.1131.0) will treat\n        the 'lCtxHandle' parameter to the 'AddContextRef' and 'ReleaseContext' methods\n        as a trusted pointer. It makes an indirect call via this pointer which leads\n        to arbitrary code execution.\n\n        This exploit utilizes a combination of heap spraying and the\n        .NET 2.0 'mscorie.dll' module to bypass DEP and ASLR. This module does not\n        opt-in to ASLR. As such, this module should be reliable on all Windows\n        versions.\n\n        The WMI Administrative Tools are a standalone download \u0026 install (linked in the\n        references).",
  "references": [
    "OSVDB-69942",
    "CVE-2010-3973",
    "BID-45546",
    "URL-http://wooyun.org/bug.php?action=view\u0026id=1006",
    "URL-http://secunia.com/advisories/42693",
    "URL-http://www.microsoft.com/downloads/en/details.aspx?FamilyID=6430f853-1120-48db-8cc5-f2abdc3ed314"
  ],
  "platform": "Windows",
  "targets": [
    "Automatic",
    "Windows Universal",
    "Debug Target (Crash)"
  ],
  "mod_time": "2020-10-02T17:38:06Z",
  "path": "/modules/exploits/windows/browser/wmi_admintools.rb",
  "is_install_path": true,
  "ref_name": "windows/browser/wmi_admintools"
}
