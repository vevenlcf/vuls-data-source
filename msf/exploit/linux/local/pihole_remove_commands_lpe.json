{
  "name": "Pi-Hole Remove Commands Linux Priv Esc",
  "fullname": "exploit/linux/local/pihole_remove_commands_lpe",
  "rank": 500,
  "disclosure_date": "2021-04-20T00:00:00Z",
  "type": "exploit",
  "author": [
    "h00die",
    "Emanuele Barbeno \u003cemanuele.barbeno@compass-security.com\u003e"
  ],
  "description": "Pi-Hole versions 3.0 - 5.3 allows for command line input to the removecustomcname,\n          removecustomdns, and removestaticdhcp functions without properly validating\n          the parameters before passing to sed.  When executed as the www-data user,\n          this allows for a privilege escalation to root since www-data is in the\n          sudoers.d/pihole file with no password.",
  "references": [
    "URL-https://github.com/pi-hole/pi-hole/security/advisories/GHSA-3597-244c-wrpj",
    "URL-https://www.compass-security.com/fileadmin/Research/Advisories/2021-02_CSNC-2021-008_Pi-hole_Privilege_Escalation.txt",
    "CVE-2021-29449"
  ],
  "platform": "Linux,Unix",
  "arch": "cmd",
  "targets": [
    "DHCP",
    "DNS",
    "CNAME"
  ],
  "mod_time": "2022-05-04T15:03:34Z",
  "path": "/modules/exploits/linux/local/pihole_remove_commands_lpe.rb",
  "is_install_path": true,
  "ref_name": "linux/local/pihole_remove_commands_lpe",
  "check": true,
  "notes": {
    "Reliability": [
      "repeatable-session"
    ],
    "SideEffects": [
      "config-changes",
      "ioc-in-logs"
    ],
    "Stability": [
      "crash-safe"
    ]
  },
  "session_types": [
    "shell",
    "meterpreter"
  ]
}
