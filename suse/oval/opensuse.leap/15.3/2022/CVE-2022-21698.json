{
  "id": "CVE-2022-21698",
  "definition_id": "oval:org.opensuse.security:def:202221698",
  "title": "CVE-2022-21698",
  "description": "\n    client_golang is the instrumentation library for Go applications in Prometheus, and the promhttp package in client_golang provides tooling around HTTP servers and clients. In client_golang prior to version 1.11.1, HTTP server is susceptible to a Denial of Service through unbounded cardinality, and potential memory exhaustion, when handling requests with non-standard HTTP methods. In order to be affected, an instrumented software must use any of `promhttp.InstrumentHandler*` middleware except `RequestsInFlight`; not filter any specific methods (e.g GET) before middleware; pass metric with `method` label name to our middleware; and not have any firewall/LB/proxy that filters away requests with unknown `method`. client_golang version 1.11.1 contains a patch for this issue. Several workarounds are available, including removing the `method` label name from counter/gauge used in the InstrumentHandler; turning off affected promhttp handlers; adding custom middleware before promhttp handler that will sanitize the request method given by Go http.Request; and using a reverse proxy or web application firewall, configured to only allow a limited set of methods.\n    ",
  "cvss3": "7.5/CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
  "severity": "Important",
  "impact": "important",
  "affected": {
    "family": "unix",
    "platforms": [
      "openSUSE Leap 15.3"
    ],
    "cpes": [
      "cpe:/o:opensuse:leap:15.3"
    ]
  },
  "packages": [
    {
      "name": "firewall-applet",
      "status": "released",
      "fixed_version": "0:0.9.3-150300.3.6.1",
      "arch": "noarch",
      "platform": "openSUSE Leap 15.3"
    },
    {
      "name": "firewall-config",
      "status": "released",
      "fixed_version": "0:0.9.3-150300.3.6.1",
      "arch": "noarch",
      "platform": "openSUSE Leap 15.3"
    },
    {
      "name": "firewall-macros",
      "status": "released",
      "fixed_version": "0:0.9.3-150300.3.6.1",
      "arch": "noarch",
      "platform": "openSUSE Leap 15.3"
    },
    {
      "name": "firewalld",
      "status": "released",
      "fixed_version": "0:0.9.3-150300.3.6.1",
      "arch": "noarch",
      "platform": "openSUSE Leap 15.3"
    },
    {
      "name": "firewalld-lang",
      "status": "released",
      "fixed_version": "0:0.9.3-150300.3.6.1",
      "arch": "noarch",
      "platform": "openSUSE Leap 15.3"
    },
    {
      "name": "golang-github-prometheus-alertmanager",
      "status": "released",
      "fixed_version": "0:0.23.0-150100.4.7.1",
      "arch": "aarch64",
      "platform": "openSUSE Leap 15.3"
    },
    {
      "name": "golang-github-prometheus-alertmanager",
      "status": "released",
      "fixed_version": "0:0.23.0-150100.4.7.1",
      "arch": "ppc64le",
      "platform": "openSUSE Leap 15.3"
    },
    {
      "name": "golang-github-prometheus-alertmanager",
      "status": "released",
      "fixed_version": "0:0.23.0-150100.4.7.1",
      "arch": "s390x",
      "platform": "openSUSE Leap 15.3"
    },
    {
      "name": "golang-github-prometheus-alertmanager",
      "status": "released",
      "fixed_version": "0:0.23.0-150100.4.7.1",
      "arch": "x86_64",
      "platform": "openSUSE Leap 15.3"
    },
    {
      "name": "golang-github-prometheus-node_exporter",
      "status": "released",
      "fixed_version": "0:1.3.0-150100.3.12.1",
      "arch": "aarch64",
      "platform": "openSUSE Leap 15.3"
    },
    {
      "name": "golang-github-prometheus-node_exporter",
      "status": "released",
      "fixed_version": "0:1.3.0-150100.3.12.1",
      "arch": "ppc64le",
      "platform": "openSUSE Leap 15.3"
    },
    {
      "name": "golang-github-prometheus-node_exporter",
      "status": "released",
      "fixed_version": "0:1.3.0-150100.3.12.1",
      "arch": "s390x",
      "platform": "openSUSE Leap 15.3"
    },
    {
      "name": "golang-github-prometheus-node_exporter",
      "status": "released",
      "fixed_version": "0:1.3.0-150100.3.12.1",
      "arch": "x86_64",
      "platform": "openSUSE Leap 15.3"
    },
    {
      "name": "golang-github-prometheus-prometheus",
      "status": "released",
      "fixed_version": "0:2.32.1-150100.4.9.2",
      "arch": "aarch64",
      "platform": "openSUSE Leap 15.3"
    },
    {
      "name": "golang-github-prometheus-prometheus",
      "status": "released",
      "fixed_version": "0:2.32.1-150100.4.9.2",
      "arch": "ppc64le",
      "platform": "openSUSE Leap 15.3"
    },
    {
      "name": "golang-github-prometheus-prometheus",
      "status": "released",
      "fixed_version": "0:2.32.1-150100.4.9.2",
      "arch": "s390x",
      "platform": "openSUSE Leap 15.3"
    },
    {
      "name": "golang-github-prometheus-prometheus",
      "status": "released",
      "fixed_version": "0:2.32.1-150100.4.9.2",
      "arch": "x86_64",
      "platform": "openSUSE Leap 15.3"
    },
    {
      "name": "podman",
      "status": "released",
      "fixed_version": "0:3.4.7-150300.9.9.2",
      "arch": "aarch64",
      "platform": "openSUSE Leap 15.3"
    },
    {
      "name": "podman",
      "status": "released",
      "fixed_version": "0:3.4.7-150300.9.9.2",
      "arch": "ppc64le",
      "platform": "openSUSE Leap 15.3"
    },
    {
      "name": "podman",
      "status": "released",
      "fixed_version": "0:3.4.7-150300.9.9.2",
      "arch": "s390x",
      "platform": "openSUSE Leap 15.3"
    },
    {
      "name": "podman",
      "status": "released",
      "fixed_version": "0:3.4.7-150300.9.9.2",
      "arch": "x86_64",
      "platform": "openSUSE Leap 15.3"
    },
    {
      "name": "podman-cni-config",
      "status": "released",
      "fixed_version": "0:3.4.7-150300.9.9.2",
      "arch": "noarch",
      "platform": "openSUSE Leap 15.3"
    },
    {
      "name": "python3-firewall",
      "status": "released",
      "fixed_version": "0:0.9.3-150300.3.6.1",
      "arch": "noarch",
      "platform": "openSUSE Leap 15.3"
    }
  ],
  "references": [
    {
      "id": "Mitre CVE-2022-21698",
      "source": "CVE",
      "url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-21698"
    },
    {
      "id": "SUSE CVE-2022-21698",
      "source": "SUSE CVE",
      "url": "https://www.suse.com/security/cve/CVE-2022-21698"
    },
    {
      "id": "SUSE-SU-2022:1433-1",
      "source": "SUSE-SU",
      "url": "https://lists.suse.com/pipermail/sle-security-updates/2022-April/010853.html"
    },
    {
      "id": "SUSE-SU-2022:1434-1",
      "source": "SUSE-SU",
      "url": "https://lists.suse.com/pipermail/sle-security-updates/2022-April/010851.html"
    },
    {
      "id": "SUSE-SU-2022:1435-1",
      "source": "SUSE-SU",
      "url": "https://lists.suse.com/pipermail/sle-security-updates/2022-April/010854.html"
    },
    {
      "id": "SUSE-SU-2022:1531-1",
      "source": "SUSE-SU",
      "url": "https://lists.suse.com/pipermail/sle-security-updates/2022-May/010934.html"
    },
    {
      "id": "SUSE-SU-2022:1545-1",
      "source": "SUSE-SU",
      "url": "https://lists.suse.com/pipermail/sle-security-updates/2022-May/010947.html"
    },
    {
      "id": "SUSE-SU-2022:2134-1",
      "source": "SUSE-SU",
      "url": "https://lists.suse.com/pipermail/sle-security-updates/2022-June/011316.html"
    },
    {
      "id": "SUSE-SU-2022:2137-1",
      "source": "SUSE-SU",
      "url": "https://lists.suse.com/pipermail/sle-security-updates/2022-June/011313.html"
    },
    {
      "id": "SUSE-SU-2022:2139-1",
      "source": "SUSE-SU",
      "url": "https://lists.suse.com/pipermail/sle-security-updates/2022-June/011314.html"
    },
    {
      "id": "SUSE-SU-2022:2140-1",
      "source": "SUSE-SU",
      "url": "https://lists.suse.com/pipermail/sle-security-updates/2022-June/011315.html"
    },
    {
      "id": "SUSE-SU-2022:2145-1",
      "source": "SUSE-SU",
      "url": "https://lists.suse.com/pipermail/sle-security-updates/2022-June/011317.html"
    },
    {
      "id": "SUSE-SU-2022:2834-1",
      "source": "SUSE-SU",
      "url": "https://lists.suse.com/pipermail/sle-security-updates/2022-August/011935.html"
    },
    {
      "id": "SUSE-SU-2022:2839-1",
      "source": "SUSE-SU",
      "url": "https://lists.suse.com/pipermail/sle-security-updates/2022-August/011941.html"
    },
    {
      "id": "SUSE-SU-2022:2839-2",
      "source": "SUSE-SU",
      "url": "https://lists.suse.com/pipermail/sle-security-updates/2022-September/012032.html"
    },
    {
      "id": "SUSE bug 1196338",
      "source": "BUG",
      "url": "https://bugzilla.suse.com/1196338"
    }
  ],
  "issued": "2022-04-28T00:00:00Z",
  "updated": "2022-09-02T00:00:00Z"
}
