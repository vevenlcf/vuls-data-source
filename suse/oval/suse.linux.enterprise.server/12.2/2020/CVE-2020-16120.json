{
  "id": "CVE-2020-16120",
  "definition_id": "oval:org.opensuse.security:def:202016120",
  "title": "CVE-2020-16120",
  "description": "\n    Overlayfs did not properly perform permission checking when copying up files in an overlayfs and could be exploited from within a user namespace, if, for example, unprivileged user namespaces were allowed. It was possible to have a file not readable by an unprivileged user to be copied to a mountpoint controlled by the user, like a removable device. This was introduced in kernel version 4.19 by commit d1d04ef (\"ovl: stack file ops\"). This was fixed in kernel version 5.8 by commits 56230d9 (\"ovl: verify permissions in ovl_path_open()\"), 48bd024 (\"ovl: switch to mounter creds in readdir\") and 05acefb (\"ovl: check permission to open real file\"). Additionally, commits 130fdbc (\"ovl: pass correct flags for opening real directory\") and 292f902 (\"ovl: call secutiry hook in ovl_real_ioctl()\") in kernel 5.8 might also be desired or necessary. These additional commits introduced a regression in overlay mounts within user namespaces which prevented access to files with ownership outside of the user namespace. This regression was mitigated by subsequent commit b6650da (\"ovl: do not fail because of O_NOATIMEi\") in kernel 5.11.\n    ",
  "cvss3": "6.2/CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
  "severity": "Moderate",
  "impact": "moderate",
  "affected": {
    "family": "unix",
    "platforms": [
      "SUSE Linux Enterprise Desktop 12 SP5",
      "SUSE Linux Enterprise Server 12 SP4-ESPOS",
      "SUSE Linux Enterprise Server 12 SP4-LTSS",
      "SUSE Linux Enterprise Server 12 SP5",
      "SUSE Linux Enterprise Server for SAP Applications 12 SP2",
      "SUSE Linux Enterprise Server for SAP Applications 12 SP3",
      "SUSE Linux Enterprise Server for SAP Applications 12 SP4",
      "SUSE Linux Enterprise Server for SAP Applications 12 SP5",
      "SUSE Linux Enterprise Workstation Extension 12 SP5"
    ],
    "cpes": [
      "cpe:/o:suse:sle-we:12:sp5",
      "cpe:/o:suse:sled:12:sp5",
      "cpe:/o:suse:sles-espos:12:sp4",
      "cpe:/o:suse:sles-ltss:12:sp4",
      "cpe:/o:suse:sles:12:sp5",
      "cpe:/o:suse:sles_sap:12:sp2",
      "cpe:/o:suse:sles_sap:12:sp3",
      "cpe:/o:suse:sles_sap:12:sp4",
      "cpe:/o:suse:sles_sap:12:sp5"
    ]
  },
  "packages": [
    {
      "name": "kernel-default",
      "status": "not-affected",
      "platform": "SUSE Linux Enterprise Server for SAP Applications 12 SP2"
    },
    {
      "name": "kernel-source",
      "status": "not-affected",
      "platform": "SUSE Linux Enterprise Server for SAP Applications 12 SP2"
    }
  ],
  "references": [
    {
      "id": "Mitre CVE-2020-16120",
      "source": "CVE",
      "url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-16120"
    },
    {
      "id": "SUSE CVE-2020-16120",
      "source": "SUSE CVE",
      "url": "https://www.suse.com/security/cve/CVE-2020-16120"
    },
    {
      "id": "SUSE-IU-2020:111-1",
      "source": "SUSE-SU",
      "url": "https://lists.suse.com/pipermail/sle-security-updates/2020-December/007966.html"
    },
    {
      "id": "SUSE-IU-2020:112-1",
      "source": "SUSE-SU",
      "url": "https://lists.suse.com/pipermail/sle-security-updates/2020-December/007967.html"
    },
    {
      "id": "SUSE-IU-2020:113-1",
      "source": "SUSE-SU",
      "url": "https://lists.suse.com/pipermail/sle-security-updates/2020-December/007968.html"
    },
    {
      "id": "SUSE-IU-2020:114-1",
      "source": "SUSE-SU",
      "url": "https://lists.suse.com/pipermail/sle-security-updates/2020-December/007969.html"
    },
    {
      "id": "SUSE-IU-2020:115-1",
      "source": "SUSE-SU",
      "url": "https://lists.suse.com/pipermail/sle-security-updates/2020-December/007970.html"
    },
    {
      "id": "SUSE-IU-2020:116-1",
      "source": "SUSE-SU",
      "url": "https://lists.suse.com/pipermail/sle-security-updates/2020-December/007971.html"
    },
    {
      "id": "SUSE-IU-2020:117-1",
      "source": "SUSE-SU",
      "url": "https://lists.suse.com/pipermail/sle-security-updates/2020-December/008059.html"
    },
    {
      "id": "SUSE-SU-2020:3122-1",
      "source": "SUSE-SU",
      "url": "https://lists.suse.com/pipermail/sle-security-updates/2020-November/007681.html"
    },
    {
      "id": "SUSE-SU-2020:3272-1",
      "source": "SUSE-SU",
      "url": "https://lists.suse.com/pipermail/sle-security-updates/2020-November/007748.html"
    },
    {
      "id": "SUSE-SU-2020:3281-1",
      "source": "SUSE-SU",
      "url": "https://lists.suse.com/pipermail/sle-security-updates/2020-November/007756.html"
    },
    {
      "id": "SUSE-SU-2020:3326-1",
      "source": "SUSE-SU",
      "url": "https://lists.suse.com/pipermail/sle-security-updates/2020-November/007775.html"
    },
    {
      "id": "SUSE-SU-2020:3484-1",
      "source": "SUSE-SU",
      "url": "https://lists.suse.com/pipermail/sle-security-updates/2020-November/007841.html"
    },
    {
      "id": "SUSE-SU-2020:3491-1",
      "source": "SUSE-SU",
      "url": "https://lists.suse.com/pipermail/sle-security-updates/2020-November/007842.html"
    },
    {
      "id": "SUSE-SU-2020:3512-1",
      "source": "SUSE-SU",
      "url": "https://lists.suse.com/pipermail/sle-security-updates/2020-November/007853.html"
    },
    {
      "id": "SUSE-SU-2020:3513-1",
      "source": "SUSE-SU",
      "url": "https://lists.suse.com/pipermail/sle-security-updates/2020-November/007854.html"
    },
    {
      "id": "SUSE-SU-2020:3522-1",
      "source": "SUSE-SU",
      "url": "https://lists.suse.com/pipermail/sle-security-updates/2020-November/007856.html"
    },
    {
      "id": "SUSE-SU-2020:3532-1",
      "source": "SUSE-SU",
      "url": "https://lists.suse.com/pipermail/sle-security-updates/2020-November/007871.html"
    },
    {
      "id": "SUSE-SU-2020:3544-1",
      "source": "SUSE-SU",
      "url": "https://lists.suse.com/pipermail/sle-security-updates/2020-November/007876.html"
    },
    {
      "id": "openSUSE-SU-2020:1906-1",
      "source": "SUSE-SU",
      "url": "https://lists.opensuse.org/archives/list/security-announce@lists.opensuse.org/thread/W7MTGDUP74HR4XORTRYN7I7MANTKWCGQ/"
    },
    {
      "id": "openSUSE-SU-2020:2112-1",
      "source": "SUSE-SU",
      "url": "https://lists.opensuse.org/archives/list/security-announce@lists.opensuse.org/thread/4EZ6GLHJ7GRNO5SFTV2VI7JJOEEIMD6U/"
    },
    {
      "id": "openSUSE-SU-2021:0242-1",
      "source": "SUSE-SU",
      "url": "https://lists.opensuse.org/archives/list/security-announce@lists.opensuse.org/thread/XOAUJM2XDOB5Y2JL726SBZNXGQBPQC75/"
    },
    {
      "id": "SUSE bug 1177470",
      "source": "BUG",
      "url": "https://bugzilla.suse.com/1177470"
    }
  ],
  "issued": "2022-03-01T00:00:00Z",
  "updated": "2022-07-12T00:00:00Z"
}
