{
  "id": "CVE-2021-28687",
  "definition_id": "oval:org.opensuse.security:def:202128687",
  "title": "CVE-2021-28687",
  "description": "\n    HVM soft-reset crashes toolstack libxl requires all data structures passed across its public interface to be initialized before use and disposed of afterwards by calling a specific set of functions. Many internal data structures also require this initialize / dispose discipline, but not all of them. When the \"soft reset\" feature was implemented, the libxl__domain_suspend_state structure didn't require any initialization or disposal. At some point later, an initialization function was introduced for the structure; but the \"soft reset\" path wasn't refactored to call the initialization function. When a guest nwo initiates a \"soft reboot\", uninitialized data structure leads to an assert() when later code finds the structure in an unexpected state. The effect of this is to crash the process monitoring the guest. How this affects the system depends on the structure of the toolstack. For xl, this will have no security-relevant effect: every VM has its own independent monitoring process, which contains no state. The domain in question will hang in a crashed state, but can be destroyed by `xl destroy` just like any other non-cooperating domain. For daemon-based toolstacks linked against libxl, such as libvirt, this will crash the toolstack, losing the state of any in-progress operations (localized DoS), and preventing further administrator operations unless the daemon is configured to restart automatically (system-wide DoS). If crashes \"leak\" resources, then repeated crashes could use up resources, also causing a system-wide DoS.\n    ",
  "cvss3": "5.5/CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
  "severity": "Moderate",
  "impact": "moderate",
  "affected": {
    "family": "unix",
    "platforms": [
      "SUSE Linux Enterprise Desktop 15 SP2",
      "SUSE Linux Enterprise Desktop 15 SP3",
      "SUSE Linux Enterprise Desktop 15 SP4",
      "SUSE Linux Enterprise High Performance Computing 15 SP2",
      "SUSE Linux Enterprise High Performance Computing 15 SP3",
      "SUSE Linux Enterprise High Performance Computing 15 SP4",
      "SUSE Linux Enterprise Module for Basesystem 15 SP2",
      "SUSE Linux Enterprise Module for Basesystem 15 SP3",
      "SUSE Linux Enterprise Module for Basesystem 15 SP4",
      "SUSE Linux Enterprise Server 15 SP2",
      "SUSE Linux Enterprise Server 15 SP3",
      "SUSE Linux Enterprise Server 15 SP4",
      "SUSE Linux Enterprise Server for SAP Applications 15 SP2",
      "SUSE Linux Enterprise Server for SAP Applications 15 SP3",
      "SUSE Linux Enterprise Server for SAP Applications 15 SP4",
      "SUSE Linux Enterprise Storage 7",
      "SUSE Linux Enterprise Storage 7.1",
      "SUSE Manager Proxy 4.1",
      "SUSE Manager Proxy 4.2",
      "SUSE Manager Proxy 4.3",
      "SUSE Manager Retail Branch Server 4.1",
      "SUSE Manager Retail Branch Server 4.2",
      "SUSE Manager Retail Branch Server 4.3",
      "SUSE Manager Server 4.1",
      "SUSE Manager Server 4.2",
      "SUSE Manager Server 4.3"
    ],
    "cpes": [
      "cpe:/o:suse:ses:7",
      "cpe:/o:suse:ses:7.1",
      "cpe:/o:suse:sle-module-basesystem:15:sp2",
      "cpe:/o:suse:sle-module-basesystem:15:sp3",
      "cpe:/o:suse:sle-module-basesystem:15:sp4",
      "cpe:/o:suse:sle_hpc:15:sp2",
      "cpe:/o:suse:sle_hpc:15:sp3",
      "cpe:/o:suse:sle_hpc:15:sp4",
      "cpe:/o:suse:sled:15:sp2",
      "cpe:/o:suse:sled:15:sp3",
      "cpe:/o:suse:sled:15:sp4",
      "cpe:/o:suse:sles:15:sp2",
      "cpe:/o:suse:sles:15:sp3",
      "cpe:/o:suse:sles:15:sp4",
      "cpe:/o:suse:sles_sap:15:sp2",
      "cpe:/o:suse:sles_sap:15:sp3",
      "cpe:/o:suse:sles_sap:15:sp4",
      "cpe:/o:suse:suse-manager-proxy:4.1",
      "cpe:/o:suse:suse-manager-proxy:4.2",
      "cpe:/o:suse:suse-manager-proxy:4.3",
      "cpe:/o:suse:suse-manager-retail-branch-server:4.1",
      "cpe:/o:suse:suse-manager-retail-branch-server:4.2",
      "cpe:/o:suse:suse-manager-retail-branch-server:4.3",
      "cpe:/o:suse:suse-manager-server:4.1",
      "cpe:/o:suse:suse-manager-server:4.2",
      "cpe:/o:suse:suse-manager-server:4.3"
    ]
  },
  "packages": [
    {
      "name": "xen-libs",
      "status": "released",
      "fixed_version": "0:4.13.2_08-3.25.3",
      "arch": "x86_64",
      "platform": "SUSE Linux Enterprise Desktop 15 SP2"
    },
    {
      "name": "xen-tools-domU",
      "status": "released",
      "fixed_version": "0:4.13.2_08-3.25.3",
      "arch": "x86_64",
      "platform": "SUSE Linux Enterprise Desktop 15 SP2"
    },
    {
      "name": "xen-libs",
      "status": "released",
      "fixed_version": "0:4.13.2_08-3.25.3",
      "arch": "x86_64",
      "platform": "SUSE Linux Enterprise High Performance Computing 15 SP2"
    },
    {
      "name": "xen-tools-domU",
      "status": "released",
      "fixed_version": "0:4.13.2_08-3.25.3",
      "arch": "x86_64",
      "platform": "SUSE Linux Enterprise High Performance Computing 15 SP2"
    },
    {
      "name": "xen-libs",
      "status": "released",
      "fixed_version": "0:4.13.2_08-3.25.3",
      "arch": "x86_64",
      "platform": "SUSE Linux Enterprise Module for Basesystem 15 SP2"
    },
    {
      "name": "xen-tools-domU",
      "status": "released",
      "fixed_version": "0:4.13.2_08-3.25.3",
      "arch": "x86_64",
      "platform": "SUSE Linux Enterprise Module for Basesystem 15 SP2"
    },
    {
      "name": "xen-libs",
      "status": "released",
      "fixed_version": "0:4.13.2_08-3.25.3",
      "arch": "x86_64",
      "platform": "SUSE Linux Enterprise Server 15 SP2"
    },
    {
      "name": "xen-tools-domU",
      "status": "released",
      "fixed_version": "0:4.13.2_08-3.25.3",
      "arch": "x86_64",
      "platform": "SUSE Linux Enterprise Server 15 SP2"
    },
    {
      "name": "xen-libs",
      "status": "released",
      "fixed_version": "0:4.13.2_08-3.25.3",
      "arch": "x86_64",
      "platform": "SUSE Linux Enterprise Server for SAP Applications 15 SP2"
    },
    {
      "name": "xen-tools-domU",
      "status": "released",
      "fixed_version": "0:4.13.2_08-3.25.3",
      "arch": "x86_64",
      "platform": "SUSE Linux Enterprise Server for SAP Applications 15 SP2"
    },
    {
      "name": "xen-libs",
      "status": "released",
      "fixed_version": "0:4.13.2_08-3.25.3",
      "arch": "x86_64",
      "platform": "SUSE Linux Enterprise Storage 7"
    },
    {
      "name": "xen-tools-domU",
      "status": "released",
      "fixed_version": "0:4.13.2_08-3.25.3",
      "arch": "x86_64",
      "platform": "SUSE Linux Enterprise Storage 7"
    },
    {
      "name": "xen-libs",
      "status": "released",
      "fixed_version": "0:4.13.2_08-3.25.3",
      "arch": "x86_64",
      "platform": "SUSE Manager Proxy 4.1"
    },
    {
      "name": "xen-tools-domU",
      "status": "released",
      "fixed_version": "0:4.13.2_08-3.25.3",
      "arch": "x86_64",
      "platform": "SUSE Manager Proxy 4.1"
    },
    {
      "name": "xen-libs",
      "status": "released",
      "fixed_version": "0:4.13.2_08-3.25.3",
      "arch": "x86_64",
      "platform": "SUSE Manager Retail Branch Server 4.1"
    },
    {
      "name": "xen-tools-domU",
      "status": "released",
      "fixed_version": "0:4.13.2_08-3.25.3",
      "arch": "x86_64",
      "platform": "SUSE Manager Retail Branch Server 4.1"
    },
    {
      "name": "xen-libs",
      "status": "released",
      "fixed_version": "0:4.13.2_08-3.25.3",
      "arch": "x86_64",
      "platform": "SUSE Manager Server 4.1"
    },
    {
      "name": "xen-tools-domU",
      "status": "released",
      "fixed_version": "0:4.13.2_08-3.25.3",
      "arch": "x86_64",
      "platform": "SUSE Manager Server 4.1"
    },
    {
      "name": "xen-libs",
      "status": "released",
      "fixed_version": "0:4.14.1_16-1.6",
      "platform": "SUSE Linux Enterprise Desktop 15 SP3"
    },
    {
      "name": "xen-tools-domU",
      "status": "released",
      "fixed_version": "0:4.14.1_16-1.6",
      "platform": "SUSE Linux Enterprise Desktop 15 SP3"
    },
    {
      "name": "xen-libs",
      "status": "released",
      "fixed_version": "0:4.14.1_16-1.6",
      "platform": "SUSE Linux Enterprise High Performance Computing 15 SP3"
    },
    {
      "name": "xen-tools-domU",
      "status": "released",
      "fixed_version": "0:4.14.1_16-1.6",
      "platform": "SUSE Linux Enterprise High Performance Computing 15 SP3"
    },
    {
      "name": "xen-libs",
      "status": "released",
      "fixed_version": "0:4.14.1_16-1.6",
      "platform": "SUSE Linux Enterprise Module for Basesystem 15 SP3"
    },
    {
      "name": "xen-tools-domU",
      "status": "released",
      "fixed_version": "0:4.14.1_16-1.6",
      "platform": "SUSE Linux Enterprise Module for Basesystem 15 SP3"
    },
    {
      "name": "xen-libs",
      "status": "released",
      "fixed_version": "0:4.14.1_16-1.6",
      "platform": "SUSE Linux Enterprise Server 15 SP3"
    },
    {
      "name": "xen-tools-domU",
      "status": "released",
      "fixed_version": "0:4.14.1_16-1.6",
      "platform": "SUSE Linux Enterprise Server 15 SP3"
    },
    {
      "name": "xen-libs",
      "status": "released",
      "fixed_version": "0:4.14.1_16-1.6",
      "platform": "SUSE Linux Enterprise Server for SAP Applications 15 SP3"
    },
    {
      "name": "xen-tools-domU",
      "status": "released",
      "fixed_version": "0:4.14.1_16-1.6",
      "platform": "SUSE Linux Enterprise Server for SAP Applications 15 SP3"
    },
    {
      "name": "xen-libs",
      "status": "released",
      "fixed_version": "0:4.14.1_16-1.6",
      "platform": "SUSE Linux Enterprise Storage 7.1"
    },
    {
      "name": "xen-tools-domU",
      "status": "released",
      "fixed_version": "0:4.14.1_16-1.6",
      "platform": "SUSE Linux Enterprise Storage 7.1"
    },
    {
      "name": "xen-libs",
      "status": "released",
      "fixed_version": "0:4.14.1_16-1.6",
      "platform": "SUSE Manager Proxy 4.2"
    },
    {
      "name": "xen-tools-domU",
      "status": "released",
      "fixed_version": "0:4.14.1_16-1.6",
      "platform": "SUSE Manager Proxy 4.2"
    },
    {
      "name": "xen-libs",
      "status": "released",
      "fixed_version": "0:4.14.1_16-1.6",
      "platform": "SUSE Manager Retail Branch Server 4.2"
    },
    {
      "name": "xen-tools-domU",
      "status": "released",
      "fixed_version": "0:4.14.1_16-1.6",
      "platform": "SUSE Manager Retail Branch Server 4.2"
    },
    {
      "name": "xen-libs",
      "status": "released",
      "fixed_version": "0:4.14.1_16-1.6",
      "platform": "SUSE Manager Server 4.2"
    },
    {
      "name": "xen-tools-domU",
      "status": "released",
      "fixed_version": "0:4.14.1_16-1.6",
      "platform": "SUSE Manager Server 4.2"
    },
    {
      "name": "xen-libs",
      "status": "released",
      "fixed_version": "0:4.16.0_08-150400.2.12",
      "platform": "SUSE Linux Enterprise Desktop 15 SP4"
    },
    {
      "name": "xen-tools-domU",
      "status": "released",
      "fixed_version": "0:4.16.0_08-150400.2.12",
      "platform": "SUSE Linux Enterprise Desktop 15 SP4"
    },
    {
      "name": "xen-libs",
      "status": "released",
      "fixed_version": "0:4.16.0_08-150400.2.12",
      "platform": "SUSE Linux Enterprise High Performance Computing 15 SP4"
    },
    {
      "name": "xen-tools-domU",
      "status": "released",
      "fixed_version": "0:4.16.0_08-150400.2.12",
      "platform": "SUSE Linux Enterprise High Performance Computing 15 SP4"
    },
    {
      "name": "xen-libs",
      "status": "released",
      "fixed_version": "0:4.16.0_08-150400.2.12",
      "platform": "SUSE Linux Enterprise Module for Basesystem 15 SP4"
    },
    {
      "name": "xen-tools-domU",
      "status": "released",
      "fixed_version": "0:4.16.0_08-150400.2.12",
      "platform": "SUSE Linux Enterprise Module for Basesystem 15 SP4"
    },
    {
      "name": "xen-libs",
      "status": "released",
      "fixed_version": "0:4.16.0_08-150400.2.12",
      "platform": "SUSE Linux Enterprise Server 15 SP4"
    },
    {
      "name": "xen-tools-domU",
      "status": "released",
      "fixed_version": "0:4.16.0_08-150400.2.12",
      "platform": "SUSE Linux Enterprise Server 15 SP4"
    },
    {
      "name": "xen-libs",
      "status": "released",
      "fixed_version": "0:4.16.0_08-150400.2.12",
      "platform": "SUSE Linux Enterprise Server for SAP Applications 15 SP4"
    },
    {
      "name": "xen-tools-domU",
      "status": "released",
      "fixed_version": "0:4.16.0_08-150400.2.12",
      "platform": "SUSE Linux Enterprise Server for SAP Applications 15 SP4"
    },
    {
      "name": "xen-libs",
      "status": "released",
      "fixed_version": "0:4.16.0_08-150400.2.12",
      "platform": "SUSE Manager Proxy 4.3"
    },
    {
      "name": "xen-tools-domU",
      "status": "released",
      "fixed_version": "0:4.16.0_08-150400.2.12",
      "platform": "SUSE Manager Proxy 4.3"
    },
    {
      "name": "xen-libs",
      "status": "released",
      "fixed_version": "0:4.16.0_08-150400.2.12",
      "platform": "SUSE Manager Retail Branch Server 4.3"
    },
    {
      "name": "xen-tools-domU",
      "status": "released",
      "fixed_version": "0:4.16.0_08-150400.2.12",
      "platform": "SUSE Manager Retail Branch Server 4.3"
    },
    {
      "name": "xen-libs",
      "status": "released",
      "fixed_version": "0:4.16.0_08-150400.2.12",
      "platform": "SUSE Manager Server 4.3"
    },
    {
      "name": "xen-tools-domU",
      "status": "released",
      "fixed_version": "0:4.16.0_08-150400.2.12",
      "platform": "SUSE Manager Server 4.3"
    }
  ],
  "references": [
    {
      "id": "Mitre CVE-2021-28687",
      "source": "CVE",
      "url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-28687"
    },
    {
      "id": "SUSE CVE-2021-28687",
      "source": "SUSE CVE",
      "url": "https://www.suse.com/security/cve/CVE-2021-28687"
    },
    {
      "id": "SUSE-CU-2021:233-1",
      "source": "SUSE-SU",
      "url": "https://lists.suse.com/pipermail/sle-security-updates/2021-June/008902.html"
    },
    {
      "id": "SUSE-IU-2021:442-1",
      "source": "SUSE-SU",
      "url": "https://lists.suse.com/pipermail/sle-security-updates/2021-May/008751.html"
    },
    {
      "id": "SUSE-IU-2021:443-1",
      "source": "SUSE-SU",
      "url": "https://lists.suse.com/pipermail/sle-security-updates/2021-May/008747.html"
    },
    {
      "id": "SUSE-IU-2021:444-1",
      "source": "SUSE-SU",
      "url": "https://lists.suse.com/pipermail/sle-security-updates/2021-May/008752.html"
    },
    {
      "id": "SUSE-IU-2022:149-1",
      "source": "SUSE-SU",
      "url": "https://lists.suse.com/pipermail/sle-security-updates/2022-January/010137.html"
    },
    {
      "id": "SUSE-SU-2021:1023-1",
      "source": "SUSE-SU",
      "url": "https://lists.suse.com/pipermail/sle-security-updates/2021-April/008585.html"
    },
    {
      "id": "SUSE-SU-2021:1028-1",
      "source": "SUSE-SU",
      "url": "https://lists.suse.com/pipermail/sle-security-updates/2021-April/008586.html"
    },
    {
      "id": "SUSE-SU-2021:1460-1",
      "source": "SUSE-SU",
      "url": "https://lists.suse.com/pipermail/sle-security-updates/2021-April/008718.html"
    },
    {
      "id": "SUSE bug 1183072",
      "source": "BUG",
      "url": "https://bugzilla.suse.com/1183072"
    }
  ],
  "issued": "2021-04-30T00:00:00Z",
  "updated": "2022-06-30T00:00:00Z"
}
