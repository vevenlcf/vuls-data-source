{
  "id": "CVE-2021-43304",
  "definition_id": "oval:com.ubuntu.impish:def:2021433040000000",
  "title": "CVE-2021-43304 on Ubuntu 21.10 (impish) - medium.",
  "description": "Heap buffer overflow in Clickhouse's LZ4 compression codec when parsing a malicious query. There is no verification that the copy operations in the LZ4::decompressImpl loop and especially the arbitrary copy operation wildCopy\u003ccopy_amount\u003e(op, ip, copy_end), don’t exceed the destination buffer’s limits.",
  "note": "",
  "severity": "Medium",
  "affected": {
    "family": "unix",
    "platform": "Ubuntu 21.10"
  },
  "packages": [
    {
      "name": "clickhouse",
      "status": "needs-triage"
    }
  ],
  "references": [
    {
      "id": "CVE-2021-43304",
      "source": "CVE",
      "url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-43304"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://ubuntu.com/security/CVE-2021-43304"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://github.com/ClickHouse/ClickHouse/commit/2aea1c8d4a5be320365472052d8a48bf69fd9fe9 (v21.9.1.7685)"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://github.com/ClickHouse/ClickHouse/commit/6d83eacec42c7c403c99804a713a9d38caa4a45d (v21.9.1.7685)"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://github.com/ClickHouse/ClickHouse/pull/27136"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://jfrog.com/blog/7-rce-and-dos-vulnerabilities-found-in-clickhouse-dbms/"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://jfrog.com/blog/7-rce-and-dos-vulnerabilities-found-in-clickhouse-dbms"
    },
    {
      "id": "",
      "source": "BUG",
      "url": "http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1008216"
    }
  ],
  "public_date": "2022-03-14T23:15:00Z",
  "rights": "Copyright (C) 2022 Canonical Ltd."
}
