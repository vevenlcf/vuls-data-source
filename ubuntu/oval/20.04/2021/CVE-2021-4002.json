{
  "id": "CVE-2021-4002",
  "definition_id": "oval:com.ubuntu.focal:def:202140020000000",
  "title": "CVE-2021-4002 on Ubuntu 20.04 LTS (focal) - high.",
  "description": "A memory leak flaw in the Linux kernel's hugetlbfs memory usage was found in the way the user maps some regions of memory twice using shmget() which are aligned to PUD alignment with the fault of some of the memory pages. A local user could use this flaw to get unauthorized access to some data. Nadav Amit discovered that the hugetlb implementation in the Linux kernel did not perform TLB flushes under certain conditions. A local attacker could use this to leak or alter data from other processes that use huge pages.\n\nUpdate Instructions:\n\nRun `sudo ua fix CVE-2021-4002` to fix the vulnerability. The problem can be corrected\nby updating your system to the following package versions:\n\nlinux-image-5.4.0-105-generic - 5.4.0-92.103\nlinux-image-5.4.0-105-generic-lpae - 5.4.0-92.103\nlinux-image-unsigned-5.4.0-105-generic - 5.4.0-92.103\nlinux-image-unsigned-5.4.0-105-lowlatency - 5.4.0-92.103\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1069-aws - 5.4.0-1061.64\nNo subscription required\n\nlinux-image-unsigned-5.11.0-1028-aws - 5.11.0-1023.24~20.04.1\nNo subscription required\n\nlinux-image-unsigned-5.13.0-1019-aws - 5.13.0-1008.9~20.04.2\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1073-azure - 5.4.0-1065.68\nNo subscription required\n\nlinux-image-unsigned-5.11.0-1028-azure - 5.11.0-1023.24~20.04.1\nNo subscription required\n\nlinux-image-unsigned-5.13.0-1017-azure - 5.13.0-1009.10~20.04.2\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1072-azure-fde - 5.4.0-1063.66+cvm2.2\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1030-bluefield - 5.4.0-1023.26\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1067-gcp - 5.4.0-1059.63\nNo subscription required\n\nlinux-image-unsigned-5.11.0-1029-gcp - 5.11.0-1024.26~20.04.1\nNo subscription required\n\nlinux-image-unsigned-5.13.0-1019-gcp - 5.13.0-1008.9~20.04.3\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1066-gke - 5.4.0-1057.60\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1037-gkeop - 5.4.0-1029.30\nNo subscription required\n\nlinux-image-5.11.0-46-generic - 5.11.0-44.48~20.04.2\nlinux-image-5.11.0-46-generic-lpae - 5.11.0-44.48~20.04.2\nlinux-image-unsigned-5.11.0-46-generic - 5.11.0-44.48~20.04.2\nlinux-image-unsigned-5.11.0-46-generic-64k - 5.11.0-44.48~20.04.2\nlinux-image-unsigned-5.11.0-46-lowlatency - 5.11.0-44.48~20.04.2\nNo subscription required\n\nlinux-image-5.13.0-37-generic - 5.13.0-23.23~20.04.2\nlinux-image-5.13.0-37-generic-lpae - 5.13.0-23.23~20.04.2\nlinux-image-unsigned-5.13.0-37-generic - 5.13.0-23.23~20.04.2\nlinux-image-unsigned-5.13.0-37-generic-64k - 5.13.0-23.23~20.04.2\nlinux-image-unsigned-5.13.0-37-lowlatency - 5.13.0-23.23~20.04.2\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1018-ibm - 5.4.0-1010.11\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1059-kvm - 5.4.0-1051.53\nNo subscription required\n\nlinux-image-extra-virtual - 5.4.0.92\nlinux-image-extra-virtual-hwe-18.04 - 5.4.0.92\nlinux-image-extra-virtual-hwe-18.04-edge - 5.4.0.92\nlinux-image-generic - 5.4.0.92\nlinux-image-generic-hwe-18.04 - 5.4.0.92\nlinux-image-generic-hwe-18.04-edge - 5.4.0.92\nlinux-image-generic-lpae - 5.4.0.92\nlinux-image-generic-lpae-hwe-18.04 - 5.4.0.92\nlinux-image-generic-lpae-hwe-18.04-edge - 5.4.0.92\nlinux-image-lowlatency - 5.4.0.92\nlinux-image-lowlatency-hwe-18.04 - 5.4.0.92\nlinux-image-lowlatency-hwe-18.04-edge - 5.4.0.92\nlinux-image-oem - 5.4.0.92\nlinux-image-oem-osp1 - 5.4.0.92\nlinux-image-virtual - 5.4.0.92\nlinux-image-virtual-hwe-18.04 - 5.4.0.92\nlinux-image-virtual-hwe-18.04-edge - 5.4.0.92\nNo subscription required\n\nlinux-image-aws-lts-20.04 - 5.4.0.1061\nNo subscription required\n\nlinux-image-aws - 5.13.0.1008\nlinux-image-aws-edge - 5.13.0.1008\nNo subscription required\n\nlinux-image-azure-lts-20.04 - 5.4.0.1065\nNo subscription required\n\nlinux-image-azure - 5.13.0.1009\nlinux-image-azure-edge - 5.13.0.1009\nNo subscription required\n\nlinux-image-azure-fde - 5.4.0.1063\nNo subscription required\n\nlinux-image-bluefield - 5.4.0.1023\nNo subscription required\n\nlinux-image-gcp-lts-20.04 - 5.4.0.1059\nNo subscription required\n\nlinux-image-gcp - 5.13.0.1008\nlinux-image-gcp-edge - 5.13.0.1008\nNo subscription required\n\nlinux-image-gke - 5.4.0.1057\nlinux-image-gke-5.4 - 5.4.0.1057\nNo subscription required\n\nlinux-image-gkeop - 5.4.0.1029\nlinux-image-gkeop-5.4 - 5.4.0.1029\nNo subscription required\n\nlinux-image-extra-virtual-hwe-20.04 - 5.13.0.23\nlinux-image-generic-64k-hwe-20.04 - 5.13.0.23\nlinux-image-generic-hwe-20.04 - 5.13.0.23\nlinux-image-generic-lpae-hwe-20.04 - 5.13.0.23\nlinux-image-lowlatency-hwe-20.04 - 5.13.0.23\nlinux-image-virtual-hwe-20.04 - 5.13.0.23\nNo subscription required\n\nlinux-image-ibm - 5.4.0.1010\nlinux-image-ibm-lts-20.04 - 5.4.0.1010\nNo subscription required\n\nlinux-image-kvm - 5.4.0.1051\nNo subscription required\n\nlinux-image-oem-20.04 - 5.10.0.1053\nlinux-image-oem-20.04-edge - 5.10.0.1053\nlinux-image-oem-20.04b - 5.10.0.1053\nNo subscription required\n\nlinux-image-oem-20.04c - 5.13.0.1026\nNo subscription required\n\nlinux-image-oem-20.04 - 5.14.0.1013\nlinux-image-oem-20.04b - 5.14.0.1013\nlinux-image-oem-20.04c - 5.14.0.1013\nlinux-image-oem-20.04d - 5.14.0.1013\nNo subscription required\n\nlinux-image-oracle-lts-20.04 - 5.4.0.1059\nNo subscription required\n\nlinux-image-oracle - 5.13.0.1011\nlinux-image-oracle-edge - 5.13.0.1011\nNo subscription required\n\nlinux-image-raspi - 5.4.0.1048\nlinux-image-raspi-hwe-18.04 - 5.4.0.1048\nlinux-image-raspi-hwe-18.04-edge - 5.4.0.1048\nlinux-image-raspi2 - 5.4.0.1048\nlinux-image-raspi2-hwe-18.04 - 5.4.0.1048\nlinux-image-raspi2-hwe-18.04-edge - 5.4.0.1048\nNo subscription required\n\nlinux-image-extra-virtual - 5.11.0.1024\nlinux-image-extra-virtual-hwe-20.04 - 5.11.0.1024\nlinux-image-generic - 5.11.0.1024\nlinux-image-generic-hwe-20.04 - 5.11.0.1024\nlinux-image-virtual - 5.11.0.1024\nlinux-image-virtual-hwe-20.04 - 5.11.0.1024\nNo subscription required\n\nlinux-image-unsigned-5.10.0-1057-oem - 5.10.0-1053.55\nNo subscription required\n\nlinux-image-unsigned-5.13.0-1029-oem - 5.13.0-1026.32\nNo subscription required\n\nlinux-image-unsigned-5.14.0-1027-oem - 5.14.0-1013.13\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1067-oracle - 5.4.0-1059.63\nNo subscription required\n\nlinux-image-unsigned-5.11.0-1028-oracle - 5.11.0-1023.24~20.04.1\nNo subscription required\n\nlinux-image-unsigned-5.13.0-1021-oracle - 5.13.0-1011.13~20.04.2\nNo subscription required\n\nlinux-image-5.4.0-1055-raspi - 5.4.0-1048.53\nNo subscription required\n\nlinux-image-5.11.0-1028-generic - 5.11.0-1024.25~20.04.1\nNo subscription required\n\nlinux-image-5.4.0-105-generic - 5.4.0-92.103\nlinux-image-5.4.0-105-lowlatency - 5.4.0-92.103\nNo subscription required\n\nlinux-image-5.4.0-1069-aws - 5.4.0-1061.64\nNo subscription required\n\nlinux-image-5.13.0-1019-aws - 5.13.0-1008.9~20.04.2\nNo subscription required\n\nlinux-image-5.4.0-1073-azure - 5.4.0-1065.68\nNo subscription required\n\nlinux-image-5.11.0-1028-azure - 5.11.0-1023.24~20.04.1\nNo subscription required\n\nlinux-image-5.13.0-1017-azure - 5.13.0-1009.10~20.04.2\nNo subscription required\n\nlinux-image-5.4.0-1072-azure-fde - 5.4.0-1063.66+cvm2.2\nNo subscription required\n\nlinux-image-5.4.0-1030-bluefield - 5.4.0-1023.26\nNo subscription required\n\nlinux-image-5.4.0-1068-gcp - 5.4.0-1059.63\nNo subscription required\n\nlinux-image-5.11.0-1029-gcp - 5.11.0-1024.26~20.04.1\nNo subscription required\n\nlinux-image-5.13.0-1021-gcp - 5.13.0-1008.9~20.04.3\nNo subscription required\n\nlinux-image-5.4.0-1066-gke - 5.4.0-1057.60\nNo subscription required\n\nlinux-image-5.4.0-1037-gkeop - 5.4.0-1029.30\nNo subscription required\n\nlinux-image-5.11.0-46-generic - 5.11.0-44.48~20.04.2\nlinux-image-5.11.0-46-generic-64k - 5.11.0-44.48~20.04.2\nlinux-image-5.11.0-46-lowlatency - 5.11.0-44.48~20.04.2\nNo subscription required\n\nlinux-image-5.13.0-37-generic - 5.13.0-23.23~20.04.2\nlinux-image-5.13.0-37-generic-64k - 5.13.0-23.23~20.04.2\nlinux-image-5.13.0-37-lowlatency - 5.13.0-23.23~20.04.2\nNo subscription required\n\nlinux-image-5.4.0-1018-ibm - 5.4.0-1010.11\nNo subscription required\n\nlinux-image-5.4.0-1059-kvm - 5.4.0-1051.53\nNo subscription required\n\nlinux-image-5.10.0-1057-oem - 5.10.0-1053.55\nNo subscription required\n\nlinux-image-5.13.0-1029-oem - 5.13.0-1026.32\nNo subscription required\n\nlinux-image-5.14.0-1027-oem - 5.14.0-1013.13\nNo subscription required\n\nlinux-image-5.4.0-1067-oracle - 5.4.0-1059.63\nNo subscription required\n\nlinux-image-5.11.0-1028-oracle - 5.11.0-1023.24~20.04.1\nNo subscription required\n\nlinux-image-5.13.0-1021-oracle - 5.13.0-1011.13~20.04.2\nNo subscription required",
  "note": "",
  "severity": "High",
  "affected": {
    "family": "unix",
    "platform": "Ubuntu 20.04 LTS"
  },
  "packages": [
    {
      "name": "linux-aws-5.8",
      "status": "ignored",
      "note": "was needs-triage now end-of-life"
    },
    {
      "name": "linux-azure-5.8",
      "status": "ignored",
      "note": "was needs-triage now end-of-life"
    },
    {
      "name": "linux-gcp-5.8",
      "status": "ignored",
      "note": "was needs-triage now end-of-life"
    },
    {
      "name": "linux-hwe-5.8",
      "status": "ignored",
      "note": "was needs-triage now end-of-life"
    },
    {
      "name": "linux-intel-5.13",
      "status": "ignored",
      "note": "was needs-triage now end-of-life"
    },
    {
      "name": "linux-meta-azure-5.8",
      "status": "ignored",
      "note": "was needs-triage now end-of-life"
    },
    {
      "name": "linux-meta-intel-5.13",
      "status": "ignored",
      "note": "was needs-triage now end-of-life"
    },
    {
      "name": "linux-oem-5.6",
      "status": "ignored",
      "note": "was needs-triage now end-of-life"
    },
    {
      "name": "linux-oracle-5.8",
      "status": "ignored",
      "note": "was needs-triage now end-of-life"
    },
    {
      "name": "linux-raspi2",
      "status": "ignored",
      "note": "replaced by linux-raspi"
    },
    {
      "name": "linux-riscv",
      "status": "ignored",
      "note": "superseded by linux-riscv-5.8"
    },
    {
      "name": "linux-riscv-5.8",
      "status": "ignored",
      "note": "was needs-triage now end-of-life"
    },
    {
      "name": "linux-signed-azure-5.8",
      "status": "ignored",
      "note": "was needs-triage now end-of-life"
    },
    {
      "name": "linux-signed-gcp-5.8",
      "status": "ignored",
      "note": "was needs-triage now end-of-life"
    },
    {
      "name": "linux-signed-hwe-5.8",
      "status": "ignored",
      "note": "was needs-triage now end-of-life"
    },
    {
      "name": "linux-signed-intel-5.13",
      "status": "ignored",
      "note": "was needs-triage now end-of-life"
    },
    {
      "name": "linux-signed-oem-5.6",
      "status": "ignored",
      "note": "was needs-triage now end-of-life"
    },
    {
      "name": "linux-signed-oracle-5.8",
      "status": "ignored",
      "note": "was needs-triage now end-of-life"
    }
  ],
  "references": [
    {
      "id": "CVE-2021-4002",
      "source": "CVE",
      "url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-4002"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://ubuntu.com/security/CVE-2021-4002"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://www.openwall.com/lists/oss-security/2021/11/25/1"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://git.kernel.org/linus/a4a118f2eead1d6c49e00765de89878288d4b890"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://ubuntu.com/security/notices/USN-5206-1"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://ubuntu.com/security/notices/USN-5207-1"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://ubuntu.com/security/notices/USN-5208-1"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://ubuntu.com/security/notices/USN-5209-1"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://ubuntu.com/security/notices/USN-5210-1"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://ubuntu.com/security/notices/USN-5211-1"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://ubuntu.com/security/notices/USN-5218-1"
    }
  ],
  "public_date": "2021-11-26T00:00:00Z",
  "public_date_at_usn": "2021-11-26T00:00:00Z",
  "discovered_by": "Nadav Amit",
  "rights": "Copyright (C) 2021 Canonical Ltd."
}
