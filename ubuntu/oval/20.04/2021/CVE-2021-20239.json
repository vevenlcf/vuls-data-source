{
  "id": "CVE-2021-20239",
  "definition_id": "oval:com.ubuntu.focal:def:2021202390000000",
  "title": "CVE-2021-20239 on Ubuntu 20.04 LTS (focal) - low.",
  "description": "A flaw was found in the Linux kernel in versions before 5.4.92 in the BPF protocol. This flaw allows an attacker with a local account to leak information about kernel internal addresses. The highest threat from this vulnerability is to confidentiality. Ryota Shiga discovered that the sockopt BPF hooks in the Linux kernel could allow a user space program to probe for valid kernel addresses. A local attacker could use this to ease exploitation of another kernel vulnerability.\n\nUpdate Instructions:\n\nRun `sudo ua fix CVE-2021-20239` to fix the vulnerability. The problem can be corrected\nby updating your system to the following package versions:\n\nlinux-image-5.4.0-105-generic - 5.4.0-67.75\nlinux-image-5.4.0-105-generic-lpae - 5.4.0-67.75\nlinux-image-unsigned-5.4.0-105-generic - 5.4.0-67.75\nlinux-image-unsigned-5.4.0-105-lowlatency - 5.4.0-67.75\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1069-aws - 5.4.0-1039.41\nNo subscription required\n\nlinux-image-unsigned-5.11.0-1028-aws - 5.11.0-1009.9~20.04.2\nNo subscription required\n\nlinux-image-unsigned-5.13.0-1019-aws - 5.13.0-1008.9~20.04.2\nNo subscription required\n\nlinux-image-5.8.0-1042-aws - 5.8.0-1035.37~20.04.1\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1073-azure - 5.4.0-1041.43\nNo subscription required\n\nlinux-image-unsigned-5.11.0-1028-azure - 5.11.0-1007.7~20.04.2\nNo subscription required\n\nlinux-image-unsigned-5.13.0-1017-azure - 5.13.0-1009.10~20.04.2\nNo subscription required\n\nlinux-image-unsigned-5.8.0-1043-azure - 5.8.0-1033.35~20.04.1\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1072-azure-fde - 5.4.0-1063.66+cvm2.2\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1030-bluefield - 5.4.0-1011.14\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1067-gcp - 5.4.0-1038.41\nNo subscription required\n\nlinux-image-unsigned-5.11.0-1029-gcp - 5.11.0-1009.10~20.04.1\nNo subscription required\n\nlinux-image-unsigned-5.13.0-1019-gcp - 5.13.0-1008.9~20.04.3\nNo subscription required\n\nlinux-image-unsigned-5.8.0-1039-gcp - 5.8.0-1032.34~20.04.1\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1066-gke - 5.4.0-1037.39\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1037-gkeop - 5.4.0-1011.12\nNo subscription required\n\nlinux-image-5.11.0-46-generic - 5.11.0-22.23~20.04.1\nlinux-image-5.11.0-46-generic-lpae - 5.11.0-22.23~20.04.1\nlinux-image-unsigned-5.11.0-46-generic - 5.11.0-22.23~20.04.1\nlinux-image-unsigned-5.11.0-46-generic-64k - 5.11.0-22.23~20.04.1\nlinux-image-unsigned-5.11.0-46-lowlatency - 5.11.0-22.23~20.04.1\nNo subscription required\n\nlinux-image-5.13.0-37-generic - 5.13.0-21.21~20.04.1\nlinux-image-5.13.0-37-generic-lpae - 5.13.0-21.21~20.04.1\nlinux-image-unsigned-5.13.0-37-generic - 5.13.0-21.21~20.04.1\nlinux-image-unsigned-5.13.0-37-generic-64k - 5.13.0-21.21~20.04.1\nlinux-image-unsigned-5.13.0-37-lowlatency - 5.13.0-21.21~20.04.1\nNo subscription required\n\nlinux-image-5.8.0-63-generic - 5.8.0-49.55~20.04.1\nlinux-image-5.8.0-63-generic-lpae - 5.8.0-49.55~20.04.1\nlinux-image-unsigned-5.8.0-63-generic - 5.8.0-49.55~20.04.1\nlinux-image-unsigned-5.8.0-63-generic-64k - 5.8.0-49.55~20.04.1\nlinux-image-unsigned-5.8.0-63-lowlatency - 5.8.0-49.55~20.04.1\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1018-ibm - 5.4.0-1003.4\nNo subscription required\n\nlinux-image-unsigned-5.13.0-1007-intel - 5.13.0-1007.7\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1059-kvm - 5.4.0-1034.35\nNo subscription required\n\nlinux-image-extra-virtual - 5.4.0.67\nlinux-image-extra-virtual-hwe-18.04 - 5.4.0.67\nlinux-image-extra-virtual-hwe-18.04-edge - 5.4.0.67\nlinux-image-generic - 5.4.0.67\nlinux-image-generic-hwe-18.04 - 5.4.0.67\nlinux-image-generic-hwe-18.04-edge - 5.4.0.67\nlinux-image-generic-lpae - 5.4.0.67\nlinux-image-generic-lpae-hwe-18.04 - 5.4.0.67\nlinux-image-generic-lpae-hwe-18.04-edge - 5.4.0.67\nlinux-image-lowlatency - 5.4.0.67\nlinux-image-lowlatency-hwe-18.04 - 5.4.0.67\nlinux-image-lowlatency-hwe-18.04-edge - 5.4.0.67\nlinux-image-oem - 5.4.0.67\nlinux-image-oem-osp1 - 5.4.0.67\nlinux-image-virtual - 5.4.0.67\nlinux-image-virtual-hwe-18.04 - 5.4.0.67\nlinux-image-virtual-hwe-18.04-edge - 5.4.0.67\nNo subscription required\n\nlinux-image-aws-lts-20.04 - 5.4.0.1039\nNo subscription required\n\nlinux-image-aws - 5.13.0.1008\nlinux-image-aws-edge - 5.13.0.1008\nNo subscription required\n\nlinux-image-azure-lts-20.04 - 5.4.0.1041\nNo subscription required\n\nlinux-image-azure - 5.13.0.1009\nlinux-image-azure-edge - 5.13.0.1009\nNo subscription required\n\nlinux-image-azure - 5.8.0.1033\nNo subscription required\n\nlinux-image-azure-fde - 5.4.0.1063\nNo subscription required\n\nlinux-image-bluefield - 5.4.0.1011\nNo subscription required\n\nlinux-image-gcp-lts-20.04 - 5.4.0.1038\nNo subscription required\n\nlinux-image-gcp - 5.13.0.1008\nlinux-image-gcp-edge - 5.13.0.1008\nNo subscription required\n\nlinux-image-gke - 5.4.0.1037\nlinux-image-gke-5.4 - 5.4.0.1037\nNo subscription required\n\nlinux-image-gkeop - 5.4.0.1011\nlinux-image-gkeop-5.4 - 5.4.0.1011\nNo subscription required\n\nlinux-image-extra-virtual-hwe-20.04 - 5.13.0.21\nlinux-image-generic-64k-hwe-20.04 - 5.13.0.21\nlinux-image-generic-hwe-20.04 - 5.13.0.21\nlinux-image-generic-lpae-hwe-20.04 - 5.13.0.21\nlinux-image-lowlatency-hwe-20.04 - 5.13.0.21\nlinux-image-virtual-hwe-20.04 - 5.13.0.21\nNo subscription required\n\nlinux-image-ibm - 5.4.0.1003\nlinux-image-ibm-lts-20.04 - 5.4.0.1003\nNo subscription required\n\nlinux-image-intel - 5.13.0.1007\nNo subscription required\n\nlinux-image-kvm - 5.4.0.1034\nNo subscription required\n\nlinux-image-oem-20.04 - 5.10.0.1008\nlinux-image-oem-20.04-edge - 5.10.0.1008\nlinux-image-oem-20.04b - 5.10.0.1008\nNo subscription required\n\nlinux-image-oem-20.04c - 5.13.0.1009\nNo subscription required\n\nlinux-image-oem-20.04 - 5.14.0.1004\nlinux-image-oem-20.04b - 5.14.0.1004\nlinux-image-oem-20.04c - 5.14.0.1004\nlinux-image-oem-20.04d - 5.14.0.1004\nNo subscription required\n\nlinux-image-oracle-lts-20.04 - 5.4.0.1039\nNo subscription required\n\nlinux-image-oracle - 5.13.0.1011\nlinux-image-oracle-edge - 5.13.0.1011\nNo subscription required\n\nlinux-image-raspi - 5.4.0.1030\nlinux-image-raspi-hwe-18.04 - 5.4.0.1030\nlinux-image-raspi-hwe-18.04-edge - 5.4.0.1030\nlinux-image-raspi2 - 5.4.0.1030\nlinux-image-raspi2-hwe-18.04 - 5.4.0.1030\nlinux-image-raspi2-hwe-18.04-edge - 5.4.0.1030\nNo subscription required\n\nlinux-image-extra-virtual - 5.11.0.1015\nlinux-image-extra-virtual-hwe-20.04 - 5.11.0.1015\nlinux-image-generic - 5.11.0.1015\nlinux-image-generic-hwe-20.04 - 5.11.0.1015\nlinux-image-virtual - 5.11.0.1015\nlinux-image-virtual-hwe-20.04 - 5.11.0.1015\nNo subscription required\n\nlinux-image-unsigned-5.10.0-1057-oem - 5.10.0-1008.9\nNo subscription required\n\nlinux-image-unsigned-5.13.0-1029-oem - 5.13.0-1009.10\nNo subscription required\n\nlinux-image-unsigned-5.14.0-1027-oem - 5.14.0-1004.4\nNo subscription required\n\nlinux-image-unsigned-5.6.0-1056-oem - 5.6.0-1050.54\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1067-oracle - 5.4.0-1039.42\nNo subscription required\n\nlinux-image-unsigned-5.11.0-1028-oracle - 5.11.0-1008.8~20.04.1\nNo subscription required\n\nlinux-image-unsigned-5.13.0-1021-oracle - 5.13.0-1011.13~20.04.2\nNo subscription required\n\nlinux-image-unsigned-5.8.0-1038-oracle - 5.8.0-1031.32~20.04.2\nNo subscription required\n\nlinux-image-5.4.0-1055-raspi - 5.4.0-1030.33\nNo subscription required\n\nlinux-image-5.11.0-1028-generic - 5.11.0-1015.16~20.04.1\nNo subscription required\n\nlinux-image-5.8.0-29-generic - 5.8.0-22.24~20.04.1\nNo subscription required\n\nlinux-image-5.4.0-105-generic - 5.4.0-67.75\nlinux-image-5.4.0-105-lowlatency - 5.4.0-67.75\nNo subscription required\n\nlinux-image-5.4.0-1069-aws - 5.4.0-1039.41\nNo subscription required\n\nlinux-image-5.13.0-1019-aws - 5.13.0-1008.9~20.04.2\nNo subscription required\n\nlinux-image-5.4.0-1073-azure - 5.4.0-1041.43\nNo subscription required\n\nlinux-image-5.11.0-1028-azure - 5.11.0-1007.7~20.04.2\nNo subscription required\n\nlinux-image-5.13.0-1017-azure - 5.13.0-1009.10~20.04.2\nNo subscription required\n\nlinux-image-5.8.0-1043-azure - 5.8.0-1033.35~20.04.1\nNo subscription required\n\nlinux-image-5.4.0-1072-azure-fde - 5.4.0-1063.66+cvm2.2\nNo subscription required\n\nlinux-image-5.4.0-1030-bluefield - 5.4.0-1011.14\nNo subscription required\n\nlinux-image-5.4.0-1068-gcp - 5.4.0-1038.41\nNo subscription required\n\nlinux-image-5.11.0-1029-gcp - 5.11.0-1009.10~20.04.1\nNo subscription required\n\nlinux-image-5.13.0-1021-gcp - 5.13.0-1008.9~20.04.3\nNo subscription required\n\nlinux-image-5.8.0-1039-gcp - 5.8.0-1032.34~20.04.1\nNo subscription required\n\nlinux-image-5.4.0-1066-gke - 5.4.0-1037.39\nNo subscription required\n\nlinux-image-5.4.0-1037-gkeop - 5.4.0-1011.12\nNo subscription required\n\nlinux-image-5.11.0-46-generic - 5.11.0-22.23~20.04.1\nlinux-image-5.11.0-46-generic-64k - 5.11.0-22.23~20.04.1\nlinux-image-5.11.0-46-lowlatency - 5.11.0-22.23~20.04.1\nNo subscription required\n\nlinux-image-5.13.0-37-generic - 5.13.0-21.21~20.04.1\nlinux-image-5.13.0-37-generic-64k - 5.13.0-21.21~20.04.1\nlinux-image-5.13.0-37-lowlatency - 5.13.0-21.21~20.04.1\nNo subscription required\n\nlinux-image-5.8.0-63-generic - 5.8.0-49.55~20.04.1\nlinux-image-5.8.0-63-generic-64k - 5.8.0-49.55~20.04.1\nlinux-image-5.8.0-63-lowlatency - 5.8.0-49.55~20.04.1\nNo subscription required\n\nlinux-image-5.4.0-1018-ibm - 5.4.0-1003.4\nNo subscription required\n\nlinux-image-5.13.0-1007-intel - 5.13.0-1007.7\nNo subscription required\n\nlinux-image-5.4.0-1059-kvm - 5.4.0-1034.35\nNo subscription required\n\nlinux-image-5.10.0-1057-oem - 5.10.0-1008.9\nNo subscription required\n\nlinux-image-5.13.0-1029-oem - 5.13.0-1009.10\nNo subscription required\n\nlinux-image-5.14.0-1027-oem - 5.14.0-1004.4\nNo subscription required\n\nlinux-image-5.6.0-1056-oem - 5.6.0-1050.54\nNo subscription required\n\nlinux-image-5.4.0-1067-oracle - 5.4.0-1039.42\nNo subscription required\n\nlinux-image-5.11.0-1028-oracle - 5.11.0-1008.8~20.04.1\nNo subscription required\n\nlinux-image-5.13.0-1021-oracle - 5.13.0-1011.13~20.04.2\nNo subscription required\n\nlinux-image-5.8.0-1038-oracle - 5.8.0-1031.32~20.04.2\nNo subscription required",
  "note": "",
  "severity": "Low",
  "affected": {
    "family": "unix",
    "platform": "Ubuntu 20.04 LTS"
  },
  "packages": [
    {
      "name": "linux-raspi2",
      "status": "ignored",
      "note": "replaced by linux-raspi"
    },
    {
      "name": "linux-riscv",
      "status": "ignored",
      "note": "was needs-triage now end-of-life"
    }
  ],
  "references": [
    {
      "id": "CVE-2021-20239",
      "source": "CVE",
      "url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-20239"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://ubuntu.com/security/CVE-2021-20239"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://www.zerodayinitiative.com/advisories/ZDI-21-100/"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://gist.github.com/Ga-ryo/2ec958e78f55c5d18558960f3fe1c6ec"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://ubuntu.com/security/notices/USN-4878-1"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://ubuntu.com/security/notices/USN-4910-1"
    }
  ],
  "public_date": "2021-02-17T00:00:00Z",
  "public_date_at_usn": "2021-02-17T00:00:00Z",
  "discovered_by": "Ryota Shiga",
  "rights": "Copyright (C) 2021 Canonical Ltd."
}
