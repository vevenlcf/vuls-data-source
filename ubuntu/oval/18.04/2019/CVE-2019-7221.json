{
  "id": "CVE-2019-7221",
  "definition_id": "oval:com.ubuntu.bionic:def:201972210000000",
  "title": "CVE-2019-7221 on Ubuntu 18.04 LTS (bionic) - medium.",
  "description": "The KVM implementation in the Linux kernel through 4.20.5 has a Use-after-Free. Jim Mattson and Felix Wilhelm discovered a use-after-free vulnerability in the KVM subsystem of the Linux kernel, when using nested virtual machines. A local attacker in a guest VM could use this to cause a denial of service (system crash) or possibly execute arbitrary code in the host system.\n\nUpdate Instructions:\n\nRun `sudo ua fix CVE-2019-7221` to fix the vulnerability. The problem can be corrected\nby updating your system to the following package versions:\n\nlinux-image-4.15.0-173-generic - 4.15.0-47.50\nlinux-image-4.15.0-173-generic-lpae - 4.15.0-47.50\nlinux-image-4.15.0-173-lowlatency - 4.15.0-47.50\nlinux-image-unsigned-4.15.0-173-generic - 4.15.0-47.50\nlinux-image-unsigned-4.15.0-173-lowlatency - 4.15.0-47.50\nNo subscription required\n\nlinux-image-unsigned-4.15.0-1124-aws - 4.15.0-1035.37\nNo subscription required\n\nlinux-image-unsigned-5.0.0-1036-azure - 4.18.0-1014.14~18.04.1\nNo subscription required\n\nlinux-image-unsigned-5.0.0-1034-gcp - 4.15.0-1029.31\nNo subscription required\n\nlinux-image-5.3.0-76-generic - 4.18.0-17.18~18.04.1\nlinux-image-5.3.0-76-lowlatency - 4.18.0-17.18~18.04.1\nlinux-image-unsigned-5.3.0-76-generic - 4.18.0-17.18~18.04.1\nlinux-image-unsigned-5.3.0-76-lowlatency - 4.18.0-17.18~18.04.1\nNo subscription required\n\nlinux-image-4.15.0-1110-kvm - 4.15.0-1031.31\nNo subscription required\n\nlinux-image-extra-virtual - 4.15.0.47\nlinux-image-extra-virtual-hwe-16.04 - 4.15.0.47\nlinux-image-extra-virtual-hwe-16.04-edge - 4.15.0.47\nlinux-image-generic - 4.15.0.47\nlinux-image-generic-hwe-16.04 - 4.15.0.47\nlinux-image-generic-hwe-16.04-edge - 4.15.0.47\nlinux-image-generic-lpae - 4.15.0.47\nlinux-image-generic-lpae-hwe-16.04 - 4.15.0.47\nlinux-image-generic-lpae-hwe-16.04-edge - 4.15.0.47\nlinux-image-lowlatency - 4.15.0.47\nlinux-image-lowlatency-hwe-16.04 - 4.15.0.47\nlinux-image-lowlatency-hwe-16.04-edge - 4.15.0.47\nlinux-image-virtual - 4.15.0.47\nlinux-image-virtual-hwe-16.04 - 4.15.0.47\nlinux-image-virtual-hwe-16.04-edge - 4.15.0.47\nNo subscription required\n\nlinux-image-aws-lts-18.04 - 4.15.0.1035\nNo subscription required\n\nlinux-image-gkeop-5.3 - 4.18.0.17\nNo subscription required\n\nlinux-image-kvm - 4.15.0.1031\nNo subscription required\n\nlinux-image-oracle-lts-18.04 - 4.15.0.1010\nNo subscription required\n\nlinux-image-raspi2 - 4.15.0.1033\nNo subscription required\n\nlinux-image-snapdragon - 4.15.0.1053\nNo subscription required\n\nlinux-image-unsigned-4.15.0-1103-oem - 4.15.0-1035.40\nNo subscription required\n\nlinux-image-unsigned-4.15.0-1090-oracle - 4.15.0-1010.12\nNo subscription required\n\nlinux-image-4.15.0-1105-raspi2 - 4.15.0-1033.35\nNo subscription required\n\nlinux-image-4.15.0-173-generic - 4.15.0-47.50\nlinux-image-4.15.0-173-lowlatency - 4.15.0-47.50\nNo subscription required\n\nlinux-image-4.15.0-1124-aws - 4.15.0-1035.37\nNo subscription required\n\nlinux-image-5.0.0-1036-azure - 4.18.0-1014.14~18.04.1\nNo subscription required\n\nlinux-image-5.0.0-1034-gcp - 4.15.0-1029.31\nNo subscription required\n\nlinux-image-5.3.0-76-generic - 4.18.0-17.18~18.04.1\nlinux-image-5.3.0-76-lowlatency - 4.18.0-17.18~18.04.1\nNo subscription required\n\nlinux-image-4.15.0-1103-oem - 4.15.0-1035.40\nNo subscription required\n\nlinux-image-4.15.0-1090-oracle - 4.15.0-1010.12\nNo subscription required\n\nlinux-image-4.15.0-1123-snapdragon - 4.15.0-1053.57\nNo subscription required",
  "note": "tyhicks\u003e Ubuntu kernels do not enable nested KVM virtualization by default and are unaffected by this flaw in the default configuration. However, installing QEMU results in nested KVM support to be enabled via the /etc/modprobe.d/qemu-system-x86.conf file. To ensure that nested virtualization is not enabled, verify that the /sys/module/kvm_intel/parameters/nested file contains \"N\".",
  "severity": "Medium",
  "affected": {
    "family": "unix",
    "platform": "Ubuntu 18.04 LTS"
  },
  "packages": null,
  "references": [
    {
      "id": "CVE-2019-7221",
      "source": "CVE",
      "url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-7221"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://ubuntu.com/security/CVE-2019-7221"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://ubuntu.com/security/notices/USN-3930-1"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://ubuntu.com/security/notices/USN-3930-2"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://ubuntu.com/security/notices/USN-3931-1"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://ubuntu.com/security/notices/USN-3931-2"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://ubuntu.com/security/notices/USN-3932-1"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://ubuntu.com/security/notices/USN-3932-2"
    },
    {
      "id": "",
      "source": "BUG",
      "url": "https://bugs.chromium.org/p/project-zero/issues/detail?id=1760"
    }
  ],
  "public_date": "2019-03-21T00:00:00Z",
  "public_date_at_usn": "2019-03-21T00:00:00Z",
  "discovered_by": "Jim Mattson and Felix Wilhelm",
  "rights": "Copyright (C) 2019 Canonical Ltd."
}
