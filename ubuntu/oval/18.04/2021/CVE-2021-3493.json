{
  "id": "CVE-2021-3493",
  "definition_id": "oval:com.ubuntu.bionic:def:202134930000000",
  "title": "CVE-2021-3493 on Ubuntu 18.04 LTS (bionic) - high.",
  "description": "The overlayfs implementation in the linux kernel did not properly validate with respect to user namespaces the setting of file capabilities on files in an underlying file system. Due to the combination of unprivileged user namespaces along with a patch carried in the Ubuntu kernel to allow unprivileged overlay mounts, an attacker could use this to gain elevated privileges. It was discovered that the overlayfs implementation in the Linux kernel did not properly validate the application of file system capabilities with respect to user namespaces. A local attacker could use this to gain elevated privileges.\n\nUpdate Instructions:\n\nRun `sudo ua fix CVE-2021-3493` to fix the vulnerability. The problem can be corrected\nby updating your system to the following package versions:\n\nlinux-image-4.15.0-173-generic - 4.15.0-142.146\nlinux-image-4.15.0-173-generic-lpae - 4.15.0-142.146\nlinux-image-4.15.0-173-lowlatency - 4.15.0-142.146\nlinux-image-unsigned-4.15.0-173-generic - 4.15.0-142.146\nlinux-image-unsigned-4.15.0-173-lowlatency - 4.15.0-142.146\nNo subscription required\n\nlinux-image-unsigned-4.15.0-1124-aws - 4.15.0-1099.106\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1069-aws - 5.4.0-1045.47~18.04.1\nNo subscription required\n\nlinux-image-unsigned-4.15.0-1134-azure - 4.15.0-1113.126\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1073-azure - 5.4.0-1046.48~18.04.1\nNo subscription required\n\nlinux-image-unsigned-4.15.0-1038-dell300x - 4.15.0-1017.21\nNo subscription required\n\nlinux-image-unsigned-4.15.0-1119-gcp - 4.15.0-1098.111\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1067-gcp - 5.4.0-1042.45~18.04.1\nNo subscription required\n\nlinux-image-unsigned-5.3.0-1045-gke - 5.3.0-1042.45\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1065-gke - 5.4.0-1042.44~18.04.1\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1036-gkeop - 5.4.0-1014.15~18.04.1\nNo subscription required\n\nlinux-image-5.3.0-76-generic - 5.3.0-73.69\nlinux-image-5.3.0-76-lowlatency - 5.3.0-73.69\nlinux-image-unsigned-5.3.0-76-generic - 5.3.0-73.69\nlinux-image-unsigned-5.3.0-76-lowlatency - 5.3.0-73.69\nNo subscription required\n\nlinux-image-5.4.0-105-generic - 5.4.0-72.80~18.04.1\nlinux-image-5.4.0-105-generic-lpae - 5.4.0-72.80~18.04.1\nlinux-image-5.4.0-105-lowlatency - 5.4.0-72.80~18.04.1\nlinux-image-unsigned-5.4.0-105-generic - 5.4.0-72.80~18.04.1\nlinux-image-unsigned-5.4.0-105-lowlatency - 5.4.0-72.80~18.04.1\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1018-ibm - 5.4.0-1010.11~18.04.2\nNo subscription required\n\nlinux-image-4.15.0-1110-kvm - 4.15.0-1090.92\nNo subscription required\n\nlinux-image-extra-virtual - 4.15.0.142\nlinux-image-extra-virtual-hwe-16.04 - 4.15.0.142\nlinux-image-extra-virtual-hwe-16.04-edge - 4.15.0.142\nlinux-image-generic - 4.15.0.142\nlinux-image-generic-hwe-16.04 - 4.15.0.142\nlinux-image-generic-hwe-16.04-edge - 4.15.0.142\nlinux-image-generic-lpae - 4.15.0.142\nlinux-image-generic-lpae-hwe-16.04 - 4.15.0.142\nlinux-image-generic-lpae-hwe-16.04-edge - 4.15.0.142\nlinux-image-lowlatency - 4.15.0.142\nlinux-image-lowlatency-hwe-16.04 - 4.15.0.142\nlinux-image-lowlatency-hwe-16.04-edge - 4.15.0.142\nlinux-image-virtual - 4.15.0.142\nlinux-image-virtual-hwe-16.04 - 4.15.0.142\nlinux-image-virtual-hwe-16.04-edge - 4.15.0.142\nNo subscription required\n\nlinux-image-aws-lts-18.04 - 4.15.0.1099\nNo subscription required\n\nlinux-image-aws - 5.4.0.1045\nlinux-image-aws-edge - 5.4.0.1045\nNo subscription required\n\nlinux-image-azure-lts-18.04 - 4.15.0.1113\nNo subscription required\n\nlinux-image-azure - 5.4.0.1046\nlinux-image-azure-edge - 5.4.0.1046\nNo subscription required\n\nlinux-image-dell300x - 4.15.0.1017\nNo subscription required\n\nlinux-image-gcp-lts-18.04 - 4.15.0.1098\nNo subscription required\n\nlinux-image-gcp - 5.4.0.1042\nlinux-image-gcp-edge - 5.4.0.1042\nNo subscription required\n\nlinux-image-gke-5.3 - 5.3.0.1042\nNo subscription required\n\nlinux-image-gke-5.4 - 5.4.0.1042\nNo subscription required\n\nlinux-image-gkeop-5.4 - 5.4.0.1014\nNo subscription required\n\nlinux-image-gkeop-5.3 - 5.3.0.73\nNo subscription required\n\nlinux-image-extra-virtual-hwe-18.04 - 5.4.0.72\nlinux-image-extra-virtual-hwe-18.04-edge - 5.4.0.72\nlinux-image-generic-hwe-18.04 - 5.4.0.72\nlinux-image-generic-hwe-18.04-edge - 5.4.0.72\nlinux-image-generic-lpae-hwe-18.04 - 5.4.0.72\nlinux-image-generic-lpae-hwe-18.04-edge - 5.4.0.72\nlinux-image-lowlatency-hwe-18.04 - 5.4.0.72\nlinux-image-lowlatency-hwe-18.04-edge - 5.4.0.72\nlinux-image-oem - 5.4.0.72\nlinux-image-oem-osp1 - 5.4.0.72\nlinux-image-snapdragon-hwe-18.04 - 5.4.0.72\nlinux-image-snapdragon-hwe-18.04-edge - 5.4.0.72\nlinux-image-virtual-hwe-18.04 - 5.4.0.72\nlinux-image-virtual-hwe-18.04-edge - 5.4.0.72\nNo subscription required\n\nlinux-image-ibm - 5.4.0.1010\nlinux-image-ibm-edge - 5.4.0.1010\nNo subscription required\n\nlinux-image-kvm - 4.15.0.1090\nNo subscription required\n\nlinux-image-oracle-lts-18.04 - 4.15.0.1070\nNo subscription required\n\nlinux-image-oracle - 5.4.0.1043\nlinux-image-oracle-edge - 5.4.0.1043\nNo subscription required\n\nlinux-image-raspi-hwe-18.04 - 5.4.0.1034\nlinux-image-raspi-hwe-18.04-edge - 5.4.0.1034\nNo subscription required\n\nlinux-image-raspi2 - 4.15.0.1084\nNo subscription required\n\nlinux-image-raspi2-hwe-18.04 - 5.3.0.1039\nNo subscription required\n\nlinux-image-snapdragon - 4.15.0.1101\nNo subscription required\n\nlinux-image-unsigned-4.15.0-1090-oracle - 4.15.0-1070.78\nNo subscription required\n\nlinux-image-unsigned-5.4.0-1067-oracle - 5.4.0-1043.46~18.04.1\nNo subscription required\n\nlinux-image-5.4.0-1055-raspi - 5.4.0-1034.37~18.04.1\nNo subscription required\n\nlinux-image-4.15.0-1105-raspi2 - 4.15.0-1084.89\nNo subscription required\n\nlinux-image-5.3.0-1042-raspi2 - 5.3.0-1039.41\nNo subscription required\n\nlinux-image-4.15.0-173-generic - 4.15.0-142.146\nlinux-image-4.15.0-173-lowlatency - 4.15.0-142.146\nNo subscription required\n\nlinux-image-4.15.0-1124-aws - 4.15.0-1099.106\nNo subscription required\n\nlinux-image-5.4.0-1069-aws - 5.4.0-1045.47~18.04.1\nNo subscription required\n\nlinux-image-4.15.0-1134-azure - 4.15.0-1113.126\nNo subscription required\n\nlinux-image-5.4.0-1073-azure - 5.4.0-1046.48~18.04.1\nNo subscription required\n\nlinux-image-4.15.0-1038-dell300x - 4.15.0-1017.21\nNo subscription required\n\nlinux-image-4.15.0-1119-gcp - 4.15.0-1098.111\nNo subscription required\n\nlinux-image-5.4.0-1067-gcp - 5.4.0-1042.45~18.04.1\nNo subscription required\n\nlinux-image-5.3.0-1045-gke - 5.3.0-1042.45\nNo subscription required\n\nlinux-image-5.4.0-1065-gke - 5.4.0-1042.44~18.04.1\nNo subscription required\n\nlinux-image-5.4.0-1037-gkeop - 5.4.0-1014.15~18.04.1\nNo subscription required\n\nlinux-image-5.3.0-76-generic - 5.3.0-73.69\nlinux-image-5.3.0-76-lowlatency - 5.3.0-73.69\nNo subscription required\n\nlinux-image-5.4.0-105-generic - 5.4.0-72.80~18.04.1\nlinux-image-5.4.0-105-lowlatency - 5.4.0-72.80~18.04.1\nNo subscription required\n\nlinux-image-5.4.0-1018-ibm - 5.4.0-1010.11~18.04.2\nNo subscription required\n\nlinux-image-4.15.0-1090-oracle - 4.15.0-1070.78\nNo subscription required\n\nlinux-image-5.4.0-1067-oracle - 5.4.0-1043.46~18.04.1\nNo subscription required\n\nlinux-image-4.15.0-1123-snapdragon - 4.15.0-1101.110\nNo subscription required",
  "note": "sbeattie\u003e issue is specific to Ubuntu or any other distribution that patched the kernel to allow unprivileged overlay mounts, prior to the 5.11 commit (459c7c565ac36b) that permits it upstream.",
  "severity": "High",
  "affected": {
    "family": "unix",
    "platform": "Ubuntu 18.04 LTS"
  },
  "packages": [
    {
      "name": "linux-aws-5.0",
      "status": "ignored",
      "note": "superseded by linux-aws-5.3"
    },
    {
      "name": "linux-aws-5.3",
      "status": "ignored",
      "note": "superseded by linux-aws-5.4"
    },
    {
      "name": "linux-azure",
      "status": "ignored",
      "note": "superseded by linux-azure-5.3"
    },
    {
      "name": "linux-azure-5.3",
      "status": "ignored",
      "note": "superseded by linux-azure-5.4"
    },
    {
      "name": "linux-gcp",
      "status": "ignored",
      "note": "superseded by linux-gcp-5.3"
    },
    {
      "name": "linux-gcp-5.3",
      "status": "ignored",
      "note": "superseded by linux-gcp-5.4"
    },
    {
      "name": "linux-gke-4.15",
      "status": "ignored",
      "note": "was needs-triage now end-of-life"
    },
    {
      "name": "linux-gke-5.0",
      "status": "ignored",
      "note": "was needs-triage now end-of-life"
    },
    {
      "name": "linux-meta-gke-4.15",
      "status": "ignored",
      "note": "was needs-triage now end-of-life"
    },
    {
      "name": "linux-meta-gke-5.0",
      "status": "ignored",
      "note": "was needs-triage now end-of-life"
    },
    {
      "name": "linux-oem",
      "status": "ignored",
      "note": "was needs-triage now end-of-life"
    },
    {
      "name": "linux-oem-osp1",
      "status": "ignored",
      "note": "was needs-triage now end-of-life"
    },
    {
      "name": "linux-oracle-5.0",
      "status": "ignored",
      "note": "superseded by linux-oracle-5.3"
    },
    {
      "name": "linux-oracle-5.3",
      "status": "ignored",
      "note": "superseded by linux-oracle-5.4"
    },
    {
      "name": "linux-signed-azure",
      "status": "ignored",
      "note": "superseded by linux-azure-5.3"
    },
    {
      "name": "linux-signed-azure-5.3",
      "status": "ignored",
      "note": "superseded by linux-azure-5.4"
    },
    {
      "name": "linux-signed-gcp",
      "status": "ignored",
      "note": "superseded by linux-gcp-5.3"
    },
    {
      "name": "linux-signed-gcp-5.3",
      "status": "ignored",
      "note": "superseded by linux-gcp-5.4"
    },
    {
      "name": "linux-signed-gke-4.15",
      "status": "ignored",
      "note": "was needs-triage now end-of-life"
    },
    {
      "name": "linux-signed-gke-5.0",
      "status": "ignored",
      "note": "was needs-triage now end-of-life"
    },
    {
      "name": "linux-signed-oem",
      "status": "ignored",
      "note": "was needs-triage now end-of-life"
    },
    {
      "name": "linux-signed-oem-osp1",
      "status": "ignored",
      "note": "was needs-triage now end-of-life"
    },
    {
      "name": "linux-signed-oracle-5.0",
      "status": "ignored",
      "note": "superseded by linux-oracle-5.3"
    },
    {
      "name": "linux-signed-oracle-5.3",
      "status": "ignored",
      "note": "superseded by linux-oracle-5.4"
    }
  ],
  "references": [
    {
      "id": "CVE-2021-3493",
      "source": "CVE",
      "url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3493"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://ubuntu.com/security/CVE-2021-3493"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://ubuntu.com/security/notices/USN-4915-1"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://ubuntu.com/security/notices/USN-4916-1"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://ubuntu.com/security/notices/USN-4917-1"
    }
  ],
  "public_date": "2021-04-15T17:00:00Z",
  "public_date_at_usn": "2021-04-15T17:00:00Z",
  "crd": "2021-04-15T17:00:00Z",
  "assigned_to": "cascardo",
  "rights": "Copyright (C) 2021 Canonical Ltd."
}
