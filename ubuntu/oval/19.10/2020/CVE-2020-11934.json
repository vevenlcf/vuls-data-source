{
  "id": "CVE-2020-11934",
  "definition_id": "oval:com.ubuntu.eoan:def:2020119340000000",
  "title": "CVE-2020-11934 on Ubuntu 19.10 (eoan) - medium.",
  "description": "A sandbox escape vulnerability was found in the snapctl user-open (xdg-open) implementation. By adding a directory controlled by the snap to $XDG_DATA_DIRS, it allows the snap to control how the host system xdg-open script opens the URL. It was discovered that snapctl user-open allowed altering the $XDG_DATA_DIRS environment variable when calling the system xdg-open. A malicious snap could exploit this to bypass intended access restrictions to control how the host system xdg-open script opens the URL. This issue did not affect Ubuntu Core systems. (CVE-2020-11934)",
  "note": "emitorino\u003e Since the vulnerability is present on the userd's OpenURL implementation, it only affects classic distros where userd is auto-started. emitorino\u003e Since userd cannot be auto-started on Ubuntu Core 16, Ubuntu Core 18 or Ubuntu Core 20 (for various reasons depending on the release), then Ubuntu Core is not affected. emitorino\u003e Even if userd happened to start (eg, the user started it manually on UC20) there is no implicitOnCore policy that allows communicating with io.snapcraft.Launcher (or the older com.canonical.SafeLauncher). emitorino\u003e The dbus interface can't be used (with either plugs or slots) to communicate with userd. emitorino\u003e /usr/bin/xdg-open on the boot file system of an Ubuntu Core system is different to Classic: it is the sandbox proxy that calls back into userd. Even if a session bus is running and a confined app could call userd, userd will report an error because the caller is not confined",
  "severity": "Medium",
  "affected": {
    "family": "unix",
    "platform": "Ubuntu 19.10"
  },
  "packages": [
    {
      "name": "snapd",
      "status": "released",
      "fixed_version": "2.45.1+19.10.2",
      "note": "2.45.1+19.10.2"
    }
  ],
  "references": [
    {
      "id": "CVE-2020-11934",
      "source": "CVE",
      "url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-11934"
    },
    {
      "id": "",
      "source": "REF",
      "url": "http://people.canonical.com/~ubuntu-security/cve/2020/CVE-2020-11934.html"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://usn.ubuntu.com/usn/usn-4424-1"
    },
    {
      "id": "",
      "source": "BUG",
      "url": "https://bugs.launchpad.net/snapd/+bug/1880085"
    }
  ],
  "public_date": "2020-07-15T12:00:00Z",
  "public_date_at_usn": "2020-07-15T12:00:00Z",
  "crd": "2020-07-15T12:00:00Z",
  "assigned_to": "emitorino",
  "discovered_by": "James Henstridge",
  "rights": "Copyright (C) 2020 Canonical Ltd."
}
