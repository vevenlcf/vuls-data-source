{
  "id": "CVE-2016-4997",
  "definition_id": "oval:com.ubuntu.trusty:def:201649970000000",
  "title": "CVE-2016-4997 on Ubuntu 14.04 LTS (trusty) - high.",
  "description": "The compat IPT_SO_SET_REPLACE and IP6T_SO_SET_REPLACE setsockopt implementations in the netfilter subsystem in the Linux kernel before 4.6.3 allow local users to gain privileges or cause a denial of service (memory corruption) by leveraging in-container root access to provide a crafted offset value that triggers an unintended decrement. Jesse Hertz and Tim Newsham discovered that the Linux netfilter implementation did not correctly perform validation when handling 32 bit compatibility IPT_SO_SET_REPLACE events on 64 bit platforms. A local unprivileged attacker could use this to cause a denial of service (system crash) or execute arbitrary code with administrative privileges.\n\nUpdate Instructions:\n\nRun `sudo ua fix CVE-2016-4997` to fix the vulnerability. The problem can be corrected\nby updating your system to the following package versions:\n\nlinux-image-3.13.0-170-generic - 3.13.0-91.138\nlinux-image-3.13.0-170-generic-lpae - 3.13.0-91.138\nlinux-image-3.13.0-170-lowlatency - 3.13.0-91.138\nlinux-image-3.13.0-170-powerpc-e500 - 3.13.0-91.138\nlinux-image-3.13.0-170-powerpc-e500mc - 3.13.0-91.138\nlinux-image-3.13.0-170-powerpc-smp - 3.13.0-91.138\nlinux-image-3.13.0-170-powerpc64-emb - 3.13.0-91.138\nlinux-image-3.13.0-170-powerpc64-smp - 3.13.0-91.138\nlinux-image-unsigned-3.13.0-170-generic - 3.13.0-91.138\nlinux-image-unsigned-3.13.0-170-lowlatency - 3.13.0-91.138\nNo subscription required\n\nlinux-image-4.4.0-1044-aws - 4.4.0-1002.2\nNo subscription required\n\nlinux-image-unsigned-4.15.0-1045-azure - 4.15.0-1023.24~14.04.1\nNo subscription required\n\nlinux-image-3.16.0-77-generic - 3.16.0-76.98~14.04.1\nlinux-image-3.16.0-77-generic-lpae - 3.16.0-76.98~14.04.1\nlinux-image-3.16.0-77-lowlatency - 3.16.0-76.98~14.04.1\nlinux-image-3.16.0-77-powerpc-e500mc - 3.16.0-76.98~14.04.1\nlinux-image-3.16.0-77-powerpc-smp - 3.16.0-76.98~14.04.1\nlinux-image-3.16.0-77-powerpc64-emb - 3.16.0-76.98~14.04.1\nlinux-image-3.16.0-77-powerpc64-smp - 3.16.0-76.98~14.04.1\nlinux-image-extra-3.16.0-77-generic - 3.16.0-76.98~14.04.1\nNo subscription required\n\nlinux-image-3.19.0-80-generic - 3.19.0-64.72~14.04.1\nlinux-image-3.19.0-80-generic-lpae - 3.19.0-64.72~14.04.1\nlinux-image-3.19.0-80-lowlatency - 3.19.0-64.72~14.04.1\nlinux-image-3.19.0-80-powerpc-e500mc - 3.19.0-64.72~14.04.1\nlinux-image-3.19.0-80-powerpc-smp - 3.19.0-64.72~14.04.1\nlinux-image-3.19.0-80-powerpc64-emb - 3.19.0-64.72~14.04.1\nlinux-image-3.19.0-80-powerpc64-smp - 3.19.0-64.72~14.04.1\nlinux-image-extra-3.19.0-80-generic - 3.19.0-64.72~14.04.1\nNo subscription required\n\nlinux-image-4.2.0-42-generic - 4.2.0-41.48~14.04.1\nlinux-image-4.2.0-42-generic-lpae - 4.2.0-41.48~14.04.1\nlinux-image-4.2.0-42-lowlatency - 4.2.0-41.48~14.04.1\nlinux-image-4.2.0-42-powerpc-e500mc - 4.2.0-41.48~14.04.1\nlinux-image-4.2.0-42-powerpc-smp - 4.2.0-41.48~14.04.1\nlinux-image-4.2.0-42-powerpc64-emb - 4.2.0-41.48~14.04.1\nlinux-image-4.2.0-42-powerpc64-smp - 4.2.0-41.48~14.04.1\nlinux-image-extra-4.2.0-42-generic - 4.2.0-41.48~14.04.1\nNo subscription required\n\nlinux-image-4.4.0-148-generic - 4.4.0-28.47~14.04.1\nlinux-image-4.4.0-148-generic-lpae - 4.4.0-28.47~14.04.1\nlinux-image-4.4.0-148-lowlatency - 4.4.0-28.47~14.04.1\nlinux-image-4.4.0-148-powerpc-e500mc - 4.4.0-28.47~14.04.1\nlinux-image-4.4.0-148-powerpc-smp - 4.4.0-28.47~14.04.1\nlinux-image-4.4.0-148-powerpc64-emb - 4.4.0-28.47~14.04.1\nlinux-image-4.4.0-148-powerpc64-smp - 4.4.0-28.47~14.04.1\nlinux-image-unsigned-4.4.0-148-generic - 4.4.0-28.47~14.04.1\nlinux-image-unsigned-4.4.0-148-lowlatency - 4.4.0-28.47~14.04.1\nNo subscription required\n\nlinux-image-extra-virtual - 3.13.0.91\nlinux-image-generic - 3.13.0.91\nlinux-image-generic-lpae - 3.13.0.91\nlinux-image-generic-lpae-lts-saucy - 3.13.0.91\nlinux-image-generic-lpae-lts-trusty - 3.13.0.91\nlinux-image-generic-lts-quantal - 3.13.0.91\nlinux-image-generic-lts-raring - 3.13.0.91\nlinux-image-generic-lts-saucy - 3.13.0.91\nlinux-image-generic-lts-trusty - 3.13.0.91\nlinux-image-generic-pae - 3.13.0.91\nlinux-image-highbank - 3.13.0.91\nlinux-image-hwe-generic-trusty - 3.13.0.91\nlinux-image-hwe-virtual-trusty - 3.13.0.91\nlinux-image-lowlatency - 3.13.0.91\nlinux-image-lowlatency-pae - 3.13.0.91\nlinux-image-omap - 3.13.0.91\nlinux-image-powerpc-e500 - 3.13.0.91\nlinux-image-powerpc-e500mc - 3.13.0.91\nlinux-image-powerpc-smp - 3.13.0.91\nlinux-image-powerpc64-emb - 3.13.0.91\nlinux-image-powerpc64-smp - 3.13.0.91\nlinux-image-server - 3.13.0.91\nlinux-image-virtual - 3.13.0.91\nNo subscription required\n\nlinux-image-aws - 4.4.0.1002\nNo subscription required\n\nlinux-image-azure - 4.15.0.1023\nNo subscription required\n\nlinux-image-extra-virtual-lts-xenial - 4.4.0.28\nlinux-image-generic-lpae-lts-xenial - 4.4.0.28\nlinux-image-generic-lts-xenial - 4.4.0.28\nlinux-image-lowlatency-lts-xenial - 4.4.0.28\nlinux-image-powerpc-e500mc-lts-xenial - 4.4.0.28\nlinux-image-powerpc-smp-lts-xenial - 4.4.0.28\nlinux-image-powerpc64-emb-lts-xenial - 4.4.0.28\nlinux-image-powerpc64-smp-lts-xenial - 4.4.0.28\nlinux-image-virtual-lts-xenial - 4.4.0.28\nNo subscription required\n\nlinux-image-3.13.0-170-generic - 3.13.0-91.138\nlinux-image-3.13.0-170-lowlatency - 3.13.0-91.138\nNo subscription required\n\nlinux-image-4.15.0-1045-azure - 4.15.0-1023.24~14.04.1\nNo subscription required\n\nlinux-image-4.4.0-148-generic - 4.4.0-28.47~14.04.1\nlinux-image-4.4.0-148-lowlatency - 4.4.0-28.47~14.04.1\nNo subscription required",
  "note": "jdstrand\u003e android kernels (flo, goldfish, grouper, maguro, mako and manta) are not supported on the Ubuntu Touch 14.10 and earlier preview kernels linux-lts-saucy no longer receives official support linux-lts-quantal no longer receives official support sbeattie\u003e priority is negligible on precise's 3.2 kernels, as user namespaces are a privileged operation there. For xenial and linux-lts-xenial on trusty, this can be mitigated against by setting the kernel.unprivileged_userns_clone sysctl to 0 to disable userns support. When we fix the netfilter issue we will also add this sysctl to all other supported kernels to allow disabling unprivileged user namespaces. Disabling user namespace may impact chromium-browser, lxc, lxd, docker, and other tools.",
  "severity": "High",
  "affected": {
    "family": "unix",
    "platform": "Ubuntu 14.04 LTS"
  },
  "packages": [
    {
      "name": "linux-flo",
      "status": "ignored"
    },
    {
      "name": "linux-goldfish",
      "status": "ignored"
    },
    {
      "name": "linux-grouper",
      "status": "ignored"
    },
    {
      "name": "linux-maguro",
      "status": "ignored"
    },
    {
      "name": "linux-mako",
      "status": "ignored"
    },
    {
      "name": "linux-manta",
      "status": "ignored"
    }
  ],
  "references": [
    {
      "id": "CVE-2016-4997",
      "source": "CVE",
      "url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-4997"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://ubuntu.com/security/CVE-2016-4997"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://marc.info/?l=oss-security\u0026m=146679591706851\u0026w=2"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://ubuntu.com/security/notices/USN-3016-1"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://ubuntu.com/security/notices/USN-3016-2"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://ubuntu.com/security/notices/USN-3017-1"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://ubuntu.com/security/notices/USN-3017-3"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://ubuntu.com/security/notices/USN-3016-3"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://ubuntu.com/security/notices/USN-3016-4"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://ubuntu.com/security/notices/USN-3017-2"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://ubuntu.com/security/notices/USN-3020-1"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://ubuntu.com/security/notices/USN-3018-2"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://ubuntu.com/security/notices/USN-3018-1"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://ubuntu.com/security/notices/USN-3019-1"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://ubuntu.com/security/notices/USN-3338-1"
    }
  ],
  "public_date": "2016-06-24T00:00:00Z",
  "public_date_at_usn": "2016-06-24T00:00:00Z",
  "discovered_by": "Jesse Hertz and Tim Newsham",
  "rights": "Copyright (C) 2016 Canonical Ltd."
}
