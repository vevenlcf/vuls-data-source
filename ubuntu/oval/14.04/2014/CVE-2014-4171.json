{
  "id": "CVE-2014-4171",
  "definition_id": "oval:com.ubuntu.trusty:def:201441710000000",
  "title": "CVE-2014-4171 on Ubuntu 14.04 LTS (trusty) - medium.",
  "description": "mm/shmem.c in the Linux kernel through 3.15.1 does not properly implement the interaction between range notification and hole punching, which allows local users to cause a denial of service (i_mutex hold) by using the mmap system call to access a hole, as demonstrated by interfering with intended shmem activity by blocking completion of (1) an MADV_REMOVE madvise call or (2) an FALLOC_FL_PUNCH_HOLE fallocate call. Sasha Levin reported an issue with the Linux kernel's shared memory subsystem when used with range notifications and hole punching. A local user could exploit this flaw to cause a denial of service.\n\nUpdate Instructions:\n\nRun `sudo ua fix CVE-2014-4171` to fix the vulnerability. The problem can be corrected\nby updating your system to the following package versions:\n\nlinux-image-3.13.0-170-generic - 3.13.0-35.62\nlinux-image-3.13.0-170-generic-lpae - 3.13.0-35.62\nlinux-image-3.13.0-170-lowlatency - 3.13.0-35.62\nlinux-image-3.13.0-170-powerpc-e500 - 3.13.0-35.62\nlinux-image-3.13.0-170-powerpc-e500mc - 3.13.0-35.62\nlinux-image-3.13.0-170-powerpc-smp - 3.13.0-35.62\nlinux-image-3.13.0-170-powerpc64-emb - 3.13.0-35.62\nlinux-image-3.13.0-170-powerpc64-smp - 3.13.0-35.62\nlinux-image-unsigned-3.13.0-170-generic - 3.13.0-35.62\nlinux-image-unsigned-3.13.0-170-lowlatency - 3.13.0-35.62\nNo subscription required\n\nlinux-image-4.4.0-1044-aws - 4.4.0-1002.2\nNo subscription required\n\nlinux-image-3.16.0-77-generic - 3.16.0-25.33~14.04.2\nlinux-image-3.16.0-77-generic-lpae - 3.16.0-25.33~14.04.2\nlinux-image-3.16.0-77-lowlatency - 3.16.0-25.33~14.04.2\nlinux-image-3.16.0-77-powerpc-e500mc - 3.16.0-25.33~14.04.2\nlinux-image-3.16.0-77-powerpc-smp - 3.16.0-25.33~14.04.2\nlinux-image-3.16.0-77-powerpc64-emb - 3.16.0-25.33~14.04.2\nlinux-image-3.16.0-77-powerpc64-smp - 3.16.0-25.33~14.04.2\nlinux-image-extra-3.16.0-77-generic - 3.16.0-25.33~14.04.2\nNo subscription required\n\nlinux-image-3.19.0-80-generic - 3.19.0-18.18~14.04.1\nlinux-image-3.19.0-80-generic-lpae - 3.19.0-18.18~14.04.1\nlinux-image-3.19.0-80-lowlatency - 3.19.0-18.18~14.04.1\nlinux-image-3.19.0-80-powerpc-e500mc - 3.19.0-18.18~14.04.1\nlinux-image-3.19.0-80-powerpc-smp - 3.19.0-18.18~14.04.1\nlinux-image-3.19.0-80-powerpc64-emb - 3.19.0-18.18~14.04.1\nlinux-image-3.19.0-80-powerpc64-smp - 3.19.0-18.18~14.04.1\nlinux-image-extra-3.19.0-80-generic - 3.19.0-18.18~14.04.1\nNo subscription required\n\nlinux-image-4.2.0-42-generic - 4.2.0-18.22~14.04.1\nlinux-image-4.2.0-42-generic-lpae - 4.2.0-18.22~14.04.1\nlinux-image-4.2.0-42-lowlatency - 4.2.0-18.22~14.04.1\nlinux-image-4.2.0-42-powerpc-e500mc - 4.2.0-18.22~14.04.1\nlinux-image-4.2.0-42-powerpc-smp - 4.2.0-18.22~14.04.1\nlinux-image-4.2.0-42-powerpc64-emb - 4.2.0-18.22~14.04.1\nlinux-image-4.2.0-42-powerpc64-smp - 4.2.0-18.22~14.04.1\nlinux-image-extra-4.2.0-42-generic - 4.2.0-18.22~14.04.1\nNo subscription required\n\nlinux-image-4.4.0-148-generic - 4.4.0-13.29~14.04.1\nlinux-image-4.4.0-148-generic-lpae - 4.4.0-13.29~14.04.1\nlinux-image-4.4.0-148-lowlatency - 4.4.0-13.29~14.04.1\nlinux-image-4.4.0-148-powerpc-e500mc - 4.4.0-13.29~14.04.1\nlinux-image-4.4.0-148-powerpc-smp - 4.4.0-13.29~14.04.1\nlinux-image-4.4.0-148-powerpc64-emb - 4.4.0-13.29~14.04.1\nlinux-image-4.4.0-148-powerpc64-smp - 4.4.0-13.29~14.04.1\nlinux-image-unsigned-4.4.0-148-generic - 4.4.0-13.29~14.04.1\nlinux-image-unsigned-4.4.0-148-lowlatency - 4.4.0-13.29~14.04.1\nNo subscription required\n\nlinux-image-extra-virtual - 3.13.0.35\nlinux-image-generic - 3.13.0.35\nlinux-image-generic-lpae - 3.13.0.35\nlinux-image-generic-lpae-lts-saucy - 3.13.0.35\nlinux-image-generic-lpae-lts-trusty - 3.13.0.35\nlinux-image-generic-lts-quantal - 3.13.0.35\nlinux-image-generic-lts-raring - 3.13.0.35\nlinux-image-generic-lts-saucy - 3.13.0.35\nlinux-image-generic-lts-trusty - 3.13.0.35\nlinux-image-generic-pae - 3.13.0.35\nlinux-image-highbank - 3.13.0.35\nlinux-image-hwe-generic-trusty - 3.13.0.35\nlinux-image-hwe-virtual-trusty - 3.13.0.35\nlinux-image-lowlatency - 3.13.0.35\nlinux-image-lowlatency-pae - 3.13.0.35\nlinux-image-omap - 3.13.0.35\nlinux-image-powerpc-e500 - 3.13.0.35\nlinux-image-powerpc-e500mc - 3.13.0.35\nlinux-image-powerpc-smp - 3.13.0.35\nlinux-image-powerpc64-emb - 3.13.0.35\nlinux-image-powerpc64-smp - 3.13.0.35\nlinux-image-server - 3.13.0.35\nlinux-image-virtual - 3.13.0.35\nNo subscription required\n\nlinux-image-aws - 4.4.0.1002\nNo subscription required\n\nlinux-image-extra-virtual-lts-xenial - 4.4.0.13\nlinux-image-generic-lpae-lts-xenial - 4.4.0.13\nlinux-image-generic-lts-xenial - 4.4.0.13\nlinux-image-lowlatency-lts-xenial - 4.4.0.13\nlinux-image-powerpc-e500mc-lts-xenial - 4.4.0.13\nlinux-image-powerpc-smp-lts-xenial - 4.4.0.13\nlinux-image-powerpc64-emb-lts-xenial - 4.4.0.13\nlinux-image-powerpc64-smp-lts-xenial - 4.4.0.13\nlinux-image-virtual-lts-xenial - 4.4.0.13\nNo subscription required\n\nlinux-image-3.13.0-170-generic - 3.13.0-35.62\nlinux-image-3.13.0-170-lowlatency - 3.13.0-35.62\nNo subscription required\n\nlinux-image-4.4.0-148-generic - 4.4.0-13.29~14.04.1\nlinux-image-4.4.0-148-lowlatency - 4.4.0-13.29~14.04.1\nNo subscription required",
  "note": "jdstrand\u003e android kernels (goldfish, grouper, maguro, mako and manta) are not supported on the Ubuntu Touch 13.10 preview kernels android kernels (flo, goldfish, grouper, maguro, mako and manta) are not supported on the Ubuntu Touch 14.04 preview kernels henrix\u003e discussion on stable kernels backport is still on-going, as the fix is likely to be different. apw\u003e the break-fix is likely wrong now as they are reverting this commit in favour of some other combo as well: break-fix: - f00cdc6df7d7cfcabb5b740911e6788cb0802bdb jdstrand\u003e linux-lts-saucy no longer receives official support linux-lts-quantal no longer receives official support",
  "severity": "Medium",
  "affected": {
    "family": "unix",
    "platform": "Ubuntu 14.04 LTS"
  },
  "packages": [
    {
      "name": "linux-flo",
      "status": "ignored",
      "note": "was needed now end-of-life"
    },
    {
      "name": "linux-goldfish",
      "status": "ignored",
      "note": "was needed now end-of-life"
    },
    {
      "name": "linux-grouper",
      "status": "ignored",
      "note": "abandoned"
    },
    {
      "name": "linux-maguro",
      "status": "ignored",
      "note": "abandoned"
    },
    {
      "name": "linux-mako",
      "status": "ignored",
      "note": "was needed now end-of-life"
    },
    {
      "name": "linux-manta",
      "status": "ignored",
      "note": "was needed now end-of-life"
    }
  ],
  "references": [
    {
      "id": "CVE-2014-4171",
      "source": "CVE",
      "url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-4171"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://ubuntu.com/security/CVE-2014-4171"
    },
    {
      "id": "",
      "source": "REF",
      "url": "http://ozlabs.org/~akpm/mmots/broken-out/shmem-fix-faulting-into-a-hole-while-its-punched.patch"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://lkml.org/lkml/2014/7/2/518"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://ubuntu.com/security/notices/USN-2334-1"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://ubuntu.com/security/notices/USN-2335-1"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://ubuntu.com/security/notices/USN-2336-1"
    },
    {
      "id": "",
      "source": "REF",
      "url": "https://ubuntu.com/security/notices/USN-2337-1"
    },
    {
      "id": "",
      "source": "BUG",
      "url": "https://launchpad.net/bugs/1333617"
    }
  ],
  "public_date": "2014-06-23T00:00:00Z",
  "public_date_at_usn": "2014-06-23T00:00:00Z",
  "discovered_by": "Sasha Levin",
  "rights": "Copyright (C) 2014 Canonical Ltd."
}
