{
  "candidate": "CVE-2009-3555",
  "description": "The TLS protocol, and the SSL protocol 3.0 and possibly earlier, as used in Microsoft Internet Information Services (IIS) 7.0, mod_ssl in the Apache HTTP Server 2.2.14 and earlier, OpenSSL before 0.9.8l, GnuTLS 2.8.5 and earlier, Mozilla Network Security Services (NSS) 3.12.4 and earlier, multiple Cisco products, and other products, does not properly associate renegotiation handshakes with an existing connection, which allows man-in-the-middle attackers to insert data into HTTPS sessions, and possibly other types of sessions protected by TLS or SSL, by sending an unauthenticated request that is processed retroactively by a server in a post-renegotiation context, related to a \"plaintext injection\" attack, aka the \"Project Mogul\" issue.",
  "notes": {
    "jdstrand": "Fixing this issue requires coordination between the IETF, SSL libraries (eg OpenSSL and GnuTLS) and TLS consumers (notably HTTPS servers, but most (or all) servers using TLS which support TLS renegotiation). Protocol-breaking changes are among the possibilities being discussed. The following is based on http://extendedsubset.com/Renegotiating_TLS.pdf and http://extendedsubset.com/Renegotiating_TLS_pd.pdf. You are encouraged to read this document as well as the email thread on ietf-tls for complete information and most up-to-date status (see References). There are essentially 3 types of renegotiation scenarios known at this time to be vulnerable, and they all require a man-in-the-middle (MITM) attack: 1. Client certificate authentication: servers configured to require client certificate authentication on a per-directory basis. Apache is known to be vulnerable when using this configuration. There is no generally usable mitigation strategy known at this time. 2. Differing server cryptographic requirements: servers configured to support different cipher suites within the same site. One mitigation strategy is to require all content on a site to use a single cipher suite. Disallowing specification of TLS parameters in .htaccess files (generally modifiable by end users) may also be a good idea. 3. Client-initiated renegotiation: servers configured for TLS. Apache is known to be vulnerable when using using TLS and the client initiates a renegotiation. There is no generally usable mitigation strategy known at this time. The flaw should not allow the attacker to see the contents of the connection, and a client cannot be redirected to another site. For the HTTPS scenarios listed above, the attacker is able to perform arbitrary requests with the credentials of the victim. Arbitrary POST requests may also be possible. Analysis on the effects of this flaw for other protocols is ongoing. Until a general fix can be found for Ubuntu, users may be interested in reading http://www.links.org/?p=780, which has a patch to OpenSSL to disable all renegotiation. Update for apache2 disabled client initiated renegotiations. This won't fix per-Directory/Location configurations. NSS 3.12.6 has support for the new renegotiation extension for TLS to implement rfc5746. NSS clients advertise their support for this extension and if the server also supports it, will be protected from this vulnerability. To maintain compatibility, NSS in Ubuntu will for the foreseeable future use the so-called 'transitional' mode which will fall back to the unprotected renegotiation method if the server doesn't support the new extension. NSS was fixed in Ubuntu 9.10 because the new Firefox required it. Because Firefox needs changes to take advantage of the new NSS, once Ubuntu 8.04 LTS - 9.04 are updated to use an embedded NSS (and therefore won't use the system NSS), we can update the system NSS for these releases. When upgrading the system NSS on Ubuntu 8.04 LTS - 9.04, be careful about https://launchpad.net/bugs/559881 and https://launchpad.net/bugs/559918 (regressions seen with the 9.10 update). postgresql 8.1.20, 8.3.10 and 8.4.3 now have ssl_renegotiation_limit to control session key renegotiation preliminary GNUtls patches at (in 2.9.10 development release): http://thread.gmane.org/gmane.comp.encryption.gpg.gnutls.devel/3944 http://git.savannah.gnu.org/gitweb/?p=gnutls.git\u0026a=search\u0026h=HEAD\u0026st=commit\u0026s=renegotiation RedHat RHSA-2010:0396-01 adds the \"SSLInsecureRenegotiation\" configuration directive to apache",
    "mdeslaur": "openssl 0.9.8l disabled renegotiations completely, with a compile time option to turn it back on. This may break connections to servers that haven't been patched. openssl 0.9.8m adds an option that applications can use to turn it back on: http://groups.google.com/group/mailing.openssl.cvs/browse_thread/thread/8d8add96fa471695 Turning renegotiation off completely may break postgresql, openvpn alpine, psi, fetchmail, etc. http://www.mail-archive.com/openssl-dev@openssl.org/msg26800.html jetty 6.1.22 has a CVE-2009-3555 fix: \"Prevent SSL renegotiate for SSL vulnerability\" gnutls doesn't have an API for renegotiations, so ignoring."
  },
  "priority": "medium",
  "bugs": [
    "https://bugs.edge.launchpad.net/ubuntu/+source/openssl/+bug/484417",
    "http://rt.openssl.org/Ticket/Display.html?user=guest\u0026pass=guest\u0026id=2105",
    "http://rt.openssl.org/index.html?q=2102",
    "https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2009-3555",
    "https://bugzilla.redhat.com/show_bug.cgi?id=537962",
    "https://bugzilla.redhat.com/show_bug.cgi?id=538373",
    "https://bugzilla.redhat.com/show_bug.cgi?id=538456",
    "https://bugzilla.redhat.com/show_bug.cgi?id=533234",
    "https://bugs.launchpad.net/ubuntu/+source/nss/+bug/562332",
    "https://bugzilla.redhat.com/show_bug.cgi?id=533125"
  ],
  "references": [
    "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3555",
    "http://www.imc.org/ietf-tls/mail-archive/msg09837.html",
    "http://www.ietf.org/rfc/rfc5746.txt",
    "http://extendedsubset.com/",
    "http://extendedsubset.com/Renegotiating_TLS.pdf",
    "http://extendedsubset.com/Renegotiating_TLS_pd.pdf",
    "http://www.ietf.org/mail-archive/web/tls/current/msg03963.html",
    "http://www.links.org/?p=780",
    "http://www.links.org/?p=786",
    "http://mail-archives.apache.org/mod_mbox/httpd-announce/200911.mbox/%3C20091107013220.31376.qmail@minotaur.apache.org%3E",
    "https://wiki.mozilla.org/Security:Renegotiation",
    "https://developer.mozilla.org/NSS_3.12.6_release_notes",
    "https://ubuntu.com/security/notices/USN-860-1",
    "https://ubuntu.com/security/notices/USN-923-1",
    "https://ubuntu.com/security/notices/USN-927-1",
    "https://ubuntu.com/security/notices/USN-927-2",
    "https://ubuntu.com/security/notices/USN-927-3",
    "http://thread.gmane.org/gmane.network.gnutls.general/1838",
    "https://ubuntu.com/security/notices/USN-927-4",
    "https://ubuntu.com/security/notices/USN-927-6"
  ],
  "assigned_to": "jdstrand",
  "discovered_by": "Marsh Ray, Steve Dispensa",
  "public_date": "2009-11-09T17:30:00Z",
  "public_date_at_usn": "2009-11-09T00:00:00Z",
  "packages": [
    {
      "name": "apache2",
      "status": "released",
      "note": "2.2.12-1ubuntu2.1",
      "patches": [
        {
          "source": "vendor",
          "text": "http://www.mandriva.com/en/security/advisories?name=MDVSA-2009:295"
        },
        {
          "source": "vendor",
          "text": "https://rhn.redhat.com/errata/RHSA-2010-0396.html"
        }
      ]
    },
    {
      "name": "gnutls26",
      "status": "ignored"
    },
    {
      "name": "sun-java6",
      "status": "released",
      "note": "6.22-0ubuntu1~9.10.1"
    },
    {
      "name": "openjdk-6b18",
      "status": "not-affected",
      "note": "6b18-1.8.4-0ubuntu1~9.10.1"
    },
    {
      "name": "openssl",
      "status": "released",
      "note": "0.9.8g-16ubuntu3.2"
    },
    {
      "name": "gnutls12",
      "status": "DNE",
      "patches": [
        {
          "source": "vendor",
          "text": "https://rhn.redhat.com/errata/RHSA-2010-0166.html"
        }
      ]
    },
    {
      "name": "gnutls13",
      "status": "DNE"
    },
    {
      "name": "libapache-mod-ssl",
      "status": "DNE"
    },
    {
      "name": "openjdk-6",
      "status": "released",
      "note": "6b16-1.6.1-3ubuntu3"
    },
    {
      "name": "nss",
      "status": "released",
      "note": "3.12.6-0ubuntu0.9.10.1"
    }
  ]
}
