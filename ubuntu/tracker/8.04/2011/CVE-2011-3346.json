{
  "candidate": "CVE-2011-3346",
  "description": "Buffer overflow in hw/scsi-disk.c in the SCSI subsystem in QEMU before 0.15.2, as used by Xen, might allow local guest users with permission to access the CD-ROM to cause a denial of service (guest crash) via a crafted SAI READ CAPACITY SCSI command.  NOTE: this is only a vulnerability when root has manually modified certain permissions or ACLs.",
  "notes": {
    "jdstrand": "redhat bug has reproducer non-privileged user in the guest can crash qemu. Requires write access to a scsi device, eg /dev/sr0 this only affected the RedHat xen packages, not qemu. Verified issue does not affect qemu-kvm on Ubuntu 12.04, 11.10, 11.04, 10.10, and 10.04 LTS by attaching a scsi CDROM and performing: sg_raw -r 32768 /dev/sr0 9E 10 00 00 00 00 00 00 00 00 00 04 00 00 00 00 sg_raw -r 32768 /dev/sr0 9E 10 00 00 00 00 00 00 00 00 00 01 00 00 00 00 hypervisor code for xen is in universe",
    "mdeslaur": "code seems different in xen, marking as not-affected"
  },
  "priority": "low",
  "bugs": [
    "https://bugzilla.redhat.com/show_bug.cgi?id=736038"
  ],
  "references": [
    "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-3346"
  ],
  "public_date": "2014-04-01T06:35:00Z",
  "packages": [
    {
      "name": "xen-3.3",
      "status": "DNE",
      "tags": [
        "universe-binary"
      ],
      "patches": [
        {
          "source": "vendor",
          "text": "https://rhn.redhat.com/errata/RHSA-2011-1401.html"
        }
      ]
    },
    {
      "name": "xen",
      "status": "DNE",
      "tags": [
        "universe-binary"
      ],
      "patches": [
        {
          "source": "vendor",
          "text": "https://rhn.redhat.com/errata/RHSA-2011-1401.html"
        }
      ]
    },
    {
      "name": "qemu-kvm",
      "status": "DNE",
      "patches": [
        {
          "source": "other",
          "text": "http://repo.or.cz/w/qemu.git/commit/7285477ab11831b1cf56e45878a89170dd06d9b9"
        },
        {
          "source": "other",
          "text": "http://repo.or.cz/w/qemu.git/commit/103b40f51e4012b3b0ad20f615562a1806d7f49a"
        }
      ]
    },
    {
      "name": "xen-3.1",
      "status": "ignored",
      "note": "reached end-of-life",
      "tags": [
        "universe-binary"
      ]
    },
    {
      "name": "xen-3.2",
      "status": "not-affected",
      "tags": [
        "universe-binary"
      ]
    }
  ]
}
