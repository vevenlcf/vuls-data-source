{
  "candidate": "CVE-2010-4247",
  "description": "The do_block_io_op function in (1) drivers/xen/blkback/blkback.c and (2) drivers/xen/blktap/blktap.c in Xen before 3.4.0 for the Linux kernel 2.6.18, and possibly other versions, allows guest OS users to cause a denial of service (infinite loop and CPU consumption) via a large production request index to the blkback or blktap back-end drivers.  NOTE: some of these details are obtained from third party information.",
  "ubuntu_description": "It was discovered that Xen did not correctly handle certain block requests. A local attacker in a Xen guest could cause the Xen host to use all available CPU resources, leading to a denial of service.",
  "notes": {
    "jdstrand": "xen-3.1 has linux-2.6-xen-sparse/drivers/xen/blkback/blkback.c, but xen-3.2 and xen-3.3 do not marking dapper task as ignored since we no longer support xen userspace on Dapper anyway",
    "smb": "My feeling is that xen-3.1 has code affected, but does not package that up. That would make only Hardy kernel code truely affected. Oneiric not-affected for now (not containing blkback) and when we move to upstream v3.0 is is fixed there."
  },
  "priority": "medium",
  "references": [
    "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-4247",
    "https://ubuntu.com/security/notices/USN-1170-1"
  ],
  "public_date": "2011-01-11T03:00:00Z",
  "public_date_at_usn": "2011-01-10T00:00:00Z",
  "packages": [
    {
      "name": "linux-ec2",
      "status": "DNE"
    },
    {
      "name": "linux-ti-omap4",
      "status": "DNE"
    },
    {
      "name": "linux-lts-backport-maverick",
      "status": "DNE"
    },
    {
      "name": "linux-mvl-dove",
      "status": "DNE"
    },
    {
      "name": "linux-fsl-imx51",
      "status": "DNE"
    },
    {
      "name": "xen-3.1",
      "status": "DNE"
    },
    {
      "name": "linux-source-2.6.15",
      "status": "ignored"
    },
    {
      "name": "linux",
      "status": "DNE",
      "patches": [
        {
          "source": "other",
          "text": "http://xenbits.xensource.com/hg/linux-2.6.18-xen.hg/rev/77f831cbb91d"
        },
        {
          "source": "other",
          "text": "http://xenbits.xensource.com/hg/linux-2.6.18-xen.hg/rev/7070d34f251c"
        }
      ]
    }
  ]
}
