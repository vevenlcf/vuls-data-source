{
  "candidate": "CVE-2005-4890",
  "description": "There is a possible tty hijacking in shadow 4.x before 4.1.5 and sudo 1.x before 1.7.4 via \"su - user -c program\". The user session can be escaped to the parent session by using the TIOCSTI ioctl to push characters into the input buffer to be read by the next process.",
  "notes": {
    "jdstrand": "sudo in 12.04 and higher has the fix for use_pty. A small patch (http://www.sudo.ws/repos/sudo/rev/8d95a163dfc1) can be used to enable it on Ubuntu 11.04 and 11.10.",
    "mdeslaur": "sudo is also apprently vulnerable to this, so the use_pty option was added. We need to verify versions, and make sure it is actually getting honored (apparently the option wasn't working: http://www.openwall.com/lists/oss-security/2011/06/22/4) Please note that use_pty is not enabled by default in sudo, it must be specifically enabled.",
    "seth-arnold": "su interactive has the same problem, no fix known on 20130305"
  },
  "priority": "low",
  "cvss": {
    "nvd": {
      "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
      "score": 7.8,
      "severity": "HIGH"
    }
  },
  "bugs": [
    "http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=262454",
    "http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=628843 (shadow)",
    "https://bugzilla.redhat.com/show_bug.cgi?id=710208",
    "https://bugzilla.redhat.com/show_bug.cgi?id=173008",
    "https://bugzilla.redhat.com/show_bug.cgi?id=199066",
    "https://bugzilla.redhat.com/show_bug.cgi?id=479145",
    "http://www.sudo.ws/bugs/show_bug.cgi?id=142"
  ],
  "references": [
    "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-4890",
    "http://www.openwall.com/lists/oss-security/2011/06/02/3",
    "http://www.openwall.com/lists/oss-security/2012/11/05/8",
    "http://www.ush.it/2009/01/06/25c3-ccc-congress-2008-tricks-makes-you-smile/",
    "http://www.redhat.com/archives/fedora-devel-list/2004-July/msg01314.html"
  ],
  "public_date": "2019-11-04T19:15:00Z",
  "packages": [
    {
      "name": "shadow",
      "status": "ignored",
      "note": "reached end-of-life"
    },
    {
      "name": "sudo",
      "status": "not-affected",
      "note": "1.8.3p2-1ubuntu2",
      "patches": [
        {
          "source": "upstream",
          "text": "http://www.sudo.ws/repos/sudo/rev/aea971f1456a (pt1)"
        },
        {
          "source": "upstream",
          "text": "http://www.sudo.ws/repos/sudo/rev/e7b167f8a6e5 (pt2)"
        },
        {
          "source": "upstream",
          "text": "http://www.sudo.ws/repos/sudo/rev/26120a59c20e (pt3)"
        },
        {
          "source": "upstream",
          "text": "http://www.sudo.ws/repos/sudo/rev/8d95a163dfc1 (pt4)"
        }
      ]
    }
  ]
}
