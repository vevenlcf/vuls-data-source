{
  "candidate": "CVE-2016-4997",
  "description": "The compat IPT_SO_SET_REPLACE and IP6T_SO_SET_REPLACE setsockopt implementations in the netfilter subsystem in the Linux kernel before 4.6.3 allow local users to gain privileges or cause a denial of service (memory corruption) by leveraging in-container root access to provide a crafted offset value that triggers an unintended decrement.",
  "ubuntu_description": "Jesse Hertz and Tim Newsham discovered that the Linux netfilter implementation did not correctly perform validation when handling 32 bit compatibility IPT_SO_SET_REPLACE events on 64 bit platforms. A local unprivileged attacker could use this to cause a denial of service (system crash) or execute arbitrary code with administrative privileges.",
  "notes": {
    "jdstrand": "android kernels (flo, goldfish, grouper, maguro, mako and manta) are not supported on the Ubuntu Touch 14.10 and earlier preview kernels linux-lts-saucy no longer receives official support linux-lts-quantal no longer receives official support",
    "sbeattie": "priority is negligible on precise's 3.2 kernels, as user namespaces are a privileged operation there. For xenial and linux-lts-xenial on trusty, this can be mitigated against by setting the kernel.unprivileged_userns_clone sysctl to 0 to disable userns support. When we fix the netfilter issue we will also add this sysctl to all other supported kernels to allow disabling unprivileged user namespaces. Disabling user namespace may impact chromium-browser, lxc, lxd, docker, and other tools."
  },
  "priority": "high",
  "cvss": {
    "nvd": {
      "vector": "CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
      "score": 7.8,
      "severity": "HIGH"
    }
  },
  "references": [
    "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-4997",
    "https://marc.info/?l=oss-security\u0026m=146679591706851\u0026w=2",
    "https://ubuntu.com/security/notices/USN-3016-1",
    "https://ubuntu.com/security/notices/USN-3016-2",
    "https://ubuntu.com/security/notices/USN-3017-1",
    "https://ubuntu.com/security/notices/USN-3017-3",
    "https://ubuntu.com/security/notices/USN-3016-3",
    "https://ubuntu.com/security/notices/USN-3016-4",
    "https://ubuntu.com/security/notices/USN-3017-2",
    "https://ubuntu.com/security/notices/USN-3020-1",
    "https://ubuntu.com/security/notices/USN-3018-2",
    "https://ubuntu.com/security/notices/USN-3018-1",
    "https://ubuntu.com/security/notices/USN-3019-1",
    "https://ubuntu.com/security/notices/USN-3338-1"
  ],
  "discovered_by": "Jesse Hertz and Tim Newsham",
  "public_date": "2016-07-03T21:59:00Z",
  "public_date_at_usn": "2016-06-24T00:00:00Z",
  "packages": [
    {
      "name": "linux-lts-xenial",
      "status": "DNE"
    },
    {
      "name": "linux-gke",
      "status": "DNE"
    },
    {
      "name": "linux-azure",
      "status": "DNE"
    },
    {
      "name": "linux-qcm-msm",
      "status": "DNE"
    },
    {
      "name": "linux-lts-trusty",
      "status": "DNE"
    },
    {
      "name": "linux-oem",
      "status": "DNE"
    },
    {
      "name": "linux-linaro-omap",
      "status": "DNE"
    },
    {
      "name": "linux-mako",
      "status": "DNE"
    },
    {
      "name": "linux-lts-wily",
      "status": "DNE"
    },
    {
      "name": "linux-gcp",
      "status": "DNE"
    },
    {
      "name": "linux-euclid",
      "status": "DNE"
    },
    {
      "name": "linux-linaro-shared",
      "status": "DNE"
    },
    {
      "name": "linux-aws",
      "status": "DNE"
    },
    {
      "name": "linux-hwe",
      "status": "DNE"
    },
    {
      "name": "linux-kvm",
      "status": "DNE"
    },
    {
      "name": "linux-armadaxp",
      "status": "DNE",
      "tags": [
        "not-ue"
      ]
    },
    {
      "name": "linux-lts-quantal",
      "status": "DNE",
      "tags": [
        "not-ue"
      ]
    },
    {
      "name": "linux-raspi2",
      "status": "not-affected",
      "note": "4.10.0-1004.6"
    },
    {
      "name": "linux-lts-utopic",
      "status": "DNE"
    },
    {
      "name": "linux-lts-vivid",
      "status": "DNE"
    },
    {
      "name": "linux-hwe-edge",
      "status": "DNE"
    },
    {
      "name": "linux-linaro-vexpress",
      "status": "DNE"
    },
    {
      "name": "linux-grouper",
      "status": "DNE"
    },
    {
      "name": "linux",
      "status": "not-affected",
      "note": "4.10.0-19.21",
      "patches": [
        {
          "source": "introduced-by",
          "text": "2722971cbe831117686039d5c334f2c0f560be13"
        },
        {
          "source": "fixed-by",
          "text": "ce683e5f9d045e5d67d1312a42b359cb2ab2a13c"
        },
        {
          "source": "introduced-by",
          "text": "2722971cbe831117686039d5c334f2c0f560be13"
        },
        {
          "source": "fixed-by",
          "text": "6e94e0cfb0887e4013b3b930fa6ab1fe6bb6ba91"
        },
        {
          "source": "introduced-by",
          "text": "2722971cbe831117686039d5c334f2c0f560be13"
        },
        {
          "source": "fixed-by",
          "text": "bdf533de6968e9686df777dc178486f600c6e617"
        }
      ]
    },
    {
      "name": "linux-ti-omap4",
      "status": "DNE"
    },
    {
      "name": "linux-lts-raring",
      "status": "DNE"
    },
    {
      "name": "linux-maguro",
      "status": "DNE"
    },
    {
      "name": "linux-manta",
      "status": "DNE"
    },
    {
      "name": "linux-flo",
      "status": "DNE"
    },
    {
      "name": "linux-lts-saucy",
      "status": "DNE",
      "tags": [
        "not-ue"
      ]
    },
    {
      "name": "linux-goldfish",
      "status": "DNE"
    },
    {
      "name": "linux-snapdragon",
      "status": "not-affected",
      "note": "4.4.0-1050.54"
    }
  ]
}
