{
  "candidate": "CVE-2014-4038",
  "description": "ppc64-diag 2.6.1 allows local users to overwrite arbitrary files via a symlink attack related to (1) rtas_errd/diag_support.c and /tmp/get_dt_files, (2) scripts/ppc64_diag_mkrsrc and /tmp/diagSEsnap/snapH.tar.gz, or (3) lpd/test/lpd_ela_test.sh and /var/tmp/ras.",
  "ubuntu_description": "sbeattie\u003e for (1) rtas_errd/diag_support.c fully fixed in 2.7.0, trusty does not have the second commit below, which should cause the mkstemp() call to fail; so is still not vulnerable. sbeattie\u003e for (2) snap binary is not shipped in powerpc-utils on yakkety and newer, so scripts/ppc64_diag_mkrsrc won't write anything out.  It does not exist in trusty and earlier releases' powerpc-utils, either. For xenial, the snap script will abort as it's not supported on Ubuntu. So no possibility of writing the tar file out in any release; therefore not affected for this part. sbeattie\u003e (3) is unfixed upstream. but is only in a test script that is not included in the package, so is not affected. Yakkety has patches applied by debian for this.",
  "priority": "medium",
  "bugs": [
    "http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=740179"
  ],
  "references": [
    "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-4038",
    "https://bugzilla.redhat.com/show_bug.cgi?id=1109371",
    "https://bugzilla.novell.com/show_bug.cgi?id=882667",
    "http://openwall.com/lists/oss-security/2014/06/17/1"
  ],
  "public_date": "2014-06-17T15:55:00Z",
  "packages": [
    {
      "name": "ppc64-diag",
      "status": "not-affected",
      "note": " 2.7.0-0ubuntu1",
      "patches": [
        {
          "source": "upstream",
          "text": "https://sourceforge.net/p/linux-diag/ppc64-diag/ci/ee3e3311fa4efdb37de44b7459e2db7bb717efaa/"
        },
        {
          "source": "upstream",
          "text": "https://sourceforge.net/p/linux-diag/ppc64-diag/ci/d9899e405d2d364de8a45475d421f65efeb728c8/"
        }
      ]
    }
  ]
}
