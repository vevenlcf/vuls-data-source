{
  "candidate": "CVE-2019-20044",
  "description": "In Zsh before 5.8, attackers able to execute commands can regain privileges dropped by the --no-PRIVILEGED option. Zsh fails to overwrite the saved uid, so the original privileges can be restored by executing MODULE_PATH=/dir/with/module zmodload with a module that calls setuid().",
  "notes": {
    "mdeslaur": "reproducer in debian bug low priority since upstream considers this to be a \"minor vulnerability\"",
    "rodrigo-zaiden": "affects versions prior to 5.8, so only xenial and bionic needed to be patched."
  },
  "priority": "low",
  "cvss": {
    "nvd": {
      "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
      "score": 7.8,
      "severity": "HIGH"
    }
  },
  "bugs": [
    "http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=951458"
  ],
  "references": [
    "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-20044",
    "https://www.zsh.org/mla/zsh-announce/141",
    "https://ubuntu.com/security/notices/USN-5325-1"
  ],
  "discovered_by": "Sam Foxman",
  "public_date": "2020-02-24T14:15:00Z",
  "public_date_at_usn": "2020-02-24T14:15:00Z",
  "packages": [
    {
      "name": "zsh",
      "status": "ignored",
      "note": "end of standard support, was needs-triage",
      "patches": [
        {
          "source": "upstream",
          "text": "https://sourceforge.net/p/zsh/code/ci/24e993db62cf146fb76ebcf677a4a7aa3766fc74/"
        },
        {
          "source": "upstream",
          "text": "https://sourceforge.net/p/zsh/code/ci/8250c5c168f07549ed646e6848e6dda118271e23/"
        },
        {
          "source": "upstream",
          "text": "https://sourceforge.net/p/zsh/code/ci/26d02efa7a9b0a6b32e1a8bbc6aca6c544b94211/"
        },
        {
          "source": "upstream",
          "text": "https://sourceforge.net/p/zsh/code/ci/4ce66857b71b40a0661df3780ff557f2b0f4cb13/"
        },
        {
          "source": "upstream",
          "text": "https://sourceforge.net/p/zsh/code/ci/b15bd4aa590db8087d1e8f2eb1af2874f5db814d/"
        },
        {
          "source": "upstream",
          "text": "https://sourceforge.net/p/zsh/code/ci/048f40b68b05fdd5f3f8d60cda4e69fce2611331/"
        },
        {
          "source": "upstream",
          "text": "https://sourceforge.net/p/zsh/code/ci/4bec892059cf3e95ab256c3fcbc85daaa648c2d9/"
        }
      ]
    }
  ]
}
