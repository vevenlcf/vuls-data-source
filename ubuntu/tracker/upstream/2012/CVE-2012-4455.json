{
  "candidate": "CVE-2012-4455",
  "description": "openCryptoki 2.4.1 allows local users to create or set world-writable permissions on arbitrary files via a symlink attack on the (1) LCK..opencryptoki or (2) LCK..opencryptoki_stdll file in /var/lock/.",
  "notes": {
    "mdeslaur": "2.4.1 moved lock files from /tmp to /var/lock, but /var/lock is world writable on certain distros, such as debian and ubuntu. 2.4.2 moved them to /var/lock/opencryptoki members of the pkcs11 group are considered trusted by upstream and can escalate privileges to root even after the upstream patches. See oss-security discussion. Moving this to /var/lock/opencryptoki makes the problem worse for members of the pkcs11 group as that directory wouldn't be covered by symlink restrictions. Fix shouldn't be applied to natty+ Fixing this in lucid would only prevent users who are not in the pkcs11 group from escalating permissions. Since it is likely that local users that have this installed are in that group, this is downgraded to low."
  },
  "priority": "low",
  "bugs": [
    "http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=689417"
  ],
  "references": [
    "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-4455",
    "http://www.openwall.com/lists/oss-security/2012/09/27",
    "http://www.openwall.com/lists/oss-security/2012/09/07/2"
  ],
  "discovered_by": "Niels Heinen",
  "public_date": "2012-10-10T18:55:00Z",
  "packages": [
    {
      "name": "opencryptoki",
      "status": "released",
      "note": "2.4.2",
      "patches": [
        {
          "source": "upstream",
          "text": "http://opencryptoki.git.sourceforge.net/git/gitweb.cgi?p=opencryptoki/opencryptoki;a=commitdiff;h=b7fcb3eb0319183348f1f4fb90ede4edd6487c30 (pt1)"
        },
        {
          "source": "upstream",
          "text": "http://opencryptoki.git.sourceforge.net/git/gitweb.cgi?p=opencryptoki/opencryptoki;a=commitdiff;h=58345488c9351d9be9a4be27c8b407c2706a33a9 (pt2)"
        },
        {
          "source": "upstream",
          "text": "http://opencryptoki.git.sourceforge.net/git/gitweb.cgi?p=opencryptoki/opencryptoki;a=commitdiff;h=8a63b3b17d34718d0f8c7525f93b5eb3c623076a (pt3)"
        },
        {
          "source": "upstream",
          "text": "http://opencryptoki.git.sourceforge.net/git/gitweb.cgi?p=opencryptoki/opencryptoki;a=commitdiff;h=5667edb52cd27b7e512f48f823b4bcc6b872ab15 (pt4)"
        }
      ]
    }
  ]
}
