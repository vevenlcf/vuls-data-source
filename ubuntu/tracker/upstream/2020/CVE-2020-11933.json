{
  "candidate": "CVE-2020-11933",
  "description": "cloud-init as managed by snapd on Ubuntu Core 16 and Ubuntu Core 18 devices was run without restrictions on every boot, which a physical attacker could exploit by crafting cloud-init user-data/meta-data via external media to perform arbitrary changes on the device to bypass intended security mechanisms such as full disk encryption. This issue did not affect traditional Ubuntu systems. Fixed in snapd version 2.45.2, revision 8539 and core version 2.45.2, revision 9659.",
  "ubuntu_description": "It was discovered that cloud-init as managed by snapd on Ubuntu Core 16 and Ubuntu Core 18 devices ran on every boot without restrictions. A physical attacker could exploit this to craft cloud-init user-data/meta-data via external media to perform arbitrary changes on the device to bypass intended security mechanisms such as full disk encryption. This issue did not affect traditional Ubuntu systems. (CVE-2020-11933)",
  "notes": {
    "jdstrand": "cloud-init as managed by snapd is only used on Ubuntu Core 16 and 18 devices. This does not affect traditional Ubuntu cloud, desktop and server systems or the upcoming Ubuntu Core 20. Since the attack requires physical presence, the vulnerability provides no additional access to standard Ubuntu Core devices. For Ubuntu Core devices with full disk encryption, the vulnerability allows admin access to the device after the disk has been decrypted. snapd will be updated to disable/restrict cloud-init after the first boot. Since this does not affect traditional deb-based Ubuntu systems, security updates will not be provided for the snapd deb in the Ubuntu archive and these debs are marked as 'not-affected'. For notification purposes we will issue a USN for this. Ubuntu Core 16 devices will be updated via the 'core' snap which includes snapd Ubuntu Core 18 devices will be updated via the 'snapd' snap (which is provided separated from the core18 snap) 20.04 LTS Raspberry Pi images are affected but do not include FDE. A non-security bug task has been added to https://launchpad.net/bugs/1879530."
  },
  "priority": "medium",
  "cvss": {
    "nvd": {
      "vector": "CVSS:3.1/AV:P/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
      "score": 6.8,
      "severity": "MEDIUM"
    },
    "ubuntu": {
      "vector": "CVSS:3.1/AV:P/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H",
      "score": 7.6,
      "severity": "HIGH"
    }
  },
  "mitigation": "jdstrand\u003e On provisioned devices, disable cloud-init using:\n $ sudo systemctl disable cloud-init\njdstrand\u003e For unprovisioned devices, provision then disable cloud-init",
  "bugs": [
    "https://launchpad.net/bugs/1879530"
  ],
  "references": [
    "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-11933",
    "https://ubuntu.com/security/notices/USN-4424-1"
  ],
  "assigned_to": "jdstrand",
  "discovered_by": "Ian Johnson",
  "public_date": "2020-07-29T17:15:00Z",
  "public_date_at_usn": "2020-07-15T12:00:00Z",
  "crd": "2020-07-15T12:00:00Z",
  "packages": [
    {
      "name": "core18",
      "status": "not-affected"
    },
    {
      "name": "core20",
      "status": "not-affected"
    },
    {
      "name": "snapd",
      "status": "released",
      "note": "2.45.2"
    },
    {
      "name": "core",
      "status": "not-affected"
    }
  ]
}
