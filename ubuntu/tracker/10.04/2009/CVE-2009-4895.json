{
  "candidate": "CVE-2009-4895",
  "description": "Race condition in the tty_fasync function in drivers/char/tty_io.c in the Linux kernel before 2.6.32.6 allows local users to cause a denial of service (NULL pointer dereference and system crash) or possibly have unspecified other impact via unknown vectors, related to the put_tty_queue and __f_setown functions.  NOTE: the vulnerability was addressed in a different way in 2.6.32.9.",
  "ubuntu_description": "Al Viro discovered a race condition in the TTY driver. A local attacker could exploit this to crash the system, leading to a denial of service.",
  "notes": {
    "sbeattie": "first patch (703625118069f9f8) was reverted and the second patch was used in 2.6.32.9, which fixes the issue \"properly\".",
    "smb": "IMO the races in tty became visible when the BLK was pushed down into the line disciplines and switch to unlocked ioctl in 2.6.26 (04f378b198da233ca0aca341b113dc6579d46123), so Hardy and Dapper are not affected."
  },
  "priority": "low",
  "references": [
    "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-4895",
    "https://ubuntu.com/security/notices/USN-1000-1",
    "https://ubuntu.com/security/notices/USN-1074-1",
    "https://ubuntu.com/security/notices/USN-1074-2",
    "https://ubuntu.com/security/notices/USN-1083-1"
  ],
  "assigned_to": "smb",
  "public_date": "2010-09-08T20:00:00Z",
  "public_date_at_usn": "2010-09-08T00:00:00Z",
  "packages": [
    {
      "name": "linux",
      "status": "not-affected",
      "note": "2.6.32-15.21",
      "patches": [
        {
          "source": "upstream",
          "text": "http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git;a=commitdiff;h=703625118069f9f8960d356676662d3db5a9d116"
        },
        {
          "source": "upstream",
          "text": "http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git;a=commitdiff;h=80e1e823989ec44d8e35bdfddadbddcffec90424"
        },
        {
          "source": "jaunty",
          "text": "http://chinstrap.ubuntu.com/~smb/CVEs/CVE-2009-4895/patches/jaunty/linux/0001-Fix-race-in-tty_fasync-properly.txt"
        },
        {
          "source": "karmic",
          "text": "http://chinstrap.ubuntu.com/~smb/CVEs/CVE-2009-4895/patches/karmic/linux/0001-Fix-race-in-tty_fasync-properly.txt"
        }
      ]
    },
    {
      "name": "linux-fsl-imx51",
      "status": "released",
      "note": "2.6.31-608.22"
    },
    {
      "name": "linux-ec2",
      "status": "released",
      "note": "2.6.32-309.18"
    },
    {
      "name": "linux-lts-backport-maverick",
      "status": "released",
      "note": "2.6.35-25.44~lucid1"
    },
    {
      "name": "linux-source-2.6.15",
      "status": "DNE"
    }
  ]
}
