{
  "vulinfo_id": "JVNDB-2022-001706",
  "title": "Qt 製 Windows アプリケーションにおける権限昇格の脆弱性",
  "vulinfo_description": "The Qt Company が提供する Qt はマルチプラットフォーム向けアプリケーションフレームワークです。Qt で作成されたWindowsアプリケーションでは、 Qt 開発ツールのインストールパスが qt_prfxpath にハードコードされており、当該アプリケーションはこれらのパスから必要なモジュールをロードしようとします。  qt_prfxpath が指しているディレクトリは、例えば Qt の Windows インストーラーの初期設定では C:\\Qt\\ のサブディレクトリとなっており、Windows システムの一般ユーザがこのディレクトリを作成して悪意あるファイルを置き、Qt アプリケーションに読み込ませることが可能となっている場合があります。 ",
  "affected": [
    {
      "name": "The Qt Company",
      "product_name": "Qt",
      "version_number": [
        "5.14より前のバージョン"
      ],
      "cpe": {
        "version": "2.2",
        "text": "cpe:/a:qt:qt"
      }
    },
    {
      "name": "The Qt Company",
      "product_name": "windeployqt",
      "version_number": [
        "commit:c2952ff8df1e18fe0120d8b29901b0b794afccc7 以降を取り込んでいないバージョン"
      ],
      "cpe": {
        "version": "2.2",
        "text": "cpe:/a:qt:qtwebkit_windeployqt"
      }
    }
  ],
  "impact": {
    "impact_item": "Qt で作成された Windows アプリケーションが特権を使用して実行される場合、Windows システムの一般ユーザが qt_prfxpath が指しているディレクトリに悪意をもったファイルを用意しておくことで、当該 Qt アプリの権限で任意のコードを実行させる可能性があります。 "
  },
  "solution": "Qt を利用した Windows アプリケーションの開発者は、以下のどちらかを実施してください。  [Qt をアップデートしてアプリケーションを作成し直す] The Qt Company が提供する情報をもとに、Qt 開発環境を最新版へアップデートし、アプリケーションを作成し直してください。 Qt プロジェクトによると、Qt 5.14 以降では本脆弱性の対策が行われているとのことです。  [最新の windeployqt ツールを使ってアプリケーションを作成し直す] Qt 開発環境を最新版に更新できない場合でも、アプリケーションのパッケージ化を行うツール windeployqt の commit:c2952ff8df1e18fe0120d8b29901b0b794afccc7 以降を含む最新版を使用することで、Qt5Core.dll に含まれる qt_prfxpath の値を削除できるとのことです。 ",
  "related": [
    {
      "type": "vendor",
      "name": "Qt",
      "vulinfo_id": "[QTBUG-15234] Qt hard-codes paths in libraries/binaries",
      "url": "https://bugreports.qt.io/browse/QTBUG-15234"
    },
    {
      "type": "vendor",
      "name": "Qt",
      "vulinfo_id": "Qt for Windows - Deployment",
      "url": "https://doc.qt.io/qt-5/windows-deployment.html"
    },
    {
      "type": "vendor",
      "name": "Qt",
      "vulinfo_id": "windeployqt: Patch qt_prfxpath when deploying Qt5Core",
      "url": "https://codereview.qt-project.org/gitweb?p=qt%2Fqttools.git\u0026a=commit\u0026h=c2952ff8df1e18fe0120d8b29901b0b794afccc7"
    },
    {
      "type": "advisory",
      "name": "Common Vulnerabilities and Exposures (CVE)",
      "vulinfo_id": "CVE-2022-26873",
      "url": "https://www.cve.org/CVERecord?id=CVE-2022-26873"
    },
    {
      "type": "advisory",
      "name": "JVN",
      "vulinfo_id": "JVNVU#92669710",
      "url": "https://jvn.jp/vu/JVNVU92669710/"
    },
    {
      "type": "advisory",
      "name": "US-CERT Vulnerability Note",
      "vulinfo_id": "VU#411271",
      "url": "https://www.kb.cert.org/vuls/id/411271"
    }
  ],
  "history": [
    {
      "history_no": "1",
      "date_time": "2022-05-10T05:04:44Z",
      "description": "[2022年05月10日]   掲載"
    }
  ],
  "date_first_published": "2022-05-10T14:55:09+09:00",
  "date_last_updated": "2022-05-10T14:55:09+09:00",
  "date_public": "2022-05-09T00:00:00+09:00"
}
