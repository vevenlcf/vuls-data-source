{
  "vulinfo_id": "JVNDB-2021-001967",
  "title": "Microsoft Windows の印刷スプーラーにリモートコード実行の脆弱性",
  "vulinfo_description": "Microsoft Windows の Print Spooler サービスには、RpcAddPrinterDriverEx() 関数のアクセス制限の不備に起因するリモートコード実行の脆弱性が存在します。  Print Spooler サービスは、印刷において印刷待ちを実現するためのサービスです。RpcAddPrinterDriverEx() 関数は、上記サービスでプリンタドライバのインストールに用いられます。パラメータ DRIVER_CONTAINER オブジェクトとパラメータ dwFileCopyFlags によって、インストールするプリンタドライバとファイルのコピー方法を制御しています。 認証ユーザであれば、RpcAddPrinterDriverEx() 関数を実行可能です。そのため、認証情報を取得した攻撃者は、リモートサーバ上のドライバを指定し、インストールできます。",
  "affected": [
    {
      "name": "マイクロソフト",
      "product_name": "Microsoft Windows 10",
      "cpe": {
        "version": "2.2",
        "text": "cpe:/o:microsoft:windows_10"
      }
    },
    {
      "name": "マイクロソフト",
      "product_name": "Microsoft Windows 7",
      "cpe": {
        "version": "2.2",
        "text": "cpe:/o:microsoft:windows_7"
      }
    },
    {
      "name": "マイクロソフト",
      "product_name": "Microsoft Windows 8.1",
      "cpe": {
        "version": "2.2",
        "text": "cpe:/o:microsoft:windows_8.1"
      }
    },
    {
      "name": "マイクロソフト",
      "product_name": "Microsoft Windows RT 8.1",
      "cpe": {
        "version": "2.2",
        "text": "cpe:/o:microsoft:windows_rt_8.1"
      }
    },
    {
      "name": "マイクロソフト",
      "product_name": "Microsoft Windows Server",
      "cpe": {
        "version": "2.2",
        "text": "cpe:/o:microsoft:windows_server"
      }
    },
    {
      "name": "マイクロソフト",
      "product_name": "Microsoft Windows Server 2008",
      "version_number": [
        "R2"
      ],
      "cpe": {
        "version": "2.2",
        "text": "cpe:/o:microsoft:windows_server_2008"
      }
    },
    {
      "name": "マイクロソフト",
      "product_name": "Microsoft Windows Server 2012",
      "version_number": [
        "R2"
      ],
      "cpe": {
        "version": "2.2",
        "text": "cpe:/o:microsoft:windows_server_2012"
      }
    },
    {
      "name": "マイクロソフト",
      "product_name": "Microsoft Windows Server 2016",
      "cpe": {
        "version": "2.2",
        "text": "cpe:/o:microsoft:windows_server_2016"
      }
    },
    {
      "name": "マイクロソフト",
      "product_name": "Microsoft Windows Server 2019",
      "cpe": {
        "version": "2.2",
        "text": "cpe:/o:microsoft:windows_server_2019"
      }
    }
  ],
  "impact": {
    "cvss": [
      {
        "version": "3.0",
        "severity": {
          "type": "Base",
          "text": "High"
        },
        "base": "8.8",
        "vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
      }
    ],
    "impact_item": "認証された遠隔の第三者によって、SYSTEM 権限で任意のコードを実行される可能性があります。"
  },
  "solution": "[アップデートする] \u003ca href=\"https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34527\" target=\"_blank\"\u003eMicrosoftが公開している情報\u003c/a\u003eをもとに、最新版へアップデートしてください。 またMicrosoftは、アップデート実施後に以下の設定を実施することを推奨しています。 詳しくは、\u003ca href=\"https://support.microsoft.com/ja-jp/topic/kb5005010-restricting-installation-of-new-printer-drivers-after-applying-the-july-6-2021-updates-31b91c02-05bc-4ada-a7ea-183b129578a7\" target=\"_blank\"\u003eKB5005010\u003c/a\u003e の内容を参照ください。  　* グループポリシーを使用して、\u003ca href=\"https://docs.microsoft.com/ja-jp/windows-hardware/drivers/print/introduction-to-point-and-print\" target=\"_blank\"\u003eポイント アンド プリント\u003c/a\u003eを無効にする 　* 非管理者アカウントがプリンタドライバをインストールできないよう制限する  [ワークアラウンドを実施する] 次のワークアラウンドを実施することで、本脆弱性の影響を軽減することが可能です。  　* Print Spooler サービスを停止し、無効にする 　* グループポリシーを使用して、インバウンドからのリモート印刷を無効にする",
  "related": [
    {
      "type": "vendor",
      "name": "Microsoft",
      "vulinfo_id": "ポイント アンド プリントの概要",
      "url": "https://docs.microsoft.com/ja-jp/windows-hardware/drivers/print/introduction-to-point-and-print"
    },
    {
      "type": "vendor",
      "name": "Microsoft",
      "vulinfo_id": "3.1.4.4.8 RpcAddPrinterDriverEx (Opnum 89)",
      "url": "https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-rprn/b96cc497-59e5-4510-ab04-5484993b259b"
    },
    {
      "type": "vendor",
      "name": "Microsoft",
      "vulinfo_id": "3.1.4.1.8.3 DRIVER_CONTAINER Parameters",
      "url": "https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-rprn/353ff796-6fb3-41cf-8b35-0022dd53d886"
    },
    {
      "type": "vendor",
      "name": "Microsoft",
      "vulinfo_id": "Windows Print Spooler の脆弱性情報 (CVE-2021-34527) に対するセキュリティ更新プログラムの定例外での公開",
      "url": "https://msrc-blog.microsoft.com/2021/07/06/20210707_windowsprintspooleroob/"
    },
    {
      "type": "vendor",
      "name": "Microsoft Knowledge Base",
      "vulinfo_id": "KB5005010: Restricting installation of new printer drivers after applying the July 6, 2021 updates",
      "url": "https://support.microsoft.com/ja-jp/topic/kb5005010-restricting-installation-of-new-printer-drivers-after-applying-the-july-6-2021-updates-31b91c02-05bc-4ada-a7ea-183b129578a7"
    },
    {
      "type": "vendor",
      "name": "Security Update Guide",
      "vulinfo_id": "CVE-2021-34527 | Windows Print Spooler Remote Code Execution Vulnerability",
      "url": "https://portal.msrc.microsoft.com/security-guidance/advisory/CVE-2021-34527"
    },
    {
      "type": "advisory",
      "name": "Common Vulnerabilities and Exposures (CVE)",
      "vulinfo_id": "CVE-2021-34527",
      "url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-34527"
    },
    {
      "type": "advisory",
      "name": "IPA 重要なセキュリティ情報",
      "vulinfo_id": "Microsoft Windows 製品の Windows Print Spooler の脆弱性対策について(CVE-2021-34527)",
      "url": "https://www.ipa.go.jp/security/ciadr/vul/20210705-ms.html"
    },
    {
      "type": "advisory",
      "name": "JPCERT 注意喚起",
      "vulinfo_id": "JPCERT-AT-2021-0029",
      "url": "https://www.jpcert.or.jp/at/2021/at210029.html"
    },
    {
      "type": "advisory",
      "name": "JVN",
      "vulinfo_id": "JVNVU#96262037",
      "url": "http://jvn.jp/cert/JVNVU96262037"
    },
    {
      "type": "advisory",
      "name": "National Vulnerability Database (NVD)",
      "vulinfo_id": "CVE-2021-34527",
      "url": "https://nvd.nist.gov/vuln/detail/CVE-2021-34527"
    },
    {
      "type": "advisory",
      "name": "US-CERT Current Activity",
      "vulinfo_id": "PrintNightmare, Critical Windows Print Spooler Vulnerability",
      "url": "https://us-cert.cisa.gov/ncas/current-activity/2021/06/30/printnightmare-critical-windows-print-spooler-vulnerability"
    },
    {
      "type": "advisory",
      "name": "US-CERT Vulnerability Note",
      "vulinfo_id": "VU#383432",
      "url": "https://kb.cert.org/vuls/id/383432"
    }
  ],
  "history": [
    {
      "history_no": "1",
      "date_time": "2021-07-06T02:42:54Z",
      "description": "[2021年07月06日]   掲載"
    },
    {
      "history_no": "2",
      "date_time": "2021-07-08T06:17:02Z",
      "description": "[2021年07月08日]\\n  対策：内容を更新\\n  ベンダ情報：マイクロソフト (Windows Print Spooler の脆弱性情報 (CVE-2021-34527) に対するセキュリティ更新プログラムの定例外での公開) を追加\\n  ベンダ情報：マイクロソフト (ポイント アンド プリントの概要) を追加\\n  ベンダ情報：マイクロソフト (KB5005010: Restricting installation of new printer drivers after applying the July 6, 2021 updates) を追加"
    }
  ],
  "date_first_published": "2021-07-06T15:07:47+09:00",
  "date_last_updated": "2021-07-08T17:31:40+09:00",
  "date_public": "2021-07-05T00:00:00+09:00"
}
