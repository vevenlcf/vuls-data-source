{
  "vulinfo_id": "JVNDB-2021-001387",
  "title": "複数の RTOS やライブラリなどにメモリ割り当て処理における脆弱性 (\"BadAlloc\")",
  "vulinfo_description": "複数の RTOS (Real Time Operating System) 製品やライブラリなどに、メモリ割り当て処理における脆弱性が報告されています。  メモリ割り当て処理においては、リクエストされたメモリサイズに対してシステムによるメモリ管理領域やアラインメント調整で必要とされるサイズを加算して、実際に確保するメモリサイズを計算します。この計算結果がシステム内で正しく表現できる範囲の値より大きくなってしまう場合には桁あふれを起こすため、その計算結果を使って以後の処理を継続すると異常動作につながります。したがってメモリ割り当て処理においては、リクエストされるメモリサイズが一定の範囲に収まっていることや計算処理が正しく行われることを検証する必要があります。 報告者らは、RTOS やライブラリ製品の実装状況を調査し、メモリ割り当て処理のなかで必要な検証を行っていない実装が複数存在することを発見しました。 報告者らは、彼らが発見し開発者と調整した脆弱性を総称して \"BadAlloc\" と呼んでいます。",
  "affected": [
    {
      "name": "Amazon.com, Inc.",
      "product_name": "Amazon FreeRTOS",
      "version_number": [
        "Version 10.4.1"
      ],
      "cpe": {
        "version": "2.2",
        "text": "cpe:/a:amazon:freertos"
      }
    },
    {
      "name": "Apache Software Foundation",
      "product_name": "Apache NuttX",
      "version_number": [
        "OS Version 9.1.0"
      ],
      "cpe": {
        "version": "2.2",
        "text": "cpe:/a:apache:nuttx"
      }
    },
    {
      "name": "ARM Ltd.",
      "product_name": "CMSIS-RTOS2",
      "version_number": [
        "Version 2.1.3 より前のバージョン"
      ],
      "cpe": {
        "version": "2.2",
        "text": "cpe:/o:arm:cmsis-rtos2"
      }
    },
    {
      "name": "ARM Ltd.",
      "product_name": "Mbed OS",
      "version_number": [
        "Version 6.3.0"
      ],
      "cpe": {
        "version": "2.2",
        "text": "cpe:/o:arm:mbed"
      }
    },
    {
      "name": "ARM Ltd.",
      "product_name": "mbed-uallaoc",
      "version_number": [
        "Version 1.3.0"
      ],
      "cpe": {
        "version": "2.2",
        "text": "cpe:/o:arm:mbed-uallaoc"
      }
    },
    {
      "name": "BlackBerry",
      "product_name": "QNX CAR Development Platform",
      "version_number": [
        "2.0RR"
      ],
      "cpe": {
        "version": "2.2",
        "text": "cpe:/o:blackberry:qnx_car_development_platform"
      }
    },
    {
      "name": "BlackBerry",
      "product_name": "QNX Cross Development Kit",
      "version_number": [
        "6.0.0",
        "6.1.0"
      ],
      "cpe": {
        "version": "2.2",
        "text": "cpe:/o:blackberry:qnx_cross_development_kit"
      }
    },
    {
      "name": "BlackBerry",
      "product_name": "QNX Development Kit",
      "version_number": [
        "(Self-hosted) 6.0.0",
        "(Self-hosted) 6.1.0"
      ],
      "cpe": {
        "version": "2.2",
        "text": "cpe:/o:blackberry:qnx_development_kit"
      }
    },
    {
      "name": "BlackBerry",
      "product_name": "QNX Momentics",
      "version_number": [
        "6.2.0",
        "6.2.1",
        "6.2.1A",
        "6.2.1b",
        "6.3.0",
        "6.3.0SP1",
        "6.3.0SP2",
        "6.3.0SP3"
      ],
      "cpe": {
        "version": "2.2",
        "text": "cpe:/o:blackberry:qnx_momentics"
      }
    },
    {
      "name": "BlackBerry",
      "product_name": "QNX Momentics Development Suite",
      "version_number": [
        "6.3.2"
      ],
      "cpe": {
        "version": "2.2",
        "text": "cpe:/o:blackberry:qnx_momentics_development_suite"
      }
    },
    {
      "name": "BlackBerry",
      "product_name": "QNX Neutrino RTOS Certified Plus",
      "version_number": [
        "1.0"
      ],
      "cpe": {
        "version": "2.2",
        "text": "cpe:/o:blackberry:qnx_neutrino_rtos_certified_plus"
      }
    },
    {
      "name": "BlackBerry",
      "product_name": "QNX Neutrino RTOS for Medical Devices",
      "version_number": [
        "1.0",
        "1.1"
      ],
      "cpe": {
        "version": "2.2",
        "text": "cpe:/o:blackberry:qnx_neutrino_rtos_for_medical_devices"
      }
    },
    {
      "name": "BlackBerry",
      "product_name": "QNX Neutrino RTOS Safe Kernel",
      "version_number": [
        "1.0"
      ],
      "cpe": {
        "version": "2.2",
        "text": "cpe:/o:blackberry:qnx_neutrino_rtos_safe_kernel"
      }
    },
    {
      "name": "BlackBerry",
      "product_name": "QNX Neutrino Secure Kernel",
      "version_number": [
        "6.4.0",
        "6.5.0"
      ],
      "cpe": {
        "version": "2.2",
        "text": "cpe:/o:blackberry:qnx_neutrino_secure_kernel"
      }
    },
    {
      "name": "BlackBerry",
      "product_name": "QNX OS for Automotive Safety",
      "version_number": [
        "1.0"
      ],
      "cpe": {
        "version": "2.2",
        "text": "cpe:/o:blackberry:qnx_os_for_automotive_safety"
      }
    },
    {
      "name": "BlackBerry",
      "product_name": "QNX OS for Safety",
      "version_number": [
        "1.0",
        "1.0.1"
      ],
      "cpe": {
        "version": "2.2",
        "text": "cpe:/o:blackberry:qnx_os_for_safety"
      }
    },
    {
      "name": "BlackBerry",
      "product_name": "QNX Realtime Platform",
      "version_number": [
        "6.0.0",
        "6.0.0a",
        "6.1.0",
        "6.1.0a"
      ],
      "cpe": {
        "version": "2.2",
        "text": "cpe:/o:blackberry:qnx_realtime_platform"
      }
    },
    {
      "name": "BlackBerry",
      "product_name": "QNX SDP",
      "version_number": [
        "6.4.0",
        "6.4.1",
        "6.5.0",
        "6.5.0SP1"
      ],
      "cpe": {
        "version": "2.2",
        "text": "cpe:/o:blackberry:qnx_sdp"
      }
    },
    {
      "name": "Cesanta",
      "product_name": "Mongoose OS",
      "version_number": [
        "v2.17.0"
      ],
      "cpe": {
        "version": "2.2",
        "text": "cpe:/o:cesanta:mongoose_os"
      }
    },
    {
      "name": "eCosCentric",
      "product_name": "eCosPro RTOS",
      "version_number": [
        "Version 2.0.1 から 4.5.3 まで"
      ],
      "cpe": {
        "version": "2.2",
        "text": "cpe:/o:misc:ecoscentric_ecospro_rtos"
      }
    },
    {
      "name": "Google",
      "product_name": "Cloud IoT Device SDK",
      "version_number": [
        "Version 1.0.2"
      ],
      "cpe": {
        "version": "2.2",
        "text": "cpe:/o:google:cloud_iot_device_sdk"
      }
    },
    {
      "name": "Media Tek",
      "product_name": "LinkIt SDK",
      "version_number": [
        "Version 4.6.1 より前のバージョン"
      ],
      "cpe": {
        "version": "2.2",
        "text": "cpe:/o:misc:media_tek_linkit_sdk"
      }
    },
    {
      "name": "newlib project",
      "product_name": "newlib",
      "version_number": [
        "Version 4.0.0 より前のバージョン"
      ],
      "cpe": {
        "version": "2.2",
        "text": "cpe:/a:newlib_project:newlib"
      }
    },
    {
      "name": "NXP Semiconductors",
      "product_name": "MCUXpresso SDK",
      "version_number": [
        "Version 2.8.2 より前のバージョン"
      ],
      "cpe": {
        "version": "2.2",
        "text": "cpe:/a:nxp:mcuxpresso_software_development_kit"
      }
    },
    {
      "name": "NXP Semiconductors",
      "product_name": "MQX",
      "version_number": [
        "Versions 5.1 およびそれ以前"
      ],
      "cpe": {
        "version": "2.2",
        "text": "cpe:/o:nxp:mqx"
      }
    },
    {
      "name": "RIOT project",
      "product_name": "RIOT OS",
      "version_number": [
        "Version 2020.01.1"
      ],
      "cpe": {
        "version": "2.2",
        "text": "cpe:/o:riot_project:riot-os"
      }
    },
    {
      "name": "Silicon Labs, Inc.",
      "product_name": "Micrium OS",
      "version_number": [
        "Versions 5.10.1 およびそれ以前"
      ],
      "cpe": {
        "version": "2.2",
        "text": "cpe:/o:silabs:micrium_os"
      }
    },
    {
      "name": "Silicon Labs, Inc.",
      "product_name": "Micrium uC/LIB",
      "version_number": [
        "Version 1.38 系および Version 1.39.00"
      ],
      "cpe": {
        "version": "2.2",
        "text": "cpe:/o:silabs:micrium_uc_lib"
      }
    },
    {
      "name": "Tencent",
      "product_name": "TencentOS-tiny",
      "version_number": [
        "Version 3.1.0"
      ],
      "cpe": {
        "version": "2.2",
        "text": "cpe:/o:qqplayer:tencentos-tiny"
      }
    },
    {
      "name": "Texas Instruments Incorporated (TI)",
      "product_name": "CC32XX",
      "version_number": [
        "Version 4.40.00.07 より前のバージョン"
      ],
      "cpe": {
        "version": "2.2",
        "text": "cpe:/o:ti:cc32xx"
      }
    },
    {
      "name": "Texas Instruments Incorporated (TI)",
      "product_name": "SimpleLink MSP432E4XX",
      "cpe": {
        "version": "2.2",
        "text": "cpe:/o:ti:simplelink_msp432e4xx"
      }
    },
    {
      "name": "Texas Instruments Incorporated (TI)",
      "product_name": "SimpleLink-CC13XX",
      "version_number": [
        "Version 4.40.00 より前のバージョン"
      ],
      "cpe": {
        "version": "2.2",
        "text": "cpe:/o:ti:simplelink-cc13xx"
      }
    },
    {
      "name": "Texas Instruments Incorporated (TI)",
      "product_name": "SimpleLink-CC26XX",
      "version_number": [
        "Version 4.40.00 より前のバージョン"
      ],
      "cpe": {
        "version": "2.2",
        "text": "cpe:/o:ti:simplelink-cc26xx"
      }
    },
    {
      "name": "Texas Instruments Incorporated (TI)",
      "product_name": "SimpleLink-CC32XX",
      "version_number": [
        "Version 4.10.03 より前のバージョン"
      ],
      "cpe": {
        "version": "2.2",
        "text": "cpe:/o:ti:simplelink-cc32xx"
      }
    },
    {
      "name": "uClibc-ng project",
      "product_name": "uClibc-ng",
      "version_number": [
        "Version 1.0.36 より前のバージョン"
      ],
      "cpe": {
        "version": "2.2",
        "text": "cpe:/a:uclibc-ng_project:uclibc-ng"
      }
    },
    {
      "name": "Zephyr Project",
      "product_name": "RTOS",
      "version_number": [
        "2.5 より前のバージョン"
      ],
      "cpe": {
        "version": "2.2",
        "text": "cpe:/o:zephyrproject:zephyr_rtos"
      }
    },
    {
      "name": "ウインドリバー株式会社",
      "product_name": "VxWorks",
      "version_number": [
        "7.0 より前のバージョン"
      ],
      "cpe": {
        "version": "2.2",
        "text": "cpe:/o:windriver:vxworks"
      }
    },
    {
      "name": "サムスン",
      "product_name": "Tizen RT RTOS",
      "version_number": [
        "Version 3.0.GBB より前のバージョン"
      ],
      "cpe": {
        "version": "2.2",
        "text": "cpe:/o:samsung:tizen_rt_rtos"
      }
    }
  ],
  "impact": {
    "impact_item": "想定される影響は各製品により異なりますが、次のような影響を受ける可能性があります。  　* デバイスをクラッシュさせられる 　* 任意のコードを実行される  詳細については、個々の製品開発者が提供している情報を確認してください。"
  },
  "solution": "[アップデートする] 本脆弱性の影響を受ける製品を使用している場合、製品開発者が提供する情報をもとに、最新版にアップデートしてください。 以下の製品については、本脆弱性を修正したバージョンがリリースされています。  　* Amazon FreeRTOS 　* Apache Nuttx OS Version 9.1.0 　* ARM Mbed OS 　* BlackBerry QNX SDP 6.6.0 　* BlackBerry QNX Neutrino RTOS for Medical Devices 1.1.1 　* BlackBerry QNX OS for Safety 1.0.2 　* Cesanta Software mongooses 　* eCosCentric eCosPro RTOS Versions 4.5.4 および最新バージョン 　* Google Cloud IoT Device SDK 　* Media Tek LinkIt SDK (ただし、無料版は除く) 　* Micrium OS v5.10.2 および最新バージョン 　* Micrium uC/LIB 1.39.01 　* NXP MCUXpresso SDK 2.9.0 および最新バージョン 　* NXP MQX 5.1 および最新バージョン 　* Redhat newlib 　* RIOT OS 　* Samsung Tizen RT RTOS 　* TencentOS-tiny 　* Texas Instruments CC32XX v4.40.00.07 　* Texas Instruments SimpleLink CC13X0 　* Texas Instruments SimpleLink CC13X2-CC26X2 　* Texas Instruments SimpleLink CC2640R2 　* uClibc-ng 　* Windriver VxWorks　　 　　　* Hitachi Energy RTU500 series CMU (RTOSにWindriver VxWorksを使用) 　* Zephyr Project (旧サポートバージョンにはパッチが提供されています。詳細は製品開発者が提供している情報を確認してください。) ",
  "related": [
    {
      "type": "vendor",
      "name": "BlackBerry Knowledge Base",
      "vulinfo_id": "QNX-2021-001 Vulnerability in the C Runtime Library Impacts BlackBerry QNX Software Development Platform (SDP), QNX OS for Medical, and QNX OS for Safety",
      "url": "https://support.blackberry.com/kb/articleDetail?articleNumber=000082334"
    },
    {
      "type": "vendor",
      "name": "eCosCentric",
      "vulinfo_id": "Issue Management System",
      "url": "https://bugzilla.ecoscentric.com/show_bug.cgi?id=1002437"
    },
    {
      "type": "vendor",
      "name": "GitHub",
      "vulinfo_id": "apache / incubator-nuttx",
      "url": "https://github.com/apache/incubator-nuttx"
    },
    {
      "type": "vendor",
      "name": "GitHub",
      "vulinfo_id": "RIOT-OS / RIOT",
      "url": "https://github.com/RIOT-OS/RIOT"
    },
    {
      "type": "vendor",
      "name": "GitHub",
      "vulinfo_id": "Add integer overflow check to the malloc wrappers #14408",
      "url": "https://github.com/ARMmbed/mbed-os/pull/14408"
    },
    {
      "type": "vendor",
      "name": "GitHub",
      "vulinfo_id": "Samsung / TizenRT",
      "url": "https://github.com/Samsung/TizenRT"
    },
    {
      "type": "vendor",
      "name": "GitHub",
      "vulinfo_id": "cesanta / mongoose-os",
      "url": "https://github.com/cesanta/mongoose-os"
    },
    {
      "type": "vendor",
      "name": "GitHub",
      "vulinfo_id": "GHSA-94vp-8gc2-rm45: Integer Overflow in memory allocating functions",
      "url": "https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-94vp-8gc2-rm45"
    },
    {
      "type": "vendor",
      "name": "GitHub",
      "vulinfo_id": "GoogleCloudPlatform / iot-device-sdk-embedded-c",
      "url": "https://github.com/GoogleCloudPlatform/iot-device-sdk-embedded-c/pull/119/files"
    },
    {
      "type": "vendor",
      "name": "GitHub",
      "vulinfo_id": "Improve heap2 bounds checking #224",
      "url": "https://github.com/FreeRTOS/FreeRTOS-Kernel/pull/224"
    },
    {
      "type": "vendor",
      "name": "Hitachi Energy",
      "vulinfo_id": "BadAlloc - Memory Allocation Vulnerabilities in Hitachi Energy RTU500 series",
      "url": "https://search.abb.com/library/Download.aspx?DocumentID=8DBD000065\u0026Action=Launch"
    },
    {
      "type": "vendor",
      "name": "Hitachi Energy",
      "vulinfo_id": "BadAlloc - Memory Allocation Vulnerabilities in Hitachi ABB Power Grids Modular Switchgear Monitoring System (MSM) Product",
      "url": "https://search.abb.com/library/Download.aspx?DocumentID=9AKK107992A5975\u0026LanguageCode=en\u0026DocumentPartId=\u0026Action=Launch"
    },
    {
      "type": "vendor",
      "name": "Hitachi Energy",
      "vulinfo_id": "BadAlloc - Memory Allocation Vulnerabilities in Hitachi Energy GMS600 Product (PDF)",
      "url": "https://search.abb.com/library/Download.aspx?DocumentID=8DBD000072\u0026LanguageCode=en\u0026DocumentPartId=\u0026Action=Launch"
    },
    {
      "type": "vendor",
      "name": "Hitachi Energy",
      "vulinfo_id": "BadAlloc - Memory Allocation Vulnerabilities in Hitachi Energy PWC600 Product (PDF)",
      "url": "https://search.abb.com/library/Download.aspx?DocumentID=8DBD000073\u0026LanguageCode=en\u0026DocumentPartId=\u0026Action=Launch"
    },
    {
      "type": "vendor",
      "name": "Hitachi Energy",
      "vulinfo_id": "BadAlloc - Memory Allocation Vulnerabilities in Hitachi Energy REB500 Product (PDF)",
      "url": "https://search.abb.com/library/Download.aspx?DocumentID=8DBD000071\u0026LanguageCode=en\u0026DocumentPartId=\u0026Action=Launch"
    },
    {
      "type": "vendor",
      "name": "Hitachi Energy",
      "vulinfo_id": "BadAlloc - Memory Allocation Vulnerabilities in Hitachi Energy Relion 670, 650 series and SAM600-IO Product (PDF)",
      "url": "https://search.abb.com/library/Download.aspx?DocumentID=8DBD000070\u0026LanguageCode=en\u0026DocumentPartId=\u0026Action=Launch"
    },
    {
      "type": "vendor",
      "name": "Micrium",
      "vulinfo_id": "μC/LIB Release notes",
      "url": "https://micrium.atlassian.net/wiki/spaces/libdoc138/pages/175908/C%2BLIB%2BRelease%2Bnotes#id-%C2%B5C%2FLIBReleasenotes-Version1.39.01"
    },
    {
      "type": "vendor",
      "name": "NXP Semiconductors",
      "vulinfo_id": "MCUXpresso SDK Builder",
      "url": "https://mcuxpresso.nxp.com/en/welcome"
    },
    {
      "type": "vendor",
      "name": "QNX",
      "vulinfo_id": "Affected Product List",
      "url": "https://www.qnx.com/support/knowledgebase.html?id=5015Y000001SX2z"
    },
    {
      "type": "vendor",
      "name": "Silicon Labs, Inc.",
      "vulinfo_id": "Micriμm OS",
      "url": "https://www.silabs.com/developers/micrium-os"
    },
    {
      "type": "vendor",
      "name": "sourceware.org",
      "vulinfo_id": "git://sourceware.org / newlib-cygwin.git / summary",
      "url": "https://sourceware.org/git/gitweb.cgi?p=newlib-cygwin.git"
    },
    {
      "type": "vendor",
      "name": "Texas Instruments",
      "vulinfo_id": "Report potential product security vulnerabilities",
      "url": "https://www.ti.com/technologies/security/report-product-security-vulnerabilities.html"
    },
    {
      "type": "vendor",
      "name": "uClibc-ng",
      "vulinfo_id": "Welcome to uClibc-ng! - Embedded C library",
      "url": "https://uclibc-ng.org/"
    },
    {
      "type": "vendor",
      "name": "三菱電機株式会社",
      "vulinfo_id": "三菱電機株式会社 の告知ページ",
      "url": "https://www.mitsubishielectric.co.jp/psirt/vulnerability/pdf/2021-013.pdf"
    },
    {
      "type": "advisory",
      "name": "ICS-CERT ADVISORY",
      "vulinfo_id": "ICSA-21-119-04",
      "url": "https://us-cert.cisa.gov/ics/advisories/icsa-21-119-04"
    },
    {
      "type": "advisory",
      "name": "JVN",
      "vulinfo_id": "JVNVU#90467655",
      "url": "http://jvn.jp/cert/JVNVU90467655"
    },
    {
      "type": "advisory",
      "name": "US-CERT National Cyber Awareness System Alerts",
      "vulinfo_id": "AA21-229A",
      "url": "https://us-cert.cisa.gov/ncas/alerts/aa21-229a"
    },
    {
      "type": "advisory",
      "name": "関連文書",
      "vulinfo_id": "“BadAlloc” - Memory allocation vulnerabilities could affect wide range of IoT and OT devices in industrial, medical, and enterprise networks",
      "url": "https://msrc-blog.microsoft.com/2021/04/29/badalloc-memory-allocation-vulnerabilities-could-affect-wide-range-of-iot-and-ot-devices-in-industrial-medical-and-enterprise-networks/"
    }
  ],
  "history": [
    {
      "history_no": "1",
      "date_time": "2021-05-10T07:33:45Z",
      "description": "[2021年05月10日]\\n  掲載"
    },
    {
      "history_no": "2",
      "date_time": "2021-08-19T07:44:08Z",
      "description": "[2021年08月19日]\\n  影響を受けるシステム：ベンダ情報の追加に伴い内容を更新\\n  対策：内容を更新\\n  ベンダ情報：BlackBerry (QNX-2021-001 Vulnerability in the C Runtime Library Impacts BlackBerry QNX Software Development Platform (SDP), QNX OS for Medical, and QNX OS for Safety) を追加\\n  ベンダ情報：BlackBerry (Affected Product List) を追加\\n  参考情報：US-CERT National Cyber Awareness System Alerts (AA21-229A) を追加"
    },
    {
      "history_no": "3",
      "date_time": "2021-09-03T05:36:46Z",
      "description": "[2021年09月03日]\\n  ベンダ情報：三菱電機株式会社 (三菱電機株式会社 の告知ページ) を追加"
    },
    {
      "history_no": "4",
      "date_time": "2021-12-02T06:39:17Z",
      "description": "[2021年12月02日]\\n  影響を受けるシステム：内容を更新\\n  対策：内容を更新\\n  ベンダ情報：Hitachi Energy (BadAlloc - Memory Allocation Vulnerabilities in Hitachi Energy RTU500 series) を追加\\n  ベンダ情報：Hitachi Energy (BadAlloc - Memory Allocation Vulnerabilities in Hitachi ABB Power Grids Modular Switchgear Monitoring System (MSM) Product) を追加\\n  ベンダ情報：Texas Instruments Incorporated (TI) (Report potential product security vulnerabilities) を追加"
    },
    {
      "history_no": "5",
      "date_time": "2022-04-21T05:30:29Z",
      "description": "[2022年04月21日]\\n  ベンダ情報：Hitachi Energy (BadAlloc - Memory Allocation Vulnerabilities in Hitachi Energy GMS600 Product (PDF)) を追加\\n  ベンダ情報：Hitachi Energy (BadAlloc - Memory Allocation Vulnerabilities in Hitachi Energy PWC600 Product (PDF)) を追加\\n  ベンダ情報：Hitachi Energy (BadAlloc - Memory Allocation Vulnerabilities in Hitachi Energy REB500 Product (PDF)) を追加\\n  ベンダ情報：Hitachi Energy (BadAlloc - Memory Allocation Vulnerabilities in Hitachi Energy Relion 670, 650 series and SAM600-IO Product (PDF)) を追加\\n\\n"
    }
  ],
  "date_first_published": "2021-05-10T16:33:45+09:00",
  "date_last_updated": "2021-09-03T14:37:25+09:00",
  "date_public": "2021-04-30T00:00:00+09:00"
}
