{
  "id": "106",
  "name": "Struts: Plug-in Framework not in Use",
  "abstraction": "Variant",
  "structure": "Simple",
  "status": "Draft",
  "description": "When an application does not use an input validation framework such as the Struts Validator, there is a greater risk of introducing weaknesses related to insufficient input validation.",
  "extended_description": "\n            \u003cxhtml:p\u003eUnchecked input is the leading cause of vulnerabilities in J2EE applications. Unchecked input leads to cross-site scripting, process control, and SQL injection vulnerabilities, among others.\u003c/xhtml:p\u003e\n            \u003cxhtml:p\u003eAlthough J2EE applications are not generally susceptible to memory corruption attacks, if a J2EE application interfaces with native code that does not perform array bounds checking, an attacker may be able to use an input validation mistake in the J2EE application to launch a buffer overflow attack.\u003c/xhtml:p\u003e\n         ",
  "related_weaknesses": [
    {
      "nature": "ChildOf",
      "cweid": "1173",
      "view_id": "1000",
      "ordinal": "Primary"
    },
    {
      "nature": "ChildOf",
      "cweid": "20",
      "view_id": "700",
      "ordinal": "Primary"
    }
  ],
  "applicable_platforms": {
    "language": [
      {
        "prevalence": "Undetermined",
        "name": "Java"
      }
    ]
  },
  "modes_of_introduction": [
    {
      "phase": "Implementation"
    }
  ],
  "common_consequences": [
    {
      "scope": [
        "Integrity"
      ],
      "impact": [
        "Unexpected State"
      ]
    }
  ],
  "potential_mitigations": [
    {
      "phase": [
        "Architecture and Design"
      ],
      "description": [
        "Use an input validation framework such as Struts."
      ],
      "strategy": "Input Validation"
    },
    {
      "phase": [
        "Architecture and Design"
      ],
      "description": [
        "Use an input validation framework such as Struts."
      ],
      "strategy": "Libraries or Frameworks"
    },
    {
      "phase": [
        "Implementation"
      ],
      "description": [
        "\n                  \u003cxhtml:p\u003eUse the Struts Validator to validate all program input before it is processed by the application. Ensure that there are no holes in the configuration of the Struts Validator. Example uses of the validator include checking to ensure that:\u003c/xhtml:p\u003e\n                  \u003cxhtml:div style=\"margin-left:10px;\"\u003e\n                     \u003cxhtml:ul\u003e\n                        \u003cxhtml:li\u003ePhone number fields contain only valid characters in phone numbers\u003c/xhtml:li\u003e\n                        \u003cxhtml:li\u003eBoolean values are only \"T\" or \"F\"\u003c/xhtml:li\u003e\n                        \u003cxhtml:li\u003eFree-form strings are of a reasonable length and composition\u003c/xhtml:li\u003e\n                     \u003c/xhtml:ul\u003e\n                  \u003c/xhtml:div\u003e\n               "
      ],
      "strategy": "Input Validation"
    },
    {
      "phase": [
        "Implementation"
      ],
      "description": [
        "\n                  \u003cxhtml:p\u003eUse the Struts Validator to validate all program input before it is processed by the application. Ensure that there are no holes in the configuration of the Struts Validator. Example uses of the validator include checking to ensure that:\u003c/xhtml:p\u003e\n                  \u003cxhtml:div style=\"margin-left:10px;\"\u003e\n                     \u003cxhtml:ul\u003e\n                        \u003cxhtml:li\u003ePhone number fields contain only valid characters in phone numbers\u003c/xhtml:li\u003e\n                        \u003cxhtml:li\u003eBoolean values are only \"T\" or \"F\"\u003c/xhtml:li\u003e\n                        \u003cxhtml:li\u003eFree-form strings are of a reasonable length and composition\u003c/xhtml:li\u003e\n                     \u003c/xhtml:ul\u003e\n                  \u003c/xhtml:div\u003e\n               "
      ],
      "strategy": "Libraries or Frameworks"
    }
  ],
  "demonstrative_examples": [
    {
      "text": "\n               \u003cIntro_Text\u003eIn the following Java example the class RegistrationForm is a Struts framework ActionForm Bean that will maintain user input data from a registration webpage for an online business site. The user will enter registration data and, through the Struts framework, the RegistrationForm bean will maintain the user data.\u003c/Intro_Text\u003e\n               \u003cExample_Code Nature=\"bad\" Language=\"Java\"\u003e\n                  \u003cxhtml:div\u003epublic class RegistrationForm extends org.apache.struts.action.ActionForm {\u003cxhtml:div style=\"margin-left:10px;\"\u003e\n                        \u003cxhtml:br/\u003e\n                        \u003cxhtml:i\u003e// private variables for registration form\u003c/xhtml:i\u003e\n                        \u003cxhtml:br/\u003eprivate String name;\u003cxhtml:br/\u003eprivate String email;\u003cxhtml:br/\u003e...\u003cxhtml:br/\u003e\n                        \u003cxhtml:br/\u003epublic RegistrationForm() {\u003cxhtml:div style=\"margin-left:10px;\"\u003esuper();\u003c/xhtml:div\u003e}\u003cxhtml:br/\u003e\n                        \u003cxhtml:br/\u003e\n                        \u003cxhtml:i\u003e// getter and setter methods for private variables\u003c/xhtml:i\u003e\n                        \u003cxhtml:br/\u003e...\u003cxhtml:br/\u003e\n                     \u003c/xhtml:div\u003e}\u003c/xhtml:div\u003e\n               \u003c/Example_Code\u003e\n               \u003cBody_Text\u003eHowever, the RegistrationForm class extends the Struts ActionForm class which does use the Struts validator plug-in to provide validator capabilities. In the following example, the RegistrationForm Java class extends the ValidatorForm and Struts configuration XML file, struts-config.xml, instructs the application to use the Struts validator plug-in.\u003c/Body_Text\u003e\n               \u003cExample_Code Nature=\"good\" Language=\"Java\"\u003e\n                  \u003cxhtml:div\u003epublic class RegistrationForm extends org.apache.struts.validator.ValidatorForm {\u003cxhtml:div style=\"margin-left:10px;\"\u003e\n                        \u003cxhtml:br/\u003e\n                        \u003cxhtml:i\u003e// private variables for registration form\u003c/xhtml:i\u003e\n                        \u003cxhtml:br/\u003eprivate String name;\u003cxhtml:br/\u003eprivate String email;\u003cxhtml:br/\u003e...\u003cxhtml:br/\u003e\n                        \u003cxhtml:br/\u003epublic RegistrationForm() {\u003cxhtml:div style=\"margin-left:10px;\"\u003esuper();\u003c/xhtml:div\u003e}\u003cxhtml:br/\u003e\n                        \u003cxhtml:br/\u003epublic ActionErrors validate(ActionMapping mapping, HttpServletRequest request) {...}\u003cxhtml:br/\u003e\n                        \u003cxhtml:br/\u003e\n                        \u003cxhtml:i\u003e// getter and setter methods for private variables\u003c/xhtml:i\u003e\n                        \u003cxhtml:br/\u003e...\u003cxhtml:br/\u003e\n                     \u003c/xhtml:div\u003e}\u003c/xhtml:div\u003e\n               \u003c/Example_Code\u003e\n               \u003cBody_Text\u003eThe plug-in tag of the Struts configuration XML file includes the name of the validator plug-in to be used and includes a set-property tag to instruct the application to use the file, validator-rules.xml, for default validation rules and the file, validation.XML, for custom validation.\u003c/Body_Text\u003e\n               \u003cExample_Code Nature=\"good\" Language=\"XML\"\u003e\n                  \u003cxhtml:div\u003e\u0026lt;struts-config\u0026gt;\u003cxhtml:div style=\"margin-left:10px;\"\u003e\n                        \u003cxhtml:br/\u003e\u0026lt;form-beans\u0026gt;\u003cxhtml:div style=\"margin-left:10px;\"\u003e\u0026lt;form-bean name=\"RegistrationForm\" type=\"RegistrationForm\"/\u0026gt;\u003c/xhtml:div\u003e\u0026lt;/form-beans\u0026gt;\u003cxhtml:br/\u003e\n                        \u003cxhtml:br/\u003e...\u003cxhtml:br/\u003e\n                        \u003cxhtml:br/\u003e\u0026lt;!-- ========================= Validator plugin ================================= --\u0026gt;\u003cxhtml:br/\u003e\u0026lt;plug-in className=\"org.apache.struts.validator.ValidatorPlugIn\"\u0026gt;\u003cxhtml:div style=\"margin-left:10px;\"\u003e\u0026lt;set-property\u003cxhtml:div style=\"margin-left:10px;\"\u003eproperty=\"pathnames\"\u003cxhtml:br/\u003evalue=\"/WEB-INF/validator-rules.xml,/WEB-INF/validation.xml\"/\u0026gt;\u003c/xhtml:div\u003e\n                        \u003c/xhtml:div\u003e\u0026lt;/plug-in\u0026gt;\u003c/xhtml:div\u003e\n                     \u003cxhtml:br/\u003e\u0026lt;/struts-config\u0026gt;\u003c/xhtml:div\u003e\n               \u003c/Example_Code\u003e\n            "
    }
  ],
  "references": [
    {
      "reference_id": "REF-6",
      "author": [
        "Katrina Tsipenyuk",
        "Brian Chess",
        "Gary McGraw"
      ],
      "title": "Seven Pernicious Kingdoms: A Taxonomy of Software Security Errors",
      "url": "https://samate.nist.gov/SSATTM_Content/papers/Seven%20Pernicious%20Kingdoms%20-%20Taxonomy%20of%20Sw%20Security%20Errors%20-%20Tsipenyuk%20-%20Chess%20-%20McGraw.pdf",
      "publication_year": "2005",
      "publication_month": "--11",
      "publication_day": "---07",
      "publication": "NIST Workshop on Software Security Assurance Tools Techniques and Metrics",
      "publisher": "NIST"
    }
  ],
  "content_history": {
    "submission": {
      "submission_name": "7 Pernicious Kingdoms",
      "submission_date": "2006-07-19T00:00:00Z"
    },
    "modification": [
      {
        "modification_name": "Eric Dalci",
        "modification_organization": "Cigital",
        "modification_date": "2008-07-01T00:00:00Z",
        "modification_comment": "updated Potential_Mitigations, Time_of_Introduction"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2008-09-08T00:00:00Z",
        "modification_comment": "updated Relationships, Other_Notes, Taxonomy_Mappings, Weakness_Ordinalities"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2009-03-10T00:00:00Z",
        "modification_comment": "updated Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2010-06-21T00:00:00Z",
        "modification_comment": "updated Demonstrative_Examples"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2011-03-29T00:00:00Z",
        "modification_comment": "updated Other_Notes"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2011-06-01T00:00:00Z",
        "modification_comment": "updated Common_Consequences"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2011-06-27T00:00:00Z",
        "modification_comment": "updated Common_Consequences"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2012-05-11T00:00:00Z",
        "modification_comment": "updated Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2013-02-21T00:00:00Z",
        "modification_comment": "updated Potential_Mitigations"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2013-07-17T00:00:00Z",
        "modification_comment": "updated Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2014-06-23T00:00:00Z",
        "modification_comment": "updated Description, Other_Notes, Potential_Mitigations"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2014-07-30T00:00:00Z",
        "modification_comment": "updated Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2017-11-08T00:00:00Z",
        "modification_comment": "updated Causal_Nature, Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2019-01-03T00:00:00Z",
        "modification_comment": "updated Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2020-02-24T00:00:00Z",
        "modification_comment": "updated References, Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2021-07-20T00:00:00Z",
        "modification_comment": "updated Potential_Mitigations"
      }
    ]
  },
  "weakness_ordinalities": [
    {
      "ordinality": "Primary"
    }
  ],
  "taxonomy_mappings": [
    {
      "taxonomy_name": "7 Pernicious Kingdoms",
      "entry_name": "Struts: Plug-in Framework Not In Use"
    }
  ]
}
