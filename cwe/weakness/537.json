{
  "id": "537",
  "name": "Java Runtime Error Message Containing Sensitive Information",
  "abstraction": "Variant",
  "structure": "Simple",
  "status": "Incomplete",
  "description": "In many cases, an attacker can leverage the conditions that cause unhandled exception errors in order to gain unauthorized access to the system.",
  "related_weaknesses": [
    {
      "nature": "ChildOf",
      "cweid": "211",
      "view_id": "1000",
      "ordinal": "Primary"
    }
  ],
  "applicable_platforms": {
    "language": [
      {
        "prevalence": "Undetermined",
        "name": "Java"
      }
    ]
  },
  "modes_of_introduction": [
    {
      "phase": "Implementation"
    }
  ],
  "common_consequences": [
    {
      "scope": [
        "Confidentiality"
      ],
      "impact": [
        "Read Application Data"
      ]
    }
  ],
  "potential_mitigations": [
    {
      "phase": [
        "Implementation"
      ],
      "description": [
        "Do not expose sensitive error information to the user."
      ]
    }
  ],
  "demonstrative_examples": [
    {
      "text": "\n               \u003cIntro_Text\u003eIn the following Java example the class InputFileRead enables an input file to be read using a FileReader object. In the constructor of this class a default input file path is set to some directory on the local file system and the method setInputFile must be called to set the name of the input file to be read in the default directory. The method readInputFile will create the FileReader object and will read the contents of the file. If the method setInputFile is not called prior to calling the method readInputFile then the File object will remain null when initializing the FileReader object. A Java RuntimeException will be raised, and an error message will be output to the user.\u003c/Intro_Text\u003e\n               \u003cExample_Code Nature=\"bad\" Language=\"Java\"\u003e\n                  \u003cxhtml:div\u003epublic class InputFileRead {\u003cxhtml:br/\u003e\n                     \u003cxhtml:div style=\"margin-left:10px;\"\u003e\n                        \u003cxhtml:div\u003eprivate File readFile = null;\u003cxhtml:br/\u003eprivate FileReader reader = null;\u003cxhtml:br/\u003eprivate String inputFilePath = null;\u003cxhtml:br/\u003eprivate final String DEFAULT_FILE_PATH = \"c:\\\\somedirectory\\\\\";\u003cxhtml:br/\u003e\n                           \u003cxhtml:br/\u003epublic InputFileRead() {\u003cxhtml:div style=\"margin-left:10px;\"\u003einputFilePath = DEFAULT_FILE_PATH;\u003c/xhtml:div\u003e}\u003cxhtml:br/\u003e\n                           \u003cxhtml:br/\u003epublic void setInputFile(String inputFile) {\u003cxhtml:div style=\"margin-left:10px;\"\u003e\n                              \u003cxhtml:div\u003e\n                                 \u003cxhtml:br/\u003e\n                                 \u003cxhtml:i\u003e/* Assume appropriate validation / encoding is used and privileges / permissions are preserved */\u003c/xhtml:i\u003e\n                                 \u003cxhtml:br/\u003e\n                              \u003c/xhtml:div\u003e\n                           \u003c/xhtml:div\u003e}\u003cxhtml:br/\u003e\n                           \u003cxhtml:br/\u003epublic void readInputFile() {\u003cxhtml:div style=\"margin-left:10px;\"\u003e\n                              \u003cxhtml:div\u003etry {\u003cxhtml:div style=\"margin-left:10px;\"\u003ereader = new FileReader(readFile);\u003cxhtml:br/\u003e...\u003c/xhtml:div\u003e} catch (RuntimeException rex) {\u003cxhtml:div style=\"margin-left:10px;\"\u003eSystem.err.println(\"Error: Cannot open input file in the directory \" + inputFilePath);\u003cxhtml:br/\u003eSystem.err.println(\"Input file has not been set, call setInputFile method before calling readInputFile\");\u003c/xhtml:div\u003e\n                                 \u003cxhtml:br/\u003e\n                                 \u003cxhtml:br/\u003e} catch (FileNotFoundException ex) {...}\u003cxhtml:br/\u003e\n                              \u003c/xhtml:div\u003e\n                           \u003c/xhtml:div\u003e}\u003c/xhtml:div\u003e\n                     \u003c/xhtml:div\u003e}\u003c/xhtml:div\u003e\n               \u003c/Example_Code\u003e\n               \u003cBody_Text\u003eHowever, the error message output to the user contains information regarding the default directory on the local file system. This information can be exploited and may lead to unauthorized access or use of the system. Any Java RuntimeExceptions that are handled should not expose sensitive information to the user.\u003c/Body_Text\u003e\n            "
    },
    {
      "text": "\n               \u003cIntro_Text\u003eIn the example below, the BankManagerLoginServlet servlet class will process a login request to determine if a user is authorized to use the BankManager Web service. The doPost method will retrieve the username and password from the servlet request and will determine if the user is authorized. If the user is authorized the servlet will go to the successful login page. Otherwise, the servlet will raise a FailedLoginException and output the failed login message to the error page of the service.\u003c/Intro_Text\u003e\n               \u003cExample_Code Nature=\"bad\" Language=\"Java\"\u003e\n                  \u003cxhtml:div\u003epublic class BankManagerLoginServlet extends HttpServlet {\u003cxhtml:div style=\"margin-left:10px;\"\u003e\n                        \u003cxhtml:div\u003eprotected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\u003cxhtml:div style=\"margin-left:10px;\"\u003e\n                              \u003cxhtml:div\u003etry {\u003cxhtml:div style=\"margin-left:10px;\"\u003e\n                                    \u003cxhtml:div\u003e\n                                       \u003cxhtml:br/\u003e\n                                       \u003cxhtml:i\u003e// Get username and password from login page request\u003c/xhtml:i\u003e\n                                       \u003cxhtml:br/\u003eString username = request.getParameter(\"username\");\u003cxhtml:br/\u003eString password = request.getParameter(\"password\");\u003cxhtml:br/\u003e\n                                       \u003cxhtml:i\u003e// Authenticate user\u003c/xhtml:i\u003e\n                                       \u003cxhtml:br/\u003eBankManager bankMgr = new BankManager();\u003cxhtml:br/\u003eboolean isAuthentic = bankMgr.authenticateUser(username, password);\u003cxhtml:br/\u003e\n                                       \u003cxhtml:i\u003e// If user is authenticated then go to successful login page\u003c/xhtml:i\u003e\n                                       \u003cxhtml:br/\u003eif (isAuthentic) {\u003cxhtml:div style=\"margin-left:10px;\"\u003erequest.setAttribute(\"login\", new String(\"Login Successful.\"));\u003cxhtml:br/\u003egetServletContext().getRequestDispatcher(\"/BankManagerServiceLoggedIn.jsp\"). forward(request, response);\u003c/xhtml:div\u003e}\u003cxhtml:br/\u003eelse {\u003cxhtml:div style=\"margin-left:10px;\"\u003e\n                                          \u003cxhtml:div\u003e\n                                             \u003cxhtml:br/\u003e\n                                             \u003cxhtml:i\u003e// Otherwise, raise failed login exception and output unsuccessful login message to error page\u003c/xhtml:i\u003e\n                                             \u003cxhtml:br/\u003ethrow new FailedLoginException(\"Failed Login for user \" + username + \" with password \" + password);\u003c/xhtml:div\u003e\n                                       \u003c/xhtml:div\u003e}\u003c/xhtml:div\u003e\n                                 \u003c/xhtml:div\u003e} catch (FailedLoginException ex) {\u003cxhtml:div style=\"margin-left:10px;\"\u003e\n                                    \u003cxhtml:div\u003e\n                                       \u003cxhtml:br/\u003e\n                                       \u003cxhtml:i\u003e// output failed login message to error page\u003c/xhtml:i\u003e\n                                       \u003cxhtml:br/\u003erequest.setAttribute(\"error\", new String(\"Login Error\"));\u003cxhtml:br/\u003erequest.setAttribute(\"message\", ex.getMessage());\u003cxhtml:br/\u003egetServletContext().getRequestDispatcher(\"/ErrorPage.jsp\").forward(request, response);\u003c/xhtml:div\u003e\n                                 \u003c/xhtml:div\u003e}\u003c/xhtml:div\u003e\n                           \u003c/xhtml:div\u003e}\u003c/xhtml:div\u003e\n                     \u003c/xhtml:div\u003e\n                  \u003c/xhtml:div\u003e\n               \u003c/Example_Code\u003e\n               \u003cBody_Text\u003eHowever, the output message generated by the FailedLoginException includes the user-supplied password. Even if the password is erroneous, it is probably close to the correct password. Since it is printed to the user's page, anybody who can see the screen display will be able to see the password. Also, if the page is cached, the password might be written to disk.\u003c/Body_Text\u003e\n            "
    }
  ],
  "content_history": {
    "submission": {
      "submission_name": "Anonymous Tool Vendor (under NDA)",
      "submission_date": "2006-07-19T00:00:00Z"
    },
    "modification": [
      {
        "modification_name": "Eric Dalci",
        "modification_organization": "Cigital",
        "modification_date": "2008-07-01T00:00:00Z",
        "modification_comment": "updated Potential_Mitigations, Time_of_Introduction"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2008-09-08T00:00:00Z",
        "modification_comment": "updated Relationships, Taxonomy_Mappings"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2010-02-16T00:00:00Z",
        "modification_comment": "updated Demonstrative_Examples, Potential_Mitigations"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2011-03-29T00:00:00Z",
        "modification_comment": "updated Demonstrative_Examples, Name"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2011-06-01T00:00:00Z",
        "modification_comment": "updated Common_Consequences"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2012-05-11T00:00:00Z",
        "modification_comment": "updated Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2014-07-30T00:00:00Z",
        "modification_comment": "updated Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2017-11-08T00:00:00Z",
        "modification_comment": "updated Taxonomy_Mappings"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2020-02-24T00:00:00Z",
        "modification_comment": "updated Name, Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2021-10-28T00:00:00Z",
        "modification_comment": "updated Relationships"
      }
    ],
    "previous_entry_name": [
      {
        "text": "Information Leak Through Java Runtime Error Message",
        "date": "2011-03-29T00:00:00Z"
      },
      {
        "text": "Information Exposure Through Java Runtime Error Message",
        "date": "2020-02-24T00:00:00Z"
      }
    ]
  }
}
