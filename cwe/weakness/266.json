{
  "id": "266",
  "name": "Incorrect Privilege Assignment",
  "abstraction": "Base",
  "structure": "Simple",
  "status": "Draft",
  "description": "A product incorrectly assigns a privilege to a particular actor, creating an unintended sphere of control for that actor.",
  "related_weaknesses": [
    {
      "nature": "ChildOf",
      "cweid": "269",
      "view_id": "1000",
      "ordinal": "Primary"
    },
    {
      "nature": "CanAlsoBe",
      "cweid": "286",
      "view_id": "1000"
    }
  ],
  "applicable_platforms": {
    "language": [
      {
        "class": "Language-Independent",
        "prevalence": "Undetermined"
      }
    ]
  },
  "modes_of_introduction": [
    {
      "phase": "Architecture and Design"
    },
    {
      "phase": "Implementation",
      "note": [
        "REALIZATION: This weakness is caused during implementation of an architectural security tactic."
      ]
    }
  ],
  "common_consequences": [
    {
      "scope": [
        "Access Control"
      ],
      "impact": [
        "Gain Privileges or Assume Identity"
      ],
      "note": "A user can access restricted functionality and/or sensitive information that may include administrative functionality and user accounts."
    }
  ],
  "potential_mitigations": [
    {
      "mitigation_id": "MIT-1",
      "phase": [
        "Architecture and Design",
        "Operation"
      ],
      "description": [
        "Very carefully manage the setting, management, and handling of privileges. Explicitly manage trust zones in the software."
      ]
    },
    {
      "mitigation_id": "MIT-17",
      "phase": [
        "Architecture and Design",
        "Operation"
      ],
      "description": [
        "Run your code using the lowest privileges that are required to accomplish the necessary tasks [REF-76]. If possible, create isolated accounts with limited privileges that are only used for a single task. That way, a successful attack will not immediately give the attacker access to the rest of the software or its environment. For example, database applications rarely need to run as the database administrator, especially in day-to-day operations."
      ],
      "strategy": "Environment Hardening"
    }
  ],
  "demonstrative_examples": [
    {
      "demonstrative_example_id": "DX-97",
      "text": "\n               \u003cIntro_Text\u003eThe following example demonstrates the weakness.\u003c/Intro_Text\u003e\n               \u003cExample_Code Nature=\"bad\" Language=\"C\"\u003e\n                  \u003cxhtml:div\u003eseteuid(0);\u003cxhtml:br/\u003e\n                     \u003cxhtml:i\u003e/* do some stuff */\u003c/xhtml:i\u003e\n                     \u003cxhtml:br/\u003e\n                     \u003cxhtml:br/\u003eseteuid(getuid());\u003c/xhtml:div\u003e\n               \u003c/Example_Code\u003e\n            "
    },
    {
      "demonstrative_example_id": "DX-142",
      "text": "\n               \u003cIntro_Text\u003eThe following example demonstrates the weakness.\u003c/Intro_Text\u003e\n               \u003cExample_Code Nature=\"bad\" Language=\"Java\"\u003e\n                  \u003cxhtml:div\u003eAccessController.doPrivileged(new PrivilegedAction() {\u003cxhtml:div style=\"margin-left:10px;\"\u003e\n                        \u003cxhtml:div\u003epublic Object run() {\u003cxhtml:div style=\"margin-left:10px;\"\u003e\n                                 \u003cxhtml:i\u003e// privileged code goes here, for example:\u003c/xhtml:i\u003e\n                                 \u003cxhtml:br/\u003eSystem.loadLibrary(\"awt\");\u003cxhtml:br/\u003ereturn null;\u003cxhtml:br/\u003e\n                                 \u003cxhtml:i\u003e// nothing to return\u003c/xhtml:i\u003e\n                                 \u003cxhtml:br/\u003e\n                           \u003c/xhtml:div\u003e}\u003c/xhtml:div\u003e\n                     \u003c/xhtml:div\u003e\n                  \u003c/xhtml:div\u003e\n               \u003c/Example_Code\u003e\n            "
    },
    {
      "demonstrative_example_id": "DX-108",
      "text": "\n               \u003cIntro_Text\u003eThis application sends a special intent with a flag that allows the receiving application to read a data file for backup purposes.\u003c/Intro_Text\u003e\n               \u003cExample_Code Nature=\"bad\" Language=\"Java\"\u003e\n                  \u003cxhtml:div\u003eIntent intent = new Intent();\u003cxhtml:br/\u003eintent.setAction(\"com.example.BackupUserData\");\u003cxhtml:br/\u003eintent.setData(file_uri);\u003cxhtml:br/\u003eintent.addFlags(FLAG_GRANT_READ_URI_PERMISSION);\u003cxhtml:br/\u003esendBroadcast(intent);\u003c/xhtml:div\u003e\n               \u003c/Example_Code\u003e\n               \u003cExample_Code Nature=\"attack\" Language=\"Java\"\u003e\n                  \u003cxhtml:div\u003epublic class CallReceiver extends BroadcastReceiver {\u003cxhtml:div style=\"margin-left:10px;\"\u003e@Override\u003cxhtml:br/\u003epublic void onReceive(Context context, Intent intent) {\u003cxhtml:div style=\"margin-left:10px;\"\u003eUri userData = intent.getData();\u003cxhtml:br/\u003estealUserData(userData);\u003c/xhtml:div\u003e}\u003c/xhtml:div\u003e}\u003c/xhtml:div\u003e\n               \u003c/Example_Code\u003e\n               \u003cBody_Text\u003eAny malicious application can register to receive this intent. Because of the FLAG_GRANT_READ_URI_PERMISSION included with the intent, the malicious receiver code can read the user's data.\u003c/Body_Text\u003e\n            "
    }
  ],
  "observed_examples": [
    {
      "reference": "CVE-1999-1193",
      "description": "untrusted user placed in unix \"wheel\" group",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-1999-1193"
    },
    {
      "reference": "CVE-2005-2741",
      "description": "Product allows users to grant themselves certain rights that can be used to escalate privileges.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-2741"
    },
    {
      "reference": "CVE-2005-2496",
      "description": "Product uses group ID of a user instead of the group, causing it to run with different privileges. This is resultant from some other unknown issue.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-2496"
    },
    {
      "reference": "CVE-2004-0274",
      "description": "Product mistakenly assigns a particular status to an entity, leading to increased privileges.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0274"
    }
  ],
  "references": [
    {
      "reference_id": "REF-76",
      "author": [
        "Sean Barnum",
        "Michael Gegick"
      ],
      "title": "Least Privilege",
      "url": "https://buildsecurityin.us-cert.gov/daisy/bsi/articles/knowledge/principles/351.html",
      "publication_year": "2005",
      "publication_month": "--09",
      "publication_day": "---14"
    }
  ],
  "content_history": {
    "submission": {
      "submission_name": "PLOVER",
      "submission_date": "2006-07-19T00:00:00Z"
    },
    "modification": [
      {
        "modification_name": "Eric Dalci",
        "modification_organization": "Cigital",
        "modification_date": "2008-07-01T00:00:00Z",
        "modification_comment": "updated Time_of_Introduction"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2008-09-08T00:00:00Z",
        "modification_comment": "updated Description, Relationships, Taxonomy_Mappings, Weakness_Ordinalities"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2009-03-10T00:00:00Z",
        "modification_comment": "updated Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2009-12-28T00:00:00Z",
        "modification_comment": "updated Potential_Mitigations"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2010-06-21T00:00:00Z",
        "modification_comment": "updated Potential_Mitigations"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2011-06-01T00:00:00Z",
        "modification_comment": "updated Common_Consequences, Relationships, Taxonomy_Mappings"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2012-05-11T00:00:00Z",
        "modification_comment": "updated Common_Consequences, Demonstrative_Examples, Relationships, Taxonomy_Mappings"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2012-10-30T00:00:00Z",
        "modification_comment": "updated Potential_Mitigations, References"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2014-02-18T00:00:00Z",
        "modification_comment": "updated Applicable_Platforms, Demonstrative_Examples"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2017-11-08T00:00:00Z",
        "modification_comment": "updated Causal_Nature, Modes_of_Introduction, References, Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2019-01-03T00:00:00Z",
        "modification_comment": "updated Relationships, Taxonomy_Mappings"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2020-02-24T00:00:00Z",
        "modification_comment": "updated Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2021-03-15T00:00:00Z",
        "modification_comment": "updated Demonstrative_Examples"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2021-10-28T00:00:00Z",
        "modification_comment": "updated Relationships"
      }
    ]
  },
  "weakness_ordinalities": [
    {
      "ordinality": "Resultant"
    }
  ],
  "taxonomy_mappings": [
    {
      "taxonomy_name": "PLOVER",
      "entry_name": "Incorrect Privilege Assignment"
    },
    {
      "taxonomy_name": "The CERT Oracle Secure Coding Standard for Java (2011)",
      "entry_name": "Do not allow privileged blocks to leak sensitive information across a trust boundary",
      "entry_id": "SEC00-J"
    },
    {
      "taxonomy_name": "The CERT Oracle Secure Coding Standard for Java (2011)",
      "entry_name": "Do not allow tainted variables in privileged blocks",
      "entry_id": "SEC01-J"
    }
  ],
  "affected_resources": [
    "System Process"
  ]
}
