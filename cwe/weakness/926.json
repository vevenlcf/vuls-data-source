{
  "id": "926",
  "name": "Improper Export of Android Application Components",
  "abstraction": "Variant",
  "structure": "Simple",
  "status": "Incomplete",
  "description": "The Android application exports a component for use by other applications, but does not properly restrict which applications can launch the component or access the data it contains.",
  "extended_description": "\n            \u003cxhtml:p\u003eThe attacks and consequences of improperly exporting a component may depend on the exported component:\u003c/xhtml:p\u003e\n            \u003cxhtml:div style=\"margin-left:10px;\"\u003e\n               \u003cxhtml:ul\u003e\n                  \u003cxhtml:li\u003eIf access to an exported Activity is not restricted, any application will be able to launch the activity. This may allow a malicious application to gain access to sensitive information, modify the internal state of the application, or trick a user into interacting with the victim application while believing they are still interacting with the malicious application.\u003c/xhtml:li\u003e\n                  \u003cxhtml:li\u003eIf access to an exported Service is not restricted, any application may start and bind to the Service. Depending on the exposed functionality, this may allow a malicious application to perform unauthorized actions, gain access to sensitive information, or corrupt the internal state of the application.\u003c/xhtml:li\u003e\n                  \u003cxhtml:li\u003eIf access to a Content Provider is not restricted to only the expected applications, then malicious applications might be able to access the sensitive data. Note that in Android before 4.2, the Content Provider is automatically exported unless it has been explicitly declared as NOT exported.\u003c/xhtml:li\u003e\n               \u003c/xhtml:ul\u003e\n            \u003c/xhtml:div\u003e\n         ",
  "related_weaknesses": [
    {
      "nature": "ChildOf",
      "cweid": "285",
      "view_id": "1000",
      "ordinal": "Primary"
    }
  ],
  "applicable_platforms": {
    "language": [
      {
        "class": "Language-Independent",
        "prevalence": "Undetermined"
      }
    ],
    "technology": [
      {
        "class": "Mobile",
        "prevalence": "Undetermined"
      }
    ]
  },
  "background_details": [
    "\n               \u003cxhtml:p\u003eThere are three types of components that can be exported in an Android application.\u003c/xhtml:p\u003e\n               \u003cxhtml:div style=\"color:#32498D; font-weight:bold;\"\u003eActivity\u003c/xhtml:div\u003e\n               \u003cxhtml:p\u003eAn Activity is an application component that provides a UI for users to interact with. A typical application will have multiple Activity screens that perform different functions, such as a main Activity screen and a separate settings Activity screen.\u003c/xhtml:p\u003e\n               \u003cxhtml:div style=\"color:#32498D; font-weight:bold;\"\u003eService\u003c/xhtml:div\u003e\n               \u003cxhtml:p\u003eA Service is an application component that is started by another component to execute an operation in the background, even after the invoking component is terminated. Services do not have a UI component visible to the user.\u003c/xhtml:p\u003e\n               \u003cxhtml:div style=\"color:#32498D; font-weight:bold;\"\u003eContent Provider\u003c/xhtml:div\u003e\n               \u003cxhtml:p\u003eThe Content Provider mechanism can be used to share data with other applications or internally within the same application.\u003c/xhtml:p\u003e\n            "
  ],
  "modes_of_introduction": [
    {
      "phase": "Architecture and Design"
    }
  ],
  "common_consequences": [
    {
      "scope": [
        "Availability",
        "Integrity"
      ],
      "impact": [
        "Unexpected State",
        "DoS: Crash, Exit, or Restart",
        "DoS: Instability",
        "Varies by Context"
      ],
      "note": "Other applications, possibly untrusted, can launch the Activity."
    },
    {
      "scope": [
        "Availability",
        "Integrity"
      ],
      "impact": [
        "Unexpected State",
        "Gain Privileges or Assume Identity",
        "DoS: Crash, Exit, or Restart",
        "DoS: Instability",
        "Varies by Context"
      ],
      "note": "Other applications, possibly untrusted, can bind to the Service."
    },
    {
      "scope": [
        "Confidentiality",
        "Integrity"
      ],
      "impact": [
        "Read Application Data",
        "Modify Application Data"
      ],
      "note": "Other applications, possibly untrusted, can read or modify the data that is offered by the Content Provider."
    }
  ],
  "potential_mitigations": [
    {
      "phase": [
        "Build and Compilation"
      ],
      "description": [
        "If they do not need to be shared by other applications, explicitly mark components with android:exported=\"false\" in the application manifest."
      ],
      "strategy": "Attack Surface Reduction"
    },
    {
      "phase": [
        "Build and Compilation"
      ],
      "description": [
        "If you only intend to use exported components between related apps under your control, use android:protectionLevel=\"signature\" in the xml manifest to restrict access to applications signed by you."
      ],
      "strategy": "Attack Surface Reduction"
    },
    {
      "phase": [
        "Build and Compilation",
        "Architecture and Design"
      ],
      "description": [
        "Limit Content Provider permissions (read/write) as appropriate."
      ],
      "strategy": "Attack Surface Reduction"
    },
    {
      "phase": [
        "Build and Compilation",
        "Architecture and Design"
      ],
      "description": [
        "Limit Content Provider permissions (read/write) as appropriate."
      ],
      "strategy": "Separation of Privilege"
    }
  ],
  "demonstrative_examples": [
    {
      "text": "\n               \u003cIntro_Text\u003eThis application is exporting an activity and a service in its manifest.xml:\u003c/Intro_Text\u003e\n               \u003cExample_Code Nature=\"bad\" Language=\"XML\"\u003e\n                  \u003cxhtml:div\u003e\u0026lt;activity android:name=\"com.example.vulnerableApp.mainScreen\"\u0026gt;\u003cxhtml:div style=\"margin-left:10px;\"\u003e\n                        \u003cxhtml:div\u003e\n                           \u003cxhtml:br/\u003e\n                           \u003cxhtml:i\u003e...\u003c/xhtml:i\u003e\n                           \u003cxhtml:br/\u003e\u0026lt;intent-filter\u0026gt;\u003cxhtml:div style=\"margin-left:10px;\"\u003e\u0026lt;action android:name=\"com.example.vulnerableApp.OPEN_UI\" /\u0026gt;\u003cxhtml:br/\u003e\u0026lt;category android:name=\"android.intent.category.DEFAULT\" /\u0026gt;\u003c/xhtml:div\u003e\u0026lt;/intent-filter\u0026gt;\u003cxhtml:br/\u003e\n                           \u003cxhtml:i\u003e...\u003c/xhtml:i\u003e\n                           \u003cxhtml:br/\u003e\n                        \u003c/xhtml:div\u003e\n                     \u003c/xhtml:div\u003e\u0026lt;/activity\u0026gt;\u003cxhtml:br/\u003e\u0026lt;service android:name=\"com.example.vulnerableApp.backgroundService\"\u0026gt;\u003cxhtml:div style=\"margin-left:10px;\"\u003e\n                        \u003cxhtml:div\u003e\n                           \u003cxhtml:br/\u003e\n                           \u003cxhtml:i\u003e...\u003c/xhtml:i\u003e\n                           \u003cxhtml:br/\u003e\u0026lt;intent-filter\u0026gt;\u003cxhtml:div style=\"margin-left:10px;\"\u003e\u0026lt;action android:name=\"com.example.vulnerableApp.START_BACKGROUND\" /\u0026gt;\u003c/xhtml:div\u003e\u0026lt;/intent-filter\u0026gt;\u003cxhtml:br/\u003e\n                           \u003cxhtml:i\u003e...\u003c/xhtml:i\u003e\n                           \u003cxhtml:br/\u003e\n                        \u003c/xhtml:div\u003e\n                     \u003c/xhtml:div\u003e\u0026lt;/service\u0026gt;\u003c/xhtml:div\u003e\n               \u003c/Example_Code\u003e\n               \u003cBody_Text\u003eBecause these components have intent filters but have not explicitly set 'android:exported=false' elsewhere in the manifest, they are automatically exported so that any other application can launch them. This may lead to unintended behavior or exploits.\u003c/Body_Text\u003e\n            "
    },
    {
      "text": "\n               \u003cIntro_Text\u003eThis application has created a content provider to enable custom search suggestions within the application:\u003c/Intro_Text\u003e\n               \u003cExample_Code Nature=\"bad\" Language=\"XML\"\u003e\n                  \u003cxhtml:div\u003e\u0026lt;provider\u0026gt;\u003cxhtml:div style=\"margin-left:10px;\"\u003eandroid:name=\"com.example.vulnerableApp.searchDB\"\u003cxhtml:br/\u003eandroid:authorities=\"com.example.vulnerableApp.searchDB\"\u0026gt;\u003c/xhtml:div\u003e\u0026lt;/provider\u0026gt;\u003c/xhtml:div\u003e\n               \u003c/Example_Code\u003e\n               \u003cBody_Text\u003eBecause this content provider is only intended to be used within the application, it does not need to be exported. However, in Android before 4.2, it is automatically exported thus potentially allowing malicious applications to access sensitive information.\u003c/Body_Text\u003e\n            "
    }
  ],
  "references": [
    {
      "reference_id": "REF-923",
      "author": [
        "Android Open Source Project"
      ],
      "title": "Security Tips",
      "url": "http://developer.android.com/training/articles/security-tips.html#ContentProviders",
      "publication_year": "2013",
      "publication_month": "--07",
      "publication_day": "---16"
    }
  ],
  "content_history": {
    "submission": {
      "submission_name": "CWE Content Team",
      "submission_organization": "MITRE",
      "submission_date": "2013-07-02T00:00:00Z"
    },
    "modification": [
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2014-01-22T00:00:00Z",
        "modification_comment": "Expanded entry to be more general and include all types of Android components that may be improperly exported.",
        "modification_importance": "Critical"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2014-02-18T00:00:00Z",
        "modification_comment": "updated Background_Details, Common_Consequences, Demonstrative_Examples, Description, Maintenance_Notes, Name, Potential_Mitigations, References"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2017-11-08T00:00:00Z",
        "modification_comment": "updated References"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2020-02-24T00:00:00Z",
        "modification_comment": "updated Applicable_Platforms, Relationships"
      }
    ],
    "previous_entry_name": [
      {
        "text": "Improper Restriction of Content Provider Export to Other Applications",
        "date": "2014-02-18T00:00:00Z"
      }
    ]
  }
}
