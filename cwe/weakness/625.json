{
  "id": "625",
  "name": "Permissive Regular Expression",
  "abstraction": "Base",
  "structure": "Simple",
  "status": "Draft",
  "description": "The product uses a regular expression that does not sufficiently restrict the set of allowed values.",
  "extended_description": "\n            \u003cxhtml:p\u003eThis effectively causes the regexp to accept substrings that match the pattern, which produces a partial comparison to the target. In some cases, this can lead to other weaknesses. Common errors include:\u003c/xhtml:p\u003e\n            \u003cxhtml:div style=\"margin-left:10px;\"\u003e\n               \u003cxhtml:ul\u003e\n                  \u003cxhtml:li\u003enot identifying the beginning and end of the target string\u003c/xhtml:li\u003e\n                  \u003cxhtml:li\u003eusing wildcards instead of acceptable character ranges\u003c/xhtml:li\u003e\n                  \u003cxhtml:li\u003eothers\u003c/xhtml:li\u003e\n               \u003c/xhtml:ul\u003e\n            \u003c/xhtml:div\u003e\n         ",
  "related_weaknesses": [
    {
      "nature": "ChildOf",
      "cweid": "185",
      "view_id": "1000",
      "ordinal": "Primary"
    },
    {
      "nature": "PeerOf",
      "cweid": "187",
      "view_id": "1000"
    },
    {
      "nature": "PeerOf",
      "cweid": "184",
      "view_id": "1000"
    },
    {
      "nature": "PeerOf",
      "cweid": "183",
      "view_id": "1000"
    }
  ],
  "applicable_platforms": {
    "language": [
      {
        "prevalence": "Undetermined",
        "name": "Perl"
      },
      {
        "prevalence": "Undetermined",
        "name": "PHP"
      }
    ]
  },
  "modes_of_introduction": [
    {
      "phase": "Implementation",
      "note": [
        "This problem is frequently found when the regular expression is used in input validation or security features such as authentication."
      ]
    }
  ],
  "common_consequences": [
    {
      "scope": [
        "Access Control"
      ],
      "impact": [
        "Bypass Protection Mechanism"
      ]
    }
  ],
  "potential_mitigations": [
    {
      "phase": [
        "Implementation"
      ],
      "description": [
        "When applicable, ensure that the regular expression marks beginning and ending string patterns, such as \"/^string$/\" for Perl."
      ]
    }
  ],
  "demonstrative_examples": [
    {
      "demonstrative_example_id": "DX-37",
      "text": "\n               \u003cIntro_Text\u003eThe following code takes phone numbers as input, and uses a regular expression to reject invalid phone numbers.\u003c/Intro_Text\u003e\n               \u003cExample_Code Nature=\"bad\" Language=\"Perl\"\u003e\n                  \u003cxhtml:div\u003e$phone = GetPhoneNumber();\u003cxhtml:br/\u003eif ($phone =~ /\\d+-\\d+/) {\u003cxhtml:div style=\"margin-left:10px;\"\u003e\n                           \u003cxhtml:i\u003e# looks like it only has hyphens and digits\u003c/xhtml:i\u003e\n                           \u003cxhtml:br/\u003esystem(\"lookup-phone $phone\");\u003c/xhtml:div\u003e}\n                     \u003cxhtml:br/\u003eelse {\u003cxhtml:div style=\"margin-left:10px;\"\u003eerror(\"malformed number!\");\u003c/xhtml:div\u003e}\u003c/xhtml:div\u003e\n               \u003c/Example_Code\u003e\n               \u003cBody_Text\u003eAn attacker could provide an argument such as: \"; ls -l ; echo 123-456\" This would pass the check, since \"123-456\" is sufficient to match the \"\\d+-\\d+\" portion of the regular expression.\u003c/Body_Text\u003e\n            "
    }
  ],
  "observed_examples": [
    {
      "reference": "CVE-2021-22204",
      "description": "Chain: regex in EXIF processor code does not correctly determine where a string ends (CWE-625), enabling eval injection (CWE-95), as exploited in the wild per CISA KEV.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-22204"
    },
    {
      "reference": "CVE-2006-1895",
      "description": "\".*\" regexp leads to static code injection",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-1895"
    },
    {
      "reference": "CVE-2002-2175",
      "description": "insertion of username into regexp results in partial comparison, causing wrong database entry to be updated when one username is a substring of another.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-2175"
    },
    {
      "reference": "CVE-2006-4527",
      "description": "regexp intended to verify that all characters are legal, only checks that at least one is legal, enabling file inclusion.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-4527"
    },
    {
      "reference": "CVE-2005-1949",
      "description": "Regexp for IP address isn't anchored at the end, allowing appending of shell metacharacters.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-1949"
    },
    {
      "reference": "CVE-2002-2109",
      "description": "Regexp isn't \"anchored\" to the beginning or end, which allows spoofed values that have trusted values as substrings.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-2109"
    },
    {
      "reference": "CVE-2006-6511",
      "description": "regexp in .htaccess file allows access of files whose names contain certain substrings",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-6511"
    },
    {
      "reference": "CVE-2006-6629",
      "description": "allow load of macro files whose names contain certain substrings.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-6629"
    }
  ],
  "references": [
    {
      "section": "Chapter 8, \"Character Stripping Vulnerabilities\", Page 437",
      "reference_id": "REF-62",
      "author": [
        "Mark Dowd",
        "John McDonald",
        "Justin Schuh"
      ],
      "title": "The Art of Software Security Assessment",
      "publication_year": "2006",
      "publisher": "Addison Wesley",
      "edition": "1st Edition"
    }
  ],
  "content_history": {
    "submission": {
      "submission_name": "CWE Content Team",
      "submission_organization": "MITRE",
      "submission_date": "2007-05-07T00:00:00Z"
    },
    "modification": [
      {
        "modification_name": "Eric Dalci",
        "modification_organization": "Cigital",
        "modification_date": "2008-07-01T00:00:00Z",
        "modification_comment": "updated Time_of_Introduction"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2008-09-08T00:00:00Z",
        "modification_comment": "updated Applicable_Platforms, Description, Relationships, Observed_Example, Other_Notes, Weakness_Ordinalities"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2009-03-10T00:00:00Z",
        "modification_comment": "updated Description"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2009-05-27T00:00:00Z",
        "modification_comment": "updated Demonstrative_Examples"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2009-07-27T00:00:00Z",
        "modification_comment": "updated Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2011-06-01T00:00:00Z",
        "modification_comment": "updated Common_Consequences, Relationships, Taxonomy_Mappings"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2012-05-11T00:00:00Z",
        "modification_comment": "updated Demonstrative_Examples, References, Relationships, Taxonomy_Mappings"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2012-10-30T00:00:00Z",
        "modification_comment": "updated Potential_Mitigations"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2014-06-23T00:00:00Z",
        "modification_comment": "updated Modes_of_Introduction, Other_Notes"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2014-07-30T00:00:00Z",
        "modification_comment": "updated Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2017-11-08T00:00:00Z",
        "modification_comment": "updated Demonstrative_Examples, Observed_Examples"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2019-01-03T00:00:00Z",
        "modification_comment": "updated Taxonomy_Mappings"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2020-02-24T00:00:00Z",
        "modification_comment": "updated Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2021-03-15T00:00:00Z",
        "modification_comment": "updated Demonstrative_Examples"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2022-06-28T00:00:00Z",
        "modification_comment": "updated Observed_Examples"
      }
    ]
  },
  "weakness_ordinalities": [
    {
      "ordinality": "Primary"
    }
  ],
  "taxonomy_mappings": [
    {
      "taxonomy_name": "The CERT Oracle Secure Coding Standard for Java (2011)",
      "entry_name": "Sanitize untrusted data passed to a regex",
      "entry_id": "IDS08-J"
    }
  ]
}
