{
  "id": "454",
  "name": "External Initialization of Trusted Variables or Data Stores",
  "abstraction": "Base",
  "structure": "Simple",
  "status": "Draft",
  "description": "The software initializes critical internal variables or data stores using inputs that can be modified by untrusted actors.",
  "extended_description": "A software system should be reluctant to trust variables that have been initialized outside of its trust boundary, especially if they are initialized by users. The variables may have been initialized incorrectly. If an attacker can initialize the variable, then they can influence what the vulnerable system will do.",
  "related_weaknesses": [
    {
      "nature": "ChildOf",
      "cweid": "665",
      "view_id": "1000",
      "ordinal": "Primary"
    },
    {
      "nature": "CanAlsoBe",
      "cweid": "456",
      "view_id": "1000"
    }
  ],
  "applicable_platforms": {
    "language": [
      {
        "prevalence": "Sometimes",
        "name": "PHP"
      },
      {
        "class": "Language-Independent",
        "prevalence": "Undetermined"
      }
    ]
  },
  "modes_of_introduction": [
    {
      "phase": "Architecture and Design"
    },
    {
      "phase": "Implementation"
    }
  ],
  "common_consequences": [
    {
      "scope": [
        "Integrity"
      ],
      "impact": [
        "Modify Application Data"
      ],
      "note": "An attacker could gain access to and modify sensitive data or system information."
    }
  ],
  "potential_mitigations": [
    {
      "phase": [
        "Implementation"
      ],
      "description": [
        "A software system should be reluctant to trust variables that have been initialized outside of its trust boundary. Ensure adequate checking (e.g. input validation) is performed when relying on input from outside a trust boundary."
      ],
      "strategy": "Input Validation"
    },
    {
      "phase": [
        "Architecture and Design"
      ],
      "description": [
        "Avoid any external control of variables. If necessary, restrict the variables that can be modified using an allowlist, and use a different namespace or naming convention if possible."
      ]
    }
  ],
  "demonstrative_examples": [
    {
      "text": "\n               \u003cIntro_Text\u003eIn the Java example below, a system property controls the debug level of the application.\u003c/Intro_Text\u003e\n               \u003cExample_Code Nature=\"bad\" Language=\"Java\"\u003e\n                  \u003cxhtml:div\u003eint debugLevel = Integer.getInteger(\"com.domain.application.debugLevel\").intValue();\u003c/xhtml:div\u003e\n               \u003c/Example_Code\u003e\n               \u003cBody_Text\u003eIf an attacker is able to modify the system property, then it may be possible to coax the application into divulging sensitive information by virtue of the fact that additional debug information is printed/exposed as the debug level increases.\u003c/Body_Text\u003e\n            "
    },
    {
      "text": "\n               \u003cIntro_Text\u003eThis code checks the HTTP POST request for a debug switch, and enables a debug mode if the switch is set.\u003c/Intro_Text\u003e\n               \u003cExample_Code Nature=\"bad\" Language=\"PHP\"\u003e\n                  \u003cxhtml:div\u003e$debugEnabled = false;\u003cxhtml:br/\u003eif ($_POST[\"debug\"] == \"true\"){\u003cxhtml:div style=\"margin-left:10px;\"\u003e$debugEnabled = true;\u003c/xhtml:div\u003e}\u003cxhtml:br/\u003e\n                     \u003cxhtml:i\u003e/.../\u003c/xhtml:i\u003e\n                     \u003cxhtml:br/\u003e\n                     \u003cxhtml:br/\u003efunction login($username, $password){\u003cxhtml:div style=\"margin-left:10px;\"\u003eif($debugEnabled){\u003cxhtml:div style=\"margin-left:10px;\"\u003eecho 'Debug Activated';\u003cxhtml:br/\u003ephpinfo();\u003cxhtml:br/\u003e$isAdmin = True;\u003cxhtml:br/\u003ereturn True;\u003c/xhtml:div\u003e}\u003c/xhtml:div\u003e}\u003c/xhtml:div\u003e\n               \u003c/Example_Code\u003e\n               \u003cBody_Text\u003eAny user can activate the debug mode, gaining administrator privileges. An attacker may also use the information printed by the phpinfo() function to further exploit the system. .\u003c/Body_Text\u003e\n               \u003cBody_Text\u003eThis example also exhibits Information Exposure Through Debug Information (CWE-215)\u003c/Body_Text\u003e\n            "
    }
  ],
  "observed_examples": [
    {
      "reference": "CVE-2000-0959",
      "description": "Does not clear dangerous environment variables, enabling symlink attack.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-0959"
    },
    {
      "reference": "CVE-2001-0033",
      "description": "Specify alternate configuration directory in environment variable, enabling untrusted path.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-0033"
    },
    {
      "reference": "CVE-2001-0872",
      "description": "Dangerous environment variable not cleansed.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-0872"
    },
    {
      "reference": "CVE-2001-0084",
      "description": "Specify arbitrary modules using environment variable.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-0084"
    }
  ],
  "content_history": {
    "submission": {
      "submission_name": "PLOVER",
      "submission_date": "2006-07-19T00:00:00Z"
    },
    "modification": [
      {
        "modification_name": "Sean Eidemiller",
        "modification_organization": "Cigital",
        "modification_date": "2008-07-01T00:00:00Z",
        "modification_comment": "added/updated demonstrative examples"
      },
      {
        "modification_name": "Eric Dalci",
        "modification_organization": "Cigital",
        "modification_date": "2008-07-01T00:00:00Z",
        "modification_comment": "updated Potential_Mitigations, Time_of_Introduction"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2008-09-08T00:00:00Z",
        "modification_comment": "updated Applicable_Platforms, Description, Relationships, Other_Notes, Taxonomy_Mappings"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2009-10-29T00:00:00Z",
        "modification_comment": "updated Other_Notes, Relationship_Notes"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2010-02-16T00:00:00Z",
        "modification_comment": "updated Description, Name, Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2010-04-05T00:00:00Z",
        "modification_comment": "updated Applicable_Platforms, Demonstrative_Examples"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2011-03-29T00:00:00Z",
        "modification_comment": "updated Demonstrative_Examples"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2011-06-01T00:00:00Z",
        "modification_comment": "updated Common_Consequences, Relationships, Taxonomy_Mappings"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2012-05-11T00:00:00Z",
        "modification_comment": "updated Common_Consequences, Relationships, Taxonomy_Mappings"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2012-10-30T00:00:00Z",
        "modification_comment": "updated Potential_Mitigations"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2014-07-30T00:00:00Z",
        "modification_comment": "updated Relationships, Taxonomy_Mappings"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2017-11-08T00:00:00Z",
        "modification_comment": "updated Description"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2020-06-25T00:00:00Z",
        "modification_comment": "updated Potential_Mitigations"
      }
    ],
    "previous_entry_name": [
      {
        "text": "External Initialization of Trusted Variables or Values",
        "date": "2008-04-11T00:00:00Z"
      },
      {
        "text": "External Initialization of Trusted Variables",
        "date": "2010-02-16T00:00:00Z"
      }
    ]
  },
  "taxonomy_mappings": [
    {
      "taxonomy_name": "PLOVER",
      "entry_name": "External initialization of trusted variables or values"
    },
    {
      "taxonomy_name": "Software Fault Patterns",
      "entry_name": "Tainted input to variable",
      "entry_id": "SFP25"
    }
  ],
  "notes": [
    {
      "type": "Relationship",
      "text": "Overlaps Missing variable initialization, especially in PHP."
    },
    {
      "type": "Applicable Platform",
      "text": "\n               \u003cxhtml:p\u003eThis is often found in PHP due to register_globals and the common practice of storing library/include files under the web document root so that they are available using a direct request.\u003c/xhtml:p\u003e\n            "
    }
  ]
}
