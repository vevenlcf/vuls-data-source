{
  "id": "602",
  "name": "Client-Side Enforcement of Server-Side Security",
  "abstraction": "Base",
  "structure": "Simple",
  "status": "Draft",
  "description": "The software is composed of a server that relies on the client to implement a mechanism that is intended to protect the server.",
  "extended_description": "When the server relies on protection mechanisms placed on the client side, an attacker can modify the client-side behavior to bypass the protection mechanisms resulting in potentially unexpected interactions between the client and server. The consequences will vary, depending on what the mechanisms are trying to protect.",
  "related_weaknesses": [
    {
      "nature": "ChildOf",
      "cweid": "669",
      "view_id": "1000",
      "ordinal": "Primary"
    },
    {
      "nature": "ChildOf",
      "cweid": "693",
      "view_id": "1000"
    },
    {
      "nature": "CanPrecede",
      "cweid": "471",
      "view_id": "1000"
    },
    {
      "nature": "PeerOf",
      "cweid": "290",
      "view_id": "1000"
    },
    {
      "nature": "PeerOf",
      "cweid": "300",
      "view_id": "1000"
    }
  ],
  "applicable_platforms": {
    "language": [
      {
        "class": "Language-Independent",
        "prevalence": "Undetermined"
      }
    ],
    "technology": [
      {
        "class": "Mobile",
        "prevalence": "Undetermined"
      }
    ]
  },
  "modes_of_introduction": [
    {
      "phase": "Architecture and Design",
      "note": [
        "COMMISSION: This weakness refers to an incorrect design related to an architectural security tactic."
      ]
    },
    {
      "phase": "Architecture and Design",
      "note": [
        "Consider a product that consists of two or more processes or nodes that must interact closely, such as a client/server model. If the product uses protection schemes in the client in order to defend from attacks against the server, and the server does not use the same schemes, then an attacker could modify the client in a way that bypasses those schemes. This is a fundamental design flaw that is primary to many weaknesses."
      ]
    }
  ],
  "likelihood_of_exploit": "Medium",
  "common_consequences": [
    {
      "scope": [
        "Access Control",
        "Availability"
      ],
      "impact": [
        "Bypass Protection Mechanism",
        "DoS: Crash, Exit, or Restart"
      ],
      "note": "Client-side validation checks can be easily bypassed, allowing malformed or unexpected input to pass into the application, potentially as trusted data. This may lead to unexpected states, behaviors and possibly a resulting crash."
    },
    {
      "scope": [
        "Access Control"
      ],
      "impact": [
        "Bypass Protection Mechanism",
        "Gain Privileges or Assume Identity"
      ],
      "note": "Client-side checks for authentication can be easily bypassed, allowing clients to escalate their access levels and perform unintended actions."
    }
  ],
  "potential_mitigations": [
    {
      "phase": [
        "Architecture and Design"
      ],
      "description": [
        "\n                  \u003cxhtml:p\u003eFor any security checks that are performed on the client side, ensure that these checks are duplicated on the server side. Attackers can bypass the client-side checks by modifying values after the checks have been performed, or by changing the client to remove the client-side checks entirely. Then, these modified values would be submitted to the server.\u003c/xhtml:p\u003e\n                  \u003cxhtml:p\u003eEven though client-side checks provide minimal benefits with respect to server-side security, they are still useful. First, they can support intrusion detection. If the server receives input that should have been rejected by the client, then it may be an indication of an attack. Second, client-side error-checking can provide helpful feedback to the user about the expectations for valid input. Third, there may be a reduction in server-side processing time for accidental input errors, although this is typically a small savings.\u003c/xhtml:p\u003e\n               "
      ]
    },
    {
      "phase": [
        "Architecture and Design"
      ],
      "description": [
        "If some degree of trust is required between the two entities, then use integrity checking and strong authentication to ensure that the inputs are coming from a trusted source. Design the product so that this trust is managed in a centralized fashion, especially if there are complex or numerous communication channels, in order to reduce the risks that the implementer will mistakenly omit a check in a single code path."
      ]
    },
    {
      "phase": [
        "Testing"
      ],
      "description": [
        "Use dynamic tools and techniques that interact with the software using large test suites with many diverse inputs, such as fuzz testing (fuzzing), robustness testing, and fault injection. The software's operation may slow down, but it should not become unstable, crash, or generate incorrect results."
      ]
    },
    {
      "phase": [
        "Testing"
      ],
      "description": [
        "Use tools and techniques that require manual (human) analysis, such as penetration testing, threat modeling, and interactive tools that allow the tester to record and modify an active session. These may be more effective than strictly automated techniques. This is especially the case with weaknesses that are related to design and business rules."
      ]
    }
  ],
  "demonstrative_examples": [
    {
      "text": "\n               \u003cIntro_Text\u003eThis example contains client-side code that checks if the user authenticated successfully before sending a command. The server-side code performs the authentication in one step, and executes the command in a separate step.\u003c/Intro_Text\u003e\n               \u003cBody_Text\u003eCLIENT-SIDE (client.pl)\u003c/Body_Text\u003e\n               \u003cExample_Code Nature=\"good\" Language=\"Perl\"\u003e\n                  \u003cxhtml:div\u003e$server = \"server.example.com\";\u003cxhtml:br/\u003e$username = AskForUserName();\u003cxhtml:br/\u003e$password = AskForPassword();\u003cxhtml:br/\u003e$address = AskForAddress();\u003cxhtml:br/\u003e$sock = OpenSocket($server, 1234);\u003cxhtml:br/\u003ewriteSocket($sock, \"AUTH $username $password\\n\");\u003cxhtml:br/\u003e$resp = readSocket($sock);\u003cxhtml:br/\u003eif ($resp eq \"success\") {\u003cxhtml:div style=\"margin-left:10px;\"\u003e\n                        \u003cxhtml:div\u003e\n                           \u003cxhtml:br/\u003e\n                           \u003cxhtml:i\u003e# username/pass is valid, go ahead and update the info!\u003c/xhtml:i\u003e\n                           \u003cxhtml:br/\u003ewriteSocket($sock, \"CHANGE-ADDRESS $username $address\\n\";\u003c/xhtml:div\u003e\n                     \u003c/xhtml:div\u003e}\u003cxhtml:br/\u003eelse {\u003cxhtml:div style=\"margin-left:10px;\"\u003eprint \"ERROR: Invalid Authentication!\\n\";\u003c/xhtml:div\u003e}\u003c/xhtml:div\u003e\n               \u003c/Example_Code\u003e\n               \u003cBody_Text\u003eSERVER-SIDE (server.pl):\u003c/Body_Text\u003e\n               \u003cExample_Code Nature=\"bad\"\u003e\n                  \u003cxhtml:div\u003e$sock = acceptSocket(1234);\u003cxhtml:br/\u003e($cmd, $args) = ParseClientRequest($sock);\u003cxhtml:br/\u003eif ($cmd eq \"AUTH\") {\u003cxhtml:div style=\"margin-left:10px;\"\u003e\n                        \u003cxhtml:div\u003e($username, $pass) = split(/\\s+/, $args, 2);\u003cxhtml:br/\u003e$result = AuthenticateUser($username, $pass);\u003cxhtml:br/\u003ewriteSocket($sock, \"$result\\n\");\u003cxhtml:br/\u003e\n                           \u003cxhtml:i\u003e# does not close the socket on failure; assumes the\u003c/xhtml:i\u003e\n                           \u003cxhtml:br/\u003e\n                           \u003cxhtml:br/\u003e\n                           \u003cxhtml:i\u003e# user will try again\u003c/xhtml:i\u003e\n                           \u003cxhtml:br/\u003e\n                        \u003c/xhtml:div\u003e\n                     \u003c/xhtml:div\u003e}\u003cxhtml:br/\u003eelsif ($cmd eq \"CHANGE-ADDRESS\") {\u003cxhtml:div style=\"margin-left:10px;\"\u003eif (validateAddress($args)) {\u003cxhtml:div style=\"margin-left:10px;\"\u003e$res = UpdateDatabaseRecord($username, \"address\", $args);\u003cxhtml:br/\u003ewriteSocket($sock, \"SUCCESS\\n\");\u003c/xhtml:div\u003e}\u003cxhtml:br/\u003eelse {\u003cxhtml:div style=\"margin-left:10px;\"\u003ewriteSocket($sock, \"FAILURE -- address is malformed\\n\");\u003c/xhtml:div\u003e}\u003c/xhtml:div\u003e}\u003c/xhtml:div\u003e\n               \u003c/Example_Code\u003e\n               \u003cBody_Text\u003eThe server accepts 2 commands, \"AUTH\" which authenticates the user, and \"CHANGE-ADDRESS\" which updates the address field for the username. The client performs the authentication and only sends a CHANGE-ADDRESS for that user if the authentication succeeds. Because the client has already performed the authentication, the server assumes that the username in the CHANGE-ADDRESS is the same as the authenticated user. An attacker could modify the client by removing the code that sends the \"AUTH\" command and simply executing the CHANGE-ADDRESS.\u003c/Body_Text\u003e\n            "
    }
  ],
  "observed_examples": [
    {
      "reference": "CVE-2006-6994",
      "description": "ASP program allows upload of .asp files by bypassing client-side checks.",
      "link": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-6994"
    },
    {
      "reference": "CVE-2007-0163",
      "description": "steganography products embed password information in the carrier file, which can be extracted from a modified client.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-0163"
    },
    {
      "reference": "CVE-2007-0164",
      "description": "steganography products embed password information in the carrier file, which can be extracted from a modified client.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-0164"
    },
    {
      "reference": "CVE-2007-0100",
      "description": "client allows server to modify client's configuration and overwrite arbitrary files.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-0100"
    }
  ],
  "references": [
    {
      "section": "Chapter 23, \"Client-Side Security Is an Oxymoron\" Page 687",
      "reference_id": "REF-7",
      "author": [
        "Michael Howard",
        "David LeBlanc"
      ],
      "title": "Writing Secure Code",
      "url": "https://www.microsoftpressstore.com/store/writing-secure-code-9780735617223",
      "publication_year": "2002",
      "publication_month": "--12",
      "publication_day": "---04",
      "publisher": "Microsoft Press",
      "edition": "2nd Edition"
    }
  ],
  "content_history": {
    "submission": {
      "submission_name": "CWE Community",
      "submission_date": "2007-05-07T00:00:00Z",
      "submission_comment": "Submitted by members of the CWE community to extend early CWE versions"
    },
    "modification": [
      {
        "modification_name": "Eric Dalci",
        "modification_organization": "Cigital",
        "modification_date": "2008-07-01T00:00:00Z",
        "modification_comment": "updated Time_of_Introduction"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2008-09-08T00:00:00Z",
        "modification_comment": "updated Relationships, Other_Notes, Taxonomy_Mappings, Weakness_Ordinalities"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2009-01-12T00:00:00Z",
        "modification_comment": "updated Demonstrative_Examples, Description, Likelihood_of_Exploit, Name, Observed_Examples, Other_Notes, Potential_Mitigations, Relationships, Research_Gaps, Time_of_Introduction"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2009-03-10T00:00:00Z",
        "modification_comment": "updated Potential_Mitigations"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2009-05-27T00:00:00Z",
        "modification_comment": "updated Demonstrative_Examples"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2009-07-27T00:00:00Z",
        "modification_comment": "updated Related_Attack_Patterns, Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2009-10-29T00:00:00Z",
        "modification_comment": "updated Applicable_Platforms, Common_Consequences, Description"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2010-02-16T00:00:00Z",
        "modification_comment": "updated References"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2010-04-05T00:00:00Z",
        "modification_comment": "updated Related_Attack_Patterns"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2010-12-13T00:00:00Z",
        "modification_comment": "updated Related_Attack_Patterns"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2011-03-29T00:00:00Z",
        "modification_comment": "updated Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2011-06-01T00:00:00Z",
        "modification_comment": "updated Common_Consequences"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2012-05-11T00:00:00Z",
        "modification_comment": "updated Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2014-07-30T00:00:00Z",
        "modification_comment": "updated Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2017-05-03T00:00:00Z",
        "modification_comment": "updated Related_Attack_Patterns"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2017-11-08T00:00:00Z",
        "modification_comment": "updated Applicable_Platforms, Enabling_Factors_for_Exploitation, Modes_of_Introduction, References, Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2018-03-27T00:00:00Z",
        "modification_comment": "updated References"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2019-06-20T00:00:00Z",
        "modification_comment": "updated Related_Attack_Patterns"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2020-02-24T00:00:00Z",
        "modification_comment": "updated Applicable_Platforms, Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2021-10-28T00:00:00Z",
        "modification_comment": "updated Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2022-04-28T00:00:00Z",
        "modification_comment": "updated Research_Gaps"
      }
    ],
    "previous_entry_name": [
      {
        "text": "Client-Side Enforcement of Server-Side Security",
        "date": "2008-04-11T00:00:00Z"
      },
      {
        "text": "Design Principle Violation: Client-Side Enforcement of Server-Side Security",
        "date": "2009-01-12T00:00:00Z"
      }
    ]
  },
  "weakness_ordinalities": [
    {
      "ordinality": "Primary"
    }
  ],
  "taxonomy_mappings": [
    {
      "taxonomy_name": "OWASP Top Ten 2004",
      "entry_name": "Unvalidated Input",
      "entry_id": "A1",
      "mapping_fit": "CWE More Specific"
    }
  ],
  "related_attack_patterns": [
    "162",
    "202",
    "207",
    "208",
    "21",
    "31",
    "383",
    "384",
    "385",
    "386",
    "387",
    "388"
  ]
}
