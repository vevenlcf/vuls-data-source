{
  "id": "309",
  "name": "Use of Password System for Primary Authentication",
  "abstraction": "Base",
  "structure": "Simple",
  "status": "Draft",
  "description": "The use of password systems as the primary means of authentication may be subject to several flaws or shortcomings, each reducing the effectiveness of the mechanism.",
  "related_weaknesses": [
    {
      "nature": "ChildOf",
      "cweid": "287",
      "view_id": "1000",
      "ordinal": "Primary"
    },
    {
      "nature": "ChildOf",
      "cweid": "654",
      "view_id": "1000"
    },
    {
      "nature": "PeerOf",
      "cweid": "308",
      "view_id": "1000"
    }
  ],
  "applicable_platforms": {
    "language": [
      {
        "class": "Language-Independent",
        "prevalence": "Undetermined"
      }
    ]
  },
  "background_details": [
    "Password systems are the simplest and most ubiquitous authentication mechanisms. However, they are subject to such well known attacks,and such frequent compromise that their use in the most simple implementation is not practical."
  ],
  "modes_of_introduction": [
    {
      "phase": "Architecture and Design"
    }
  ],
  "likelihood_of_exploit": "High",
  "common_consequences": [
    {
      "scope": [
        "Access Control"
      ],
      "impact": [
        "Bypass Protection Mechanism",
        "Gain Privileges or Assume Identity"
      ],
      "note": "A password authentication mechanism error will almost always result in attackers being authorized as valid users."
    }
  ],
  "potential_mitigations": [
    {
      "phase": [
        "Architecture and Design"
      ],
      "description": [
        "\n                  \u003cxhtml:p\u003eIn order to protect password systems from compromise, the following should be noted:\u003c/xhtml:p\u003e\n                  \u003cxhtml:div style=\"margin-left:10px;\"\u003e\n                     \u003cxhtml:ul\u003e\n                        \u003cxhtml:li\u003ePasswords should be stored safely to prevent insider attack and to ensure that -- if a system is compromised -- the passwords are not retrievable. Due to password reuse, this information may be useful in the compromise of other systems these users work with. In order to protect these passwords, they should be stored encrypted, in a non-reversible state, such that the original text password cannot be extracted from the stored value.\u003c/xhtml:li\u003e\n                        \u003cxhtml:li\u003ePassword aging should be strictly enforced to ensure that passwords do not remain unchanged for long periods of time. The longer a password remains in use, the higher the probability that it has been compromised. For this reason, passwords should require refreshing periodically, and users should be informed of the risk of passwords which remain in use for too long.\u003c/xhtml:li\u003e\n                        \u003cxhtml:li\u003ePassword strength should be enforced intelligently. Rather than restrict passwords to specific content, or specific length, users should be encouraged to use upper and lower case letters, numbers, and symbols in their passwords. The system should also ensure that no passwords are derived from dictionary words.\u003c/xhtml:li\u003e\n                     \u003c/xhtml:ul\u003e\n                  \u003c/xhtml:div\u003e\n               "
      ]
    },
    {
      "phase": [
        "Architecture and Design"
      ],
      "description": [
        "Use a zero-knowledge password protocol, such as SRP."
      ]
    },
    {
      "phase": [
        "Architecture and Design"
      ],
      "description": [
        "Ensure that passwords are stored safely and are not reversible."
      ]
    },
    {
      "phase": [
        "Architecture and Design"
      ],
      "description": [
        "Implement password aging functionality that requires passwords be changed after a certain point."
      ]
    },
    {
      "phase": [
        "Architecture and Design"
      ],
      "description": [
        "Use a mechanism for determining the strength of a password and notify the user of weak password use."
      ]
    },
    {
      "phase": [
        "Architecture and Design"
      ],
      "description": [
        "Inform the user of why password protections are in place, how they work to protect data integrity, and why it is important to heed their warnings."
      ]
    }
  ],
  "demonstrative_examples": [
    {
      "demonstrative_example_id": "DX-101",
      "text": "\n               \u003cIntro_Text\u003eIn both of these examples, a user is logged in if their given password matches a stored password:\u003c/Intro_Text\u003e\n               \u003cExample_Code Nature=\"bad\" Language=\"C\"\u003e\n                  \u003cxhtml:div\u003eunsigned char *check_passwd(char *plaintext) {\u003cxhtml:div style=\"margin-left:10px;\"\u003ectext = simple_digest(\"sha1\",plaintext,strlen(plaintext), ... );\u003cxhtml:br/\u003e\n                        \u003cxhtml:i\u003e//Login if hash matches stored hash\u003c/xhtml:i\u003e\n                        \u003cxhtml:br/\u003eif (equal(ctext, secret_password())) {\u003cxhtml:div style=\"margin-left:10px;\"\u003elogin_user();\u003c/xhtml:div\u003e}\u003c/xhtml:div\u003e}\u003c/xhtml:div\u003e\n               \u003c/Example_Code\u003e\n               \u003cExample_Code Nature=\"bad\" Language=\"Java\"\u003e\n                  \u003cxhtml:div\u003eString plainText = new String(plainTextIn);\u003cxhtml:br/\u003eMessageDigest encer = MessageDigest.getInstance(\"SHA\");\u003cxhtml:br/\u003eencer.update(plainTextIn);\u003cxhtml:br/\u003ebyte[] digest = password.digest();\u003cxhtml:br/\u003e\n                     \u003cxhtml:i\u003e//Login if hash matches stored hash\u003c/xhtml:i\u003e\n                     \u003cxhtml:br/\u003eif (equal(digest,secret_password())) {\u003cxhtml:div style=\"margin-left:10px;\"\u003elogin_user();\u003c/xhtml:div\u003e}\u003c/xhtml:div\u003e\n               \u003c/Example_Code\u003e\n               \u003cBody_Text\u003eThis code relies exclusively on a password mechanism (CWE-309) using only one factor of authentication (CWE-308). If an attacker can steal or guess a user's password, they are given full access to their account. Note this code also uses SHA-1, which is a weak hash (CWE-328).  It also does not use a salt (CWE-759).\u003c/Body_Text\u003e\n            "
    }
  ],
  "references": [
    {
      "reference_id": "REF-18",
      "author": [
        "Secure Software, Inc."
      ],
      "title": "The CLASP Application Security Process",
      "url": "https://cwe.mitre.org/documents/sources/TheCLASPApplicationSecurityProcess.pdf",
      "publication_year": "2005"
    }
  ],
  "content_history": {
    "submission": {
      "submission_name": "CLASP",
      "submission_date": "2006-07-19T00:00:00Z"
    },
    "modification": [
      {
        "modification_organization": "Veracode",
        "modification_date": "2008-08-15T00:00:00Z",
        "modification_comment": "Suggested OWASP Top Ten 2004 mapping"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2008-09-08T00:00:00Z",
        "modification_comment": "updated Background_Details, Common_Consequences, Relationships, Taxonomy_Mappings"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2010-12-13T00:00:00Z",
        "modification_comment": "updated Common_Consequences"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2011-06-01T00:00:00Z",
        "modification_comment": "updated Common_Consequences"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2012-05-11T00:00:00Z",
        "modification_comment": "updated Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2012-10-30T00:00:00Z",
        "modification_comment": "updated Demonstrative_Examples"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2014-07-30T00:00:00Z",
        "modification_comment": "updated Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2017-11-08T00:00:00Z",
        "modification_comment": "updated Applicable_Platforms, Likelihood_of_Exploit"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2020-02-24T00:00:00Z",
        "modification_comment": "updated References, Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2020-08-20T00:00:00Z",
        "modification_comment": "updated Related_Attack_Patterns"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2021-03-15T00:00:00Z",
        "modification_comment": "updated Demonstrative_Examples"
      }
    ],
    "previous_entry_name": [
      {
        "text": "Using Password Systems",
        "date": "2008-04-11T00:00:00Z"
      }
    ]
  },
  "taxonomy_mappings": [
    {
      "taxonomy_name": "CLASP",
      "entry_name": "Using password systems"
    },
    {
      "taxonomy_name": "OWASP Top Ten 2004",
      "entry_name": "Broken Authentication and Session Management",
      "entry_id": "A3",
      "mapping_fit": "CWE More Specific"
    }
  ],
  "related_attack_patterns": [
    "16",
    "49",
    "509",
    "55",
    "555",
    "560",
    "561",
    "565",
    "600",
    "652",
    "653",
    "70"
  ]
}
