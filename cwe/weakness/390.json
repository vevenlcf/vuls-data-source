{
  "id": "390",
  "name": "Detection of Error Condition Without Action",
  "abstraction": "Base",
  "structure": "Simple",
  "status": "Draft",
  "description": "The software detects a specific error, but takes no actions to handle the error.",
  "related_weaknesses": [
    {
      "nature": "ChildOf",
      "cweid": "755",
      "view_id": "1000",
      "ordinal": "Primary"
    },
    {
      "nature": "CanPrecede",
      "cweid": "401",
      "view_id": "1000"
    }
  ],
  "applicable_platforms": {
    "language": [
      {
        "class": "Language-Independent",
        "prevalence": "Undetermined"
      }
    ]
  },
  "modes_of_introduction": [
    {
      "phase": "Architecture and Design"
    },
    {
      "phase": "Implementation",
      "note": [
        "REALIZATION: This weakness is caused during implementation of an architectural security tactic."
      ]
    }
  ],
  "likelihood_of_exploit": "Medium",
  "common_consequences": [
    {
      "scope": [
        "Integrity",
        "Other"
      ],
      "impact": [
        "Varies by Context",
        "Unexpected State",
        "Alter Execution Logic"
      ],
      "note": "An attacker could utilize an ignored error condition to place the system in an unexpected state that could lead to the execution of unintended logic and could cause other unintended behavior."
    }
  ],
  "potential_mitigations": [
    {
      "phase": [
        "Implementation"
      ],
      "description": [
        "Properly handle each exception. This is the recommended solution. Ensure that all exceptions are handled in such a way that you can be sure of the state of your system at any given moment."
      ]
    },
    {
      "phase": [
        "Implementation"
      ],
      "description": [
        "If a function returns an error, it is important to either fix the problem and try again, alert the user that an error has happened and let the program continue, or alert the user and close and cleanup the program."
      ]
    },
    {
      "phase": [
        "Testing"
      ],
      "description": [
        "Subject the software to extensive testing to discover some of the possible instances of where/how errors or return values are not handled. Consider testing techniques such as ad hoc, equivalence partitioning, robustness and fault tolerance, mutation, and fuzzing."
      ]
    }
  ],
  "demonstrative_examples": [
    {
      "text": "\n               \u003cIntro_Text\u003eThe following example attempts to allocate memory for a character. After the call to malloc, an if statement is used to check whether the malloc function failed.\u003c/Intro_Text\u003e\n               \u003cExample_Code Nature=\"bad\" Language=\"C\"\u003e\n                  \u003cxhtml:div\u003efoo=malloc(sizeof(char)); //the next line checks to see if malloc failed\u003cxhtml:br/\u003eif (foo==NULL) {\u003cxhtml:div style=\"margin-left:10px;\"\u003e//We do nothing so we just ignore the error.\u003c/xhtml:div\u003e}\u003c/xhtml:div\u003e\n               \u003c/Example_Code\u003e\n               \u003cBody_Text\u003eThe conditional successfully detects a NULL return value from malloc indicating a failure, however it does not do anything to handle the problem. Unhandled errors may have unexpected results and may cause the program to crash or terminate.\u003c/Body_Text\u003e\n               \u003cBody_Text\u003eInstead, the if block should contain statements that either attempt to fix the problem or notify the user that an error has occurred and continue processing or perform some cleanup and gracefully terminate the program. The following example notifies the user that the malloc function did not allocate the required memory resources and returns an error code.\u003c/Body_Text\u003e\n               \u003cExample_Code Nature=\"good\" Language=\"C\"\u003e\n                  \u003cxhtml:div\u003efoo=malloc(sizeof(char)); //the next line checks to see if malloc failed\u003cxhtml:br/\u003eif (foo==NULL) {\u003cxhtml:div style=\"margin-left:10px;\"\u003eprintf(\"Malloc failed to allocate memory resources\");\u003cxhtml:br/\u003ereturn -1;\u003c/xhtml:div\u003e}\u003c/xhtml:div\u003e\n               \u003c/Example_Code\u003e\n            "
    },
    {
      "text": "\n               \u003cIntro_Text\u003eIn the following C++ example the method readFile() will read the file whose name is provided in the input parameter and will return the contents of the file in char string. The method calls open() and read() may result in errors if the file does not exist or does not contain any data to read. These errors will be thrown when the is_open() method and good() method indicate errors opening or reading the file. However, these errors are not handled within the catch statement. Catch statements that do not perform any processing will have unexpected results. In this case an empty char string will be returned, and the file will not be properly closed.\u003c/Intro_Text\u003e\n               \u003cExample_Code Nature=\"bad\" Language=\"C++\"\u003e\n                  \u003cxhtml:div\u003echar* readfile (char *filename) {\u003cxhtml:div style=\"margin-left:10px;\"\u003e\n                        \u003cxhtml:div\u003etry {\u003cxhtml:div style=\"margin-left:10px;\"\u003e\n                              \u003cxhtml:div\u003e// open input file\u003cxhtml:br/\u003eifstream infile;\u003cxhtml:br/\u003einfile.open(filename);\u003cxhtml:br/\u003e\n                                 \u003cxhtml:br/\u003eif (!infile.is_open()) {\u003cxhtml:div style=\"margin-left:10px;\"\u003ethrow \"Unable to open file \" + filename;\u003c/xhtml:div\u003e}\u003cxhtml:br/\u003e\n                                 \u003cxhtml:br/\u003e// get length of file\u003cxhtml:br/\u003einfile.seekg (0, ios::end);\u003cxhtml:br/\u003eint length = infile.tellg();\u003cxhtml:br/\u003einfile.seekg (0, ios::beg);\u003cxhtml:br/\u003e\n                                 \u003cxhtml:br/\u003e// allocate memory\u003cxhtml:br/\u003echar *buffer = new char [length];\u003cxhtml:br/\u003e\n                                 \u003cxhtml:br/\u003e// read data from file\u003cxhtml:br/\u003einfile.read (buffer,length);\u003cxhtml:br/\u003e\n                                 \u003cxhtml:br/\u003eif (!infile.good()) {\u003cxhtml:div style=\"margin-left:10px;\"\u003ethrow \"Unable to read from file \" + filename;\u003c/xhtml:div\u003e}\u003cxhtml:br/\u003e\n                                 \u003cxhtml:br/\u003einfile.close();\u003cxhtml:br/\u003e\n                                 \u003cxhtml:br/\u003ereturn buffer;\u003c/xhtml:div\u003e\n                           \u003c/xhtml:div\u003e}\u003cxhtml:br/\u003ecatch (...) {\u003cxhtml:div style=\"margin-left:10px;\"\u003e/* bug: insert code to handle this later */\u003c/xhtml:div\u003e}\u003c/xhtml:div\u003e\n                     \u003c/xhtml:div\u003e}\u003c/xhtml:div\u003e\n               \u003c/Example_Code\u003e\n               \u003cBody_Text\u003eThe catch statement should contain statements that either attempt to fix the problem or notify the user that an error has occurred and continue processing or perform some cleanup and gracefully terminate the program. The following C++ example contains two catch statements. The first of these will catch a specific error thrown within the try block, and the second catch statement will catch all other errors from within the catch block. Both catch statements will notify the user that an error has occurred, close the file, and rethrow to the block that called the readFile() method for further handling or possible termination of the program.\u003c/Body_Text\u003e\n               \u003cExample_Code Nature=\"good\" Language=\"C++\"\u003e\n                  \u003cxhtml:div\u003echar* readFile (char *filename) {\u003cxhtml:div style=\"margin-left:10px;\"\u003e\n                        \u003cxhtml:div\u003etry {\u003cxhtml:div style=\"margin-left:10px;\"\u003e\n                              \u003cxhtml:div\u003e// open input file\u003cxhtml:br/\u003eifstream infile;\u003cxhtml:br/\u003einfile.open(filename);\u003cxhtml:br/\u003e\n                                 \u003cxhtml:br/\u003eif (!infile.is_open()) {\u003cxhtml:div style=\"margin-left:10px;\"\u003ethrow \"Unable to open file \" + filename;\u003c/xhtml:div\u003e}\u003cxhtml:br/\u003e\n                                 \u003cxhtml:br/\u003e// get length of file\u003cxhtml:br/\u003einfile.seekg (0, ios::end);\u003cxhtml:br/\u003eint length = infile.tellg();\u003cxhtml:br/\u003einfile.seekg (0, ios::beg);\u003cxhtml:br/\u003e\n                                 \u003cxhtml:br/\u003e// allocate memory\u003cxhtml:br/\u003echar *buffer = new char [length];\u003cxhtml:br/\u003e\n                                 \u003cxhtml:br/\u003e// read data from file\u003cxhtml:br/\u003einfile.read (buffer,length);\u003cxhtml:br/\u003e\n                                 \u003cxhtml:br/\u003eif (!infile.good()) {\u003cxhtml:div style=\"margin-left:10px;\"\u003ethrow \"Unable to read from file \" + filename;\u003c/xhtml:div\u003e}\u003cxhtml:br/\u003einfile.close();\u003cxhtml:br/\u003e\n                                 \u003cxhtml:br/\u003ereturn buffer;\u003c/xhtml:div\u003e\n                           \u003c/xhtml:div\u003e}\u003cxhtml:br/\u003ecatch (char *str) {\u003cxhtml:div style=\"margin-left:10px;\"\u003eprintf(\"Error: %s \\n\", str);\u003cxhtml:br/\u003einfile.close();\u003cxhtml:br/\u003ethrow str;\u003c/xhtml:div\u003e}\u003cxhtml:br/\u003ecatch (...) {\u003cxhtml:div style=\"margin-left:10px;\"\u003eprintf(\"Error occurred trying to read from file \\n\");\u003cxhtml:br/\u003einfile.close();\u003cxhtml:br/\u003ethrow;\u003c/xhtml:div\u003e}\u003c/xhtml:div\u003e\n                     \u003c/xhtml:div\u003e}\u003c/xhtml:div\u003e\n               \u003c/Example_Code\u003e\n            "
    },
    {
      "text": "\n               \u003cIntro_Text\u003eIn the following Java example the method readFile will read the file whose name is provided in the input parameter and will return the contents of the file in a String object. The constructor of the FileReader object and the read method call may throw exceptions and therefore must be within a try/catch block. While the catch statement in this example will catch thrown exceptions in order for the method to compile, no processing is performed to handle the thrown exceptions. Catch statements that do not perform any processing will have unexpected results. In this case, this will result in the return of a null String.\u003c/Intro_Text\u003e\n               \u003cExample_Code Nature=\"bad\" Language=\"Java\"\u003e\n                  \u003cxhtml:div\u003epublic String readFile(String filename) {\u003cxhtml:div style=\"margin-left:10px;\"\u003e\n                        \u003cxhtml:div\u003eString retString = null;\u003cxhtml:br/\u003etry {\u003cxhtml:div style=\"margin-left:10px;\"\u003e\n                              \u003cxhtml:div\u003e// initialize File and FileReader objects\u003cxhtml:br/\u003eFile file = new File(filename);\u003cxhtml:br/\u003eFileReader fr = new FileReader(file);\u003cxhtml:br/\u003e\n                                 \u003cxhtml:br/\u003e// initialize character buffer\u003cxhtml:br/\u003elong fLen = file.length();\u003cxhtml:br/\u003echar[] cBuf = new char[(int) fLen];\u003cxhtml:br/\u003e\n                                 \u003cxhtml:br/\u003e// read data from file\u003cxhtml:br/\u003eint iRead = fr.read(cBuf, 0, (int) fLen);\u003cxhtml:br/\u003e\n                                 \u003cxhtml:br/\u003e// close file\u003cxhtml:br/\u003efr.close();\u003cxhtml:br/\u003e\n                                 \u003cxhtml:br/\u003eretString = new String(cBuf);\u003cxhtml:br/\u003e\n                              \u003c/xhtml:div\u003e\n                           \u003c/xhtml:div\u003e} catch (Exception ex) {\u003cxhtml:div style=\"margin-left:10px;\"\u003e/* do nothing, but catch so it'll compile... */\u003c/xhtml:div\u003e}\u003cxhtml:br/\u003ereturn retString;\u003c/xhtml:div\u003e\n                     \u003c/xhtml:div\u003e}\u003c/xhtml:div\u003e\n               \u003c/Example_Code\u003e\n               \u003cBody_Text\u003eThe catch statement should contain statements that either attempt to fix the problem, notify the user that an exception has been raised and continue processing, or perform some cleanup and gracefully terminate the program. The following Java example contains three catch statements. The first of these will catch the FileNotFoundException that may be thrown by the FileReader constructor called within the try/catch block. The second catch statement will catch the IOException that may be thrown by the read method called within the try/catch block. The third catch statement will catch all other exceptions thrown within the try block. For all catch statements the user is notified that the exception has been thrown and the exception is rethrown to the block that called the readFile() method for further processing or possible termination of the program. Note that with Java it is usually good practice to use the getMessage() method of the exception class to provide more information to the user about the exception raised.\u003c/Body_Text\u003e\n               \u003cExample_Code Nature=\"good\" Language=\"Java\"\u003e\n                  \u003cxhtml:div\u003epublic String readFile(String filename) throws FileNotFoundException, IOException, Exception {\u003cxhtml:div style=\"margin-left:10px;\"\u003e\n                        \u003cxhtml:div\u003eString retString = null;\u003cxhtml:br/\u003etry {\u003cxhtml:div style=\"margin-left:10px;\"\u003e\n                              \u003cxhtml:div\u003e// initialize File and FileReader objects\u003cxhtml:br/\u003eFile file = new File(filename);\u003cxhtml:br/\u003eFileReader fr = new FileReader(file);\u003cxhtml:br/\u003e\n                                 \u003cxhtml:br/\u003e// initialize character buffer\u003cxhtml:br/\u003elong fLen = file.length();\u003cxhtml:br/\u003echar [] cBuf = new char[(int) fLen];\u003cxhtml:br/\u003e\n                                 \u003cxhtml:br/\u003e// read data from file\u003cxhtml:br/\u003eint iRead = fr.read(cBuf, 0, (int) fLen);\u003cxhtml:br/\u003e\n                                 \u003cxhtml:br/\u003e// close file\u003cxhtml:br/\u003efr.close();\u003cxhtml:br/\u003e\n                                 \u003cxhtml:br/\u003eretString = new String(cBuf);\u003cxhtml:br/\u003e\n                              \u003c/xhtml:div\u003e\n                           \u003c/xhtml:div\u003e} catch (FileNotFoundException ex) {\u003cxhtml:div style=\"margin-left:10px;\"\u003eSystem.err.println (\"Error: FileNotFoundException opening the input file: \" + filename );\u003cxhtml:br/\u003eSystem.err.println (\"\" + ex.getMessage() );\u003cxhtml:br/\u003ethrow new FileNotFoundException(ex.getMessage());\u003c/xhtml:div\u003e} catch (IOException ex) {\u003cxhtml:div style=\"margin-left:10px;\"\u003eSystem.err.println(\"Error: IOException reading the input file.\\n\" + ex.getMessage() );\u003cxhtml:br/\u003ethrow new IOException(ex);\u003c/xhtml:div\u003e} catch (Exception ex) {\u003cxhtml:div style=\"margin-left:10px;\"\u003eSystem.err.println(\"Error: Exception reading the input file.\\n\" + ex.getMessage() );\u003cxhtml:br/\u003ethrow new Exception(ex);\u003c/xhtml:div\u003e}\u003cxhtml:br/\u003ereturn retString;\u003c/xhtml:div\u003e\n                     \u003c/xhtml:div\u003e}\u003c/xhtml:div\u003e\n               \u003c/Example_Code\u003e\n            "
    }
  ],
  "references": [
    {
      "reference_id": "REF-18",
      "author": [
        "Secure Software, Inc."
      ],
      "title": "The CLASP Application Security Process",
      "url": "https://cwe.mitre.org/documents/sources/TheCLASPApplicationSecurityProcess.pdf",
      "publication_year": "2005"
    },
    {
      "section": "\"Sin 11: Failure to Handle Errors Correctly.\" Page 183",
      "reference_id": "REF-44",
      "author": [
        "Michael Howard",
        "David LeBlanc",
        "John Viega"
      ],
      "title": "24 Deadly Sins of Software Security",
      "publication_year": "2010",
      "publication": "McGraw-Hill"
    }
  ],
  "content_history": {
    "submission": {
      "submission_name": "CLASP",
      "submission_date": "2006-07-19T00:00:00Z"
    },
    "modification": [
      {
        "modification_name": "Eric Dalci",
        "modification_organization": "Cigital",
        "modification_date": "2008-07-01T00:00:00Z",
        "modification_comment": "updated Time_of_Introduction"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2008-09-08T00:00:00Z",
        "modification_comment": "updated Relationships, Other_Notes, Taxonomy_Mappings"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2008-11-24T00:00:00Z",
        "modification_comment": "updated Demonstrative_Examples, Description, Other_Notes, Potential_Mitigations"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2009-03-10T00:00:00Z",
        "modification_comment": "updated Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2009-07-27T00:00:00Z",
        "modification_comment": "updated Demonstrative_Examples"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2011-06-01T00:00:00Z",
        "modification_comment": "updated Common_Consequences, Relationships, Taxonomy_Mappings"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2011-06-27T00:00:00Z",
        "modification_comment": "updated Common_Consequences"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2011-09-13T00:00:00Z",
        "modification_comment": "updated Relationships, Taxonomy_Mappings"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2012-05-11T00:00:00Z",
        "modification_comment": "updated Common_Consequences, References, Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2014-02-18T00:00:00Z",
        "modification_comment": "updated Related_Attack_Patterns"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2014-07-30T00:00:00Z",
        "modification_comment": "updated Relationships, Taxonomy_Mappings"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2017-11-08T00:00:00Z",
        "modification_comment": "updated Applicable_Platforms, Modes_of_Introduction, Relationships, Taxonomy_Mappings"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2019-01-03T00:00:00Z",
        "modification_comment": "updated Related_Attack_Patterns, Taxonomy_Mappings"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2020-02-24T00:00:00Z",
        "modification_comment": "updated References, Type"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2020-08-20T00:00:00Z",
        "modification_comment": "updated Relationships"
      }
    ],
    "previous_entry_name": [
      {
        "text": "Improper Error Handling",
        "date": "2008-04-11T00:00:00Z"
      }
    ]
  },
  "taxonomy_mappings": [
    {
      "taxonomy_name": "CLASP",
      "entry_name": "Improper error handling"
    },
    {
      "taxonomy_name": "The CERT Oracle Secure Coding Standard for Java (2011)",
      "entry_name": "Do not suppress or ignore checked exceptions",
      "entry_id": "ERR00-J"
    },
    {
      "taxonomy_name": "Software Fault Patterns",
      "entry_name": "Unchecked Status Condition",
      "entry_id": "SFP4"
    }
  ]
}
