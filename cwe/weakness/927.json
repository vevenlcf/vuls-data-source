{
  "id": "927",
  "name": "Use of Implicit Intent for Sensitive Communication",
  "abstraction": "Variant",
  "structure": "Simple",
  "status": "Incomplete",
  "description": "The Android application uses an implicit intent for transmitting sensitive data to other applications.",
  "extended_description": "\n            \u003cxhtml:p\u003eSince an implicit intent does not specify a particular application to receive the data, any application can process the intent by using an Intent Filter for that intent. This can allow untrusted applications to obtain sensitive data. There are two variations on the standard broadcast intent, ordered and sticky.\u003c/xhtml:p\u003e\n            \u003cxhtml:p\u003eOrdered broadcast intents are delivered to a series of registered receivers in order of priority as declared by the Receivers. A malicious receiver can give itself a high priority and cause a denial of service by stopping the broadcast from propagating further down the chain. There is also the possibility of malicious data modification, as a receiver may also alter the data within the Intent before passing it on to the next receiver. The downstream components have no way of asserting that the data has not been altered earlier in the chain.\u003c/xhtml:p\u003e\n            \u003cxhtml:p\u003eSticky broadcast intents remain accessible after the initial broadcast. An old sticky intent will be broadcast again to any new receivers that register for it in the future, greatly increasing the chances of information exposure over time. Also, sticky broadcasts cannot be protected by permissions that may apply to other kinds of intents.\u003c/xhtml:p\u003e\n            \u003cxhtml:p\u003eIn addition, any broadcast intent may include a URI that references data that the receiving component does not normally have the privileges to access. The sender of the intent can include special privileges that grant the receiver read or write access to the specific URI included in the intent. A malicious receiver that intercepts this intent will also gain those privileges and be able to read or write the resource at the specified URI.\u003c/xhtml:p\u003e\n         ",
  "related_weaknesses": [
    {
      "nature": "ChildOf",
      "cweid": "285",
      "view_id": "1000",
      "ordinal": "Primary"
    },
    {
      "nature": "ChildOf",
      "cweid": "668",
      "view_id": "1000"
    }
  ],
  "applicable_platforms": {
    "language": [
      {
        "class": "Language-Independent",
        "prevalence": "Undetermined"
      }
    ],
    "technology": [
      {
        "class": "Mobile",
        "prevalence": "Undetermined"
      }
    ]
  },
  "modes_of_introduction": [
    {
      "phase": "Architecture and Design"
    }
  ],
  "common_consequences": [
    {
      "scope": [
        "Confidentiality"
      ],
      "impact": [
        "Read Application Data"
      ],
      "note": "Other applications, possibly untrusted, can read the data that is offered through the Intent."
    },
    {
      "scope": [
        "Integrity"
      ],
      "impact": [
        "Varies by Context"
      ],
      "note": "The application may handle responses from untrusted applications on the device, which could cause it to perform unexpected or unauthorized actions."
    }
  ],
  "potential_mitigations": [
    {
      "phase": [
        "Implementation"
      ],
      "description": [
        "If the application only requires communication with its own components, then the destination is always known, and an explicit intent could be used."
      ]
    }
  ],
  "demonstrative_examples": [
    {
      "text": "\n               \u003cIntro_Text\u003eThis application wants to create a user account in several trusted applications using one broadcast intent:\u003c/Intro_Text\u003e\n               \u003cExample_Code Nature=\"bad\" Language=\"Java\"\u003e\n                  \u003cxhtml:div\u003eIntent intent = new Intent();\u003cxhtml:br/\u003eintent.setAction(\"com.example.CreateUser\");\u003cxhtml:br/\u003eintent.putExtra(\"Username\", uname_string);\u003cxhtml:br/\u003eintent.putExtra(\"Password\", pw_string);\u003cxhtml:br/\u003esendBroadcast(intent);\u003c/xhtml:div\u003e\n               \u003c/Example_Code\u003e\n               \u003cBody_Text\u003eThis application assumes only the trusted applications will be listening for the action. A malicious application can register for this action and intercept the user's login information, as below:\u003c/Body_Text\u003e\n               \u003cExample_Code Nature=\"attack\" Language=\"Java\"\u003e\n                  \u003cxhtml:div\u003eIntentFilter filter = new IntentFilter(\"com.example.CreateUser\");\u003cxhtml:br/\u003eMyReceiver receiver = new MyReceiver();\u003cxhtml:br/\u003eregisterReceiver(receiver, filter);\u003c/xhtml:div\u003e\n               \u003c/Example_Code\u003e\n               \u003cBody_Text\u003eWhen a broadcast contains sensitive information, create an allowlist of applications that can receive the action using the application's manifest file, or programmatically send the intent to each individual intended receiver.\u003c/Body_Text\u003e\n            "
    },
    {
      "text": "\n               \u003cIntro_Text\u003eThis application interfaces with a web service that requires a separate user login. It creates a sticky intent, so that future trusted applications that also use the web service will know who the current user is:\u003c/Intro_Text\u003e\n               \u003cExample_Code Nature=\"bad\" Language=\"Java\"\u003e\n                  \u003cxhtml:div\u003eIntent intent = new Intent();\u003cxhtml:br/\u003eintent.setAction(\"com.example.service.UserExists\");\u003cxhtml:br/\u003eintent.putExtra(\"Username\", uname_string);\u003cxhtml:br/\u003esendStickyBroadcast(intent);\u003c/xhtml:div\u003e\n               \u003c/Example_Code\u003e\n               \u003cExample_Code Nature=\"attack\" Language=\"Java\"\u003e\n                  \u003cxhtml:div\u003eIntentFilter filter = new IntentFilter(\"com.example.service.UserExists\");\u003cxhtml:br/\u003eMyReceiver receiver = new MyReceiver();\u003cxhtml:br/\u003eregisterReceiver(receiver, filter);\u003c/xhtml:div\u003e\n               \u003c/Example_Code\u003e\n               \u003cBody_Text\u003eSticky broadcasts can be read by any application at any time, and so should never contain sensitive information such as a username.\u003c/Body_Text\u003e\n            "
    },
    {
      "text": "\n               \u003cIntro_Text\u003eThis application is sending an ordered broadcast, asking other applications to open a URL:\u003c/Intro_Text\u003e\n               \u003cExample_Code Nature=\"bad\" Language=\"Java\"\u003e\n                  \u003cxhtml:div\u003eIntent intent = new Intent();\u003cxhtml:br/\u003eintent.setAction(\"com.example.OpenURL\");\u003cxhtml:br/\u003eintent.putExtra(\"URL_TO_OPEN\", url_string);\u003cxhtml:br/\u003esendOrderedBroadcastAsUser(intent);\u003c/xhtml:div\u003e\n               \u003c/Example_Code\u003e\n               \u003cBody_Text\u003eAny application in the broadcast chain may alter the data within the intent. This malicious application is altering the URL to point to an attack site:\u003c/Body_Text\u003e\n               \u003cExample_Code Nature=\"attack\" Language=\"Java\"\u003e\n                  \u003cxhtml:div\u003epublic class CallReceiver extends BroadcastReceiver {\u003cxhtml:div style=\"margin-left:10px;\"\u003e@Override\u003cxhtml:br/\u003epublic void onReceive(Context context, Intent intent) {\u003cxhtml:div style=\"margin-left:10px;\"\u003eString Url = intent.getStringExtra(Intent.URL_TO_OPEN);\u003cxhtml:br/\u003eattackURL = \"www.example.com/attack?\" + Url;\u003cxhtml:br/\u003esetResultData(attackURL);\u003c/xhtml:div\u003e}\u003c/xhtml:div\u003e}\u003c/xhtml:div\u003e\n               \u003c/Example_Code\u003e\n               \u003cBody_Text\u003eThe final receiving application will then open the attack URL. Where possible, send intents to specific trusted applications instead of using a broadcast chain.\u003c/Body_Text\u003e\n            "
    },
    {
      "demonstrative_example_id": "DX-108",
      "text": "\n               \u003cIntro_Text\u003eThis application sends a special intent with a flag that allows the receiving application to read a data file for backup purposes.\u003c/Intro_Text\u003e\n               \u003cExample_Code Nature=\"bad\" Language=\"Java\"\u003e\n                  \u003cxhtml:div\u003eIntent intent = new Intent();\u003cxhtml:br/\u003eintent.setAction(\"com.example.BackupUserData\");\u003cxhtml:br/\u003eintent.setData(file_uri);\u003cxhtml:br/\u003eintent.addFlags(FLAG_GRANT_READ_URI_PERMISSION);\u003cxhtml:br/\u003esendBroadcast(intent);\u003c/xhtml:div\u003e\n               \u003c/Example_Code\u003e\n               \u003cExample_Code Nature=\"attack\" Language=\"Java\"\u003e\n                  \u003cxhtml:div\u003epublic class CallReceiver extends BroadcastReceiver {\u003cxhtml:div style=\"margin-left:10px;\"\u003e@Override\u003cxhtml:br/\u003epublic void onReceive(Context context, Intent intent) {\u003cxhtml:div style=\"margin-left:10px;\"\u003eUri userData = intent.getData();\u003cxhtml:br/\u003estealUserData(userData);\u003c/xhtml:div\u003e}\u003c/xhtml:div\u003e}\u003c/xhtml:div\u003e\n               \u003c/Example_Code\u003e\n               \u003cBody_Text\u003eAny malicious application can register to receive this intent. Because of the FLAG_GRANT_READ_URI_PERMISSION included with the intent, the malicious receiver code can read the user's data.\u003c/Body_Text\u003e\n            "
    }
  ],
  "references": [
    {
      "section": "3.2.1",
      "reference_id": "REF-922",
      "author": [
        "Erika Chin",
        "Adrienne Porter Felt",
        "Kate Greenwood",
        "David Wagner"
      ],
      "title": "Analyzing Inter-Application Communication in Android",
      "url": "http://www.eecs.berkeley.edu/~daw/papers/intents-mobisys11.pdf"
    },
    {
      "reference_id": "REF-923",
      "author": [
        "Android Open Source Project"
      ],
      "title": "Security Tips",
      "url": "http://developer.android.com/training/articles/security-tips.html#ContentProviders",
      "publication_year": "2013",
      "publication_month": "--07",
      "publication_day": "---16"
    }
  ],
  "content_history": {
    "submission": {
      "submission_name": "CWE Content Team",
      "submission_organization": "MITRE",
      "submission_date": "2013-07-09T00:00:00Z"
    },
    "modification": [
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2014-02-18T00:00:00Z",
        "modification_comment": "updated Demonstrative_Examples, Description, References"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2017-11-08T00:00:00Z",
        "modification_comment": "updated References"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2020-02-24T00:00:00Z",
        "modification_comment": "updated Applicable_Platforms, Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2020-06-25T00:00:00Z",
        "modification_comment": "updated Demonstrative_Examples"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2021-03-15T00:00:00Z",
        "modification_comment": "updated Maintenance_Notes"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2021-10-28T00:00:00Z",
        "modification_comment": "updated Relationships"
      }
    ]
  }
}
