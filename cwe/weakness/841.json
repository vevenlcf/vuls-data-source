{
  "id": "841",
  "name": "Improper Enforcement of Behavioral Workflow",
  "abstraction": "Base",
  "structure": "Simple",
  "status": "Incomplete",
  "description": "The software supports a session in which more than one behavior must be performed by an actor, but it does not properly ensure that the actor performs the behaviors in the required sequence.",
  "extended_description": "\n            \u003cxhtml:p\u003eBy performing actions in an unexpected order, or by omitting steps, an attacker could manipulate the business logic of the software or cause it to enter an invalid state. In some cases, this can also expose resultant weaknesses.\u003c/xhtml:p\u003e\n            \u003cxhtml:p\u003eFor example, a file-sharing protocol might require that an actor perform separate steps to provide a username, then a password, before being able to transfer files. If the file-sharing server accepts a password command followed by a transfer command, without any username being provided, the software might still perform the transfer.\u003c/xhtml:p\u003e\n            \u003cxhtml:p\u003eNote that this is different than CWE-696, which focuses on when the software performs actions in the wrong sequence; this entry is closely related, but it is focused on ensuring that the actor performs actions in the correct sequence.\u003c/xhtml:p\u003e\n            \u003cxhtml:p\u003eWorkflow-related behaviors include:\u003c/xhtml:p\u003e\n            \u003cxhtml:div style=\"margin-left:10px;\"\u003e\n               \u003cxhtml:ul\u003e\n                  \u003cxhtml:li\u003eSteps are performed in the expected order.\u003c/xhtml:li\u003e\n                  \u003cxhtml:li\u003eRequired steps are not omitted.\u003c/xhtml:li\u003e\n                  \u003cxhtml:li\u003eSteps are not interrupted.\u003c/xhtml:li\u003e\n                  \u003cxhtml:li\u003eSteps are performed in a timely fashion.\u003c/xhtml:li\u003e\n               \u003c/xhtml:ul\u003e\n            \u003c/xhtml:div\u003e\n         ",
  "related_weaknesses": [
    {
      "nature": "ChildOf",
      "cweid": "691",
      "view_id": "1000",
      "ordinal": "Primary"
    }
  ],
  "applicable_platforms": {},
  "modes_of_introduction": [
    {
      "phase": "Implementation",
      "note": [
        "REALIZATION: This weakness is caused during implementation of an architectural security tactic."
      ]
    }
  ],
  "common_consequences": [
    {
      "scope": [
        "Other"
      ],
      "impact": [
        "Alter Execution Logic"
      ],
      "note": "An attacker could cause the software to skip critical steps or perform them in the wrong order, bypassing its intended business logic. This can sometimes have security implications."
    }
  ],
  "demonstrative_examples": [
    {
      "text": "\n               \u003cIntro_Text\u003eThis code is part of an FTP server and deals with various commands that could be sent by a user. It is intended that a user must successfully login before performing any other action such as retrieving or listing files.\u003c/Intro_Text\u003e\n               \u003cExample_Code Nature=\"bad\" Language=\"Python\"\u003e\n                  \u003cxhtml:div\u003edef dispatchCommand(command, user, args):\u003cxhtml:div style=\"margin-left:10px;\"\u003e\n                        \u003cxhtml:div\u003eif command == 'Login':\u003cxhtml:div style=\"margin-left:10px;\"\u003eloginUser(args)\u003cxhtml:br/\u003ereturn\u003c/xhtml:div\u003e\n                           \u003cxhtml:br/\u003e\n                           \u003cxhtml:br/\u003e\n                           \u003cxhtml:i\u003e# user has requested a file\u003c/xhtml:i\u003e\n                           \u003cxhtml:br/\u003eif command == 'Retrieve_file':\n\t\t\t   \u003cxhtml:div style=\"margin-left:10px;\"\u003e\n\t\t\t   if authenticated(user) and ownsFile(user,args):\n\t\t\t   \u003cxhtml:br/\u003e\n\t\t\t   \u003cxhtml:div style=\"margin-left:10px;\"\u003esendFile(args)\u003cxhtml:br/\u003ereturn\u003c/xhtml:div\u003e\n\t\t\t   \u003c/xhtml:div\u003e\n                           \u003cxhtml:br/\u003eif command == 'List_files':\u003cxhtml:div style=\"margin-left:10px;\"\u003elistFiles(args)\u003cxhtml:br/\u003ereturn\u003c/xhtml:div\u003e\n                           \u003cxhtml:br/\u003e\n                           \u003cxhtml:i\u003e...\u003c/xhtml:i\u003e\n                           \u003cxhtml:br/\u003e\n                        \u003c/xhtml:div\u003e\n                     \u003c/xhtml:div\u003e\n                  \u003c/xhtml:div\u003e\n               \u003c/Example_Code\u003e\n               \u003cBody_Text\u003eThe server correctly avoids sending files to a user that isn't logged in and doesn't own the file. However, the server will incorrectly list the files in any directory without confirming the command came from an authenticated user, and that the user is authorized to see the directory's contents.\u003c/Body_Text\u003e\n               \u003cBody_Text\u003eHere is a fixed version of the above example:\u003c/Body_Text\u003e\n               \u003cExample_Code Nature=\"good\" Language=\"Python\"\u003e\n                  \u003cxhtml:div\u003edef dispatchCommand(command, user, args):\u003cxhtml:div style=\"margin-left:10px;\"\u003e\n                        \u003cxhtml:div\u003e\n                           \u003cxhtml:br/\u003e\n                           \u003cxhtml:i\u003e...\u003c/xhtml:i\u003e\n                           \u003cxhtml:br/\u003eif command == 'List_files':\u003cxhtml:div style=\"margin-left:10px;\"\u003eif authenticated(user) and ownsDirectory(user,args):\u003cxhtml:div style=\"margin-left:10px;\"\u003elistFiles(args)\u003cxhtml:br/\u003ereturn\u003c/xhtml:div\u003e\n                           \u003c/xhtml:div\u003e\n                           \u003cxhtml:br/\u003e\n                           \u003cxhtml:i\u003e...\u003c/xhtml:i\u003e\n                           \u003cxhtml:br/\u003e\n                        \u003c/xhtml:div\u003e\n                     \u003c/xhtml:div\u003e\n                  \u003c/xhtml:div\u003e\n               \u003c/Example_Code\u003e\n            "
    }
  ],
  "observed_examples": [
    {
      "reference": "CVE-2011-0348",
      "description": "Bypass of access/billing restrictions by sending traffic to an unrestricted destination before sending to a restricted destination.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-0348"
    },
    {
      "reference": "CVE-2007-3012",
      "description": "Attacker can access portions of a restricted page by canceling out of a dialog.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-3012"
    },
    {
      "reference": "CVE-2009-5056",
      "description": "Ticket-tracking system does not enforce a permission setting.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-5056"
    },
    {
      "reference": "CVE-2004-2164",
      "description": "Shopping cart does not close a database connection when user restores a previous order, leading to connection exhaustion.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-2164"
    },
    {
      "reference": "CVE-2003-0777",
      "description": "Chain: product does not properly handle dropped connections, leading to missing NULL terminator (CWE-170) and segmentation fault.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2003-0777"
    },
    {
      "reference": "CVE-2005-3327",
      "description": "Chain: Authentication bypass by skipping the first startup step as required by the protocol.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3327"
    },
    {
      "reference": "CVE-2004-0829",
      "description": "Chain: File server crashes when sent a \"find next\" request without an initial \"find first.\"",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0829"
    },
    {
      "reference": "CVE-2010-2620",
      "description": "FTP server allows remote attackers to bypass authentication by sending (1) LIST, (2) RETR, (3) STOR, or other commands without performing the required login steps first.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-2620"
    },
    {
      "reference": "CVE-2005-3296",
      "description": "FTP server allows remote attackers to list arbitrary directories as root by running the LIST command before logging in.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3296"
    }
  ],
  "references": [
    {
      "reference_id": "REF-795",
      "author": [
        "Jeremiah Grossman"
      ],
      "title": "Business Logic Flaws and Yahoo Games",
      "url": "http://jeremiahgrossman.blogspot.com/2006/12/business-logic-flaws.html",
      "publication_year": "2006",
      "publication_month": "--12",
      "publication_day": "---08"
    },
    {
      "reference_id": "REF-796",
      "author": [
        "Jeremiah Grossman"
      ],
      "title": "Seven Business Logic Flaws That Put Your Website At Risk",
      "url": "http://www.whitehatsec.com/home/assets/WP_bizlogic092407.pdf",
      "publication_year": "2007",
      "publication_month": "--10"
    },
    {
      "reference_id": "REF-797",
      "author": [
        "WhiteHat Security"
      ],
      "title": "Business Logic Flaws",
      "url": "http://www.whitehatsec.com/home/solutions/BL_auction.html"
    },
    {
      "reference_id": "REF-806",
      "author": [
        "WASC"
      ],
      "title": "Insufficient Process Validation",
      "url": "http://projects.webappsec.org/w/page/13246943/Insufficient-Process-Validation"
    },
    {
      "reference_id": "REF-799",
      "author": [
        "Rafal Los",
        "Prajakta Jagdale"
      ],
      "title": "Defying Logic: Theory, Design, and Implementation of Complex Systems for Testing Application Logic",
      "url": "http://www.slideshare.net/RafalLos/defying-logic-business-logic-testing-with-automation",
      "publication_year": "2011"
    },
    {
      "reference_id": "REF-667",
      "author": [
        "Rafal Los"
      ],
      "title": "Real-Life Example of a 'Business Logic Defect' (Screen Shots!)",
      "url": "http://h30501.www3.hp.com/t5/Following-the-White-Rabbit-A/Real-Life-Example-of-a-Business-Logic-Defect-Screen-Shots/ba-p/22581",
      "publication_year": "2011"
    },
    {
      "reference_id": "REF-801",
      "author": [
        "Viktoria Felmetsger",
        "Ludovico Cavedon",
        "Christopher Kruegel",
        "Giovanni Vigna"
      ],
      "title": "Toward Automated Detection of Logic Vulnerabilities in Web Applications",
      "url": "http://www.usenix.org/events/sec10/tech/full_papers/Felmetsger.pdf",
      "publication_year": "2010",
      "publication_month": "--08",
      "publication": "USENIX Security Symposium 2010"
    },
    {
      "section": "pages 29 - 41",
      "reference_id": "REF-802",
      "author": [
        "Faisal Nabi"
      ],
      "title": "Designing a Framework Method for Secure Business Application Logic Integrity in e-Commerce Systems",
      "url": "http://ijns.femto.com.tw/contents/ijns-v12-n1/ijns-2011-v12-n1-p29-41.pdf",
      "publication_year": "2011",
      "publication": "International Journal of Network Security, Vol.12, No.1"
    }
  ],
  "content_history": {
    "submission": {
      "submission_name": "CWE Content Team",
      "submission_organization": "MITRE",
      "submission_date": "2011-03-24T00:00:00Z"
    },
    "modification": [
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2011-06-01T00:00:00Z",
        "modification_comment": "updated Common_Consequences"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2011-06-27T00:00:00Z",
        "modification_comment": "updated Common_Consequences, Observed_Examples, Related_Attack_Patterns, Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2012-05-11T00:00:00Z",
        "modification_comment": "updated Demonstrative_Examples, Observed_Examples, Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2017-11-08T00:00:00Z",
        "modification_comment": "updated Modes_of_Introduction, References, Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2020-02-24T00:00:00Z",
        "modification_comment": "updated Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2021-10-28T00:00:00Z",
        "modification_comment": "updated Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2022-04-28T00:00:00Z",
        "modification_comment": "updated Demonstrative_Examples"
      }
    ],
    "contribution": [
      {
        "type": "Feedback",
        "contribution_name": "Anonymous External Contributor",
        "contribution_date": "2021-11-11T00:00:00Z",
        "contribution_comment": "Reported an error in a demonstrative example"
      }
    ]
  },
  "taxonomy_mappings": [
    {
      "taxonomy_name": "WASC",
      "entry_name": "Insufficient Process Validation",
      "entry_id": "40"
    }
  ],
  "notes": [
    {
      "type": "Research Gap",
      "text": "\n               \u003cxhtml:p\u003eThis weakness is typically associated with business logic flaws, except when it produces resultant weaknesses.\u003c/xhtml:p\u003e\n               \u003cxhtml:p\u003eThe classification of business logic flaws has been under-studied, although exploitation of business flaws frequently happens in real-world systems, and many applied vulnerability researchers investigate them. The greatest focus is in web applications. There is debate within the community about whether these problems represent particularly new concepts, or if they are variations of well-known principles.\u003c/xhtml:p\u003e\n               \u003cxhtml:p\u003eMany business logic flaws appear to be oriented toward business processes, application flows, and sequences of behaviors, which are not as well-represented in CWE as weaknesses related to input validation, memory management, etc.\u003c/xhtml:p\u003e\n            "
    }
  ]
}
