{
  "id": "1267",
  "name": "Policy Uses Obsolete Encoding",
  "abstraction": "Base",
  "structure": "Simple",
  "status": "Draft",
  "description": "The product uses an obsolete encoding mechanism to implement access controls.",
  "extended_description": "\n    \u003cxhtml:p\u003eWithin a System-On-a-Chip (SoC), various circuits and hardware engines generate transactions for the purpose of accessing (read/write) assets or performing various actions (e.g., reset, fetch, compute, etc.). Among various types of message information, a typical transaction is comprised of source identity (identifying the originator of the transaction) and a destination identity (routing the transaction to the respective entity). Sometimes the transactions are qualified with a Security Token. This Security Token helps the destination agent decide on the set of allowed actions (e.g., access to an asset for reads and writes). A policy encoder is used to map the bus transactions to Security Tokens that in turn are used as access-controls/protection mechanisms. A common weakness involves using an encoding which is no longer trusted, i.e., an obsolete encoding.\u003c/xhtml:p\u003e\n   ",
  "related_weaknesses": [
    {
      "nature": "ChildOf",
      "cweid": "284",
      "view_id": "1000",
      "ordinal": "Primary"
    }
  ],
  "applicable_platforms": {
    "language": [
      {
        "class": "Language-Independent",
        "prevalence": "Undetermined"
      }
    ],
    "technology": [
      {
        "class": "Technology-Independent",
        "prevalence": "Undetermined"
      }
    ],
    "operating_system": [
      {
        "class": "OS-Independent",
        "prevalence": "Undetermined"
      }
    ],
    "architecture": [
      {
        "class": "Architecture-Independent",
        "prevalence": "Undetermined"
      }
    ]
  },
  "modes_of_introduction": [
    {
      "phase": "Architecture and Design"
    },
    {
      "phase": "Implementation"
    }
  ],
  "common_consequences": [
    {
      "scope": [
        "Confidentiality",
        "Integrity",
        "Availability",
        "Access Control"
      ],
      "impact": [
        "Modify Memory",
        "Read Memory",
        "Modify Files or Directories",
        "Read Files or Directories",
        "DoS: Resource Consumption (Other)",
        "Execute Unauthorized Code or Commands",
        "Gain Privileges or Assume Identity",
        "Bypass Protection Mechanism",
        "Reduce Reliability"
      ],
      "likelihood": "High"
    }
  ],
  "potential_mitigations": [
    {
      "phase": [
        "Architecture and Design",
        "Implementation"
      ],
      "description": [
        "\n      \u003cxhtml:p\u003eSecurity Token Decoders should be reviewed for design inconsistency and common weaknesses.\u003c/xhtml:p\u003e\n      \u003cxhtml:p\u003eAccess and programming flows should be tested in both pre-silicon and post-silicon testing.\u003c/xhtml:p\u003e\n     "
      ],
      "effectiveness": "High"
    }
  ],
  "demonstrative_examples": [
    {
      "text": "\n      \u003cIntro_Text\u003e\n       \u003cxhtml:p\u003eFor example, consider a system that has four bus masters. The table below provides bus masters, their Security Tokens, and trust assumptions.\u003c/xhtml:p\u003e\n       \u003cxhtml:table\u003e\n        \u003cxhtml:tr\u003e\n         \u003cxhtml:th\u003eBus Master\u003c/xhtml:th\u003e\n         \u003cxhtml:th\u003eSecurity Token Decoding\u003c/xhtml:th\u003e\n         \u003cxhtml:th\u003eTrust Assumptions\u003c/xhtml:th\u003e\n        \u003c/xhtml:tr\u003e\n        \u003cxhtml:tr\u003e\n         \u003cxhtml:td\u003eMaster_0\u003c/xhtml:td\u003e\n         \u003cxhtml:td\u003e\"00\"\u003c/xhtml:td\u003e\n         \u003cxhtml:td\u003eUntrusted\u003c/xhtml:td\u003e\n        \u003c/xhtml:tr\u003e\n        \u003cxhtml:tr\u003e\n         \u003cxhtml:td\u003eMaster_1\u003c/xhtml:td\u003e\n         \u003cxhtml:td\u003e\"01\"\u003c/xhtml:td\u003e\n         \u003cxhtml:td\u003eTrusted\u003c/xhtml:td\u003e\n        \u003c/xhtml:tr\u003e\n        \u003cxhtml:tr\u003e\n         \u003cxhtml:td\u003eMaster_2\u003c/xhtml:td\u003e\n         \u003cxhtml:td\u003e\"10\"\u003c/xhtml:td\u003e\n         \u003cxhtml:td\u003eUntrusted\u003c/xhtml:td\u003e\n        \u003c/xhtml:tr\u003e\n        \u003cxhtml:tr\u003e\n         \u003cxhtml:td\u003eMaster_3\u003c/xhtml:td\u003e\n         \u003cxhtml:td\u003e\"11\"\u003c/xhtml:td\u003e\n         \u003cxhtml:td\u003eUntrusted\u003c/xhtml:td\u003e\n        \u003c/xhtml:tr\u003e\n       \u003c/xhtml:table\u003e\n       \u003cxhtml:p\u003eThe policy encoding is to be defined such that Security Token will be used in implemented access-controls. The bits in the bus transaction that contain Security-Token information are Bus_transaction [15:11]. The assets are the AES-Key registers for encryption or decryption. The key of 128 bits is implemented as a set of four, 32-bit registers.\u003c/xhtml:p\u003e\n       \u003cxhtml:table\u003e\n        \u003cxhtml:tr\u003e\n         \u003cxhtml:th\u003eRegister\u003c/xhtml:th\u003e\n         \u003cxhtml:th\u003eField description\u003c/xhtml:th\u003e\n        \u003c/xhtml:tr\u003e\n        \u003cxhtml:tr\u003e\n         \u003cxhtml:td\u003eAES_ENC_DEC_KEY_0\u003c/xhtml:td\u003e\n         \u003cxhtml:td\u003eAES key [0:31] for encryption or decryption, Default 0x00000000\u003c/xhtml:td\u003e\n        \u003c/xhtml:tr\u003e\n        \u003cxhtml:tr\u003e\n         \u003cxhtml:td\u003eAES_ENC_DEC_KEY_1\u003c/xhtml:td\u003e\n         \u003cxhtml:td\u003eAES key [32:63] for encryption or decryption, Default 0x00000000\u003c/xhtml:td\u003e\n        \u003c/xhtml:tr\u003e\n        \u003cxhtml:tr\u003e\n         \u003cxhtml:td\u003eAES_ENC_DEC_KEY_2\u003c/xhtml:td\u003e\n         \u003cxhtml:td\u003eAES key [64:95] for encryption or decryption, Default 0x00000000\u003c/xhtml:td\u003e\n        \u003c/xhtml:tr\u003e\n        \u003cxhtml:tr\u003e\n         \u003cxhtml:td\u003eAES_ENC_DEC_KEY_4\u003c/xhtml:td\u003e\n         \u003cxhtml:td\u003eAES key [96:127] for encryption or decryption, Default 0x00000000\u003c/xhtml:td\u003e\n        \u003c/xhtml:tr\u003e\n       \u003c/xhtml:table\u003e\n       \u003cxhtml:p\u003eBelow is an example of a policy encoding scheme inherited from a previous project where all \"ODD\" numbered Security Tokens are trusted.\u003c/xhtml:p\u003e\n      \u003c/Intro_Text\u003e\n      \u003cExample_Code Nature=\"bad\"\u003e\n        \u003cxhtml:div\u003eIf (Bus_transaction[14] == \"1\")\u003cxhtml:div style=\"margin-left:10px\"\u003eTrusted = \"1\"\u003c/xhtml:div\u003eElse\u003cxhtml:div style=\"margin-left:10px\"\u003eTrusted = \"0\"\u003c/xhtml:div\u003e\u003c/xhtml:div\u003e\n        \u003cxhtml:div\u003eIf (trusted)\u003cxhtml:div style=\"margin-left:10px\"\u003e  Allow access to AES-Key registers\u003c/xhtml:div\u003eElse\u003cxhtml:div style=\"margin-left:10px\"\u003eDeny access to AES-Key registers\u003c/xhtml:div\u003e\u003c/xhtml:div\u003e\n      \u003c/Example_Code\u003e\n\t\t  \u003cBody_Text\u003e\u003cxhtml:p\u003eThe inherited policy encoding is obsolete and does not work for the new system where an untrusted bus master with an odd Security Token exists in the system, i.e., Master_3 whose Security Token is \"11\". Based on the old policy, the untrusted bus master (Master_3) has access to the AES-Key registers. To resolve this, a register AES_KEY_ACCESS_POLICY can be defined to provide necessary, access controls:\u003c/xhtml:p\u003e\u003c/Body_Text\u003e\n\t\t  \u003cBody_Text\u003e\n\t\t    \u003cxhtml:p\u003eNew Policy: \u003c/xhtml:p\u003e\n\t\t    \u003cxhtml:table\u003e\n\t\t      \u003cxhtml:tr\u003e\n\t\t        \u003cxhtml:td\u003eAES_KEY_ACCESS_POLICY\u003c/xhtml:td\u003e\n\t\t        \u003cxhtml:td\u003e[31:0] Default 0x00000002 â€“ agent with Security Token \"1\" has access to AES_ENC_DEC_KEY_0 through AES_ENC_DEC_KEY_4 registers\u003c/xhtml:td\u003e\n\t\t      \u003c/xhtml:tr\u003e\n\t\t    \u003c/xhtml:table\u003e\n\t\t    \u003cxhtml:p\u003eThe AES_KEY_ACCESS_POLICY register defines which agents with a Security Token in the transaction can access the AES-key registers. Each bit in this 32-bit register defines a Security Token. There could be a maximum of 32 security Tokens that are allowed access to the AES-key registers. The number of the bit when set (i.e., \"1\") allows respective action from an agent whose identity matches the number of the bit and, if \"0\" (i.e., Clear), disallows the respective action to that corresponding agent. Thus, any bus master with Security Token \"01\" is allowed access to the AES-Key registers. Below is the Pseudo Code for policy encoding:\u003c/xhtml:p\u003e\n\t\t  \u003c/Body_Text\u003e\n      \u003cExample_Code Nature=\"good\"\u003e\n        \u003cxhtml:div\u003eSecurity_Token[4:0] = Bus_transaction[15:11]\u003c/xhtml:div\u003e\n        \u003cxhtml:div\u003eIf (AES_KEY_ACCESS_POLICY[Security_Token] == \"1\")\u003cxhtml:div style=\"margin-left:10px;\"\u003eAllow access to AES-Key registers\u003c/xhtml:div\u003eElse\u003cxhtml:div style=\"margin-left:10px;\"\u003eDeny access to AES-Key registers\u003c/xhtml:div\u003e\u003c/xhtml:div\u003e\n      \u003c/Example_Code\u003e\n\t\t"
    }
  ],
  "references": [
    {
      "reference_id": "REF-1093",
      "author": [
        "Brandon Hill"
      ],
      "title": "Huge Intel CPU Bug Allegedly Causes Kernel Memory Vulnerability With Up To 30% Performance Hit In Windows And Linux",
      "url": "https://hothardware.com/news/intel-cpu-bug-kernel-memory-isolation-linux-windows-macos",
      "publication_year": "2018",
      "publication_month": "--01",
      "publication_day": "---02"
    }
  ],
  "content_history": {
    "submission": {
      "submission_name": "Arun Kanuparthi, Hareesh Khattri, Parbati Kumar Manna, Narasimha Kumar V Mangipudi",
      "submission_organization": "Intel Corporation",
      "submission_date": "2020-04-18T00:00:00Z"
    },
    "modification": [
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2020-08-20T00:00:00Z",
        "modification_comment": "updated Applicable_Platforms, Demonstrative_Examples, Description, Modes_of_Introduction, Potential_Mitigations"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2021-07-20T00:00:00Z",
        "modification_comment": "updated Related_Attack_Patterns"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2022-04-28T00:00:00Z",
        "modification_comment": "updated Related_Attack_Patterns"
      }
    ]
  },
  "related_attack_patterns": [
    "121",
    "681"
  ]
}
