{
  "id": "312",
  "name": "Cleartext Storage of Sensitive Information",
  "abstraction": "Base",
  "structure": "Simple",
  "status": "Draft",
  "description": "The application stores sensitive information in cleartext within a resource that might be accessible to another control sphere.",
  "extended_description": "Because the information is stored in cleartext, attackers could potentially read it. Even if the information is encoded in a way that is not human-readable, certain techniques could determine which encoding is being used, then decode the information.",
  "related_weaknesses": [
    {
      "nature": "ChildOf",
      "cweid": "311",
      "view_id": "1000",
      "ordinal": "Primary"
    },
    {
      "nature": "ChildOf",
      "cweid": "311",
      "view_id": "1003",
      "ordinal": "Primary"
    },
    {
      "nature": "ChildOf",
      "cweid": "922",
      "view_id": "1000"
    }
  ],
  "applicable_platforms": {
    "language": [
      {
        "class": "Language-Independent",
        "prevalence": "Undetermined"
      }
    ],
    "technology": [
      {
        "class": "Mobile",
        "prevalence": "Undetermined"
      }
    ]
  },
  "modes_of_introduction": [
    {
      "phase": "Architecture and Design",
      "note": [
        "OMISSION: This weakness is caused by missing a security tactic during the architecture and design phase."
      ]
    }
  ],
  "common_consequences": [
    {
      "scope": [
        "Confidentiality"
      ],
      "impact": [
        "Read Application Data"
      ],
      "note": "An attacker with access to the system could read sensitive information stored in cleartext."
    }
  ],
  "demonstrative_examples": [
    {
      "demonstrative_example_id": "DX-44",
      "text": "\n               \u003cIntro_Text\u003eThe following code excerpt stores a plaintext user account ID in a browser cookie.\u003c/Intro_Text\u003e\n               \u003cExample_Code Nature=\"bad\" Language=\"Java\"\u003e\n                  \u003cxhtml:div\u003eresponse.addCookie( new Cookie(\"userAccountID\", acctID);\u003c/xhtml:div\u003e\n               \u003c/Example_Code\u003e\n               \u003cBody_Text\u003eBecause the account ID is in plaintext, the user's account information is exposed if their computer is compromised by an attacker.\u003c/Body_Text\u003e\n            "
    },
    {
      "demonstrative_example_id": "DX-40",
      "text": "\n               \u003cIntro_Text\u003eThis code writes a user's login information to a cookie so the user does not have to login again later.\u003c/Intro_Text\u003e\n               \u003cExample_Code Nature=\"bad\" Language=\"PHP\"\u003e\n                  \u003cxhtml:div\u003efunction persistLogin($username, $password){\u003cxhtml:div style=\"margin-left:10px;\"\u003e$data = array(\"username\" =\u0026gt; $username, \"password\"=\u0026gt; $password);\u003cxhtml:br/\u003esetcookie (\"userdata\", $data);\u003c/xhtml:div\u003e}\u003c/xhtml:div\u003e\n               \u003c/Example_Code\u003e\n               \u003cBody_Text\u003eThe code stores the user's username and password in plaintext in a cookie on the user's machine. This exposes the user's login information if their computer is compromised by an attacker. Even if the user's machine is not compromised, this weakness combined with cross-site scripting (CWE-79) could allow an attacker to remotely copy the cookie.\u003c/Body_Text\u003e\n               \u003cBody_Text\u003eAlso note this example code also exhibits Plaintext Storage in a Cookie (CWE-315).\u003c/Body_Text\u003e\n            "
    },
    {
      "demonstrative_example_id": "DX-41",
      "text": "\n               \u003cIntro_Text\u003eThe following code attempts to establish a connection, read in a password, then store it to a buffer.\u003c/Intro_Text\u003e\n               \u003cExample_Code Nature=\"bad\" Language=\"C\"\u003e\n                  \u003cxhtml:div\u003eserver.sin_family = AF_INET; hp = gethostbyname(argv[1]);\u003cxhtml:br/\u003eif (hp==NULL) error(\"Unknown host\");\u003cxhtml:br/\u003ememcpy( (char *)\u0026amp;server.sin_addr,(char *)hp-\u0026gt;h_addr,hp-\u0026gt;h_length);\u003cxhtml:br/\u003eif (argc \u0026lt; 3) port = 80;\u003cxhtml:br/\u003eelse port = (unsigned short)atoi(argv[3]);\u003cxhtml:br/\u003eserver.sin_port = htons(port);\u003cxhtml:br/\u003eif (connect(sock, (struct sockaddr *)\u0026amp;server, sizeof server) \u0026lt; 0) error(\"Connecting\");\u003cxhtml:br/\u003e...\u003cxhtml:br/\u003ewhile ((n=read(sock,buffer,BUFSIZE-1))!=-1) {\u003cxhtml:div style=\"margin-left:10px;\"\u003e\n                        \u003cxhtml:div\u003e\n                           \u003cxhtml:br/\u003ewrite(dfd,password_buffer,n);\u003cxhtml:br/\u003e...\u003cxhtml:br/\u003e\n                        \u003c/xhtml:div\u003e\n                     \u003c/xhtml:div\u003e\n                  \u003c/xhtml:div\u003e\n               \u003c/Example_Code\u003e\n               \u003cBody_Text\u003eWhile successful, the program does not encrypt the data before writing it to a buffer, possibly exposing it to unauthorized actors.\u003c/Body_Text\u003e\n            "
    },
    {
      "demonstrative_example_id": "DX-43",
      "text": "\n               \u003cIntro_Text\u003eThe following examples show a portion of properties and configuration files for Java and ASP.NET applications. The files include username and password information but they are stored in cleartext.\u003c/Intro_Text\u003e\n               \u003cBody_Text\u003eThis Java example shows a properties file with a cleartext username / password pair.\u003c/Body_Text\u003e\n               \u003cExample_Code Nature=\"bad\" Language=\"Java\"\u003e\n                  \u003cxhtml:div\u003e\n                     \u003cxhtml:br/\u003e\n                     \u003cxhtml:i\u003e# Java Web App ResourceBundle properties file\u003c/xhtml:i\u003e\n                     \u003cxhtml:br/\u003e...\u003cxhtml:br/\u003ewebapp.ldap.username=secretUsername\u003cxhtml:br/\u003ewebapp.ldap.password=secretPassword\u003cxhtml:br/\u003e...\u003c/xhtml:div\u003e\n               \u003c/Example_Code\u003e\n               \u003cBody_Text\u003eThe following example shows a portion of a configuration file for an ASP.Net application. This configuration file includes username and password information for a connection to a database but the pair is stored in cleartext.\u003c/Body_Text\u003e\n               \u003cExample_Code Nature=\"bad\" Language=\"ASP.NET\"\u003e\n                  \u003cxhtml:div\u003e...\u003cxhtml:br/\u003e\u0026lt;connectionStrings\u0026gt;\u003cxhtml:div style=\"margin-left:10px;\"\u003e\u0026lt;add name=\"ud_DEV\" connectionString=\"connectDB=uDB; uid=db2admin; pwd=password; dbalias=uDB;\" providerName=\"System.Data.Odbc\" /\u0026gt;\u003c/xhtml:div\u003e\u0026lt;/connectionStrings\u0026gt;\u003cxhtml:br/\u003e...\u003c/xhtml:div\u003e\n               \u003c/Example_Code\u003e\n               \u003cBody_Text\u003eUsername and password information should not be included in a configuration file or a properties file in cleartext as this will allow anyone who can read the file access to the resource. If possible, encrypt this information.\u003c/Body_Text\u003e\n            "
    }
  ],
  "observed_examples": [
    {
      "reference": "CVE-2009-2272",
      "description": "password and username stored in cleartext in a cookie",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-2272"
    },
    {
      "reference": "CVE-2009-1466",
      "description": "password stored in cleartext in a file with insecure permissions",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-1466"
    },
    {
      "reference": "CVE-2009-0152",
      "description": "chat program disables SSL in some circumstances even when the user says to use SSL.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0152"
    },
    {
      "reference": "CVE-2009-1603",
      "description": "Chain: product uses an incorrect public exponent when generating an RSA key, which effectively disables the encryption",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-1603"
    },
    {
      "reference": "CVE-2009-0964",
      "description": "storage of unencrypted passwords in a database",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0964"
    },
    {
      "reference": "CVE-2008-6157",
      "description": "storage of unencrypted passwords in a database",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-6157"
    },
    {
      "reference": "CVE-2008-6828",
      "description": "product stores a password in cleartext in memory",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-6828"
    },
    {
      "reference": "CVE-2008-1567",
      "description": "storage of a secret key in cleartext in a temporary file",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-1567"
    },
    {
      "reference": "CVE-2008-0174",
      "description": "SCADA product uses HTTP Basic Authentication, which is not encrypted",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-0174"
    },
    {
      "reference": "CVE-2007-5778",
      "description": "login credentials stored unencrypted in a registry key",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-5778"
    },
    {
      "reference": "CVE-2001-1481",
      "description": "Plaintext credentials in world-readable file.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-1481"
    },
    {
      "reference": "CVE-2005-1828",
      "description": "Password in cleartext in config file.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-1828"
    },
    {
      "reference": "CVE-2005-2209",
      "description": "Password in cleartext in config file.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-2209"
    },
    {
      "reference": "CVE-2002-1696",
      "description": "Decrypted copy of a message written to disk given a combination of options and when user replies to an encrypted message.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-1696"
    },
    {
      "reference": "CVE-2004-2397",
      "description": "Plaintext storage of private key and passphrase in log file when user imports the key.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-2397"
    },
    {
      "reference": "CVE-2002-1800",
      "description": "Admin password in plaintext in a cookie.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-1800"
    },
    {
      "reference": "CVE-2001-1537",
      "description": "Default configuration has cleartext usernames/passwords in cookie.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-1537"
    },
    {
      "reference": "CVE-2001-1536",
      "description": "Usernames/passwords in cleartext in cookies.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-1536"
    },
    {
      "reference": "CVE-2005-2160",
      "description": "Authentication information stored in cleartext in a cookie.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-2160"
    }
  ],
  "references": [
    {
      "section": "Chapter 9, \"Protecting Secret Data\" Page 299",
      "reference_id": "REF-7",
      "author": [
        "Michael Howard",
        "David LeBlanc"
      ],
      "title": "Writing Secure Code",
      "url": "https://www.microsoftpressstore.com/store/writing-secure-code-9780735617223",
      "publication_year": "2002",
      "publication_month": "--12",
      "publication_day": "---04",
      "publisher": "Microsoft Press",
      "edition": "2nd Edition"
    },
    {
      "section": "Chapter 2, \"Common Vulnerabilities of Encryption\", Page 43",
      "reference_id": "REF-62",
      "author": [
        "Mark Dowd",
        "John McDonald",
        "Justin Schuh"
      ],
      "title": "The Art of Software Security Assessment",
      "publication_year": "2006",
      "publisher": "Addison Wesley",
      "edition": "1st Edition"
    },
    {
      "reference_id": "REF-172",
      "author": [
        "Chris Wysopal"
      ],
      "title": "Mobile App Top 10 List",
      "url": "http://www.veracode.com/blog/2010/12/mobile-app-top-10-list/",
      "publication_year": "2010",
      "publication_month": "--12",
      "publication_day": "---13"
    }
  ],
  "content_history": {
    "submission": {
      "submission_name": "PLOVER",
      "submission_date": "2006-07-19T00:00:00Z"
    },
    "modification": [
      {
        "modification_name": "Eric Dalci",
        "modification_organization": "Cigital",
        "modification_date": "2008-07-01T00:00:00Z",
        "modification_comment": "updated Time_of_Introduction"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2008-09-08T00:00:00Z",
        "modification_comment": "updated Relationships, Taxonomy_Mappings"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2009-01-12T00:00:00Z",
        "modification_comment": "updated Description, Name"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2010-02-16T00:00:00Z",
        "modification_comment": "updated References"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2010-06-21T00:00:00Z",
        "modification_comment": "updated Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2011-06-01T00:00:00Z",
        "modification_comment": "updated Common_Consequences"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2012-05-11T00:00:00Z",
        "modification_comment": "updated Common_Consequences, Demonstrative_Examples, Observed_Examples, References, Related_Attack_Patterns, Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2013-02-21T00:00:00Z",
        "modification_comment": "updated Applicable_Platforms, References"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2013-07-17T00:00:00Z",
        "modification_comment": "updated Description, Relationships, Terminology_Notes"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2014-07-30T00:00:00Z",
        "modification_comment": "updated Demonstrative_Examples, Relationships, Taxonomy_Mappings"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2017-05-03T00:00:00Z",
        "modification_comment": "updated Related_Attack_Patterns"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2017-11-08T00:00:00Z",
        "modification_comment": "updated Modes_of_Introduction, References, Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2018-01-23T00:00:00Z",
        "modification_comment": "updated Abstraction, Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2018-03-27T00:00:00Z",
        "modification_comment": "updated References, Relationships, Type"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2019-06-20T00:00:00Z",
        "modification_comment": "updated Relationships, Type"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2020-02-24T00:00:00Z",
        "modification_comment": "updated Applicable_Platforms, Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2021-03-15T00:00:00Z",
        "modification_comment": "updated Demonstrative_Examples"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2021-10-28T00:00:00Z",
        "modification_comment": "updated Relationships"
      }
    ],
    "previous_entry_name": [
      {
        "text": "Plaintext Storage of Sensitive Information",
        "date": "2009-01-12T00:00:00Z"
      }
    ]
  },
  "taxonomy_mappings": [
    {
      "taxonomy_name": "PLOVER",
      "entry_name": "Plaintext Storage of Sensitive Information"
    },
    {
      "taxonomy_name": "Software Fault Patterns",
      "entry_name": "Exposed Data",
      "entry_id": "SFP23"
    }
  ],
  "related_attack_patterns": [
    "37"
  ],
  "notes": [
    {
      "type": "Terminology",
      "text": "Different people use \"cleartext\" and \"plaintext\" to mean the same thing: the lack of encryption. However, within cryptography, these have more precise meanings. Plaintext is the information just before it is fed into a cryptographic algorithm, including already-encrypted text. Cleartext is any information that is unencrypted, although it might be in an encoded form that is not easily human-readable (such as base64 encoding)."
    }
  ]
}
