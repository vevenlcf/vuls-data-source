{
  "id": "1300",
  "name": "Improper Protection of Physical Side Channels",
  "abstraction": "Base",
  "structure": "Simple",
  "status": "Stable",
  "description": "The device does not contain sufficient protection\n\tmechanisms to prevent physical side channels from exposing\n\tsensitive information due to patterns in physically observable\n\tphenomena such as variations in power consumption,\n\telectromagnetic emissions (EME), or acoustic emissions.",
  "extended_description": "\n\t  \u003cxhtml:p\u003eAn adversary could monitor and measure physical\n\t  phenomena to detect patterns and make inferences, even if it\n\t  is not possible to extract the information in the digital\n\t  domain.\u003c/xhtml:p\u003e\n\t  \u003cxhtml:p\u003ePhysical side channels have been well-studied for\n\t  decades in the context of breaking implementations of\n\t  cryptographic algorithms or other attacks against security\n\t  features. These side channels may be easily observed by an\n\t  adversary with physical access to the device, or using a\n\t  tool that is in close proximity.  If the adversary can\n\t  monitor hardware operation and correlate its data processing\n\t  with power, EME, and acoustic measurements, the adversary\n\t  might be able to recover of secret keys and data.\u003c/xhtml:p\u003e\n\t\t\t",
  "related_weaknesses": [
    {
      "nature": "ChildOf",
      "cweid": "203",
      "view_id": "1000",
      "ordinal": "Primary"
    },
    {
      "nature": "ChildOf",
      "cweid": "203",
      "view_id": "1194",
      "ordinal": "Primary"
    }
  ],
  "applicable_platforms": {
    "language": [
      {
        "class": "Language-Independent",
        "prevalence": "Undetermined"
      }
    ],
    "technology": [
      {
        "class": "Technology-Independent",
        "prevalence": "Undetermined"
      }
    ],
    "operating_system": [
      {
        "class": "OS-Independent",
        "prevalence": "Undetermined"
      }
    ],
    "architecture": [
      {
        "class": "Architecture-Independent",
        "prevalence": "Undetermined"
      }
    ]
  },
  "modes_of_introduction": [
    {
      "phase": "Implementation"
    }
  ],
  "common_consequences": [
    {
      "scope": [
        "Confidentiality"
      ],
      "impact": [
        "Read Memory",
        "Read Application Data"
      ]
    }
  ],
  "potential_mitigations": [
    {
      "phase": [
        "Architecture and Design"
      ],
      "description": [
        "Apply blinding or masking techniques to implementations of cryptographic algorithms."
      ]
    },
    {
      "phase": [
        "Implementation"
      ],
      "description": [
        "Add shielding or tamper-resistant protections to the device to increase the difficulty of obtaining measurements of the side-channel."
      ]
    }
  ],
  "demonstrative_examples": [
    {
      "text": "\n\t\t    \u003cIntro_Text\u003eConsider a device that checks a\n\t\t    passcode to unlock the screen.\u003c/Intro_Text\u003e\n\t\t    \u003cExample_Code Nature=\"bad\"\u003eAs each character of\n\t\t    the PIN number is entered, a correct character\n\t\t    exhibits one current pulse shape while an\n\t\t    incorrect character exhibits a different current\n\t\t    pulse shape.\u003c/Example_Code\u003e\n\t\t    \u003cBody_Text\u003ePIN numbers used to unlock a cell phone\n\t\t    should not exhibit any characteristics about\n\t\t    themselves. This creates a side channel. An\n\t\t    attacker could monitor the pulses using an\n\t\t    oscilloscope or other method. Once the first\n\t\t    character is correctly guessed (based on the\n\t\t    oscilloscope readings), they can then move to the\n\t\t    next character, which is much more efficient than\n\t\t    the brute force method of guessing every possible\n\t\t    sequence of characters.\u003c/Body_Text\u003e\n\t\t    \u003cExample_Code Nature=\"good\"\u003eRather than comparing\n\t\t    each character to the correct PIN value as it is\n\t\t    entered, the device could accumulate the PIN in a\n\t\t    register, and do the comparison all at once at the\n\t\t    end. Alternatively, the components for the\n\t\t    comparison could be modified so that the current\n\t\t    pulse shape is the same regardless of the\n\t\t    correctness of the entered\n\t\t    character.\u003c/Example_Code\u003e\n\t\t  "
    },
    {
      "text": "\n\t\t\t\u003cIntro_Text\u003eConsider the device vulnerability CVE-2021-3011, which affects certain microcontrollers [REF-1221]. The Google Titan Security Key is used for two-factor authentication using cryptographic algorithms. The device uses an internal secret key for this purpose and exchanges information based on this key for the authentication. If this internal secret key and the encryption algorithm were known to an adversary, the key function could be duplicated, allowing the adversary to masquerade as the legitimate user.\u003c/Intro_Text\u003e\n\t\t\t\u003cExample_Code Nature=\"bad\"\u003eThe local method of extracting the secret key consists of plugging the key into a USB port and using electromagnetic (EM) sniffing tools and computers.\u003c/Example_Code\u003e\n\t\t\t\u003cExample_Code Nature=\"good\"\u003eSeveral solutions could have been considered by the manufacturer. For example, the manufacturer could shield the circuitry in the key or add randomized delays, indirect calculations with random values involved, or randomly ordered calculations to make extraction much more difficult or a combination of these techniques.\u003c/Example_Code\u003e\n\t\t  "
    }
  ],
  "observed_examples": [
    {
      "reference": "CVE-2021-3011",
      "description": "electromagnetic-wave side-channel in security-related microcontrollers allows extraction of private key",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3011"
    },
    {
      "reference": "CVE-2013-4576",
      "description": "message encryption software uses certain instruction sequences that allows RSA key extraction using a chosen-ciphertext attack and acoustic cryptanalysis",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-4576"
    },
    {
      "reference": "CVE-2020-28368",
      "description": "virtualization product allows recovery of AES keys from the guest OS using a side channel attack against a power/energy monitoring interface.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-28368"
    },
    {
      "reference": "CVE-2019-18673",
      "description": "power consumption varies based on number of pixels being illuminated in a display, allowing reading of secrets such as the PIN by using the USB interface to measure power consumption",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-18673"
    }
  ],
  "references": [
    {
      "reference_id": "REF-1117",
      "author": [
        "Paul Kocher",
        "Joshua Jaffe",
        "Benjamin Jun"
      ],
      "title": "Introduction to differential power analysis and related attacks",
      "url": "https://www.rambus.com/wp-content/uploads/2015/08/DPATechInfo.pdf",
      "publication_year": "1998"
    },
    {
      "reference_id": "REF-1118",
      "author": [
        "Dakshi Agrawal",
        "Bruce Archambeault",
        "Josyula R. Rao",
        "Pankaj Rohatgi"
      ],
      "title": "The EM Side-Channel(s)",
      "url": "https://link.springer.com/content/pdf/10.1007%2F3-540-36400-5_4.pdf",
      "publication_year": "2007",
      "publication_month": "--08",
      "publication_day": "---24"
    },
    {
      "reference_id": "REF-1119",
      "author": [
        "Daniel Genkin",
        "Adi Shamir",
        "Eran Tromer"
      ],
      "title": "RSA key extraction via low-bandwidth acoustic cryptanalysis",
      "url": "https://www.iacr.org/archive/crypto2014/86160149/86160149.pdf",
      "publication_year": "2014",
      "publication_month": "--06",
      "publication_day": "---13"
    },
    {
      "reference_id": "REF-1120",
      "author": [
        "Colin O’Flynn"
      ],
      "title": "Power Analysis for Cheapskates",
      "url": "https://media.blackhat.com/eu-13/briefings/OFlynn/bh-eu-13-for-cheapstakes-oflynn-wp.pdf",
      "publication_year": "2013",
      "publication_month": "--01",
      "publication_day": "---24"
    },
    {
      "reference_id": "REF-1055",
      "author": [
        "Peter Gutmann"
      ],
      "title": "Data Remanence in Semiconductor Devices",
      "url": "https://www.usenix.org/legacy/events/sec01/full_papers/gutmann/gutmann.pdf",
      "publication_year": "2001",
      "publication_month": "--08",
      "publication": "10th USENIX Security Symposium"
    },
    {
      "reference_id": "REF-1218",
      "author": [
        "Graham Cluley"
      ],
      "title": "This Black Box Can Brute Force Crack iPhone PIN Passcodes",
      "url": "https://www.intego.com/mac-security-blog/iphone-pin-pass-code/",
      "publication_year": "2015",
      "publication_month": "--03",
      "publication_day": "---16",
      "publication": "The Mac Security Blog"
    },
    {
      "reference_id": "REF-1221",
      "author": [
        "Victor Lomne",
        "Thomas Roche"
      ],
      "title": "A Side Journey to Titan",
      "url": "https://ninjalab.io/wp-content/uploads/2021/01/a_side_journey_to_titan.pdf",
      "publication_year": "2021",
      "publication_month": "--01",
      "publication_day": "---07"
    },
    {
      "reference_id": "REF-1228",
      "author": [
        "Gilbert Goodwill",
        "Benjamin Jun",
        "Josh Jaffe",
        "Pankaj Rohatgi"
      ],
      "title": "A testing methodology for side-channel resistance validation",
      "url": "https://csrc.nist.gov/csrc/media/events/non-invasive-attack-testing-workshop/documents/08_goodwill.pdf",
      "publication_year": "2011"
    },
    {
      "reference_id": "REF-1229",
      "author": [
        "ISO/IEC"
      ],
      "title": "ISO/IEC 17825:2016: Testing methods for the mitigation of non-invasive attack classes against cryptographic modules",
      "url": "https://www.iso.org/standard/60612.html",
      "publication_year": "2016"
    },
    {
      "reference_id": "REF-1230",
      "author": [
        "Cryptography Research Inc."
      ],
      "title": "Test Vector Leakage Assessment (TVLA) Derived Test Requirements (DTR) with AES",
      "url": "https://www.rambus.com/wp-content/uploads/2015/08/TVLA-DTR-with-AES.pdf",
      "publication_year": "2015",
      "publication_month": "--08"
    },
    {
      "section": "pp. 305-319",
      "reference_id": "REF-1231",
      "author": [
        "Danilo Šijaˇci´c",
        "Josep Balasch",
        "Bohan Yang",
        "Santosh Ghosh",
        "Ingrid Verbauwhede"
      ],
      "title": "Towards efficient and automated side-channel evaluations at design time",
      "url": "https://www.esat.kuleuven.be/cosic/publications/article-3204.pdf",
      "publication_year": "2020",
      "publication": "Journal of Cryptographic Engineering, 10(4)"
    },
    {
      "section": "pp. 123-130",
      "reference_id": "REF-1232",
      "author": [
        "Amit Kumar",
        "Cody Scarborough",
        "Ali Yilmaz",
        "Michael Orshansky"
      ],
      "title": "Efficient simulation of EM side-channel attack resilience",
      "url": "https://dl.acm.org/doi/pdf/10.5555/3199700.3199717",
      "publication_year": "2017",
      "publication": "IEEE/ACM International Conference on Computer-Aided Design (ICCAD)"
    },
    {
      "reference_id": "REF-1233",
      "author": [
        "Yuan Yao",
        "Tuna Tufan",
        "Tarun Kathuria",
        "Baris Ege",
        "Ulkuhan Guler",
        "Patrick Schaumont"
      ],
      "title": "Pre-silicon Architecture Correlation Analysis (PACA): Identifying and Mitigating the Source of Side-channel Leakage at Gate-level",
      "url": "https://eprint.iacr.org/2021/530.pdf",
      "publication_year": "2021",
      "publication_month": "--04",
      "publication_day": "---21",
      "publisher": "IACR Cryptology ePrint Archive"
    },
    {
      "reference_id": "REF-1234",
      "author": [
        "Elisabeth Oswald",
        "Thomas Popp",
        "Stefan Mangard"
      ],
      "title": "Power Analysis Attacks - Revealing the Secrets of Smart Cards",
      "url": "https://www.springer.com/gp/book/9780387308579",
      "publication_year": "2007"
    },
    {
      "reference_id": "REF-1235",
      "author": [
        "David Oswald",
        "Bastian Richter",
        "Christof Paar"
      ],
      "title": "Side-Channel Attacks on the Yubikey 2 One-Time Password Generator",
      "url": "https://www.emsec.ruhr-uni-bochum.de/media/crypto/veroeffentlichungen/2014/02/04/paper_yubikey_sca.pdf",
      "publication_year": "2013",
      "publication_month": "--06",
      "publication_day": "---14"
    },
    {
      "reference_id": "REF-1239",
      "author": [
        "François-Xavier Standaert"
      ],
      "title": "How (not) to Use Welch's T-test in Side-Channel Security Evaluations",
      "url": "https://eprint.iacr.org/2017/138.pdf",
      "publication_year": "2017",
      "publication_month": "--02",
      "publication_day": "---15",
      "publisher": "IACR Cryptology ePrint Archive"
    },
    {
      "reference_id": "REF-1240",
      "author": [
        "Carolyn Whitnall",
        "Elisabeth Oswald"
      ],
      "title": "A Critical Analysis of ISO 17825 ('Testing methods for the mitigation of non-invasive attack classes against cryptographic modules')",
      "url": "https://eprint.iacr.org/2019/1013.pdf",
      "publication_year": "2019",
      "publication_month": "--09",
      "publication_day": "---10",
      "publisher": "IACR Cryptology ePrint Archive"
    }
  ],
  "content_history": {
    "submission": {
      "submission_name": "Nicole Fern",
      "submission_organization": "Tortuga Logic",
      "submission_date": "2020-05-29T00:00:00Z"
    },
    "modification": [
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2021-03-15T00:00:00Z",
        "modification_comment": "updated Functional_Areas, Maintenance_Notes"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2021-07-20T00:00:00Z",
        "modification_comment": "updated Related_Attack_Patterns"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2021-10-28T00:00:00Z",
        "modification_comment": "updated Demonstrative_Examples, Description, Detection_Factors, Maintenance_Notes, Name, Observed_Examples, References, Relationships, Weakness_Ordinalities"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2022-06-28T00:00:00Z",
        "modification_comment": "updated Relationships"
      }
    ],
    "previous_entry_name": [
      {
        "text": "Improper Protection Against Physical Side Channels",
        "date": "2021-10-28T00:00:00Z"
      }
    ],
    "contribution": [
      {
        "type": "Content",
        "contribution_name": "Anders Nordstrom, Alric Althoff",
        "contribution_organization": "Tortuga Logic",
        "contribution_date": "2021-10-11T00:00:00Z",
        "contribution_comment": "Provided detection methods, observed examples, and references"
      },
      {
        "type": "Content",
        "contribution_name": "Nicole Fern",
        "contribution_organization": "Riscure",
        "contribution_date": "2021-10-13T00:00:00Z",
        "contribution_comment": "Provided detection methods, observed examples, and references"
      }
    ]
  },
  "weakness_ordinalities": [
    {
      "ordinality": "Primary"
    },
    {
      "ordinality": "Resultant"
    }
  ],
  "detection_methods": [
    {
      "method": "Manual Analysis",
      "description": "Perform a set of leakage detection tests such as the procedure outlined in the Test Vector Leakage Assessment (TVLA) test requirements for AES [REF-1230].  TVLA is the basis for the ISO standard 17825 [REF-1229]. A separate methodology is provided by [REF-1228]. Note that sole reliance on this method might not yield expected results [REF-1239] [REF-1240].",
      "effectiveness": "Moderate"
    },
    {
      "method": "Manual Analysis",
      "description": "\n\t\t\t\t  \u003cxhtml:p\u003ePost-silicon, perform full side-channel attacks (penetration testing) covering as many known leakage models as possible against test code.\u003c/xhtml:p\u003e",
      "effectiveness": "Moderate"
    },
    {
      "method": "Manual Analysis",
      "description": "\n\t\t\t\t  \u003cxhtml:p\u003ePre-silicon - while the aforementioned TVLA methods can be performed post-silicon, models of device power consumption or other physical emanations can be built from information present at various stages of the hardware design process before fabrication. TVLA or known side-channel attacks can be applied to these simulated traces and countermeasures applied before tape-out.  Academic research in this field includes [REF-1231] [REF-1232] [REF-1233].\u003c/xhtml:p\u003e",
      "effectiveness": "Moderate"
    }
  ],
  "related_attack_patterns": [
    "189"
  ],
  "functional_areas": [
    "Power"
  ]
}
