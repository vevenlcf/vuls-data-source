{
  "id": "621",
  "name": "Variable Extraction Error",
  "abstraction": "Base",
  "structure": "Simple",
  "status": "Incomplete",
  "description": "The product uses external input to determine the names of variables into which information is extracted, without verifying that the names of the specified variables are valid. This could cause the program to overwrite unintended variables.",
  "extended_description": "\n            \u003cxhtml:p\u003eFor example, in PHP, extraction can be used to provide functionality similar to register_globals, a dangerous functionality that is frequently disabled in production systems. Calling extract() or import_request_variables() without the proper arguments could allow arbitrary global variables to be overwritten, including superglobals.\u003c/xhtml:p\u003e\n            \u003cxhtml:p\u003eSimilar functionality is possible in other interpreted languages, including custom languages.\u003c/xhtml:p\u003e\n         ",
  "related_weaknesses": [
    {
      "nature": "ChildOf",
      "cweid": "914",
      "view_id": "1000",
      "ordinal": "Primary"
    },
    {
      "nature": "CanPrecede",
      "cweid": "471",
      "view_id": "1000"
    }
  ],
  "applicable_platforms": {
    "language": [
      {
        "prevalence": "Undetermined",
        "name": "PHP"
      }
    ]
  },
  "modes_of_introduction": [
    {
      "phase": "Implementation"
    }
  ],
  "common_consequences": [
    {
      "scope": [
        "Integrity"
      ],
      "impact": [
        "Modify Application Data"
      ],
      "note": "An attacker could modify sensitive data or program variables."
    }
  ],
  "potential_mitigations": [
    {
      "phase": [
        "Implementation"
      ],
      "description": [
        "Use allowlists of variable names that can be extracted."
      ],
      "strategy": "Input Validation"
    },
    {
      "phase": [
        "Implementation"
      ],
      "description": [
        "Consider refactoring your code to avoid extraction routines altogether."
      ]
    },
    {
      "phase": [
        "Implementation"
      ],
      "description": [
        "In PHP, call extract() with options such as EXTR_SKIP and EXTR_PREFIX_ALL; call import_request_variables() with a prefix argument. Note that these capabilities are not present in all PHP versions."
      ]
    }
  ],
  "demonstrative_examples": [
    {
      "demonstrative_example_id": "DX-107",
      "text": "\n               \u003cIntro_Text\u003eThis code uses the credentials sent in a POST request to login a user.\u003c/Intro_Text\u003e\n               \u003cExample_Code Nature=\"bad\" Language=\"PHP\"\u003e\n                  \u003cxhtml:div\u003e\n                     \u003cxhtml:i\u003e//Log user in, and set $isAdmin to true if user is an administrator\u003c/xhtml:i\u003e\n                     \u003cxhtml:br/\u003e\n                     \u003cxhtml:br/\u003efunction login($user,$pass){\u003cxhtml:div style=\"margin-left:10px;\"\u003e$query = buildQuery($user,$pass);\u003cxhtml:br/\u003emysql_query($query);\u003cxhtml:br/\u003eif(getUserRole($user) == \"Admin\"){\u003cxhtml:div style=\"margin-left:10px;\"\u003e$isAdmin = true;\u003c/xhtml:div\u003e}\u003c/xhtml:div\u003e}\u003cxhtml:br/\u003e\n                     \u003cxhtml:br/\u003e$isAdmin = false;\u003cxhtml:br/\u003eextract($_POST);\u003cxhtml:br/\u003elogin(mysql_real_escape_string($user),mysql_real_escape_string($pass));\u003c/xhtml:div\u003e\n               \u003c/Example_Code\u003e\n               \u003cBody_Text\u003eThe call to extract() will overwrite the existing values of any variables defined previously, in this case $isAdmin. An attacker can send a POST request with an unexpected third value \"isAdmin\" equal to \"true\", thus gaining Admin privileges.\u003c/Body_Text\u003e\n            "
    }
  ],
  "observed_examples": [
    {
      "reference": "CVE-2006-7135",
      "description": "extract issue enables file inclusion",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-7135"
    },
    {
      "reference": "CVE-2006-7079",
      "description": "extract used for register_globals compatibility layer, enables path traversal",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-7079"
    },
    {
      "reference": "CVE-2007-0649",
      "description": "extract() buried in include files makes post-disclosure analysis confusing; original report had seemed incorrect.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-0649"
    },
    {
      "reference": "CVE-2006-6661",
      "description": "extract() enables static code injection",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-6661"
    },
    {
      "reference": "CVE-2006-2828",
      "description": "import_request_variables() buried in include files makes post-disclosure analysis confusing",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-2828"
    }
  ],
  "content_history": {
    "submission": {
      "submission_name": "CWE Content Team",
      "submission_organization": "MITRE",
      "submission_date": "2007-05-07T00:00:00Z"
    },
    "modification": [
      {
        "modification_name": "Eric Dalci",
        "modification_organization": "Cigital",
        "modification_date": "2008-07-01T00:00:00Z",
        "modification_comment": "updated Time_of_Introduction"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2008-09-08T00:00:00Z",
        "modification_comment": "updated Description, Relationships, Observed_Example, Other_Notes, Weakness_Ordinalities"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2008-10-14T00:00:00Z",
        "modification_comment": "updated Description"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2011-06-01T00:00:00Z",
        "modification_comment": "updated Common_Consequences"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2012-05-11T00:00:00Z",
        "modification_comment": "updated Common_Consequences, Demonstrative_Examples, Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2012-10-30T00:00:00Z",
        "modification_comment": "updated Potential_Mitigations"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2013-02-21T00:00:00Z",
        "modification_comment": "updated Demonstrative_Examples, Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2014-06-23T00:00:00Z",
        "modification_comment": "updated Description, Other_Notes"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2014-07-30T00:00:00Z",
        "modification_comment": "updated Relationships, Taxonomy_Mappings"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2020-02-24T00:00:00Z",
        "modification_comment": "updated Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2020-06-25T00:00:00Z",
        "modification_comment": "updated Potential_Mitigations"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2022-04-28T00:00:00Z",
        "modification_comment": "updated Research_Gaps"
      }
    ]
  },
  "weakness_ordinalities": [
    {
      "ordinality": "Primary"
    }
  ],
  "alternate_terms": [
    {
      "term": "Variable overwrite"
    }
  ],
  "taxonomy_mappings": [
    {
      "taxonomy_name": "Software Fault Patterns",
      "entry_name": "Tainted input to command",
      "entry_id": "SFP24"
    }
  ],
  "notes": [
    {
      "type": "Research Gap",
      "text": "Probably under-reported for PHP. Seems under-studied for other interpreted languages."
    }
  ]
}
