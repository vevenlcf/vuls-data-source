{
  "id": "226",
  "name": "Sensitive Information in Resource Not Removed Before Reuse",
  "abstraction": "Base",
  "structure": "Simple",
  "status": "Draft",
  "description": "The product releases a resource such as memory or a file so that it can be made available for reuse, but it does not clear or \"zeroize\" the information contained in the resource before the product performs a critical state transition or makes the resource available for reuse by other entities.",
  "extended_description": "\n\t\t\t \u003cxhtml:p\u003eWhen resources are released, they can be made available for reuse. For example, after memory is de-allocated, an operating system may make the memory available to another process, or disk space may be reallocated when a file is deleted. As removing information requires time and additional resources, operating systems do not usually clear the previously written information.\u003c/xhtml:p\u003e\n\t\t\t \u003cxhtml:p\u003eEven when the resource is reused by the same process, this weakness can arise when new data is not as large as the old data, which leaves portions of the old data still available. Equivalent errors can occur in other situations where the length of data is variable but the associated data structure is not. If memory is not cleared after use, the information may be read by less trustworthy parties when the memory is reallocated.\u003c/xhtml:p\u003e\n\t\t\t \u003cxhtml:p\u003eThis weakness can apply in hardware, such as when a device or system switches between power, sleep, or debug states during normal operation, or when execution changes to different users or privilege levels.\u003c/xhtml:p\u003e\n     ",
  "related_weaknesses": [
    {
      "nature": "ChildOf",
      "cweid": "459",
      "view_id": "1000",
      "ordinal": "Primary"
    },
    {
      "nature": "ChildOf",
      "cweid": "212",
      "view_id": "1000"
    },
    {
      "nature": "CanPrecede",
      "cweid": "201",
      "view_id": "1000"
    }
  ],
  "applicable_platforms": {
    "language": [
      {
        "class": "Language-Independent",
        "prevalence": "Undetermined"
      }
    ],
    "technology": [
      {
        "class": "Technology-Independent",
        "prevalence": "Undetermined"
      }
    ]
  },
  "modes_of_introduction": [
    {
      "phase": "Architecture and Design"
    },
    {
      "phase": "Implementation"
    }
  ],
  "common_consequences": [
    {
      "scope": [
        "Confidentiality"
      ],
      "impact": [
        "Read Application Data"
      ]
    }
  ],
  "potential_mitigations": [
    {
      "phase": [
        "Architecture and Design",
        "Implementation"
      ],
      "description": [
        "During critical state transitions, information not needed in the next state should be removed or overwritten with fixed patterns (such as all 0's) or random data, before the transition to the next state."
      ],
      "effectiveness": "High"
    },
    {
      "phase": [
        "Architecture and Design",
        "Implementation"
      ],
      "description": [
        "When releasing, de-allocating, or deleting a resource, overwrite its data and relevant metadata with fixed patterns or random data. Be cautious about complex resource types whose underlying representation might be non-contiguous or change at a low level, such as how a file might be split into different chunks on a file system, even though \"logical\" file positions are contiguous at the application layer. Such resource types might require invocation of special modes or APIs to tell the underlying operating system to perform the necessary clearing, such as SDelete (Secure Delete) on Windows, although the appropriate functionality might not be available at the application layer."
      ],
      "effectiveness": "High"
    }
  ],
  "demonstrative_examples": [
    {
      "demonstrative_example_id": "DX-147",
      "text": "\n\t \u003cIntro_Text\u003eThis example shows how an attacker can take advantage of an incorrect state transition.\u003c/Intro_Text\u003e\n\t \u003cBody_Text\u003e\n\t   \u003cxhtml:p\u003eSuppose a device is transitioning from state A to state B. During state A, it can read certain private keys from the hidden fuses that are only accessible in state A but not in state B. The device reads the keys, performs operations using those keys, then transitions to state B, where those private keys should no longer be accessible.\u003c/xhtml:p\u003e\n\t \u003c/Body_Text\u003e\n\t \u003cExample_Code Nature=\"bad\"\u003e\n\t \u003cxhtml:p\u003eDuring the transition from A to B, the device does not scrub the memory.\u003c/xhtml:p\u003e\n\t \u003c/Example_Code\u003e\n\t \u003cBody_Text\u003e\u003cxhtml:p\u003eAfter the transition to state B, even though the private keys are no longer accessible directly from the fuses in state B, they can be accessed indirectly by reading the memory that contains the private keys.\u003c/xhtml:p\u003e\u003c/Body_Text\u003e\n\t \u003cExample_Code Nature=\"good\"\u003eFor transition from state A to state B, remove information which should not be available once the transition is complete.\u003c/Example_Code\u003e\n       "
    },
    {
      "demonstrative_example_id": "DX-148",
      "text": "\n         \u003cIntro_Text\u003eThe following code calls realloc() on a buffer containing sensitive data:\u003c/Intro_Text\u003e\n         \u003cExample_Code Nature=\"bad\" Language=\"C\"\u003e\n           \u003cxhtml:div\u003ecleartext_buffer = get_secret();...\u003cxhtml:br/\u003ecleartext_buffer = realloc(cleartext_buffer, 1024);\u003cxhtml:br/\u003e...\u003cxhtml:br/\u003escrub_memory(cleartext_buffer, 1024);\u003c/xhtml:div\u003e\n         \u003c/Example_Code\u003e\n         \u003cBody_Text\u003eThere is an attempt to scrub the sensitive data from memory, but realloc() is used, so it could return a pointer to a different part of memory. The memory that was originally allocated for cleartext_buffer could still contain an uncleared copy of the data.\u003c/Body_Text\u003e\n       "
    }
  ],
  "observed_examples": [
    {
      "reference": "CVE-2003-0001",
      "description": "Ethernet NIC drivers do not pad frames with null bytes, leading to infoleak from malformed packets.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2003-0001"
    },
    {
      "reference": "CVE-2003-0291",
      "description": "router does not clear information from DHCP packets that have been previously used",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2003-0291"
    },
    {
      "reference": "CVE-2005-1406",
      "description": "Products do not fully clear memory buffers when less data is stored into the buffer than previous.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-1406"
    },
    {
      "reference": "CVE-2005-1858",
      "description": "Products do not fully clear memory buffers when less data is stored into the buffer than previous.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-1858"
    },
    {
      "reference": "CVE-2005-3180",
      "description": "Products do not fully clear memory buffers when less data is stored into the buffer than previous.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3180"
    },
    {
      "reference": "CVE-2005-3276",
      "description": "Product does not clear a data structure before writing to part of it, yielding information leak of previously used memory.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3276"
    },
    {
      "reference": "CVE-2002-2077",
      "description": "Memory not properly cleared before reuse.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-2077"
    }
  ],
  "content_history": {
    "submission": {
      "submission_name": "PLOVER",
      "submission_date": "2006-07-19T00:00:00Z"
    },
    "modification": [
      {
        "modification_name": "Eric Dalci",
        "modification_organization": "Cigital",
        "modification_date": "2008-07-01T00:00:00Z",
        "modification_comment": "updated Time_of_Introduction"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2008-09-08T00:00:00Z",
        "modification_comment": "updated Relationships, Other_Notes, Relationship_Notes, Taxonomy_Mappings, Weakness_Ordinalities"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2008-10-14T00:00:00Z",
        "modification_comment": "updated Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2008-11-24T00:00:00Z",
        "modification_comment": "updated Relationships, Taxonomy_Mappings"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2009-03-10T00:00:00Z",
        "modification_comment": "updated Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2009-05-27T00:00:00Z",
        "modification_comment": "updated Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2009-10-29T00:00:00Z",
        "modification_comment": "updated Description, Other_Notes"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2010-02-16T00:00:00Z",
        "modification_comment": "updated Applicable_Platforms, Maintenance_Notes, Relationship_Notes"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2010-09-27T00:00:00Z",
        "modification_comment": "updated Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2010-12-13T00:00:00Z",
        "modification_comment": "updated Description"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2011-06-01T00:00:00Z",
        "modification_comment": "updated Common_Consequences, Relationships, Taxonomy_Mappings"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2011-09-13T00:00:00Z",
        "modification_comment": "updated Relationships, Taxonomy_Mappings"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2012-05-11T00:00:00Z",
        "modification_comment": "updated Relationships, Taxonomy_Mappings"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2014-07-30T00:00:00Z",
        "modification_comment": "updated Relationships, Taxonomy_Mappings"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2017-11-08T00:00:00Z",
        "modification_comment": "updated Causal_Nature, Functional_Areas, Relationships, Taxonomy_Mappings"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2020-02-24T00:00:00Z",
        "modification_comment": "updated Applicable_Platforms, Description, Name, Relationships, Time_of_Introduction, Weakness_Ordinalities"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2020-08-20T00:00:00Z",
        "modification_comment": "updated Description, Name, Related_Attack_Patterns, Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2021-10-28T00:00:00Z",
        "modification_comment": "updated Demonstrative_Examples, Description, Detection_Factors, Maintenance_Notes, Potential_Mitigations, Relationships, Research_Gaps"
      }
    ],
    "previous_entry_name": [
      {
        "text": "Sensitive Information Uncleared Before Use",
        "date": "2008-04-11T00:00:00Z"
      },
      {
        "text": "Sensitive Information Uncleared Before Release",
        "date": "2020-02-24T00:00:00Z"
      },
      {
        "text": "Sensitive Information Uncleared in Resource Before Release for Reuse",
        "date": "2020-08-20T00:00:00Z"
      }
    ]
  },
  "weakness_ordinalities": [
    {
      "ordinality": "Primary"
    }
  ],
  "detection_methods": [
    {
      "method": "Manual Analysis",
      "description": "Write a known pattern into each sensitive location. Trigger the release of the resource or cause the desired state transition to occur. Read data back from the sensitive locations. If the reads are successful, and the data is the same as the pattern that was originally written, the test fails and the product needs to be fixed. Note that this test can likely be automated.",
      "effectiveness": "High"
    }
  ],
  "taxonomy_mappings": [
    {
      "taxonomy_name": "PLOVER",
      "entry_name": "Sensitive Information Uncleared Before Use"
    },
    {
      "taxonomy_name": "CERT C Secure Coding",
      "entry_name": "Clear sensitive information stored in reusable resources returned for reuse",
      "entry_id": "MEM03-C"
    },
    {
      "taxonomy_name": "Software Fault Patterns",
      "entry_name": "Exposed Data",
      "entry_id": "SFP23"
    }
  ],
  "related_attack_patterns": [
    "37"
  ],
  "notes": [
    {
      "type": "Relationship",
      "text": "There is a close association between CWE-226 and CWE-212. The difference is partially that of perspective. CWE-226 is geared towards the final stage of the resource lifecycle, in which the resource is deleted, eliminated, expired, or otherwise released for reuse. Technically, this involves a transfer to a different control sphere, in which the original contents of the resource are no longer relevant. CWE-212, however, is intended for sensitive data in resources that are intentionally shared with others, so they are still active. This distinction is useful from the perspective of the CWE research view (CWE-1000)."
    },
    {
      "type": "Maintenance",
      "text": "This entry needs modification to clarify the differences with CWE-212. The description also combines two problems that are distinct from the CWE research perspective: the inadvertent transfer of information to another sphere, and improper initialization/shutdown. Some of the associated taxonomy mappings reflect these different uses."
    },
    {
      "type": "Research Gap",
      "text": "This is frequently found for network packets, but it can also exist in local memory allocation, files, etc."
    }
  ],
  "affected_resources": [
    "Memory"
  ],
  "functional_areas": [
    "Memory Management",
    "Networking"
  ]
}
