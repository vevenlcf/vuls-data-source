{
  "id": "915",
  "name": "Improperly Controlled Modification of Dynamically-Determined Object Attributes",
  "abstraction": "Base",
  "structure": "Simple",
  "status": "Incomplete",
  "description": "The software receives input from an upstream component that specifies multiple attributes, properties, or fields that are to be initialized or updated in an object, but it does not properly control which attributes can be modified.",
  "extended_description": "\n            \u003cxhtml:p\u003eIf the object contains attributes that were only intended for internal use, then their unexpected modification could lead to a vulnerability.\u003c/xhtml:p\u003e\n            \u003cxhtml:p\u003eThis weakness is sometimes known by the language-specific mechanisms that make it possible, such as mass assignment, autobinding, or object injection.\u003c/xhtml:p\u003e\n         ",
  "related_weaknesses": [
    {
      "nature": "ChildOf",
      "cweid": "913",
      "view_id": "1000",
      "ordinal": "Primary"
    },
    {
      "nature": "PeerOf",
      "cweid": "502",
      "view_id": "1000"
    }
  ],
  "applicable_platforms": {
    "language": [
      {
        "prevalence": "Undetermined",
        "name": "Ruby"
      },
      {
        "prevalence": "Undetermined",
        "name": "ASP.NET"
      },
      {
        "prevalence": "Undetermined",
        "name": "PHP"
      },
      {
        "prevalence": "Undetermined",
        "name": "Python"
      },
      {
        "class": "Language-Independent",
        "prevalence": "Undetermined"
      }
    ]
  },
  "modes_of_introduction": [
    {
      "phase": "Architecture and Design"
    },
    {
      "phase": "Implementation"
    }
  ],
  "common_consequences": [
    {
      "scope": [
        "Integrity"
      ],
      "impact": [
        "Modify Application Data"
      ],
      "note": "An attacker could modify sensitive data or program variables."
    },
    {
      "scope": [
        "Integrity"
      ],
      "impact": [
        "Execute Unauthorized Code or Commands"
      ]
    },
    {
      "scope": [
        "Other",
        "Integrity"
      ],
      "impact": [
        "Varies by Context",
        "Alter Execution Logic"
      ]
    }
  ],
  "potential_mitigations": [
    {
      "phase": [
        "Implementation"
      ],
      "description": [
        "\n                  \u003cxhtml:p\u003eIf available, use features of the language or framework that allow specification of allowlists of attributes or fields that are allowed to be modified. If possible, prefer allowlists over denylists.\u003c/xhtml:p\u003e\n                  \u003cxhtml:p\u003eFor applications written with Ruby on Rails, use the attr_accessible (allowlist) or attr_protected (denylist) macros in each class that may be used in mass assignment.\u003c/xhtml:p\u003e\n               "
      ]
    },
    {
      "phase": [
        "Architecture and Design",
        "Implementation"
      ],
      "description": [
        "If available, use the signing/sealing features of the programming language to assure that deserialized data has not been tainted. For example, a hash-based message authentication code (HMAC) could be used to ensure that data has not been modified."
      ]
    },
    {
      "phase": [
        "Implementation"
      ],
      "description": [
        "For any externally-influenced input, check the input against an allowlist of internal object attributes or fields that are allowed to be modified."
      ],
      "strategy": "Input Validation"
    },
    {
      "phase": [
        "Implementation",
        "Architecture and Design"
      ],
      "description": [
        "Refactor the code so that object attributes or fields do not need to be dynamically identified, and only expose getter/setter functionality for the intended attributes."
      ],
      "strategy": "Refactoring"
    }
  ],
  "observed_examples": [
    {
      "reference": "CVE-2012-2054",
      "description": "Mass assignment allows modification of arbitrary attributes using modified URL.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-2054"
    },
    {
      "reference": "CVE-2012-2055",
      "description": "Source version control product allows modification of trusted key using mass assignment.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-2055"
    },
    {
      "reference": "CVE-2008-7310",
      "description": "Attackers can bypass payment step in e-commerce software.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-7310"
    },
    {
      "reference": "CVE-2013-1465",
      "description": "Use of PHP unserialize function on untrusted input allows attacker to modify application configuration.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-1465"
    },
    {
      "reference": "CVE-2012-3527",
      "description": "Use of PHP unserialize function on untrusted input in content management system might allow code execution.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-3527"
    },
    {
      "reference": "CVE-2012-0911",
      "description": "Use of PHP unserialize function on untrusted input in content management system allows code execution using a crafted cookie value.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-0911"
    },
    {
      "reference": "CVE-2012-0911",
      "description": "Content management system written in PHP allows unserialize of arbitrary objects, possibly allowing code execution.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-0911"
    },
    {
      "reference": "CVE-2011-4962",
      "description": "Content management system written in PHP allows code execution through page comments.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-4962"
    },
    {
      "reference": "CVE-2009-4137",
      "description": "Use of PHP unserialize function on cookie value allows remote code execution or upload of arbitrary files.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-4137"
    },
    {
      "reference": "CVE-2007-5741",
      "description": "Content management system written in Python interprets untrusted data as pickles, allowing code execution.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-5741"
    },
    {
      "reference": "CVE-2011-2520",
      "description": "Python script allows local users to execute code via pickled data.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-2520"
    },
    {
      "reference": "CVE-2005-2875",
      "description": "Python script allows remote attackers to execute arbitrary code using pickled objects.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-2875"
    },
    {
      "reference": "CVE-2013-0277",
      "description": "Ruby on Rails allows deserialization of untrusted YAML to execute arbitrary code.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-0277"
    },
    {
      "reference": "CVE-2011-2894",
      "description": "Spring framework allows deserialization of objects from untrusted sources to execute arbitrary code.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-2894"
    },
    {
      "reference": "CVE-2012-1833",
      "description": "Grails allows binding of arbitrary parameters to modify arbitrary object properties.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-1833"
    },
    {
      "reference": "CVE-2010-3258",
      "description": "Incorrect deserialization in web browser allows escaping the sandbox.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-3258"
    },
    {
      "reference": "CVE-2008-1013",
      "description": "Media library allows deserialization of objects by untrusted Java applets, leading to arbitrary code execution.",
      "link": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-1013"
    }
  ],
  "references": [
    {
      "reference_id": "REF-885",
      "author": [
        "Stefan Esser"
      ],
      "title": "Shocking News in PHP Exploitation",
      "url": "http://www.suspekt.org/downloads/POC2009-ShockingNewsInPHPExploitation.pdf",
      "publication_year": "2009"
    },
    {
      "reference_id": "REF-886",
      "author": [
        "Dinis Cruz"
      ],
      "title": "\"Two Security Vulnerabilities in the Spring Framework's MVC\" pdf (from 2008)",
      "url": "http://blog.diniscruz.com/2011/07/two-security-vulnerabilities-in-spring.html"
    },
    {
      "reference_id": "REF-887",
      "author": [
        "Ryan Berg",
        "Dinis Cruz"
      ],
      "title": "Two Security Vulnerabilities in the Spring Framework's MVC",
      "url": "http://o2platform.files.wordpress.com/2011/07/ounce_springframework_vulnerabilities.pdf"
    },
    {
      "reference_id": "REF-888",
      "author": [
        "ASPNETUE"
      ],
      "title": "Best Practices for ASP.NET MVC",
      "url": "http://blogs.msdn.com/b/aspnetue/archive/2010/09/17/second_2d00_post.aspx",
      "publication_year": "2010",
      "publication_month": "--09",
      "publication_day": "---17"
    },
    {
      "reference_id": "REF-889",
      "author": [
        "Michael Hartl"
      ],
      "title": "Mass assignment in Rails applications",
      "url": "http://blog.mhartl.com/2008/09/21/mass-assignment-in-rails-applications/",
      "publication_year": "2008",
      "publication_month": "--09",
      "publication_day": "---21"
    },
    {
      "reference_id": "REF-890",
      "author": [
        "Tobi"
      ],
      "title": "Secure your Rails apps!",
      "url": "http://pragtob.wordpress.com/2012/03/06/secure-your-rails-apps/",
      "publication_year": "2012",
      "publication_month": "--03",
      "publication_day": "---06"
    },
    {
      "reference_id": "REF-891",
      "author": [
        "Heiko Webers"
      ],
      "title": "Ruby On Rails Security Guide",
      "url": "http://guides.rubyonrails.org/security.html#mass-assignment"
    },
    {
      "reference_id": "REF-892",
      "author": [
        "Josh Bush"
      ],
      "title": "Mass Assignment Vulnerability in ASP.NET MVC",
      "url": "http://freshbrewedcode.com/joshbush/2012/03/05/mass-assignment-aspnet-mvc/",
      "publication_year": "2012",
      "publication_month": "--03",
      "publication_day": "---05"
    },
    {
      "reference_id": "REF-893",
      "author": [
        "K. Scott Allen"
      ],
      "title": "6 Ways To Avoid Mass Assignment in ASP.NET MVC",
      "url": "http://odetocode.com/blogs/scott/archive/2012/03/11/complete-guide-to-mass-assignment-in-asp-net-mvc.aspx",
      "publication_year": "2012",
      "publication_month": "--03",
      "publication_day": "---12"
    },
    {
      "reference_id": "REF-894",
      "author": [
        "Egidio Romano"
      ],
      "title": "PHP Object Injection",
      "url": "https://www.owasp.org/index.php/PHP_Object_Injection",
      "publication_year": "2013",
      "publication_month": "--01",
      "publication_day": "---22"
    },
    {
      "reference_id": "REF-464",
      "author": [
        "Heine Deelstra"
      ],
      "title": "Unserializing user-supplied data, a bad idea",
      "url": "http://heine.familiedeelstra.com/security/unserialize",
      "publication_year": "2010",
      "publication_month": "--08",
      "publication_day": "---25"
    },
    {
      "reference_id": "REF-466",
      "author": [
        "Nadia Alramli"
      ],
      "title": "Why Python Pickle is Insecure",
      "url": "http://nadiana.com/python-pickle-insecure",
      "publication_year": "2009",
      "publication_month": "--09",
      "publication_day": "---09"
    }
  ],
  "content_history": {
    "submission": {
      "submission_name": "CWE Content Team",
      "submission_organization": "MITRE",
      "submission_date": "2013-01-26T00:00:00Z"
    },
    "modification": [
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2013-07-17T00:00:00Z",
        "modification_comment": "updated References"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2017-05-03T00:00:00Z",
        "modification_comment": "updated Potential_Mitigations"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2017-11-08T00:00:00Z",
        "modification_comment": "updated References"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2019-06-20T00:00:00Z",
        "modification_comment": "updated Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2020-02-24T00:00:00Z",
        "modification_comment": "updated Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2020-06-25T00:00:00Z",
        "modification_comment": "updated Alternate_Terms, Potential_Mitigations"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2020-12-10T00:00:00Z",
        "modification_comment": "updated Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2021-10-28T00:00:00Z",
        "modification_comment": "updated Relationships"
      }
    ],
    "contribution": [
      {
        "type": "Feedback",
        "contribution_name": "Dan Amodio, Dave Wichers",
        "contribution_organization": "Aspect Security",
        "contribution_date": "2013-01-26T00:00:00Z",
        "contribution_comment": "Suggested adding mass assignment, provided references, and clarified relationship with AutoBinding."
      }
    ]
  },
  "weakness_ordinalities": [
    {
      "ordinality": "Primary"
    }
  ],
  "alternate_terms": [
    {
      "term": "Mass Assignment",
      "description": "\"Mass assignment\" is the name of a feature in Ruby on Rails that allows simultaneous modification of multiple object attributes."
    },
    {
      "term": "AutoBinding",
      "description": "The \"Autobinding\" term is used in frameworks such as Spring MVC and ASP.NET MVC."
    },
    {
      "term": "PHP Object Injection",
      "description": "Some PHP application researchers use this term for attacking unsafe use of the unserialize() function, but it is also used for CWE-502."
    }
  ],
  "notes": [
    {
      "type": "Maintenance",
      "text": "The relationships between CWE-502 and CWE-915 need further exploration. CWE-915 is more narrowly scoped to object modification, and is not necessarily used for deserialization."
    }
  ]
}
