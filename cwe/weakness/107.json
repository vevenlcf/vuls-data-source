{
  "id": "107",
  "name": "Struts: Unused Validation Form",
  "abstraction": "Variant",
  "structure": "Simple",
  "status": "Draft",
  "description": "An unused validation form indicates that validation logic is not up-to-date.",
  "extended_description": "It is easy for developers to forget to update validation logic when they remove or rename action form mappings. One indication that validation logic is not being properly maintained is the presence of an unused validation form.",
  "related_weaknesses": [
    {
      "nature": "ChildOf",
      "cweid": "1164",
      "view_id": "1000",
      "ordinal": "Primary"
    },
    {
      "nature": "ChildOf",
      "cweid": "20",
      "view_id": "700",
      "ordinal": "Primary"
    }
  ],
  "applicable_platforms": {
    "language": [
      {
        "prevalence": "Undetermined",
        "name": "Java"
      }
    ]
  },
  "modes_of_introduction": [
    {
      "phase": "Implementation"
    },
    {
      "phase": "Operation"
    }
  ],
  "common_consequences": [
    {
      "scope": [
        "Other"
      ],
      "impact": [
        "Quality Degradation"
      ]
    }
  ],
  "potential_mitigations": [
    {
      "phase": [
        "Implementation"
      ],
      "description": [
        "Remove the unused Validation Form from the validation.xml file."
      ]
    }
  ],
  "demonstrative_examples": [
    {
      "text": "\n               \u003cIntro_Text\u003eIn the following example the class RegistrationForm is a Struts framework ActionForm Bean that will maintain user input data from a registration webpage for an online business site. The user will enter registration data and, through the Struts framework, the RegistrationForm bean will maintain the user data in the form fields using the private member variables. The RegistrationForm class uses the Struts validation capability by extending the ValidatorForm class and including the validation for the form fields within the validator XML file, validator.xml.\u003c/Intro_Text\u003e\n               \u003cExample_Code Nature=\"bad\" Language=\"Java\"\u003e\n                  \u003cxhtml:div\u003epublic class RegistrationForm extends org.apache.struts.validator.ValidatorForm {\u003cxhtml:br/\u003e\n                     \u003cxhtml:div style=\"margin-left:10px;\"\u003e\n                        \u003cxhtml:div\u003e\n                           \u003cxhtml:br/\u003e\n                           \u003cxhtml:i\u003e// private variables for registration form\u003c/xhtml:i\u003e\n                           \u003cxhtml:br/\u003eprivate String name;\u003cxhtml:br/\u003eprivate String address;\u003cxhtml:br/\u003eprivate String city;\u003cxhtml:br/\u003eprivate String state;\u003cxhtml:br/\u003eprivate String zipcode;\u003cxhtml:br/\u003e\n                           \u003cxhtml:i\u003e// no longer using the phone form field\u003c/xhtml:i\u003e\n                           \u003cxhtml:br/\u003e\n                           \u003cxhtml:br/\u003e\n                           \u003cxhtml:i\u003e// private String phone;\u003c/xhtml:i\u003e\n                           \u003cxhtml:br/\u003eprivate String email;\u003cxhtml:br/\u003e\n                           \u003cxhtml:br/\u003epublic RegistrationForm() {\u003cxhtml:div style=\"margin-left:10px;\"\u003esuper();\u003c/xhtml:div\u003e}\u003cxhtml:br/\u003e\n                           \u003cxhtml:br/\u003e\n                           \u003cxhtml:i\u003e// getter and setter methods for private variables\u003c/xhtml:i\u003e\n                           \u003cxhtml:br/\u003e...\u003c/xhtml:div\u003e\n                     \u003c/xhtml:div\u003e}\u003c/xhtml:div\u003e\n               \u003c/Example_Code\u003e\n               \u003cExample_Code Nature=\"bad\" Language=\"XML\"\u003e\n                  \u003cxhtml:div\u003e\u0026lt;form-validation\u0026gt;\u003cxhtml:div style=\"margin-left:10px;\"\u003e\n                        \u003cxhtml:div\u003e\u0026lt;formset\u0026gt;\u003cxhtml:div style=\"margin-left:10px;\"\u003e\n                              \u003cxhtml:div\u003e\u0026lt;form name=\"RegistrationForm\"\u0026gt;\u003cxhtml:div style=\"margin-left:10px;\"\u003e\n                                    \u003cxhtml:div\u003e\u0026lt;field property=\"name\" depends=\"required\"\u0026gt;\u003cxhtml:div style=\"margin-left:10px;\"\u003e\u0026lt;arg position=\"0\" key=\"prompt.name\"/\u0026gt;\u003c/xhtml:div\u003e\u0026lt;/field\u0026gt;\u003cxhtml:br/\u003e\u0026lt;field property=\"address\" depends=\"required\"\u0026gt;\u003cxhtml:div style=\"margin-left:10px;\"\u003e\u0026lt;arg position=\"0\" key=\"prompt.address\"/\u0026gt;\u003c/xhtml:div\u003e\u0026lt;/field\u0026gt;\u003cxhtml:br/\u003e\u0026lt;field property=\"city\" depends=\"required\"\u0026gt;\u003cxhtml:div style=\"margin-left:10px;\"\u003e\u0026lt;arg position=\"0\" key=\"prompt.city\"/\u0026gt;\u003c/xhtml:div\u003e\u0026lt;/field\u0026gt;\u003cxhtml:br/\u003e\u0026lt;field property=\"state\" depends=\"required,mask\"\u0026gt;\u003cxhtml:div style=\"margin-left:10px;\"\u003e\u0026lt;arg position=\"0\" key=\"prompt.state\"/\u0026gt;\u003cxhtml:br/\u003e\u0026lt;var\u0026gt;\u003cxhtml:div style=\"margin-left:10px;\"\u003e\u0026lt;var-name\u0026gt;mask\u0026lt;/var-name\u0026gt;\u003cxhtml:br/\u003e\u0026lt;var-value\u0026gt;[a-zA-Z]{2}\u0026lt;/var-value\u0026gt;\u003c/xhtml:div\u003e\u0026lt;/var\u0026gt;\u003c/xhtml:div\u003e\u0026lt;/field\u0026gt;\u003cxhtml:br/\u003e\u0026lt;field property=\"zipcode\" depends=\"required,mask\"\u0026gt;\u003cxhtml:div style=\"margin-left:10px;\"\u003e\u0026lt;arg position=\"0\" key=\"prompt.zipcode\"/\u0026gt;\u003cxhtml:br/\u003e\u0026lt;var\u0026gt;\u003cxhtml:div style=\"margin-left:10px;\"\u003e\u0026lt;var-name\u0026gt;mask\u0026lt;/var-name\u0026gt;\u003cxhtml:br/\u003e\u0026lt;var-value\u0026gt;\\d{5}\u0026lt;/var-value\u0026gt;\u003c/xhtml:div\u003e\u0026lt;/var\u0026gt;\u003c/xhtml:div\u003e\u0026lt;/field\u0026gt;\u003cxhtml:br/\u003e\u0026lt;field property=\"phone\" depends=\"required,mask\"\u0026gt;\u003cxhtml:div style=\"margin-left:10px;\"\u003e\u0026lt;arg position=\"0\" key=\"prompt.phone\"/\u0026gt;\u003cxhtml:br/\u003e\u0026lt;var\u0026gt;\u003cxhtml:div style=\"margin-left:10px;\"\u003e\u0026lt;var-name\u0026gt;mask\u0026lt;/var-name\u0026gt;\u003cxhtml:br/\u003e\u0026lt;var-value\u0026gt;^([0-9]{3})(-)([0-9]{4}|[0-9]{4})$\u0026lt;/var-value\u0026gt;\u003c/xhtml:div\u003e\u0026lt;/var\u0026gt;\u003c/xhtml:div\u003e\u0026lt;/field\u0026gt;\u003cxhtml:br/\u003e\u0026lt;field property=\"email\" depends=\"required,email\"\u0026gt;\u003cxhtml:div style=\"margin-left:10px;\"\u003e\u0026lt;arg position=\"0\" key=\"prompt.email\"/\u0026gt;\u003c/xhtml:div\u003e\u0026lt;/field\u0026gt;\u003c/xhtml:div\u003e\n                                 \u003c/xhtml:div\u003e\u0026lt;/form\u0026gt;\u003c/xhtml:div\u003e\n                           \u003c/xhtml:div\u003e\u0026lt;/formset\u0026gt;\u003c/xhtml:div\u003e\n                     \u003c/xhtml:div\u003e\u0026lt;/form-validation\u0026gt;\u003c/xhtml:div\u003e\n               \u003c/Example_Code\u003e\n               \u003cBody_Text\u003eHowever, the validator XML file, validator.xml, for the RegistrationForm class includes the validation form for the user input form field \"phone\" that is no longer used by the input form and the RegistrationForm class. Any validation forms that are no longer required should be removed from the validator XML file, validator.xml.\u003c/Body_Text\u003e\n               \u003cBody_Text\u003eThe existence of unused forms may be an indication to attackers that this code is out of date or poorly maintained.\u003c/Body_Text\u003e\n            "
    }
  ],
  "references": [
    {
      "reference_id": "REF-6",
      "author": [
        "Katrina Tsipenyuk",
        "Brian Chess",
        "Gary McGraw"
      ],
      "title": "Seven Pernicious Kingdoms: A Taxonomy of Software Security Errors",
      "url": "https://samate.nist.gov/SSATTM_Content/papers/Seven%20Pernicious%20Kingdoms%20-%20Taxonomy%20of%20Sw%20Security%20Errors%20-%20Tsipenyuk%20-%20Chess%20-%20McGraw.pdf",
      "publication_year": "2005",
      "publication_month": "--11",
      "publication_day": "---07",
      "publication": "NIST Workshop on Software Security Assurance Tools Techniques and Metrics",
      "publisher": "NIST"
    }
  ],
  "content_history": {
    "submission": {
      "submission_name": "7 Pernicious Kingdoms",
      "submission_date": "2006-07-19T00:00:00Z"
    },
    "modification": [
      {
        "modification_name": "Eric Dalci",
        "modification_organization": "Cigital",
        "modification_date": "2008-07-01T00:00:00Z",
        "modification_comment": "updated Potential_Mitigations, Time_of_Introduction"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2008-09-08T00:00:00Z",
        "modification_comment": "updated Description, Relationships, Taxonomy_Mappings, Weakness_Ordinalities"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2010-06-21T00:00:00Z",
        "modification_comment": "updated Demonstrative_Examples"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2011-06-01T00:00:00Z",
        "modification_comment": "updated Common_Consequences"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2011-06-27T00:00:00Z",
        "modification_comment": "updated Common_Consequences"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2012-05-11T00:00:00Z",
        "modification_comment": "updated Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2012-10-30T00:00:00Z",
        "modification_comment": "updated Potential_Mitigations"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2014-07-30T00:00:00Z",
        "modification_comment": "updated Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2017-11-08T00:00:00Z",
        "modification_comment": "updated Causal_Nature, Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2020-02-24T00:00:00Z",
        "modification_comment": "updated References, Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2022-04-28T00:00:00Z",
        "modification_comment": "updated Relationships"
      }
    ]
  },
  "weakness_ordinalities": [
    {
      "ordinality": "Resultant"
    }
  ],
  "taxonomy_mappings": [
    {
      "taxonomy_name": "7 Pernicious Kingdoms",
      "entry_name": "Struts: Unused Validation Form"
    }
  ]
}
