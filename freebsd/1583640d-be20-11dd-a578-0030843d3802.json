{
  "vid": "1583640d-be20-11dd-a578-0030843d3802",
  "topic": "samba -- potential leakage of arbitrary memory contents",
  "description": "\n\t\u003cp\u003eSamba Team reports:\u003c/p\u003e\n\t\u003cblockquote cite=\"http://www.samba.org/samba/security/CVE-2008-4314.html\"\u003e\n\t  \u003cp\u003eSamba 3.0.29 and beyond contain a change to deal with gcc 4\n\t    optimizations. Part of the change modified range checking for\n\t    client-generated offsets of secondary trans, trans2 and nttrans\n\t    requests. These requests are used to transfer arbitrary amounts\n\t    of memory from clients to servers and back using small SMB\n\t    requests and contain two offsets: One offset (A) pointing into\n\t    the PDU sent by the client and one (B) to direct the transferred\n\t    contents into the buffer built on the server side. While the range\n\t    checking for offset (B) is correct, a cut and paste error lets offset\n\t    (A) pass completely unchecked against overflow.\u003c/p\u003e\n\t  \u003cp\u003eThe buffers passed into trans, trans2 and nttrans undergo higher-level\n\t    processing like DCE/RPC requests or listing directories. The missing\n\t    bounds check means that a malicious client can make the server do this\n\t    higher-level processing on arbitrary memory contents of the smbd process\n\t    handling the request. It is unknown if that can be abused to pass arbitrary\n\t    memory contents back to the client, but an important barrier is missing from\n\t    the affected Samba versions.\u003c/p\u003e\n\t\u003c/blockquote\u003e\n      ",
  "affects": [
    {
      "name": "samba",
      "range": [
        {
          "lt": "3.0.32_2,1",
          "ge": "3.0.29,1"
        }
      ]
    },
    {
      "name": "samba3",
      "range": [
        {
          "lt": "3.0.32_2,1",
          "ge": "3.0.29,1"
        }
      ]
    },
    {
      "name": "ja-samba",
      "range": [
        {
          "lt": "3.0.32_2,1",
          "ge": "3.0.29,1"
        }
      ]
    },
    {
      "name": "samba32-devel",
      "range": [
        {
          "lt": "3.2.4_1"
        }
      ]
    }
  ],
  "dates": {
    "discovery": "2008-11-27T00:00:00Z",
    "entry": "2008-11-29T00:00:00Z"
  },
  "references": [
    {
      "source": "URL",
      "text": "http://www.samba.org/samba/security/CVE-2008-4314.html"
    },
    {
      "source": "URL",
      "text": "http://secunia.com/advisories/32813/"
    },
    {
      "source": "CVE",
      "text": "CVE-2008-4314"
    }
  ]
}
