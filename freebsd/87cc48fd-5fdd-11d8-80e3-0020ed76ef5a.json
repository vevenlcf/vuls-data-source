{
  "vid": "87cc48fd-5fdd-11d8-80e3-0020ed76ef5a",
  "topic": "mnGoSearch buffer overflow in UdmDocToTextBuf()",
  "description": "\n\t\u003cp\u003eJedi/Sector One \u0026lt;j@pureftpd.org\u0026gt; reported the following\n\t  on the full-disclosure list:\u003c/p\u003e\n\t\u003cblockquote\u003e\n\t  \u003cp\u003eEvery document is stored in multiple parts according to\n\t    its sections (description, body, etc) in databases. And\n\t    when the content has to be sent to the client,\n\t    UdmDocToTextBuf() concatenates those parts together and\n\t    skips metadata.\u003c/p\u003e\n\t  \u003cp\u003eUnfortunately, that function lacks bounds checking and\n\t    a buffer overflow can be triggered by indexing a large\n\t    enough document.\u003c/p\u003e\n\t  \u003cp\u003e'len' is fixed to 10K [in UdmDocToTextBuf] in searchd.c\n\t    . S-\u0026gt;val length depends on the length of the original\n\t    document and on the indexer settings (the sample\n\t    configuration file has low limits that work around the\n\t    bug, though).\u003c/p\u003e\n\t  \u003cp\u003eExploitation should be easy, moreover textbuf points to\n\t  the stack.\u003c/p\u003e\n\t\u003c/blockquote\u003e\n      ",
  "affects": [
    {
      "name": "mnogosearch",
      "range": [
        {
          "lt": "3.2.15",
          "ge": "3.2.*"
        }
      ]
    }
  ],
  "dates": {
    "discovery": "2004-02-15T00:00:00Z",
    "entry": "2004-02-15T00:00:00Z"
  },
  "references": [
    {
      "source": "MLIST",
      "text": "http://lists.netsys.com/pipermail/full-disclosure/2004-February/017366.html"
    }
  ]
}
