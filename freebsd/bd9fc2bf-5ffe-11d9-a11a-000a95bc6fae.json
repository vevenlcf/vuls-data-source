{
  "vid": "bd9fc2bf-5ffe-11d9-a11a-000a95bc6fae",
  "topic": "vim -- vulnerabilities in modeline handling",
  "description": "\n\t\u003cp\u003eCiaran McCreesh discovered news ways in which a VIM modeline\n\t  can be used to trojan a text file.  The patch by Bram\n\t  Moolenaar reads:\u003c/p\u003e\n\t\u003cblockquote cite=\"ftp://ftp.vim.org/pub/vim/patches/6.3/6.3.045\"\u003e\n\t  \u003cp\u003eProblem: Unusual characters in an option value may cause\n\t    unexpected behavior, especially for a modeline. (Ciaran\n\t    McCreesh)\u003c/p\u003e\n\t  \u003cp\u003eSolution: Don't allow setting termcap options or\n\t    'printdevice' or 'titleold' in a modeline. Don't list\n\t    options for \"termcap\" and \"all\" in a modeline. Don't allow\n\t    unusual characters in 'filetype', 'syntax', 'backupext',\n\t    'keymap', 'patchmode' and 'langmenu'.\u003c/p\u003e\n\t\u003c/blockquote\u003e\n\t\u003cp\u003e\u003cstrong\u003eNote:\u003c/strong\u003e It is generally recommended that VIM\n\t  users use \u003ccode\u003eset nomodeline\u003c/code\u003e in\n\t  \u003ccode\u003e~/.vimrc\u003c/code\u003e to avoid the possibility of trojaned\n\t  text files.\u003c/p\u003e\n      ",
  "affects": [
    {
      "name": "vim",
      "range": [
        {
          "lt": "6.3.45"
        }
      ]
    },
    {
      "name": "vim-console",
      "range": [
        {
          "lt": "6.3.45"
        }
      ]
    },
    {
      "name": "vim-lite",
      "range": [
        {
          "lt": "6.3.45"
        }
      ]
    },
    {
      "name": "vim+ruby",
      "range": [
        {
          "lt": "6.3.45"
        }
      ]
    }
  ],
  "dates": {
    "discovery": "2004-12-09T00:00:00Z",
    "entry": "2005-01-06T00:00:00Z",
    "modified": "2005-01-13T00:00:00Z"
  },
  "references": [
    {
      "source": "URL",
      "text": "ftp://ftp.vim.org/pub/vim/patches/6.3/6.3.045"
    },
    {
      "source": "CVE",
      "text": "CVE-2004-1138"
    },
    {
      "source": "MLIST",
      "text": "http://groups.yahoo.com/group/vimdev/message/38084"
    }
  ]
}
