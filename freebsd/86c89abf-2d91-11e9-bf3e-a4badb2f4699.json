{
  "vid": "86c89abf-2d91-11e9-bf3e-a4badb2f4699",
  "topic": "FreeBSD -- File description reference count leak",
  "description": "\n\t\u003ch1\u003eProblem Description:\u003c/h1\u003e\n\t\u003cp\u003eFreeBSD 12.0 attempts to handle the case where the\n\treceiving process does not provide a sufficiently large\n\tbuffer for an incoming control message containing rights.\n\tIn particular, to avoid leaking the corresponding descriptors\n\tinto the receiving process' descriptor table, the kernel\n\thandles the truncation case by closing descriptors referenced\n\tby the discarded message.\u003c/p\u003e\n\t\u003cp\u003eThe code which performs this operation failed to release\n\ta reference obtained on the file corresponding to a received\n\tright. This bug can be used to cause the reference counter\n\tto wrap around and free the file structure.\u003c/p\u003e\n\t\u003ch1\u003eImpact:\u003c/h1\u003e\n\t\u003cp\u003eA local user can exploit the bug to gain root privileges\n\tor escape from a jail.\u003c/p\u003e\n      ",
  "affects": [
    {
      "name": "FreeBSD-kernel",
      "range": [
        {
          "lt": "12.0_3",
          "ge": "12.0"
        }
      ]
    }
  ],
  "dates": {
    "discovery": "2019-02-05T00:00:00Z",
    "entry": "2019-02-11T00:00:00Z"
  },
  "references": [
    {
      "source": "CVE",
      "text": "CVE-2019-5596"
    },
    {
      "source": "FreebsdSA",
      "text": "SA-19:02.fd"
    }
  ]
}
