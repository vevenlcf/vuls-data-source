{
  "vid": "ba796b98-b61c-11ec-9ebc-1c697aa5a594",
  "topic": "FreeBSD -- Bhyve e82545 device emulation out-of-bounds write",
  "description": "\n\t\u003ch1\u003eProblem Description:\u003c/h1\u003e\n\t\u003cp\u003eThe e1000 network adapters permit a variety of modifications to an\n\tEthernet packet when it is being transmitted.  These include the\n\tinsertion of IP and TCP checksums, insertion of an Ethernet VLAN\n\theader, and TCP segmentation offload (\"TSO\").  The e1000 device model\n\tuses an on-stack buffer to generate the modified packet header when\n\tsimulating these modifications on transmitted packets.\u003c/p\u003e\n\t\u003cp\u003eWhen checksum offload is requested for a transmitted packet, the\n\te1000 device model used a guest-provided value to specify the checksum\n\toffset in the on-stack buffer.  The offset was not validated for\n\tcertain packet types.\u003c/p\u003e\n\t\u003ch1\u003eImpact:\u003c/h1\u003e\n\t\u003cp\u003eA misbehaving bhyve guest could overwrite memory in the bhyve\n\tprocess on the host, possibly leading to code execution in the host\n\tcontext.\u003c/p\u003e\n\t\u003cp\u003eThe bhyve process runs in a Capsicum sandbox, which (depending on\n\tthe FreeBSD version and bhyve configuration) limits the impact of\n\texploiting this issue.\u003c/p\u003e\n      ",
  "affects": [
    {
      "name": "FreeBSD-kernel",
      "range": [
        {
          "lt": "13.0_11",
          "ge": "13.0"
        },
        {
          "lt": "12.3_5",
          "ge": "12.3"
        }
      ]
    }
  ],
  "dates": {
    "discovery": "2022-04-06T00:00:00Z",
    "entry": "2022-04-07T00:00:00Z"
  },
  "references": [
    {
      "source": "CVE",
      "text": "CVE-2022-23087"
    },
    {
      "source": "FreebsdSA",
      "text": "SA-22:05.bhyve"
    }
  ]
}
