{
  "vid": "a81746a1-c2c7-11d9-89f7-02061b08fc24",
  "topic": "mozilla -- \"Wrapped\" javascript: urls bypass security checks",
  "description": "\n\t\u003cp\u003eA Mozilla Foundation Security Advisory reports:\u003c/p\u003e\n\t\u003cblockquote cite=\"http://www.mozilla.org/security/announce/mfsa2005-43.html\"\u003e\n\t  \u003cp\u003eSome security checks intended to prevent script injection\n\t    were incorrect and could be bypassed by wrapping a\n\t    javascript: url in the view-source:\n\t    pseudo-protocol. Michael Krax demonstrated that a variant\n\t    of his \u003ca href=\"http://www.mozilla.org/security/announce/mfsa2005-37.html\"\u003efavicon\u003c/a\u003e\n\t    exploit could still execute arbitrary code, and the same\n\t    technique could also be used to perform cross-site\n\t    scripting.\u003c/p\u003e\n\t  \u003cp\u003eGeorgi Guninski demonstrated the same flaw wrapping\n\t    javascript: urls with the jar: pseudo-protocol.\u003c/p\u003e\n\t  \u003cp\u003eL. David Baron discovered a nested variant that defeated\n\t    checks in the script security manager.\u003c/p\u003e\n\t  \u003cp\u003e\u003cstrong\u003eWorkaround:\u003c/strong\u003e Disable Javascript\u003c/p\u003e\n\t\u003c/blockquote\u003e\n      ",
  "affects": [
    {
      "name": "firefox",
      "range": [
        {
          "lt": "1.0.4,1"
        }
      ]
    },
    {
      "name": "linux-firefox",
      "range": [
        {
          "lt": "1.0.4"
        }
      ]
    },
    {
      "name": "mozilla",
      "range": [
        {
          "lt": "1.7.8,2"
        },
        {
          "ge": "1.8.*,2"
        }
      ]
    },
    {
      "name": "linux-mozilla",
      "range": [
        {
          "lt": "1.7.8"
        },
        {
          "ge": "1.8.*"
        }
      ]
    },
    {
      "name": "linux-mozilla-devel",
      "range": [
        {
          "lt": "1.7.8"
        },
        {
          "ge": "1.8.*"
        }
      ]
    },
    {
      "name": "netscape7",
      "range": [
        {
          "ge": "0"
        }
      ]
    },
    {
      "name": "de-linux-mozillafirebird",
      "range": [
        {
          "ge": "0"
        }
      ]
    },
    {
      "name": "el-linux-mozillafirebird",
      "range": [
        {
          "ge": "0"
        }
      ]
    },
    {
      "name": "ja-linux-mozillafirebird-gtk1",
      "range": [
        {
          "ge": "0"
        }
      ]
    },
    {
      "name": "ja-mozillafirebird-gtk2",
      "range": [
        {
          "ge": "0"
        }
      ]
    },
    {
      "name": "linux-mozillafirebird",
      "range": [
        {
          "ge": "0"
        }
      ]
    },
    {
      "name": "ru-linux-mozillafirebird",
      "range": [
        {
          "ge": "0"
        }
      ]
    },
    {
      "name": "zhCN-linux-mozillafirebird",
      "range": [
        {
          "ge": "0"
        }
      ]
    },
    {
      "name": "zhTW-linux-mozillafirebird",
      "range": [
        {
          "ge": "0"
        }
      ]
    },
    {
      "name": "de-linux-netscape",
      "range": [
        {
          "ge": "0"
        }
      ]
    },
    {
      "name": "de-netscape7",
      "range": [
        {
          "ge": "0"
        }
      ]
    },
    {
      "name": "fr-linux-netscape",
      "range": [
        {
          "ge": "0"
        }
      ]
    },
    {
      "name": "fr-netscape7",
      "range": [
        {
          "ge": "0"
        }
      ]
    },
    {
      "name": "ja-linux-netscape",
      "range": [
        {
          "ge": "0"
        }
      ]
    },
    {
      "name": "ja-netscape7",
      "range": [
        {
          "ge": "0"
        }
      ]
    },
    {
      "name": "linux-netscape",
      "range": [
        {
          "ge": "0"
        }
      ]
    },
    {
      "name": "linux-phoenix",
      "range": [
        {
          "ge": "0"
        }
      ]
    },
    {
      "name": "mozilla+ipv6",
      "range": [
        {
          "ge": "0"
        }
      ]
    },
    {
      "name": "mozilla-embedded",
      "range": [
        {
          "ge": "0"
        }
      ]
    },
    {
      "name": "mozilla-firebird",
      "range": [
        {
          "ge": "0"
        }
      ]
    },
    {
      "name": "mozilla-gtk1",
      "range": [
        {
          "ge": "0"
        }
      ]
    },
    {
      "name": "mozilla-gtk2",
      "range": [
        {
          "ge": "0"
        }
      ]
    },
    {
      "name": "mozilla-gtk",
      "range": [
        {
          "ge": "0"
        }
      ]
    },
    {
      "name": "mozilla-thunderbird",
      "range": [
        {
          "ge": "0"
        }
      ]
    },
    {
      "name": "phoenix",
      "range": [
        {
          "ge": "0"
        }
      ]
    },
    {
      "name": "pt_BR-netscape7",
      "range": [
        {
          "ge": "0"
        }
      ]
    }
  ],
  "dates": {
    "discovery": "2005-05-11T00:00:00Z",
    "entry": "2005-05-12T00:00:00Z"
  },
  "references": [
    {
      "source": "URL",
      "text": "http://www.mozilla.org/security/announce/mfsa2005-43.html"
    }
  ]
}
