{
  "vid": "1cf00643-ed8a-11d9-8310-0001020eed82",
  "topic": "cacti -- multiple vulnerabilities",
  "description": "\n\t\u003cp\u003eStefan Esser reports:\u003c/p\u003e\n\t\u003cblockquote cite=\"http://www.hardened-php.net/advisory-032005.php\"\u003e\n\t  \u003cp\u003eWrongly implemented user input filters lead to multiple\n\t    SQL Injection vulnerabilities which can lead f.e. to\n\t    disclosure of the admin password hash.\u003c/p\u003e\n\t\u003c/blockquote\u003e\n\t\u003cblockquote cite=\"http://www.hardened-php.net/advisory-042005.php\"\u003e\n\t  \u003cp\u003eWrongly implemented user input filters allows injection\n\t    of user input into executed commandline.\u003c/p\u003e\n\t  \u003cp\u003eAlberto Trivero posted his Remote Command Execution\n\t    Exploit for Cacti \u0026lt;= 0.8.6d to Bugtraq on the 22th\n\t    June. Having analysed his bug we come to the conclusion,\n\t    that the malfunctioning input filters, which were already\n\t    mentioned in the previous advisory are also responsible\n\t    for this bug still being exploitable.\u003c/p\u003e\n\t\u003c/blockquote\u003e\n\t\u003cblockquote cite=\"http://www.hardened-php.net/advisory-052005.php\"\u003e\n\t  \u003cp\u003eA HTTP headers bypass switch can also be used to\n\t    completely bypass the authentification system of Cacti. As\n\t    admin it is possible to execute shell commands with the\n\t    permission of the webserver.\u003c/p\u003e\n\t  \u003cp\u003eWhile looking at the source of Cacti a HTTP headers\n\t    bypass switch was discovered, that also switches off a\n\t    call to \u003ccode\u003esession_start()\u003c/code\u003e and the manual\n\t    application of \u003ccode\u003eaddslashes()\u003c/code\u003e in case of\n\t    \u003ccode\u003emagic_quotes_gpc=Off\u003c/code\u003e.\u003c/p\u003e\n\t  \u003cp\u003eWhen register_globals is turned on* an attacker can use\n\t    this switch to disables Cacti's use of PHP's session\n\t    support and therefore supply the session variables on his\n\t    own through f.e.  the URL. Additionally using the switch\n\t    renders several SQL statements vulnerable to SQL\n\t    Injections attacks, when magic_quotes_gpc is turned off,\n\t    which is the recommended setting.\u003c/p\u003e\n\t  \u003cp\u003eLogged in as an admin it is possible to issue shell\n\t    commands.\u003c/p\u003e\n\t  \u003cp\u003e(*) register_globals is turned off by default since PHP\n\t    4.2 but is activated on most servers because of older\n\t    scripts requiring it.\u003c/p\u003e\n\t\u003c/blockquote\u003e\n      ",
  "affects": [
    {
      "name": "cacti",
      "range": [
        {
          "lt": "0.8.6f"
        }
      ]
    }
  ],
  "dates": {
    "discovery": "2005-06-22T00:00:00Z",
    "entry": "2005-07-05T00:00:00Z"
  },
  "references": [
    {
      "source": "URL",
      "text": "http://www.hardened-php.net/advisory-032005.php"
    },
    {
      "source": "URL",
      "text": "http://www.hardened-php.net/advisory-042005.php"
    },
    {
      "source": "URL",
      "text": "http://www.hardened-php.net/advisory-052005.php"
    },
    {
      "source": "MLIST: 007301c57753$5ab17f60$0100a8c0@alberto",
      "text": "http://marc.theaimsgroup.com/?l=bugtraq\u0026m=111954136315248"
    }
  ]
}
