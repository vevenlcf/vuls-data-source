{
  "vid": "4b478274-47a0-11ec-bd24-6c3be5272acd",
  "topic": "Grafana -- XSS",
  "description": "\n\t\u003cp\u003eGrafana Labs reports:\u003c/p\u003e\n\t\u003cblockquote cite=\"https://grafana.com/blog/2021/11/03/grafana-8.2.3-released-with-medium-severity-security-fix-cve-2021-41174-grafana-xss/\"\u003e\n\t  \u003cp\u003eIf an attacker is able to convince a victim to visit a URL referencing a vulnerable page, arbitrary JavaScript content may be executed within the context of the victim’s browser.\u003c/p\u003e\n\t  \u003cp\u003eThe user visiting the malicious link must be unauthenticated, and the link must be for a page that contains the login button in the menu bar.\u003c/p\u003e\n\t  \u003cp\u003eThere are two ways an unauthenticated user can open a page in Grafana that contains the login button:\u003c/p\u003e\n\t  \u003cul\u003e\n\t    \u003cli\u003eAnonymous authentication is enabled. This means all pages in Grafana would be open for the attack.\u003c/li\u003e\n\t    \u003cli\u003eThe link is to an unauthenticated page. The following pages are vulnerable:\n\t      \u003cul\u003e\n\t\t\u003cli\u003e\u003ccode\u003e/dashboard-solo/snapshot/*\u003c/code\u003e\u003c/li\u003e\n\t\t\u003cli\u003e\u003ccode\u003e/dashboard/snapshot/*\u003c/code\u003e\u003c/li\u003e\n\t\t\u003cli\u003e\u003ccode\u003e/invite/:code\u003c/code\u003e\u003c/li\u003e\n\t      \u003c/ul\u003e\n\t    \u003c/li\u003e\n\t  \u003c/ul\u003e\n\t  \u003cp\u003eThe url has to be crafted to exploit AngularJS rendering and contain the interpolation binding for AngularJS expressions. AngularJS uses double curly braces for interpolation binding: \u003ccode\u003e{{ }}\u003c/code\u003e\u003c/p\u003e\n\t  \u003cp\u003eAn example of an expression would be: \u003ccode\u003e{{constructor.constructor(‘alert(1)’)()}}\u003c/code\u003e. This can be included in the link URL like this:\u003c/p\u003e\n\t  \u003cp\u003e\u003ca href=\"https://play.grafana.org/dashboard/snapshot/%7B%7Bconstructor.constructor('alert(1)')()%7D%7D?orgId=1\"\u003ehttps://play.grafana.org/dashboard/snapshot/%7B%7Bconstructor.constructor('alert(1)')()%7D%7D?orgId=1\u003c/a\u003e\u003c/p\u003e\n\t  \u003cp\u003eWhen the user follows the link and the page renders, the login button will contain the original link with a query parameter to force a redirect to the login page. The URL is not validated, and the AngularJS rendering engine will execute the JavaScript expression contained in the URL.\u003c/p\u003e\n\t\u003c/blockquote\u003e\n      ",
  "affects": [
    {
      "name": "grafana8",
      "range": [
        {
          "lt": "8.2.3",
          "ge": "8.0.0"
        }
      ]
    },
    {
      "name": "grafana",
      "range": [
        {
          "lt": "8.2.3",
          "ge": "8.0.0"
        }
      ]
    }
  ],
  "dates": {
    "discovery": "2021-10-21T00:00:00Z",
    "entry": "2021-12-11T00:00:00Z"
  },
  "references": [
    {
      "source": "URL",
      "text": "https://grafana.com/blog/2021/11/03/grafana-8.2.3-released-with-medium-severity-security-fix-cve-2021-41174-grafana-xss/"
    },
    {
      "source": "CVE",
      "text": "CVE-2021-41174"
    }
  ]
}
