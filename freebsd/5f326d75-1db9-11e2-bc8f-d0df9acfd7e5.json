{
  "vid": "5f326d75-1db9-11e2-bc8f-d0df9acfd7e5",
  "topic": "django -- multiple vulnerabilities",
  "description": "\n\t\u003cp\u003eThe Django Project reports:\u003c/p\u003e\n\t\u003cblockquote cite=\"https://www.djangoproject.com/weblog/2012/oct/17/security/\"\u003e\n\t\u003col\u003e\n\t  \u003cli\u003e\n\t  \u003cp\u003eHost header poisoning\u003c/p\u003e\n\t  \u003cp\u003eSome parts of Django -- independent of end-user-written applications\n\t     -- make use of full URLs, including domain name, which are generated\n\t     from the HTTP Host header. Some attacks against this are beyond Django's\n\t     ability to control, and require the web server to be properly configured;\n\t     Django's documentation has for some time contained notes advising users\n\t     on such configuration.\u003c/p\u003e\n\t  \u003cp\u003eDjango's own built-in parsing of the Host header is, however, still\n\t     vulnerable, as was reported to us recently. The Host header parsing\n\t     in Django 1.3 and Django 1.4 -- specifically, django.http.HttpRequest.get_host()\n\t     -- was incorrectly handling username/password information in the header.\n\t     Thus, for example, the following Host header would be accepted by Django when\n\t     running on \"validsite.com\":\u003c/p\u003e\n\t  \u003cp\u003eHost: validsite.com:random@evilsite.com\u003c/p\u003e\n\t  \u003cp\u003eUsing this, an attacker can cause parts of Django -- particularly the\n\t     password-reset mechanism -- to generate and display arbitrary URLs to users.\u003c/p\u003e\n\t  \u003cp\u003eTo remedy this, the parsing in HttpRequest.get_host() is being modified; Host\n\t     headers which contain potentially dangerous content (such as username/password\n\t     pairs) now raise the exception django.core.exceptions.SuspiciousOperation.\u003c/p\u003e\n\t  \u003c/li\u003e\n\t  \u003cli\u003e\n\t  \u003cp\u003eDocumentation of HttpOnly cookie option\u003c/p\u003e\n\t  \u003cp\u003eAs of Django 1.4, session cookies are always sent with the HttpOnly flag, which\n\t     provides some additional protection from cross-site scripting attacks by denying\n\t     client-side scripts access to the session cookie.\u003c/p\u003e\n\t  \u003cp\u003eThough not directly a security issue in Django, it has been reported that the\n\t     Django 1.4 documentation incorrectly described this change, by claiming that this\n\t     was now the default for all cookies set by the HttpResponse.set_cookie() method.\u003c/p\u003e\n\t  \u003cp\u003eThe Django documentation has been updated to reflect that this only applies to the\n\t     session cookie. Users of Django are encouraged to review their use of set_cookie()\n\t     to ensure that the HttpOnly flag is being set or unset appropriately.\u003c/p\u003e\n\t  \u003c/li\u003e\n\t  \u003c/ol\u003e\n\t\u003c/blockquote\u003e\n      ",
  "affects": [
    {
      "name": "django",
      "range": [
        {
          "lt": "1.4.2"
        }
      ]
    },
    {
      "name": "django13",
      "range": [
        {
          "lt": "1.3.4"
        }
      ]
    }
  ],
  "dates": {
    "discovery": "2012-10-17T00:00:00Z",
    "entry": "2012-10-24T00:00:00Z"
  },
  "references": [
    {
      "source": "URL",
      "text": "https://www.djangoproject.com/weblog/2012/oct/17/security/"
    },
    {
      "source": "CVE",
      "text": "CVE-2012-4520"
    }
  ]
}
