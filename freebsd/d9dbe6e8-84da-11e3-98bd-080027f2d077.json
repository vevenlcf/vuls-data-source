{
  "vid": "d9dbe6e8-84da-11e3-98bd-080027f2d077",
  "topic": "varnish -- DoS vulnerability in Varnish HTTP cache",
  "description": "\n\t\u003cp\u003eVarnish Cache Project reports:\u003c/p\u003e\n\t\u003cblockquote cite=\"https://www.varnish-cache.org/lists/pipermail/varnish-announce/2013-October/000686.html\"\u003e\n\t  \u003cp\u003eIf Varnish receives a certain illegal request, and the subroutine\n\t    'vcl_error{}' restarts the request, the varnishd worker process\n\t    will crash with an assert.\n\t  \u003c/p\u003e\n\t  \u003cp\u003eThe varnishd management process will restart the worker process, but\n\t    there will be a brief interruption of service and the cache will be\n\t    emptied, causing more traffic to go to the backend.\n\t  \u003c/p\u003e\n\t  \u003cp\u003eWe are releasing this advisory because restarting from vcl_error{} is\n\t    both fairly common and documented.\u003c/p\u003e\n\t  \u003cp\u003eThis is purely a denial of service vulnerability, there is no risk of\n\t    privilege escalation.\u003c/p\u003e\n\t  \u003cp\u003eWorkaround\u003c/p\u003e\n\t  \u003cp\u003eInsert this at the top of your VCL file:\u003c/p\u003e\n\t  \u003cpre\u003e\n\t\tsub vcl_error {\n\t\t\tif (obj.status == 400 || obj.status == 413) {\n\t\t\t\treturn(deliver);\n\t\t\t}\n\t\t}\n\n\t\tOr add this test at the top of your existing vcl_error{}.\n\t  \u003c/pre\u003e\n\t\u003c/blockquote\u003e\n      ",
  "affects": [
    {
      "name": "varnish",
      "range": [
        {
          "lt": "3.0.5"
        }
      ]
    }
  ],
  "dates": {
    "discovery": "2013-10-30T00:00:00Z",
    "entry": "2014-01-25T00:00:00Z"
  },
  "references": [
    {
      "source": "CVE",
      "text": "CVE-2013-4484"
    },
    {
      "source": "MLIST",
      "text": "https://www.varnish-cache.org/lists/pipermail/varnish-announce/2013-October/000686.html"
    }
  ]
}
