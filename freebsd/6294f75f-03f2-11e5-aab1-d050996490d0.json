{
  "vid": "6294f75f-03f2-11e5-aab1-d050996490d0",
  "topic": "cURL -- multiple vulnerabilities",
  "description": "\n\t\u003cp\u003ecURL reports:\u003c/p\u003e\n\t\u003cblockquote cite=\"http://curl.haxx.se/docs/adv_20150422A.html\"\u003e\n\t  \u003cp\u003elibcurl keeps a pool of its last few connections around\n\t    after use to facilitate easy, convenient, and completely\n\t    transparent connection re-use for applications.\u003c/p\u003e\n\t  \u003cp\u003eWhen doing HTTP requests NTLM authenticated, the entire\n\t    connection becomes authenticated and not just the\n\t    specific HTTP request which is otherwise how HTTP works.\n\t    This makes NTLM special and a subject for special\n\t    treatment in the code. With NTLM, once the connection is\n\t    authenticated, no further authentication is necessary until\n\t    the connection gets closed.\u003c/p\u003e\n\t\u003c/blockquote\u003e\n\t\u003cblockquote cite=\"http://curl.haxx.se/docs/adv_20150422B.html\"\u003e\n\t  \u003cp\u003eWhen doing HTTP requests Negotiate authenticated, the\n\t    entire connection may become authenticated and not just\n\t    the specific HTTP request which is otherwise how HTTP\n\t    works, as Negotiate can basically use NTLM under the hood.\n\t    curl was not adhering to this fact but would assume that\n\t    such requests would also be authenticated per request.\u003c/p\u003e\n\t\u003c/blockquote\u003e\n\t\u003cblockquote cite=\"http://curl.haxx.se/docs/adv_20150422C.html\"\u003e\n\t  \u003cp\u003elibcurl supports HTTP \"cookies\" as documented in RFC 6265.\n\t    Together with each individual cookie there are several\n\t    different properties, but for this vulnerability we\n\t    focus on the associated \"path\" element. It tells\n\t    information about for which path on a given host the\n\t    cookies is valid.\u003c/p\u003e\n\t  \u003cp\u003eThe internal libcurl function called sanitize_cookie_path()\n\t    that cleans up the path element as given to it from a\n\t    remote site or when read from a file, did not properly\n\t    validate the input. If given a path that consisted of a\n\t    single double-quote, libcurl would index a newly\n\t    allocated memory area with index -1 and assign a zero\n\t    to it, thus destroying heap memory it wasn't supposed to.\u003c/p\u003e\n\t\u003c/blockquote\u003e\n\t\u003cblockquote cite=\"http://curl.haxx.se/docs/adv_20150422D.html\"\u003e\n\t  \u003cp\u003eThere is a private function in libcurl called fix_hostname()\n\t    that removes a trailing dot from the host name if there is\n\t    one. The function is called after the host name has been\n\t    extracted from the URL libcurl has been told to act on.\u003c/p\u003e\n\t  \u003cp\u003eIf a URL is given with a zero-length host name, like in\n\t    \"http://:80\" or just \":80\", fix_hostname() will index the\n\t    host name pointer with a -1 offset (as it blindly assumes\n\t    a non-zero length) and both read and assign that address.\u003c/p\u003e\n\t\u003c/blockquote\u003e\n      ",
  "affects": [
    {
      "name": "curl",
      "range": [
        {
          "lt": "7.42.0"
        }
      ]
    }
  ],
  "dates": {
    "discovery": "2015-04-22T00:00:00Z",
    "entry": "2015-05-26T00:00:00Z"
  },
  "references": [
    {
      "source": "URL",
      "text": "http://curl.haxx.se/docs/adv_20150422A.html"
    },
    {
      "source": "URL",
      "text": "http://curl.haxx.se/docs/adv_20150422B.html"
    },
    {
      "source": "URL",
      "text": "http://curl.haxx.se/docs/adv_20150422C.html"
    },
    {
      "source": "URL",
      "text": "http://curl.haxx.se/docs/adv_20150422D.html"
    },
    {
      "source": "CVE",
      "text": "CVE-2014-3143"
    },
    {
      "source": "CVE",
      "text": "CVE-2014-3144"
    },
    {
      "source": "CVE",
      "text": "CVE-2014-3145"
    },
    {
      "source": "CVE",
      "text": "CVE-2014-3148"
    }
  ]
}
