{
  "vid": "abcc5ad3-7e6a-11e7-93f7-d43d7e971a1b",
  "topic": "GitLab -- two vulnerabilities",
  "description": "\n\t\u003cp\u003eGitLab reports:\u003c/p\u003e\n\t\u003cblockquote cite=\"https://about.gitlab.com/2017/08/10/gitlab-9-dot-4-dot-4-released/\"\u003e\n    \u003ch1\u003eRemote Command Execution in git client\u003c/h1\u003e\n\t  \u003cp\u003eAn external code review performed by Recurity-Labs identified a remote\n\t  command execution vulnerability in git that could be exploited via the \"Repo\n\t  by URL\" import option in GitLab. The command line git client was not\n\t  properly escaping command line arguments in URLs using the SSH protocol\n\t  before invoking the SSH client. A specially crafted URL could be used to\n\t  execute arbitrary shell commands on the GitLab server.\u003cbr/\u003e\n    To fully patch this vulnerability two fixes were needed. The Omnibus\n    versions of GitLab contain a patched git client. For source users who may\n    still be running an older version of git, GitLab now also blocks import URLs\n    containing invalid host and usernames.\u003cbr/\u003e\n    This issue has been assigned CVE-2017-12426.\u003c/p\u003e\n    \u003ch1\u003eImproper sanitization of GitLab export files on import\u003c/h1\u003e\n    \u003cp\u003eGitLab versions 8.13.3, 8.12.8, 8.11.10, 8.10.13, and 8.9.12 contained a\n    patch for a critical directory traversal vulnerability in the GitLab export\n    feature that could be exploited by including symlinks in the export file and\n    then re-importing it to a GitLab instance. This vulnerability was patched by\n    checking for and removing symlinks in these files on import.\u003cbr/\u003e\n    Recurity-Labs also determined that this fix did not properly remove symlinks for\n    hidden files. Though not as dangerous as the original vulnerability hidden file\n    symlinks could still be used to steal copies of git repositories belonging to\n    other users if the path to the git repository was known by the attacker. An\n    updated fix has been included in these releases that properly removes all\n    symlinks.\u003cbr/\u003e\n    This import option was not made available to non-admin users until GitLab\n    8.13.0.\u003c/p\u003e\n\t\u003c/blockquote\u003e\n      ",
  "affects": [
    {
      "name": "gitlab",
      "range": [
        {
          "ge": "7.9.0",
          "le": "8.17.8"
        },
        {
          "ge": "9.0.0",
          "le": "9.0.12"
        },
        {
          "ge": "9.1.0",
          "le": "9.1.9"
        },
        {
          "ge": "9.2.0",
          "le": "9.2.9"
        },
        {
          "ge": "9.3.0",
          "le": "9.3.9"
        },
        {
          "ge": "9.4.0",
          "le": "9.4.3"
        }
      ]
    }
  ],
  "dates": {
    "discovery": "2017-08-10T00:00:00Z",
    "entry": "2017-08-11T00:00:00Z"
  },
  "references": [
    {
      "source": "URL",
      "text": "https://about.gitlab.com/2017/08/10/gitlab-9-dot-4-dot-4-released/"
    },
    {
      "source": "CVE",
      "text": "CVE-2017-12426"
    }
  ]
}
