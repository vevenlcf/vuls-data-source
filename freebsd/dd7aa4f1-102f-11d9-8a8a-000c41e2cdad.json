{
  "vid": "dd7aa4f1-102f-11d9-8a8a-000c41e2cdad",
  "topic": "php -- memory_limit related vulnerability",
  "description": "\n\t\u003cp\u003eStefan Esser of e-matters discovered a condition within PHP\n\t  that may lead to remote execution of arbitrary code.\tThe\n\t  memory_limit facility is used to notify functions when memory\n\t  contraints have been met. Under certain conditions, the entry\n\t  into this facility is able to interrupt functions such as\n\t  zend_hash_init() at locations not suitable for interruption.\n\t  The result would leave these functions in a vulnerable state.\u003c/p\u003e\n\t\u003cblockquote cite=\"http://security.e-matters.de/advisories/112004.html\"\u003e\n\t  \u003cp\u003eAn attacker that is able to trigger the memory_limit abort\n\t    within zend_hash_init() and is additionally able to control\n\t    the heap before the HashTable itself is allocated, is able to\n\t    supply his own HashTable destructor pointer. [...]\u003c/p\u003e\n\t  \u003cp\u003eAll mentioned places outside of the extensions are quite easy\n\t    to exploit, because the memory allocation up to those places\n\t    is deterministic and quite static throughout different PHP\n\t    versions. [...]\u003c/p\u003e\n\t  \u003cp\u003eBecause the exploit itself consist of supplying an arbitrary\n\t    destructor pointer this bug is exploitable on any platform.\u003c/p\u003e\n\t\u003c/blockquote\u003e\n      ",
  "affects": [
    {
      "name": "mod_php4-twig",
      "range": [
        {
          "le": "4.3.7_3"
        }
      ]
    },
    {
      "name": "php4",
      "range": [
        {
          "le": "4.3.7_3"
        }
      ]
    },
    {
      "name": "php4-cgi",
      "range": [
        {
          "le": "4.3.7_3"
        }
      ]
    },
    {
      "name": "php4-cli",
      "range": [
        {
          "le": "4.3.7_3"
        }
      ]
    },
    {
      "name": "php4-dtc",
      "range": [
        {
          "le": "4.3.7_3"
        }
      ]
    },
    {
      "name": "php4-horde",
      "range": [
        {
          "le": "4.3.7_3"
        }
      ]
    },
    {
      "name": "php4-nms",
      "range": [
        {
          "le": "4.3.7_3"
        }
      ]
    },
    {
      "name": "mod_php4",
      "range": [
        {
          "le": "4.3.7_3,1"
        }
      ]
    },
    {
      "name": "php5",
      "range": [
        {
          "le": "5.0.0.r3_2"
        }
      ]
    },
    {
      "name": "php5-cgi",
      "range": [
        {
          "le": "5.0.0.r3_2"
        }
      ]
    },
    {
      "name": "php5-cli",
      "range": [
        {
          "le": "5.0.0.r3_2"
        }
      ]
    },
    {
      "name": "mod_php5",
      "range": [
        {
          "le": "5.0.0.r3_2,1"
        }
      ]
    }
  ],
  "dates": {
    "discovery": "2004-07-07T00:00:00Z",
    "entry": "2004-09-27T00:00:00Z",
    "modified": "2004-10-02T00:00:00Z"
  },
  "references": [
    {
      "source": "URL",
      "text": "http://security.e-matters.de/advisories/112004.html"
    },
    {
      "source": "CVE",
      "text": "CVE-2004-0594"
    },
    {
      "source": "MLIST: 20040713225329.GA26865@e-matters.de",
      "text": "http://marc.theaimsgroup.com/?l=bugtraq\u0026m=108981780109154"
    },
    {
      "source": "BID",
      "text": "10725"
    }
  ]
}
