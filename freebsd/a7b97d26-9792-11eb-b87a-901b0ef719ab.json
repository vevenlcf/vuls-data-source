{
  "vid": "a7b97d26-9792-11eb-b87a-901b0ef719ab",
  "topic": "FreeBSD -- jail escape possible by mounting over jail root",
  "description": "\n\t\u003ch1\u003eProblem Description:\u003c/h1\u003e\n\t\u003cp\u003eDue to a race condition between lookup of \"..\" and remounting a filesystem,\n\ta process running inside a jail might access filesystem hierarchy outside\n\tof jail.\u003c/p\u003e\n\t\u003ch1\u003eImpact:\u003c/h1\u003e\n\t\u003cp\u003eA process with superuser privileges running inside a jail configured\n\twith the allow.mount permission (not enabled by default) could change the root\n\tdirectory outside of the jail, and thus gain full read and write access\n\tto all files and directories in the system.\u003c/p\u003e\n      ",
  "affects": [
    {
      "name": "FreeBSD-kernel",
      "range": [
        {
          "lt": "12.2_6",
          "ge": "12.2"
        },
        {
          "lt": "11.4_9",
          "ge": "11.4"
        }
      ]
    }
  ],
  "dates": {
    "discovery": "2021-04-06T00:00:00Z",
    "entry": "2021-04-07T00:00:00Z"
  },
  "references": [
    {
      "source": "CVE",
      "text": "CVE-2020-25584"
    },
    {
      "source": "FreebsdSA",
      "text": "SA-21:10.jail_mount"
    }
  ]
}
