{
  "vid": "b905dff4-e227-11ea-b0ea-08002728f74c",
  "topic": "curl -- expired pointer dereference vulnerability",
  "description": "\n\t\u003cp\u003ecurl security problems:\u003c/p\u003e\n\t\u003cblockquote cite=\"https://curl.haxx.se/docs/security.html\"\u003e\n\t  \u003cp\u003eCVE-2020-8231: wrong connect-only connection\u003c/p\u003e\n\t  \u003cp\u003eAn application that performs multiple requests with libcurl's multi API\n\t    and sets the CURLOPT_CONNECT_ONLY option, might in rare circumstances\n\t    experience that when subsequently using the setup connect-only transfer,\n\t    libcurl will pick and use the wrong connection - and instead pick\n\t    another one the application has created since then.\u003c/p\u003e\n\t  \u003cp\u003eCURLOPT_CONNECT_ONLY is the option to tell libcurl to not perform an\n\t    actual transfer, only connect. When that operation is completed, libcurl\n\t    remembers which connection it used for that transfer and \"easy handle\".\n\t    It remembers the connection using a pointer to the internal connectdata\n\t    struct in memory.\u003c/p\u003e\n\t  \u003cp\u003eIf more transfers are then done with the same multi handle before the\n\t    connect-only connection is used, leading to the initial connect-only\n\t    connection to get closed (for example due to idle time-out) while also\n\t    new transfers (and connections) are setup, such a new connection might\n\t    end up getting the exact same memory address as the now closed\n\t    connect-only connection.\u003c/p\u003e\n\t  \u003cp\u003eIf after those operations, the application then wants to use the\n\t    original transfer's connect-only setup to for example use\n\t    curl_easy_send() to send raw data over that connection, libcurl could\n\t    erroneously find an existing connection still being alive at the address\n\t    it remembered since before even though this is now a new and different\n\t    connection.\u003c/p\u003e\n\t  \u003cp\u003eThe application could then accidentally send data over that connection\n\t    which wasn't at all intended for that recipient, entirely unknowingly.\u003c/p\u003e\n\t\u003c/blockquote\u003e\n      ",
  "affects": [
    {
      "name": "curl",
      "range": [
        {
          "lt": "7.72.0",
          "ge": "7.29.0"
        }
      ]
    }
  ],
  "dates": {
    "discovery": "2020-08-19T00:00:00Z",
    "entry": "2020-08-19T00:00:00Z"
  },
  "references": [
    {
      "source": "URL",
      "text": "https://curl.haxx.se/docs/security.html"
    },
    {
      "source": "URL",
      "text": "https://curl.haxx.se/docs/CVE-2020-8231.html"
    },
    {
      "source": "CVE",
      "text": "CVE-2020-8231"
    }
  ]
}
