{
  "vid": "22f00553-a09d-11d9-a788-0001020eed82",
  "topic": "portupgrade -- insecure temporary file handling vulnerability",
  "description": "\n\t\u003cp\u003eSimon L. Nielsen discovered that portupgrade handles\n\t  temporary files in an insecure manner.  This could allow an\n\t  unprivileged local attacker to execute arbitrary commands or\n\t  overwrite arbitrary files with the permissions of the user\n\t  running portupgrade, typically root, by way of a symlink\n\t  attack.\u003c/p\u003e\n\t\u003cp\u003eThe following issues exist where the temporary files are\n\t  created, by default in the world writeable directory\n\t  /var/tmp, with the permissions of the user running\n\t  portupgrade:\u003c/p\u003e\n\t\u003cul\u003e\n\t  \u003cli\u003epkg_fetch download packages with a predictable local\n\t    filename allowing a local attacker to overwrite arbitrary\n\t    local files or potentially replace the downloaded package\n\t    after download but before install with a package with\n\t    malicious content, allowing the attacker to run arbitrary\n\t    commands.\u003c/li\u003e\n\t  \u003cli\u003eportupgrade will, when upgrading ports/packages, write\n\t    the old package to a predictable temporary file, allowing\n\t    an attacker to overwrite arbitrary files via a symlink\n\t    attack.\u003c/li\u003e\n\t  \u003cli\u003eportupgrade will \u003cq\u003etouch\u003c/q\u003e a temporary file\n\t    with a constant filename (pkgdb.fixme) allowing an\n\t    attacker to create arbitrary zero-byte files via a symlink\n\t    attack.\u003c/li\u003e\n\t\u003c/ul\u003e\n\t\u003cp\u003eA workaround for these issues is to set the\n\t  \u003ccode\u003ePKG_TMPDIR\u003c/code\u003e environment variable to a directory\n\t  only write-able by the user running portupgrade.\u003c/p\u003e\n      ",
  "affects": [
    {
      "name": "portupgrade",
      "range": [
        {
          "lt": "20041226_2"
        }
      ]
    }
  ],
  "dates": {
    "discovery": "2005-04-12T00:00:00Z",
    "entry": "2005-04-12T00:00:00Z"
  },
  "references": [
    {
      "source": "CVE",
      "text": "CVE-2005-0610"
    }
  ]
}
