{
  "id": "CVE-2010-4170",
  "rhsa_id": "RHSA-2010:0895",
  "definition_id": "oval:com.redhat.rhsa:def:20100895",
  "title": "RHSA-2010:0895: systemtap security update (Moderate)",
  "description": "SystemTap is an instrumentation system for systems running the Linux\nkernel, version 2.6. Developers can write scripts to collect data on the\noperation of the system. staprun, the SystemTap runtime tool, is used for\nmanaging SystemTap kernel modules (for example, loading them).\n\nIt was discovered that staprun did not properly sanitize the environment\nbefore executing the modprobe command to load an additional kernel module.\nA local, unprivileged user could use this flaw to escalate their\nprivileges. (CVE-2010-4170)\n\nNote: On Red Hat Enterprise Linux 4, an attacker must be a member of the\nstapusr group to exploit this issue. Also note that, after installing this\nupdate, users already in the stapdev group must be added to the stapusr\ngroup in order to be able to run the staprun tool.\n\nRed Hat would like to thank Tavis Ormandy for reporting this issue.\n\nSystemTap users should upgrade to these updated packages, which contain\na backported patch to correct this issue.",
  "cvss2": "7.2/AV:L/AC:L/Au:N/C:C/I:C/A:C",
  "cwe": "CWE-284",
  "severity": "Moderate",
  "impact": "moderate",
  "affected": {
    "family": "unix",
    "platforms": [
      "Red Hat Enterprise Linux 4"
    ],
    "cpes": [
      {
        "cpe": "cpe:/o:redhat:enterprise_linux:4"
      },
      {
        "cpe": "cpe:/o:redhat:enterprise_linux:4::as",
        "repository": [
          "rhel-4-for-power-rpms",
          "rhel-4-as-rpms",
          "rhel-4-as-source-rpms",
          "rhel-4-for-system-z-source-rpms",
          "rhel-4-for-system-z-rpms",
          "rhel-4-for-power-source-rpms"
        ]
      },
      {
        "cpe": "cpe:/o:redhat:enterprise_linux:4::desktop",
        "repository": [
          "rhel-4-desktop-rpms",
          "rhel-4-desktop-source-rpms"
        ]
      },
      {
        "cpe": "cpe:/o:redhat:enterprise_linux:4::es",
        "repository": [
          "rhel-4-es-source-rpms",
          "rhel-4-es-rpms"
        ]
      },
      {
        "cpe": "cpe:/o:redhat:enterprise_linux:4::ws",
        "repository": [
          "rhel-4-ws-rpms",
          "rhel-4-ws-source-rpms"
        ]
      }
    ]
  },
  "packages": [
    {
      "name": "systemtap-runtime",
      "status": "Fixed",
      "fixed_version": "0:0.6.2-2.el4_8.3",
      "arch": "x86_64"
    },
    {
      "name": "systemtap",
      "status": "Fixed",
      "fixed_version": "0:0.6.2-2.el4_8.3",
      "arch": "ppc64"
    },
    {
      "name": "systemtap",
      "status": "Fixed",
      "fixed_version": "0:0.6.2-2.el4_8.3",
      "arch": "i386"
    },
    {
      "name": "systemtap-runtime",
      "status": "Fixed",
      "fixed_version": "0:0.6.2-2.el4_8.3",
      "arch": "ia64"
    },
    {
      "name": "systemtap-testsuite",
      "status": "Fixed",
      "fixed_version": "0:0.6.2-2.el4_8.3",
      "arch": "i386"
    },
    {
      "name": "systemtap-testsuite",
      "status": "Fixed",
      "fixed_version": "0:0.6.2-2.el4_8.3",
      "arch": "x86_64"
    },
    {
      "name": "systemtap",
      "status": "Fixed",
      "fixed_version": "0:0.6.2-2.el4_8.3",
      "arch": "ia64"
    },
    {
      "name": "systemtap-testsuite",
      "status": "Fixed",
      "fixed_version": "0:0.6.2-2.el4_8.3",
      "arch": "ppc64"
    },
    {
      "name": "systemtap-testsuite",
      "status": "Fixed",
      "fixed_version": "0:0.6.2-2.el4_8.3",
      "arch": "ia64"
    },
    {
      "name": "systemtap",
      "status": "Fixed",
      "fixed_version": "0:0.6.2-2.el4_8.3",
      "arch": "x86_64"
    },
    {
      "name": "systemtap-runtime",
      "status": "Fixed",
      "fixed_version": "0:0.6.2-2.el4_8.3",
      "arch": "ppc64"
    },
    {
      "name": "systemtap-runtime",
      "status": "Fixed",
      "fixed_version": "0:0.6.2-2.el4_8.3",
      "arch": "i386"
    }
  ],
  "references": [
    {
      "id": "RHSA-2010:0895",
      "source": "RHSA",
      "url": "https://access.redhat.com/errata/RHSA-2010:0895"
    },
    {
      "id": "CVE-2010-4170",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2010-4170"
    },
    {
      "id": "CVE-2010-4170 Systemtap: Insecure loading of modules",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/653604"
    }
  ],
  "public": "2010-11-17T00:00:00Z",
  "issued": "2010-11-17T00:00:00Z",
  "updated": "2010-11-17T00:00:00Z"
}
