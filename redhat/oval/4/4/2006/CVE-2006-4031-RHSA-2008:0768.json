{
  "id": "CVE-2006-4031",
  "rhsa_id": "RHSA-2008:0768",
  "definition_id": "oval:com.redhat.rhsa:def:20080768",
  "title": "RHSA-2008:0768: mysql security, bug fix, and enhancement update (Moderate)",
  "description": "MySQL is a multi-user, multi-threaded SQL database server. MySQL is a\nclient/server implementation consisting of a server daemon (mysqld), and\nmany different client programs and libraries.\n\nMySQL did not correctly check directories used as arguments for the DATA\nDIRECTORY and INDEX DIRECTORY directives. Using this flaw, an authenticated\nattacker could elevate their access privileges to tables created by other\ndatabase users. Note: this attack does not work on existing tables. An\nattacker can only elevate their access to another user's tables as the\ntables are created. As well, the names of these created tables need to be\npredicted correctly for this attack to succeed. (CVE-2008-2079)\n\nMySQL did not require the \"DROP\" privilege for \"RENAME TABLE\" statements.\nAn authenticated user could use this flaw to rename arbitrary tables.\n(CVE-2007-2691)\n\nMySQL allowed an authenticated user to access a table through a previously\ncreated MERGE table, even after the user's privileges were revoked from the\noriginal table, which might violate intended security policy. This is\naddressed by allowing the MERGE storage engine to be disabled, which can be\ndone by running mysqld with the \"--skip-merge\" option. (CVE-2006-4031)\n\nA flaw in MySQL allowed an authenticated user to cause the MySQL daemon to\ncrash via crafted SQL queries. This only caused a temporary denial of\nservice, as the MySQL daemon is automatically restarted after the crash.\n(CVE-2006-3469)\n\nAs well, these updated packages fix the following bugs:\n\n* in the previous mysql packages, if a column name was referenced more\nthan once in an \"ORDER BY\" section of a query, a segmentation fault\noccurred.\n\n* when MySQL failed to start, the init script returned a successful (0)\nexit code. When using the Red Hat Cluster Suite, this may have caused\ncluster services to report a successful start, even when MySQL failed to\nstart. In these updated packages, the init script returns the correct exit\ncodes, which resolves this issue.\n\n* it was possible to use the mysqld_safe command to specify invalid port\nnumbers (higher than 65536), causing invalid ports to be created, and, in\nsome cases, a \"port number definition: unsigned short\" error. In these\nupdated packages, when an invalid port number is specified, the default\nport number is used.\n\n* when setting \"myisam_repair_threads \u003e 1\", any repair set the index\ncardinality to \"1\", regardless of the table size.\n\n* the MySQL init script no longer runs \"chmod -R\" on the entire database\ndirectory tree during every startup.\n\n* when running \"mysqldump\" with the MySQL 4.0 compatibility mode option,\n\"--compatible=mysql40\", mysqldump created dumps that omitted the\n\"auto_increment\" field.\n\nAs well, the MySQL init script now uses more reliable methods for\ndetermining parameters, such as the data directory location.\n\nNote: these updated packages upgrade MySQL to version 4.1.22. For a full\nlist of bug fixes and enhancements, refer to the MySQL release notes:\nhttp://dev.mysql.com/doc/refman/4.1/en/news-4-1-22.html\n\nAll mysql users are advised to upgrade to these updated packages, which\nresolve these issues and add this enhancement.",
  "severity": "Moderate",
  "impact": "low",
  "affected": {
    "family": "unix",
    "platforms": [
      "Red Hat Enterprise Linux 4"
    ],
    "cpes": [
      {
        "cpe": "cpe:/o:redhat:enterprise_linux:4"
      },
      {
        "cpe": "cpe:/o:redhat:enterprise_linux:4::as",
        "repository": [
          "rhel-4-for-power-rpms",
          "rhel-4-as-source-rpms",
          "rhel-4-for-system-z-source-rpms",
          "rhel-4-for-power-source-rpms",
          "rhel-4-as-rpms",
          "rhel-4-for-system-z-rpms"
        ]
      },
      {
        "cpe": "cpe:/o:redhat:enterprise_linux:4::desktop",
        "repository": [
          "rhel-4-desktop-rpms",
          "rhel-4-desktop-source-rpms"
        ]
      },
      {
        "cpe": "cpe:/o:redhat:enterprise_linux:4::es",
        "repository": [
          "rhel-4-es-rpms",
          "rhel-4-es-source-rpms"
        ]
      },
      {
        "cpe": "cpe:/o:redhat:enterprise_linux:4::ws",
        "repository": [
          "rhel-4-ws-rpms",
          "rhel-4-ws-source-rpms"
        ]
      }
    ]
  },
  "packages": [
    {
      "name": "mysql-server",
      "status": "Fixed",
      "fixed_version": "0:4.1.22-2.el4",
      "arch": "ppc"
    },
    {
      "name": "mysql-devel",
      "status": "Fixed",
      "fixed_version": "0:4.1.22-2.el4",
      "arch": "s390x"
    },
    {
      "name": "mysql-server",
      "status": "Fixed",
      "fixed_version": "0:4.1.22-2.el4",
      "arch": "s390"
    },
    {
      "name": "mysql",
      "status": "Fixed",
      "fixed_version": "0:4.1.22-2.el4",
      "arch": "ppc"
    },
    {
      "name": "mysql-bench",
      "status": "Fixed",
      "fixed_version": "0:4.1.22-2.el4",
      "arch": "i386"
    },
    {
      "name": "mysql",
      "status": "Fixed",
      "fixed_version": "0:4.1.22-2.el4",
      "arch": "x86_64"
    },
    {
      "name": "mysql-bench",
      "status": "Fixed",
      "fixed_version": "0:4.1.22-2.el4",
      "arch": "s390x"
    },
    {
      "name": "mysql-bench",
      "status": "Fixed",
      "fixed_version": "0:4.1.22-2.el4",
      "arch": "ppc"
    },
    {
      "name": "mysql",
      "status": "Fixed",
      "fixed_version": "0:4.1.22-2.el4",
      "arch": "ppc64"
    },
    {
      "name": "mysql",
      "status": "Fixed",
      "fixed_version": "0:4.1.22-2.el4",
      "arch": "ia64"
    },
    {
      "name": "mysql-server",
      "status": "Fixed",
      "fixed_version": "0:4.1.22-2.el4",
      "arch": "s390x"
    },
    {
      "name": "mysql",
      "status": "Fixed",
      "fixed_version": "0:4.1.22-2.el4",
      "arch": "s390x"
    },
    {
      "name": "mysql-devel",
      "status": "Fixed",
      "fixed_version": "0:4.1.22-2.el4",
      "arch": "i386"
    },
    {
      "name": "mysql",
      "status": "Fixed",
      "fixed_version": "0:4.1.22-2.el4",
      "arch": "i386"
    },
    {
      "name": "mysql-devel",
      "status": "Fixed",
      "fixed_version": "0:4.1.22-2.el4",
      "arch": "s390"
    },
    {
      "name": "mysql-devel",
      "status": "Fixed",
      "fixed_version": "0:4.1.22-2.el4",
      "arch": "ppc"
    },
    {
      "name": "mysql-server",
      "status": "Fixed",
      "fixed_version": "0:4.1.22-2.el4",
      "arch": "ia64"
    },
    {
      "name": "mysql-bench",
      "status": "Fixed",
      "fixed_version": "0:4.1.22-2.el4",
      "arch": "s390"
    },
    {
      "name": "mysql-devel",
      "status": "Fixed",
      "fixed_version": "0:4.1.22-2.el4",
      "arch": "x86_64"
    },
    {
      "name": "mysql-bench",
      "status": "Fixed",
      "fixed_version": "0:4.1.22-2.el4",
      "arch": "x86_64"
    },
    {
      "name": "mysql-bench",
      "status": "Fixed",
      "fixed_version": "0:4.1.22-2.el4",
      "arch": "ia64"
    },
    {
      "name": "mysql",
      "status": "Fixed",
      "fixed_version": "0:4.1.22-2.el4",
      "arch": "s390"
    },
    {
      "name": "mysql-devel",
      "status": "Fixed",
      "fixed_version": "0:4.1.22-2.el4",
      "arch": "ia64"
    },
    {
      "name": "mysql-server",
      "status": "Fixed",
      "fixed_version": "0:4.1.22-2.el4",
      "arch": "x86_64"
    },
    {
      "name": "mysql-server",
      "status": "Fixed",
      "fixed_version": "0:4.1.22-2.el4",
      "arch": "i386"
    }
  ],
  "references": [
    {
      "id": "RHSA-2008:0768",
      "source": "RHSA",
      "url": "https://access.redhat.com/errata/RHSA-2008:0768"
    },
    {
      "id": "CVE-2006-3469",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2006-3469"
    },
    {
      "id": "CVE-2006-4031",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2006-4031"
    },
    {
      "id": "CVE-2007-2691",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2007-2691"
    },
    {
      "id": "CVE-2008-2079",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2008-2079"
    },
    {
      "id": "CVE-2006-3469 mysql server DoS",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/201904"
    },
    {
      "id": "CVE-2006-4031 MySQL improper permission revocation",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/202246"
    },
    {
      "id": "CVE-2007-2691 mysql DROP privilege not enforced when renaming tables",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/241688"
    },
    {
      "id": "CVE-2008-2079 mysql: privilege escalation via DATA/INDEX DIRECTORY directives",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/445222"
    }
  ],
  "public": "2005-11-23T00:00:00Z",
  "issued": "2008-07-24T00:00:00Z",
  "updated": "2008-07-24T00:00:00Z"
}
