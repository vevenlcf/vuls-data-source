{
  "id": "CVE-2007-5794",
  "rhsa_id": "RHSA-2008:0715",
  "definition_id": "oval:com.redhat.rhsa:def:20080715",
  "title": "RHSA-2008:0715: nss_ldap security and bug fix update (Low)",
  "description": "The nss_ldap package contains the nss_ldap and pam_ldap modules. The\nnss_ldap module is a plug-in which allows applications to retrieve\ninformation about users and groups from a directory server. The pam_ldap\nmodule allows PAM-aware applications to use a directory server to verify\nuser passwords.\n\nA race condition was discovered in nss_ldap, which affected certain\napplications that make LDAP connections, such as Dovecot. This could cause\nnss_ldap to answer a request for information about one user with the\ninformation about a different user. (CVE-2007-5794)\n\nAs well, this updated package fixes the following bugs:\n\n* in certain situations, on Itanium(R) architectures, when an application\nperformed an LDAP lookup for a highly populated group, for example,\ncontaining more than 150 members, the application crashed, or may have\ncaused a segmentation fault. As well, this issue may have caused commands,\nsuch as \"ls\", to return a \"ber_free_buf: Assertion\" error.\n\n* when an application enumerated members of a netgroup, the nss_ldap\nmodule returned a successful status result and the netgroup name, even\nwhen the netgroup did not exist. This behavior was not consistent with\nother modules. In this updated package, nss_ldap no longer returns a\nsuccessful status when the netgroup does not exist.\n\n* in master and slave server environments, with systems that were\nconfigured to use a read-only directory server, if user log in attempts\nwere denied because their passwords had expired, and users attempted to\nimmediately change their passwords, the replication server returned an LDAP\nreferral, instructing the pam_ldap module to resissue its request to a\ndifferent server; however, the pam_ldap module failed to do so. In these\nsituations, an error such as the following occurred:\n\nLDAP password information update failed: Can't contact LDAP server\nInsufficient 'write' privilege to the 'userPassword' attribute of entry\n[entry]\n\nIn this updated package, password changes are allowed when binding against\na slave server, which resolves this issue.\n\n* when a system used a directory server for naming information, and\n\"nss_initgroups_ignoreusers root\" was configured in \"/etc/ldap.conf\",\ndbus-daemon-1 would hang. Running the \"service messagebus start\" command\ndid not start the service, and it did not fail, which would stop the boot\nprocess if it was not cancelled.\n\nAs well, this updated package upgrades nss_ldap to the version as shipped\nwith Red Hat Enterprise Linux 5.\n\nUsers of nss_ldap are advised to upgrade to this updated package, which\nresolves these issues.",
  "severity": "Low",
  "impact": "low",
  "affected": {
    "family": "unix",
    "platforms": [
      "Red Hat Enterprise Linux 4"
    ],
    "cpes": [
      {
        "cpe": "cpe:/o:redhat:enterprise_linux:4"
      },
      {
        "cpe": "cpe:/o:redhat:enterprise_linux:4::as",
        "repository": [
          "rhel-4-for-power-rpms",
          "rhel-4-as-source-rpms",
          "rhel-4-for-system-z-source-rpms",
          "rhel-4-for-power-source-rpms",
          "rhel-4-as-rpms",
          "rhel-4-for-system-z-rpms"
        ]
      },
      {
        "cpe": "cpe:/o:redhat:enterprise_linux:4::desktop",
        "repository": [
          "rhel-4-desktop-rpms",
          "rhel-4-desktop-source-rpms"
        ]
      },
      {
        "cpe": "cpe:/o:redhat:enterprise_linux:4::es",
        "repository": [
          "rhel-4-es-rpms",
          "rhel-4-es-source-rpms"
        ]
      },
      {
        "cpe": "cpe:/o:redhat:enterprise_linux:4::ws",
        "repository": [
          "rhel-4-ws-rpms",
          "rhel-4-ws-source-rpms"
        ]
      }
    ]
  },
  "packages": [
    {
      "name": "nss_ldap",
      "status": "Fixed",
      "fixed_version": "0:253-5.el4",
      "arch": "ppc"
    },
    {
      "name": "nss_ldap",
      "status": "Fixed",
      "fixed_version": "0:253-5.el4",
      "arch": "ppc64"
    },
    {
      "name": "nss_ldap",
      "status": "Fixed",
      "fixed_version": "0:253-5.el4",
      "arch": "s390"
    },
    {
      "name": "nss_ldap",
      "status": "Fixed",
      "fixed_version": "0:253-5.el4",
      "arch": "s390x"
    },
    {
      "name": "nss_ldap",
      "status": "Fixed",
      "fixed_version": "0:253-5.el4",
      "arch": "x86_64"
    },
    {
      "name": "nss_ldap",
      "status": "Fixed",
      "fixed_version": "0:253-5.el4",
      "arch": "i386"
    },
    {
      "name": "nss_ldap",
      "status": "Fixed",
      "fixed_version": "0:253-5.el4",
      "arch": "ia64"
    }
  ],
  "references": [
    {
      "id": "RHSA-2008:0715",
      "source": "RHSA",
      "url": "https://access.redhat.com/errata/RHSA-2008:0715"
    },
    {
      "id": "CVE-2007-5794",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2007-5794"
    },
    {
      "id": "CVE-2007-5794 nss_ldap randomly replying with wrong user's data",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/367461"
    }
  ],
  "public": "2005-04-09T00:00:00Z",
  "issued": "2008-07-24T00:00:00Z",
  "updated": "2008-07-24T00:00:00Z"
}
