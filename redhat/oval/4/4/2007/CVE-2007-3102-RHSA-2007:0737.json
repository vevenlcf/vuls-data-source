{
  "id": "CVE-2007-3102",
  "rhsa_id": "RHSA-2007:0737",
  "definition_id": "oval:com.redhat.rhsa:def:20070737",
  "title": "RHSA-2007:0737: pam security, bug fix, and enhancement update (Moderate)",
  "description": "Pluggable Authentication Modules (PAM) provide a system whereby\nadministrators can set up authentication policies without having to\nrecompile programs that handle authentication.\n\nA flaw was found in the way pam_console set console device permissions. It\nwas possible for various console devices to retain ownership of the console\nuser after logging out, possibly leaking information to another local user.\n(CVE-2007-1716)\n\nA flaw was found in the way the PAM library wrote account names to the\naudit subsystem. An attacker could inject strings containing parts of audit\nmessages, which could possibly mislead or confuse audit log parsing tools.\n(CVE-2007-3102)\n\nAs well, these updated packages fix the following bugs:\n\n* the pam_xauth module, which is used for copying the X11 authentication\ncookie, did not reset the \"XAUTHORITY\" variable in certain circumstances,\ncausing unnecessary delays when using su command.\n\n* when calculating password similarity, pam_cracklib disregarded changes\nto the last character in passwords when \"difok=x\" (where \"x\" is the\nnumber of characters required to change) was configured in\n\"/etc/pam.d/system-auth\". This resulted in password changes that should\nhave been successful to fail with the following error:\n\nBAD PASSWORD: is too similar to the old one\n\nThis issue has been resolved in these updated packages.\n\n* the pam_limits module, which provides setting up system resources limits\nfor user sessions, reset the nice priority of the user session to \"0\" if it\nwas not configured otherwise in the \"/etc/security/limits.conf\"\nconfiguration file.\n\nThese updated packages add the following enhancement:\n\n* a new PAM module, pam_tally2, which allows accounts to be locked after a\nmaximum number of failed log in attempts.\n\nAll users of PAM should upgrade to these updated packages, which resolve\nthese issues and add this enhancement.",
  "severity": "Moderate",
  "impact": "moderate",
  "affected": {
    "family": "unix",
    "platforms": [
      "Red Hat Enterprise Linux 4"
    ],
    "cpes": [
      {
        "cpe": "cpe:/o:redhat:enterprise_linux:4"
      },
      {
        "cpe": "cpe:/o:redhat:enterprise_linux:4::as",
        "repository": [
          "rhel-4-for-system-z-rpms",
          "rhel-4-for-system-z-source-rpms",
          "rhel-4-for-power-rpms",
          "rhel-4-as-source-rpms",
          "rhel-4-for-power-source-rpms",
          "rhel-4-as-rpms"
        ]
      },
      {
        "cpe": "cpe:/o:redhat:enterprise_linux:4::desktop",
        "repository": [
          "rhel-4-desktop-rpms",
          "rhel-4-desktop-source-rpms"
        ]
      },
      {
        "cpe": "cpe:/o:redhat:enterprise_linux:4::es",
        "repository": [
          "rhel-4-es-rpms",
          "rhel-4-es-source-rpms"
        ]
      },
      {
        "cpe": "cpe:/o:redhat:enterprise_linux:4::ws",
        "repository": [
          "rhel-4-ws-rpms",
          "rhel-4-ws-source-rpms"
        ]
      }
    ]
  },
  "packages": [
    {
      "name": "pam-devel",
      "status": "Fixed",
      "fixed_version": "0:0.77-66.23",
      "arch": "x86_64"
    },
    {
      "name": "pam",
      "status": "Fixed",
      "fixed_version": "0:0.77-66.23",
      "arch": "s390"
    },
    {
      "name": "pam-devel",
      "status": "Fixed",
      "fixed_version": "0:0.77-66.23",
      "arch": "ia64"
    },
    {
      "name": "pam",
      "status": "Fixed",
      "fixed_version": "0:0.77-66.23",
      "arch": "s390x"
    },
    {
      "name": "pam",
      "status": "Fixed",
      "fixed_version": "0:0.77-66.23",
      "arch": "ppc"
    },
    {
      "name": "pam-devel",
      "status": "Fixed",
      "fixed_version": "0:0.77-66.23",
      "arch": "s390"
    },
    {
      "name": "pam-devel",
      "status": "Fixed",
      "fixed_version": "0:0.77-66.23",
      "arch": "ppc"
    },
    {
      "name": "pam-devel",
      "status": "Fixed",
      "fixed_version": "0:0.77-66.23",
      "arch": "ppc64"
    },
    {
      "name": "pam-devel",
      "status": "Fixed",
      "fixed_version": "0:0.77-66.23",
      "arch": "i386"
    },
    {
      "name": "pam",
      "status": "Fixed",
      "fixed_version": "0:0.77-66.23",
      "arch": "x86_64"
    },
    {
      "name": "pam",
      "status": "Fixed",
      "fixed_version": "0:0.77-66.23",
      "arch": "ia64"
    },
    {
      "name": "pam",
      "status": "Fixed",
      "fixed_version": "0:0.77-66.23",
      "arch": "ppc64"
    },
    {
      "name": "pam-devel",
      "status": "Fixed",
      "fixed_version": "0:0.77-66.23",
      "arch": "s390x"
    },
    {
      "name": "pam",
      "status": "Fixed",
      "fixed_version": "0:0.77-66.23",
      "arch": "i386"
    }
  ],
  "references": [
    {
      "id": "RHSA-2007:0737",
      "source": "RHSA",
      "url": "https://access.redhat.com/errata/RHSA-2007:0737"
    },
    {
      "id": "CVE-2007-1716",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2007-1716"
    },
    {
      "id": "CVE-2007-3102",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2007-3102"
    },
    {
      "id": "CVE-2007-3102 audit logging of failed logins",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/243204"
    },
    {
      "id": "CVE-2007-1716 security flaw",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1618305"
    }
  ],
  "public": "2007-11-07T00:00:00Z",
  "issued": "2007-11-15T00:00:00Z",
  "updated": "2008-03-20T00:00:00Z"
}
