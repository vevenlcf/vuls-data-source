{
  "id": "CVE-2007-3847",
  "rhsa_id": "RHSA-2007:0747",
  "definition_id": "oval:com.redhat.rhsa:def:20070747",
  "title": "RHSA-2007:0747: httpd security, bug fix, and enhancement update (Moderate)",
  "description": "The Apache HTTP Server is a popular and freely-available Web server.\n\nA flaw was found in the Apache HTTP Server mod_proxy module. On sites where\na reverse proxy is configured, a remote attacker could send a carefully\ncrafted request that would cause the Apache child process handling that\nrequest to crash. On sites where a forward proxy is configured, an attacker\ncould cause a similar crash if a user could be persuaded to visit a\nmalicious site using the proxy. This could lead to a denial of service if\nusing a threaded Multi-Processing Module. (CVE-2007-3847)\n\nAs well, these updated packages fix the following bugs:\n\n* the default \"/etc/logrotate.d/httpd\" script incorrectly invoked the kill\ncommand, instead of using the \"/sbin/service httpd restart\" command. If you\nconfigured the httpd PID to be in a location other than\n\"/var/run/httpd.pid\", the httpd logs failed to be rotated. This has been\nresolved in these updated packages.\n\n* Set-Cookie headers with a status code of 3xx are not forwarded to\nclients when the \"ProxyErrorOverride\" directive is enabled. These\nresponses are overridden at the proxy. Only the responses with status\ncodes of 4xx and 5xx are overridden in these updated packages.\n\n* mod_proxy did not correctly handle percent-encoded characters (ie %20)\nwhen configured as a reverse proxy.\n\n* invalid HTTP status codes could be logged if output filters returned\nerrors.\n\n* the \"ProxyTimeout\" directive was not inherited across virtual host\ndefinitions.\n\n* in some cases the Content-Length header was dropped from HEAD responses.\nThis resulted in certain sites not working correctly with mod_proxy, such\nas www.windowsupdate.com.\n\nThis update adds the following enhancements:\n\n* a new configuration option has been added, \"ServerTokens Full-Release\",\nwhich adds the package release to the server version string, which is\nreturned in the \"Server\" response header.\n\n* a new module has been added, mod_version, which allows configuration\nfiles to be written containing sections, which are evaluated only if the\nversion of httpd used matches a specified condition.\n\nUsers of httpd are advised to upgrade to these updated packages, which\nresolve these issues and add these enhancements.",
  "cwe": "CWE-125",
  "severity": "Moderate",
  "impact": "moderate",
  "affected": {
    "family": "unix",
    "platforms": [
      "Red Hat Enterprise Linux 4"
    ],
    "cpes": [
      {
        "cpe": "cpe:/o:redhat:enterprise_linux:4"
      },
      {
        "cpe": "cpe:/o:redhat:enterprise_linux:4::as",
        "repository": [
          "rhel-4-for-power-rpms",
          "rhel-4-as-source-rpms",
          "rhel-4-for-system-z-source-rpms",
          "rhel-4-for-power-source-rpms",
          "rhel-4-as-rpms",
          "rhel-4-for-system-z-rpms"
        ]
      },
      {
        "cpe": "cpe:/o:redhat:enterprise_linux:4::desktop",
        "repository": [
          "rhel-4-desktop-rpms",
          "rhel-4-desktop-source-rpms"
        ]
      },
      {
        "cpe": "cpe:/o:redhat:enterprise_linux:4::es",
        "repository": [
          "rhel-4-es-rpms",
          "rhel-4-es-source-rpms"
        ]
      },
      {
        "cpe": "cpe:/o:redhat:enterprise_linux:4::ws",
        "repository": [
          "rhel-4-ws-rpms",
          "rhel-4-ws-source-rpms"
        ]
      }
    ]
  },
  "packages": [
    {
      "name": "httpd-suexec",
      "status": "Fixed",
      "fixed_version": "0:2.0.52-38.ent",
      "arch": "s390x"
    },
    {
      "name": "httpd-devel",
      "status": "Fixed",
      "fixed_version": "0:2.0.52-38.ent",
      "arch": "s390"
    },
    {
      "name": "mod_ssl",
      "status": "Fixed",
      "fixed_version": "1:2.0.52-38.ent",
      "arch": "s390x"
    },
    {
      "name": "mod_ssl",
      "status": "Fixed",
      "fixed_version": "1:2.0.52-38.ent",
      "arch": "x86_64"
    },
    {
      "name": "httpd-suexec",
      "status": "Fixed",
      "fixed_version": "0:2.0.52-38.ent",
      "arch": "s390"
    },
    {
      "name": "mod_ssl",
      "status": "Fixed",
      "fixed_version": "1:2.0.52-38.ent",
      "arch": "i386"
    },
    {
      "name": "httpd",
      "status": "Fixed",
      "fixed_version": "0:2.0.52-38.ent",
      "arch": "ppc"
    },
    {
      "name": "httpd",
      "status": "Fixed",
      "fixed_version": "0:2.0.52-38.ent",
      "arch": "i386"
    },
    {
      "name": "mod_ssl",
      "status": "Fixed",
      "fixed_version": "1:2.0.52-38.ent",
      "arch": "ppc"
    },
    {
      "name": "httpd-devel",
      "status": "Fixed",
      "fixed_version": "0:2.0.52-38.ent",
      "arch": "ppc"
    },
    {
      "name": "httpd",
      "status": "Fixed",
      "fixed_version": "0:2.0.52-38.ent",
      "arch": "s390x"
    },
    {
      "name": "httpd-devel",
      "status": "Fixed",
      "fixed_version": "0:2.0.52-38.ent",
      "arch": "s390x"
    },
    {
      "name": "httpd-suexec",
      "status": "Fixed",
      "fixed_version": "0:2.0.52-38.ent",
      "arch": "ppc"
    },
    {
      "name": "httpd-devel",
      "status": "Fixed",
      "fixed_version": "0:2.0.52-38.ent",
      "arch": "ia64"
    },
    {
      "name": "httpd-suexec",
      "status": "Fixed",
      "fixed_version": "0:2.0.52-38.ent",
      "arch": "ia64"
    },
    {
      "name": "httpd-devel",
      "status": "Fixed",
      "fixed_version": "0:2.0.52-38.ent",
      "arch": "x86_64"
    },
    {
      "name": "httpd-manual",
      "status": "Fixed",
      "fixed_version": "0:2.0.52-38.ent",
      "arch": "s390"
    },
    {
      "name": "httpd",
      "status": "Fixed",
      "fixed_version": "0:2.0.52-38.ent",
      "arch": "ia64"
    },
    {
      "name": "httpd-manual",
      "status": "Fixed",
      "fixed_version": "0:2.0.52-38.ent",
      "arch": "ia64"
    },
    {
      "name": "httpd",
      "status": "Fixed",
      "fixed_version": "0:2.0.52-38.ent",
      "arch": "s390"
    },
    {
      "name": "httpd-devel",
      "status": "Fixed",
      "fixed_version": "0:2.0.52-38.ent",
      "arch": "i386"
    },
    {
      "name": "httpd-suexec",
      "status": "Fixed",
      "fixed_version": "0:2.0.52-38.ent",
      "arch": "x86_64"
    },
    {
      "name": "httpd-manual",
      "status": "Fixed",
      "fixed_version": "0:2.0.52-38.ent",
      "arch": "i386"
    },
    {
      "name": "httpd-manual",
      "status": "Fixed",
      "fixed_version": "0:2.0.52-38.ent",
      "arch": "ppc"
    },
    {
      "name": "mod_ssl",
      "status": "Fixed",
      "fixed_version": "1:2.0.52-38.ent",
      "arch": "s390"
    },
    {
      "name": "httpd",
      "status": "Fixed",
      "fixed_version": "0:2.0.52-38.ent",
      "arch": "x86_64"
    },
    {
      "name": "mod_ssl",
      "status": "Fixed",
      "fixed_version": "1:2.0.52-38.ent",
      "arch": "ia64"
    },
    {
      "name": "httpd-manual",
      "status": "Fixed",
      "fixed_version": "0:2.0.52-38.ent",
      "arch": "x86_64"
    },
    {
      "name": "httpd-suexec",
      "status": "Fixed",
      "fixed_version": "0:2.0.52-38.ent",
      "arch": "i386"
    },
    {
      "name": "httpd-manual",
      "status": "Fixed",
      "fixed_version": "0:2.0.52-38.ent",
      "arch": "s390x"
    }
  ],
  "references": [
    {
      "id": "RHSA-2007:0747",
      "source": "RHSA",
      "url": "https://access.redhat.com/errata/RHSA-2007:0747"
    },
    {
      "id": "CVE-2007-3847",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2007-3847"
    },
    {
      "id": "CVE-2007-3847 httpd: out of bounds read",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/250731"
    }
  ],
  "public": "2007-08-01T00:00:00Z",
  "issued": "2007-11-15T00:00:00Z",
  "updated": "2008-03-20T00:00:00Z"
}
