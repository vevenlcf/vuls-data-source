{
  "id": "CVE-2009-3238",
  "rhsa_id": "RHSA-2009:1438",
  "definition_id": "oval:com.redhat.rhsa:def:20091438",
  "title": "RHSA-2009:1438: kernel security and bug fix update (Important)",
  "description": "The kernel packages contain the Linux kernel, the core of any Linux\noperating system.\n\nSecurity issues:\n\n* the ADDR_COMPAT_LAYOUT and MMAP_PAGE_ZERO flags were not cleared when a\nsetuid or setgid program was executed. A local, unprivileged user could use\nthis flaw to bypass the mmap_min_addr protection mechanism and perform a\nNULL pointer dereference attack, or bypass the Address Space Layout\nRandomization (ASLR) security feature. (CVE-2009-1895, Important)\n\n* it was discovered that, when executing a new process, the clear_child_tid\npointer in the Linux kernel is not cleared. If this pointer points to a\nwritable portion of the memory of the new program, the kernel could corrupt\nfour bytes of memory, possibly leading to a local denial of service or\nprivilege escalation. (CVE-2009-2848, Important)\n\n* Solar Designer reported a missing capability check in the z90crypt driver\nin the Linux kernel. This missing check could allow a local user with an\neffective user ID (euid) of 0 to bypass intended capability restrictions.\n(CVE-2009-1883, Moderate)\n\n* a flaw was found in the way the do_sigaltstack() function in the Linux\nkernel copies the stack_t structure to user-space. On 64-bit machines, this\nflaw could lead to a four-byte information leak. (CVE-2009-2847, Moderate)\n\nBug fixes:\n\n* the gcc flag \"-fno-delete-null-pointer-checks\" was added to the kernel\nbuild options. This prevents gcc from optimizing out NULL pointer checks\nafter the first use of a pointer. NULL pointer bugs are often exploited by\nattackers. Keeping these checks is a safety measure. (BZ#517964)\n\n* the Emulex LPFC driver has been updated to version 8.0.16.47, which fixes\na memory leak that caused memory allocation failures and system hangs.\n(BZ#513192)\n\n* an error in the MPT Fusion driver makefile caused CSMI ioctls to not work\nwith Serial Attached SCSI devices. (BZ#516184)\n\n* this update adds the mmap_min_addr tunable and restriction checks to help\nprevent unprivileged users from creating new memory mappings below the\nminimum address. This can help prevent the exploitation of NULL pointer\ndeference bugs. Note that mmap_min_addr is set to zero (disabled) by\ndefault for backwards compatibility. (BZ#517904)\n\n* time-outs resulted in I/O errors being logged to \"/var/log/messages\" when\nrunning \"mt erase\" on tape drives using certain LSI MegaRAID SAS adapters,\npreventing the command from completing. The megaraid_sas driver's timeout\nvalue is now set to the OS layer value. (BZ#517965)\n\n* a locking issue caused the qla2xxx ioctl module to hang after\nencountering errors. This locking issue has been corrected. This ioctl\nmodule is used by the QLogic SAN management tools, such as SANsurfer and\nscli. (BZ#519428)\n\n* when a RAID 1 array that uses the mptscsi driver and the LSI 1030\ncontroller became degraded, the whole array was detected as being offline,\nwhich could cause kernel panics at boot or data loss. (BZ#517295)\n\n* on 32-bit architectures, if a file was held open and frequently written\nfor more than 25 days, it was possible that the kernel would stop flushing\nthose writes to storage. (BZ#515255)\n\n* a memory allocation bug in ib_mthca prevented the driver from loading if\nit was loaded with large values for the \"num_mpt=\" and \"num_mtt=\" options.\nSee Kbase link below for details. (BZ#518707)\n\n* with this update, get_random_int() is more random and no longer uses a\ncommon seed value, reducing the possibility of predicting the values\nreturned. See Kbase link below for details. (BZ#519692)\n\n* a bug in __ptrace_unlink() caused it to create deadlocked and unkillable\nprocesses. See Kbase link below for details. (BZ#519446)\n\n* previously, multiple threads using the fcntl() F_SETLK command to\nsynchronize file access caused a deadlock in posix_locks_deadlock(). This\ncould cause a system hang. (BZ#519429)\n\nUsers should upgrade to these updated packages, which contain backported\npatches to correct these issues. Reboot the system for this update to take\neffect.",
  "cvss2": "7.8/AV:N/AC:L/Au:N/C:C/I:N/A:N",
  "cwe": "CWE-330",
  "severity": "Important",
  "impact": "important",
  "affected": {
    "family": "unix",
    "platforms": [
      "Red Hat Enterprise Linux 4"
    ],
    "cpes": [
      {
        "cpe": "cpe:/o:redhat:enterprise_linux:4"
      },
      {
        "cpe": "cpe:/o:redhat:enterprise_linux:4::as",
        "repository": [
          "rhel-4-for-power-rpms",
          "rhel-4-as-source-rpms",
          "rhel-4-for-system-z-source-rpms",
          "rhel-4-for-power-source-rpms",
          "rhel-4-as-rpms",
          "rhel-4-for-system-z-rpms"
        ]
      },
      {
        "cpe": "cpe:/o:redhat:enterprise_linux:4::desktop",
        "repository": [
          "rhel-4-desktop-rpms",
          "rhel-4-desktop-source-rpms"
        ]
      },
      {
        "cpe": "cpe:/o:redhat:enterprise_linux:4::es",
        "repository": [
          "rhel-4-es-rpms",
          "rhel-4-es-source-rpms"
        ]
      },
      {
        "cpe": "cpe:/o:redhat:enterprise_linux:4::ws",
        "repository": [
          "rhel-4-ws-rpms",
          "rhel-4-ws-source-rpms"
        ]
      }
    ]
  },
  "packages": [
    {
      "name": "kernel-xenU",
      "status": "Fixed",
      "fixed_version": "0:2.6.9-89.0.11.EL",
      "arch": "i686"
    },
    {
      "name": "kernel-smp-devel",
      "status": "Fixed",
      "fixed_version": "0:2.6.9-89.0.11.EL",
      "arch": "x86_64"
    },
    {
      "name": "kernel-devel",
      "status": "Fixed",
      "fixed_version": "0:2.6.9-89.0.11.EL",
      "arch": "i686"
    },
    {
      "name": "kernel",
      "status": "Fixed",
      "fixed_version": "0:2.6.9-89.0.11.EL",
      "arch": "ppc64iseries"
    },
    {
      "name": "kernel-smp-devel",
      "status": "Fixed",
      "fixed_version": "0:2.6.9-89.0.11.EL",
      "arch": "i686"
    },
    {
      "name": "kernel-devel",
      "status": "Fixed",
      "fixed_version": "0:2.6.9-89.0.11.EL",
      "arch": "s390"
    },
    {
      "name": "kernel-xenU-devel",
      "status": "Fixed",
      "fixed_version": "0:2.6.9-89.0.11.EL",
      "arch": "i686"
    },
    {
      "name": "kernel-devel",
      "status": "Fixed",
      "fixed_version": "0:2.6.9-89.0.11.EL",
      "arch": "s390x"
    },
    {
      "name": "kernel-smp",
      "status": "Fixed",
      "fixed_version": "0:2.6.9-89.0.11.EL",
      "arch": "x86_64"
    },
    {
      "name": "kernel-devel",
      "status": "Fixed",
      "fixed_version": "0:2.6.9-89.0.11.EL",
      "arch": "ppc64"
    },
    {
      "name": "kernel-devel",
      "status": "Fixed",
      "fixed_version": "0:2.6.9-89.0.11.EL",
      "arch": "x86_64"
    },
    {
      "name": "kernel-largesmp-devel",
      "status": "Fixed",
      "fixed_version": "0:2.6.9-89.0.11.EL",
      "arch": "ppc64"
    },
    {
      "name": "kernel",
      "status": "Fixed",
      "fixed_version": "0:2.6.9-89.0.11.EL",
      "arch": "s390"
    },
    {
      "name": "kernel-xenU",
      "status": "Fixed",
      "fixed_version": "0:2.6.9-89.0.11.EL",
      "arch": "x86_64"
    },
    {
      "name": "kernel-xenU-devel",
      "status": "Fixed",
      "fixed_version": "0:2.6.9-89.0.11.EL",
      "arch": "x86_64"
    },
    {
      "name": "kernel",
      "status": "Fixed",
      "fixed_version": "0:2.6.9-89.0.11.EL",
      "arch": "ia64"
    },
    {
      "name": "kernel-doc",
      "status": "Fixed",
      "fixed_version": "0:2.6.9-89.0.11.EL"
    },
    {
      "name": "kernel-hugemem-devel",
      "status": "Fixed",
      "fixed_version": "0:2.6.9-89.0.11.EL",
      "arch": "i686"
    },
    {
      "name": "kernel-largesmp",
      "status": "Fixed",
      "fixed_version": "0:2.6.9-89.0.11.EL",
      "arch": "ia64"
    },
    {
      "name": "kernel-devel",
      "status": "Fixed",
      "fixed_version": "0:2.6.9-89.0.11.EL",
      "arch": "ia64"
    },
    {
      "name": "kernel",
      "status": "Fixed",
      "fixed_version": "0:2.6.9-89.0.11.EL",
      "arch": "x86_64"
    },
    {
      "name": "kernel-hugemem",
      "status": "Fixed",
      "fixed_version": "0:2.6.9-89.0.11.EL",
      "arch": "i686"
    },
    {
      "name": "kernel",
      "status": "Fixed",
      "fixed_version": "0:2.6.9-89.0.11.EL",
      "arch": "ppc64"
    },
    {
      "name": "kernel-largesmp",
      "status": "Fixed",
      "fixed_version": "0:2.6.9-89.0.11.EL",
      "arch": "x86_64"
    },
    {
      "name": "kernel",
      "status": "Fixed",
      "fixed_version": "0:2.6.9-89.0.11.EL",
      "arch": "i686"
    },
    {
      "name": "kernel",
      "status": "Fixed",
      "fixed_version": "0:2.6.9-89.0.11.EL",
      "arch": "s390x"
    },
    {
      "name": "kernel-smp",
      "status": "Fixed",
      "fixed_version": "0:2.6.9-89.0.11.EL",
      "arch": "i686"
    },
    {
      "name": "kernel-devel",
      "status": "Fixed",
      "fixed_version": "0:2.6.9-89.0.11.EL",
      "arch": "ppc64iseries"
    },
    {
      "name": "kernel-largesmp",
      "status": "Fixed",
      "fixed_version": "0:2.6.9-89.0.11.EL",
      "arch": "ppc64"
    },
    {
      "name": "kernel-largesmp-devel",
      "status": "Fixed",
      "fixed_version": "0:2.6.9-89.0.11.EL",
      "arch": "ia64"
    },
    {
      "name": "kernel-largesmp-devel",
      "status": "Fixed",
      "fixed_version": "0:2.6.9-89.0.11.EL",
      "arch": "x86_64"
    }
  ],
  "references": [
    {
      "id": "RHSA-2009:1438",
      "source": "RHSA",
      "url": "https://access.redhat.com/errata/RHSA-2009:1438"
    },
    {
      "id": "CVE-2009-1883",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2009-1883"
    },
    {
      "id": "CVE-2009-1895",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2009-1895"
    },
    {
      "id": "CVE-2009-2847",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2009-2847"
    },
    {
      "id": "CVE-2009-2848",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2009-2848"
    },
    {
      "id": "CVE-2009-3238",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2009-3238"
    },
    {
      "id": "CVE-2009-1883 kernel: missing capability check in z90crypt",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/505983"
    },
    {
      "id": "CVE-2009-1895 kernel: personality: fix PER_CLEAR_ON_SETID",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/511171"
    },
    {
      "id": "CVE-2009-2847 kernel: information leak in sigaltstack",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/515392"
    },
    {
      "id": "CVE-2009-2848 kernel: execve: must clear current-\u003eclear_child_tid",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/515423"
    },
    {
      "id": "CVE-2009-3238 kernel: random: add robust get_random_u32, remove weak get_random_int",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/524512"
    }
  ],
  "public": "2009-05-05T00:00:00Z",
  "issued": "2009-09-15T00:00:00Z",
  "updated": "2009-09-15T00:00:00Z"
}
