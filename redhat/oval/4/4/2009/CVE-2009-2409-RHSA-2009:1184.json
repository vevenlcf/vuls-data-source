{
  "id": "CVE-2009-2409",
  "rhsa_id": "RHSA-2009:1184",
  "definition_id": "oval:com.redhat.rhsa:def:20091184",
  "title": "RHSA-2009:1184: nspr and nss security and bug fix update (Critical)",
  "description": "Netscape Portable Runtime (NSPR) provides platform independence for non-GUI\noperating system facilities. These facilities include threads, thread\nsynchronization, normal file and network I/O, interval timing, calendar\ntime, basic memory management (malloc and free), and shared library linking.\n\nNetwork Security Services (NSS) is a set of libraries designed to support\nthe cross-platform development of security-enabled client and server\napplications. Applications built with NSS can support SSLv2, SSLv3, TLS,\nand other security standards.\n\nThese updated packages upgrade NSS from the previous version, 3.12.2, to a\nprerelease of version 3.12.4. The version of NSPR has also been upgraded\nfrom 4.7.3 to 4.7.4. \n\nMoxie Marlinspike reported a heap overflow flaw in a regular expression\nparser in the NSS library used by browsers such as Mozilla Firefox to match\ncommon names in certificates. A malicious website could present a\ncarefully-crafted certificate in such a way as to trigger the heap\noverflow, leading to a crash or, possibly, arbitrary code execution with\nthe permissions of the user running the browser. (CVE-2009-2404)\n\nNote: in order to exploit this issue without further user interaction in\nFirefox, the carefully-crafted certificate would need to be signed by a\nCertificate Authority trusted by Firefox, otherwise Firefox presents the\nvictim with a warning that the certificate is untrusted. Only if the user\nthen accepts the certificate will the overflow take place.\n\nDan Kaminsky discovered flaws in the way browsers such as Firefox handle\nNULL characters in a certificate. If an attacker is able to get a\ncarefully-crafted certificate signed by a Certificate Authority trusted by\nFirefox, the attacker could use the certificate during a man-in-the-middle\nattack and potentially confuse Firefox into accepting it by mistake.\n(CVE-2009-2408)\n\nDan Kaminsky found that browsers still accept certificates with MD2 hash\nsignatures, even though MD2 is no longer considered a cryptographically\nstrong algorithm. This could make it easier for an attacker to create a\nmalicious certificate that would be treated as trusted by a browser. NSS\nnow disables the use of MD2 and MD4 algorithms inside signatures by\ndefault. (CVE-2009-2409)\n\nThese version upgrades also provide a fix for the following bug:\n\n* SSL client authentication failed against an Apache server when it was \nusing the mod_nss module and configured for NSSOCSP. On the client side,\nthe user agent received an error message that referenced \"Error Code:\n-12271\" and stated that establishing an encrypted connection had failed\nbecause the certificate had been rejected by the host.\n\nOn the server side, the nss_error_log under /var/log/httpd/ contained the\nfollowing message:\n\n[error] Re-negotiation handshake failed: Not accepted by client!?\n\nAlso, /var/log/httpd/error_log contained this error:\n\nSSL Library Error: -8071 The OCSP server experienced an internal error\n\nWith these updated packages, the dependency problem which caused this\nfailure has been resolved so that SSL client authentication with an\nApache web server using mod_nss which is configured for NSSOCSP succeeds\nas expected. Note that if the presented client certificate is expired,\nthen access is denied, the user agent is presented with an error message\nabout the invalid certificate, and the OCSP queries are seen in the OCSP\nresponder. Also, similar OCSP status verification happens for SSL server\ncertificates used in Apache upon instance start or restart. (BZ#508027)\n\nAll users of nspr and nss are advised to upgrade to these updated packages,\nwhich resolve these issues.",
  "cvss2": "2.6/AV:N/AC:H/Au:N/C:N/I:P/A:N",
  "severity": "Critical",
  "impact": "moderate",
  "affected": {
    "family": "unix",
    "platforms": [
      "Red Hat Enterprise Linux 4"
    ],
    "cpes": [
      {
        "cpe": "cpe:/o:redhat:enterprise_linux:4"
      },
      {
        "cpe": "cpe:/o:redhat:enterprise_linux:4::as",
        "repository": [
          "rhel-4-for-power-rpms",
          "rhel-4-as-source-rpms",
          "rhel-4-for-system-z-source-rpms",
          "rhel-4-for-power-source-rpms",
          "rhel-4-as-rpms",
          "rhel-4-for-system-z-rpms"
        ]
      },
      {
        "cpe": "cpe:/o:redhat:enterprise_linux:4::desktop",
        "repository": [
          "rhel-4-desktop-rpms",
          "rhel-4-desktop-source-rpms"
        ]
      },
      {
        "cpe": "cpe:/o:redhat:enterprise_linux:4::es",
        "repository": [
          "rhel-4-es-rpms",
          "rhel-4-es-source-rpms"
        ]
      },
      {
        "cpe": "cpe:/o:redhat:enterprise_linux:4::ws",
        "repository": [
          "rhel-4-ws-rpms",
          "rhel-4-ws-source-rpms"
        ]
      }
    ]
  },
  "packages": [
    {
      "name": "nspr",
      "status": "Fixed",
      "fixed_version": "0:4.7.4-1.el4_8.1",
      "arch": "ppc64"
    },
    {
      "name": "nss",
      "status": "Fixed",
      "fixed_version": "0:3.12.3.99.3-1.el4_8.2",
      "arch": "ppc64"
    },
    {
      "name": "nss-devel",
      "status": "Fixed",
      "fixed_version": "0:3.12.3.99.3-1.el4_8.2",
      "arch": "i386"
    },
    {
      "name": "nss-devel",
      "status": "Fixed",
      "fixed_version": "0:3.12.3.99.3-1.el4_8.2",
      "arch": "ppc"
    },
    {
      "name": "nspr",
      "status": "Fixed",
      "fixed_version": "0:4.7.4-1.el4_8.1",
      "arch": "ppc"
    },
    {
      "name": "nspr-devel",
      "status": "Fixed",
      "fixed_version": "0:4.7.4-1.el4_8.1",
      "arch": "s390"
    },
    {
      "name": "nss-tools",
      "status": "Fixed",
      "fixed_version": "0:3.12.3.99.3-1.el4_8.2",
      "arch": "ia64"
    },
    {
      "name": "nspr",
      "status": "Fixed",
      "fixed_version": "0:4.7.4-1.el4_8.1",
      "arch": "s390x"
    },
    {
      "name": "nspr",
      "status": "Fixed",
      "fixed_version": "0:4.7.4-1.el4_8.1",
      "arch": "s390"
    },
    {
      "name": "nss",
      "status": "Fixed",
      "fixed_version": "0:3.12.3.99.3-1.el4_8.2",
      "arch": "i386"
    },
    {
      "name": "nss-tools",
      "status": "Fixed",
      "fixed_version": "0:3.12.3.99.3-1.el4_8.2",
      "arch": "s390x"
    },
    {
      "name": "nss-devel",
      "status": "Fixed",
      "fixed_version": "0:3.12.3.99.3-1.el4_8.2",
      "arch": "s390x"
    },
    {
      "name": "nspr-devel",
      "status": "Fixed",
      "fixed_version": "0:4.7.4-1.el4_8.1",
      "arch": "ppc"
    },
    {
      "name": "nss",
      "status": "Fixed",
      "fixed_version": "0:3.12.3.99.3-1.el4_8.2",
      "arch": "ppc"
    },
    {
      "name": "nspr-devel",
      "status": "Fixed",
      "fixed_version": "0:4.7.4-1.el4_8.1",
      "arch": "s390x"
    },
    {
      "name": "nspr-devel",
      "status": "Fixed",
      "fixed_version": "0:4.7.4-1.el4_8.1",
      "arch": "i386"
    },
    {
      "name": "nspr-devel",
      "status": "Fixed",
      "fixed_version": "0:4.7.4-1.el4_8.1",
      "arch": "x86_64"
    },
    {
      "name": "nss-devel",
      "status": "Fixed",
      "fixed_version": "0:3.12.3.99.3-1.el4_8.2",
      "arch": "x86_64"
    },
    {
      "name": "nss-tools",
      "status": "Fixed",
      "fixed_version": "0:3.12.3.99.3-1.el4_8.2",
      "arch": "s390"
    },
    {
      "name": "nss-tools",
      "status": "Fixed",
      "fixed_version": "0:3.12.3.99.3-1.el4_8.2",
      "arch": "x86_64"
    },
    {
      "name": "nspr-devel",
      "status": "Fixed",
      "fixed_version": "0:4.7.4-1.el4_8.1",
      "arch": "ia64"
    },
    {
      "name": "nss-tools",
      "status": "Fixed",
      "fixed_version": "0:3.12.3.99.3-1.el4_8.2",
      "arch": "i386"
    },
    {
      "name": "nss",
      "status": "Fixed",
      "fixed_version": "0:3.12.3.99.3-1.el4_8.2",
      "arch": "s390"
    },
    {
      "name": "nss",
      "status": "Fixed",
      "fixed_version": "0:3.12.3.99.3-1.el4_8.2",
      "arch": "ia64"
    },
    {
      "name": "nss-devel",
      "status": "Fixed",
      "fixed_version": "0:3.12.3.99.3-1.el4_8.2",
      "arch": "s390"
    },
    {
      "name": "nspr",
      "status": "Fixed",
      "fixed_version": "0:4.7.4-1.el4_8.1",
      "arch": "i386"
    },
    {
      "name": "nss-devel",
      "status": "Fixed",
      "fixed_version": "0:3.12.3.99.3-1.el4_8.2",
      "arch": "ia64"
    },
    {
      "name": "nspr",
      "status": "Fixed",
      "fixed_version": "0:4.7.4-1.el4_8.1",
      "arch": "x86_64"
    },
    {
      "name": "nss",
      "status": "Fixed",
      "fixed_version": "0:3.12.3.99.3-1.el4_8.2",
      "arch": "s390x"
    },
    {
      "name": "nspr",
      "status": "Fixed",
      "fixed_version": "0:4.7.4-1.el4_8.1",
      "arch": "ia64"
    },
    {
      "name": "nss-tools",
      "status": "Fixed",
      "fixed_version": "0:3.12.3.99.3-1.el4_8.2",
      "arch": "ppc"
    },
    {
      "name": "nss",
      "status": "Fixed",
      "fixed_version": "0:3.12.3.99.3-1.el4_8.2",
      "arch": "x86_64"
    }
  ],
  "references": [
    {
      "id": "RHSA-2009:1184",
      "source": "RHSA",
      "url": "https://access.redhat.com/errata/RHSA-2009:1184"
    },
    {
      "id": "CVE-2009-2404",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2009-2404"
    },
    {
      "id": "CVE-2009-2408",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2009-2408"
    },
    {
      "id": "CVE-2009-2409",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2009-2409"
    },
    {
      "id": "CVE-2009-2409 deprecate MD2 in SSL cert validation (Kaminsky)",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/510197"
    },
    {
      "id": "CVE-2009-2408 firefox/nss: doesn't handle NULL in Common Name properly",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/510251"
    },
    {
      "id": "CVE-2009-2404 nss regexp heap overflow",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/512912"
    }
  ],
  "public": "2009-07-29T00:00:00Z",
  "issued": "2009-07-30T00:00:00Z",
  "updated": "2009-07-30T00:00:00Z"
}
