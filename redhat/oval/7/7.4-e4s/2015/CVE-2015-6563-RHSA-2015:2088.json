{
  "id": "CVE-2015-6563",
  "rhsa_id": "RHSA-2015:2088",
  "definition_id": "oval:com.redhat.rhsa:def:20152088",
  "title": "RHSA-2015:2088: openssh security, bug fix, and enhancement update (Moderate)",
  "description": "OpenSSH is OpenBSD's SSH (Secure Shell) protocol implementation. These\npackages include the core files necessary for both the OpenSSH client and\nserver.\n\nA flaw was found in the way OpenSSH handled PAM authentication when using\nprivilege separation. An attacker with valid credentials on the system and\nable to fully compromise a non-privileged pre-authentication process using\na different flaw could use this flaw to authenticate as other users.\n(CVE-2015-6563)\n\nA use-after-free flaw was found in OpenSSH. An attacker able to fully\ncompromise a non-privileged pre-authentication process using a different\nflaw could possibly cause sshd to crash or execute arbitrary code with\nroot privileges. (CVE-2015-6564)\n\nIt was discovered that the OpenSSH sshd daemon did not check the list of\nkeyboard-interactive authentication methods for duplicates. A remote\nattacker could use this flaw to bypass the MaxAuthTries limit, making it\neasier to perform password guessing attacks. (CVE-2015-5600)\n\nIt was found that the OpenSSH ssh-agent, a program to hold private keys\nused for public key authentication, was vulnerable to password guessing\nattacks. An attacker able to connect to the agent could use this flaw to\nconduct a brute-force attack to unlock keys in the ssh-agent. (BZ#1238238)\n\nThis update fixes the following bugs:\n\n* Previously, the sshd_config(5) man page was misleading and could thus\nconfuse the user. This update improves the man page text to clearly\ndescribe the AllowGroups feature. (BZ#1150007)\n\n* The limit for the function for restricting the number of files listed using the wildcard character (*) that prevents the Denial of Service (DoS) for both server and client was previously set too low. Consequently, the user reaching the limit was prevented from listing a directory with a large number of files over Secure File Transfer Protocol (SFTP). This update increases the aforementioned limit, thus fixing this bug. (BZ#1160377)\n\n* When the ForceCommand option with a pseudoterminal was used and the\nMaxSession option was set to \"2\", multiplexed SSH connections did not work\nas expected. After the user attempted to open a second multiplexed\nconnection, the attempt failed if the first connection was still open. This\nupdate modifies OpenSSH to issue only one audit message per session, and\nthe user is thus able to open two multiplexed connections in this\nsituation. (BZ#1199112)\n\n* The ssh-copy-id utility failed if the account on the remote server did\nnot use an sh-like shell. Remote commands have been modified to run in an\nsh-like shell, and ssh-copy-id now works also with non-sh-like shells.\n(BZ#1201758)\n\n* Due to a race condition between auditing messages and answers when using\nControlMaster multiplexing, one session in the shared connection randomly\nand unexpectedly exited the connection. This update fixes the race\ncondition in the auditing code, and multiplexing connections now work as\nexpected even with a number of sessions created at once. (BZ#1240613)\n\nIn addition, this update adds the following enhancements:\n\n* As not all Lightweight Directory Access Protocol (LDAP) servers possess\na default schema, as expected by the ssh-ldap-helper program, this update\nprovides the user with an ability to adjust the LDAP query to get public\nkeys from servers with a different schema, while the default functionality\nstays untouched. (BZ#1201753)\n\n* With this enhancement update, the administrator is able to set\npermissions for files uploaded using Secure File Transfer Protocol (SFTP).\n(BZ#1197989)\n\n* This update provides the LDAP schema in LDAP Data Interchange Format (LDIF) format as a complement to the old schema previously accepted\nby OpenLDAP. (BZ#1184938)\n\n* With this update, the user can selectively disable the Generic Security\nServices API (GSSAPI) key exchange algorithms as any normal key exchange.\n(BZ#1253062)\n\nUsers of openssh are advised to upgrade to these updated packages, which\ncorrect these issues and add these enhancements.",
  "cvss2": "6.2/AV:L/AC:H/Au:N/C:C/I:C/A:C",
  "cwe": "CWE-266",
  "severity": "Moderate",
  "impact": "moderate",
  "affected": {
    "family": "unix",
    "platforms": [
      "Red Hat Enterprise Linux 7"
    ],
    "cpes": [
      {
        "cpe": "cpe:/a:redhat:rhel_extras_sap_e4s:7.4",
        "repository": [
          "rhel-sap-for-rhel-7-server-e4s-source-rpms__7_DOT_4__x86_64",
          "rhel-sap-for-rhel-7-for-power-le-e4s-rpms",
          "rhel-sap-for-rhel-7-for-power-le-e4s-source-rpms",
          "rhel-sap-for-rhel-7-for-power-le-e4s-debug-rpms",
          "rhel-sap-for-rhel-7-server-e4s-rpms__7_DOT_4__x86_64",
          "rhel-sap-for-rhel-7-server-e4s-rpms",
          "rhel-sap-for-rhel-7-server-e4s-source-rpms",
          "rhel-sap-for-rhel-7-for-power-le-e4s-rpms__7_DOT_4__ppc64le",
          "rhel-sap-for-rhel-7-for-power-le-e4s-debug-rpms__7_DOT_4__ppc64le",
          "rhel-sap-for-rhel-7-for-power-le-e4s-source-rpms__7_DOT_4__ppc64le",
          "rhel-sap-for-rhel-7-server-e4s-debug-rpms",
          "rhel-sap-for-rhel-7-server-e4s-debug-rpms__7_DOT_4__x86_64"
        ]
      },
      {
        "cpe": "cpe:/a:redhat:rhel_extras_sap_hana_e4s:7.4",
        "repository": [
          "rhel-sap-hana-for-rhel-7-for-power-le-e4s-rpms",
          "rhel-sap-hana-for-rhel-7-server-e4s-source-rpms",
          "rhel-sap-hana-for-rhel-7-for-power-le-e4s-debug-rpms__7_DOT_4__ppc64le",
          "rhel-sap-hana-for-rhel-7-server-e4s-rpms__7_DOT_4__x86_64",
          "rhel-sap-hana-for-rhel-7-for-power-le-e4s-source-rpms__7_DOT_4__ppc64le",
          "rhel-sap-hana-for-rhel-7-server-e4s-debug-rpms__7_DOT_4__x86_64",
          "rhel-sap-hana-for-rhel-7-server-e4s-source-rpms__7_DOT_4__x86_64",
          "rhel-sap-hana-for-rhel-7-for-power-le-e4s-debug-rpms",
          "rhel-sap-hana-for-rhel-7-for-power-le-e4s-rpms__7_DOT_4__ppc64le",
          "rhel-sap-hana-for-rhel-7-for-power-le-e4s-source-rpms",
          "rhel-sap-hana-for-rhel-7-server-e4s-debug-rpms",
          "rhel-sap-hana-for-rhel-7-server-e4s-rpms"
        ]
      },
      {
        "cpe": "cpe:/o:redhat:rhel_e4s:7.4"
      },
      {
        "cpe": "cpe:/o:redhat:rhel_e4s:7.4::server",
        "repository": [
          "rhel-7-for-power-le-e4s-optional-debug-rpms",
          "rhel-7-server-aus-debug-rpms",
          "rhel-7-server-e4s-source-rpms",
          "rhel-ha-for-rhel-7-server-for-power-le-e4s-source-rpms",
          "rhel-7-server-e4s-optional-source-rpms__7_DOT_4__x86_64",
          "rhel-ha-for-rhel-7-server-e4s-debug-rpms",
          "rhel-7-server-tus-rpms",
          "rhel-ha-for-rhel-7-server-for-power-le-e4s-debug-rpms",
          "rhel-7-server-e4s-debug-rpms__7_DOT_4__x86_64",
          "rhel-7-for-power-le-e4s-rpms__7_DOT_4__ppc64le",
          "rhel-7-server-tus-optional-rpms",
          "rhel-7-server-e4s-optional-rpms__7_DOT_4__x86_64",
          "rhel-7-server-aus-rpms",
          "rhel-ha-for-rhel-7-server-for-power-le-e4s-source-rpms__7_DOT_4__ppc64le",
          "rhel-7-for-power-le-e4s-debug-rpms__7_DOT_4__ppc64le",
          "rhel-ha-for-rhel-7-server-e4s-debug-rpms__7_DOT_4__x86_64",
          "rhel-7-server-e4s-rpms__7_DOT_4__x86_64",
          "rhel-7-server-e4s-source-rpms__7_DOT_4__x86_64",
          "rhel-7-for-power-le-e4s-debug-rpms",
          "rhel-7-server-tus-debug-rpms",
          "rhel-7-for-power-le-e4s-source-rpms",
          "rhel-7-for-power-le-e4s-optional-source-rpms__7_DOT_4__ppc64le",
          "rhel-7-server-aus-optional-debug-rpms",
          "rhel-7-for-power-le-e4s-optional-rpms__7_DOT_4__ppc64le",
          "rhel-7-server-tus-optional-source-rpms",
          "rhel-ha-for-rhel-7-server-for-power-le-e4s-rpms__7_DOT_4__ppc64le",
          "rhel-ha-for-rhel-7-server-e4s-rpms__7_DOT_4__x86_64",
          "rhel-7-server-e4s-optional-source-rpms",
          "rhel-7-server-aus-optional-rpms",
          "rhel-7-for-power-le-e4s-source-rpms__7_DOT_4__ppc64le",
          "rhel-7-for-power-le-e4s-optional-source-rpms",
          "rhel-7-server-tus-source-rpms",
          "rhel-7-server-e4s-debug-rpms",
          "rhel-ha-for-rhel-7-server-e4s-source-rpms",
          "rhel-7-server-e4s-optional-debug-rpms__7_DOT_4__x86_64",
          "rhel-7-for-power-le-e4s-optional-debug-rpms__7_DOT_4__ppc64le",
          "rhel-ha-for-rhel-7-server-for-power-le-e4s-debug-rpms__7_DOT_4__ppc64le",
          "rhel-ha-for-rhel-7-server-for-power-le-e4s-rpms",
          "rhel-7-for-power-le-e4s-optional-rpms",
          "rhel-ha-for-rhel-7-server-e4s-rpms",
          "rhel-7-for-power-le-e4s-rpms",
          "rhel-7-server-aus-optional-source-rpms",
          "rhel-7-server-e4s-optional-rpms",
          "rhel-ha-for-rhel-7-server-e4s-source-rpms__7_DOT_4__x86_64",
          "rhel-7-server-tus-optional-debug-rpms",
          "rhel-7-server-e4s-optional-debug-rpms",
          "rhel-7-server-e4s-rpms",
          "rhel-7-server-aus-source-rpms"
        ]
      }
    ]
  },
  "packages": [
    {
      "name": "openssh-ldap",
      "status": "Fixed",
      "fixed_version": "0:6.6.1p1-22.el7",
      "arch": "ppc64le"
    },
    {
      "name": "openssh-server-sysvinit",
      "status": "Fixed",
      "fixed_version": "0:6.6.1p1-22.el7",
      "arch": "x86_64"
    },
    {
      "name": "openssh-server-sysvinit",
      "status": "Fixed",
      "fixed_version": "0:6.6.1p1-22.el7",
      "arch": "aarch64"
    },
    {
      "name": "openssh-server",
      "status": "Fixed",
      "fixed_version": "0:6.6.1p1-22.el7",
      "arch": "ppc64le"
    },
    {
      "name": "openssh-askpass",
      "status": "Fixed",
      "fixed_version": "0:6.6.1p1-22.el7",
      "arch": "x86_64"
    },
    {
      "name": "pam_ssh_agent_auth",
      "status": "Fixed",
      "fixed_version": "0:0.9.3-9.22.el7",
      "arch": "s390x"
    },
    {
      "name": "pam_ssh_agent_auth",
      "status": "Fixed",
      "fixed_version": "0:0.9.3-9.22.el7",
      "arch": "ppc64"
    },
    {
      "name": "openssh-ldap",
      "status": "Fixed",
      "fixed_version": "0:6.6.1p1-22.el7",
      "arch": "aarch64"
    },
    {
      "name": "openssh",
      "status": "Fixed",
      "fixed_version": "0:6.6.1p1-22.el7",
      "arch": "aarch64"
    },
    {
      "name": "openssh-clients",
      "status": "Fixed",
      "fixed_version": "0:6.6.1p1-22.el7",
      "arch": "x86_64"
    },
    {
      "name": "openssh-keycat",
      "status": "Fixed",
      "fixed_version": "0:6.6.1p1-22.el7",
      "arch": "x86_64"
    },
    {
      "name": "openssh-server-sysvinit",
      "status": "Fixed",
      "fixed_version": "0:6.6.1p1-22.el7",
      "arch": "ppc64"
    },
    {
      "name": "openssh-server",
      "status": "Fixed",
      "fixed_version": "0:6.6.1p1-22.el7",
      "arch": "aarch64"
    },
    {
      "name": "openssh-ldap",
      "status": "Fixed",
      "fixed_version": "0:6.6.1p1-22.el7",
      "arch": "x86_64"
    },
    {
      "name": "openssh-keycat",
      "status": "Fixed",
      "fixed_version": "0:6.6.1p1-22.el7",
      "arch": "aarch64"
    },
    {
      "name": "openssh-askpass",
      "status": "Fixed",
      "fixed_version": "0:6.6.1p1-22.el7",
      "arch": "ppc64"
    },
    {
      "name": "openssh",
      "status": "Fixed",
      "fixed_version": "0:6.6.1p1-22.el7",
      "arch": "x86_64"
    },
    {
      "name": "openssh-clients",
      "status": "Fixed",
      "fixed_version": "0:6.6.1p1-22.el7",
      "arch": "s390x"
    },
    {
      "name": "openssh-server",
      "status": "Fixed",
      "fixed_version": "0:6.6.1p1-22.el7",
      "arch": "x86_64"
    },
    {
      "name": "pam_ssh_agent_auth",
      "status": "Fixed",
      "fixed_version": "0:0.9.3-9.22.el7",
      "arch": "x86_64"
    },
    {
      "name": "pam_ssh_agent_auth",
      "status": "Fixed",
      "fixed_version": "0:0.9.3-9.22.el7",
      "arch": "i686"
    },
    {
      "name": "openssh-ldap",
      "status": "Fixed",
      "fixed_version": "0:6.6.1p1-22.el7",
      "arch": "ppc64"
    },
    {
      "name": "openssh-ldap",
      "status": "Fixed",
      "fixed_version": "0:6.6.1p1-22.el7",
      "arch": "s390x"
    },
    {
      "name": "openssh-server-sysvinit",
      "status": "Fixed",
      "fixed_version": "0:6.6.1p1-22.el7",
      "arch": "s390x"
    },
    {
      "name": "pam_ssh_agent_auth",
      "status": "Fixed",
      "fixed_version": "0:0.9.3-9.22.el7",
      "arch": "ppc64le"
    },
    {
      "name": "pam_ssh_agent_auth",
      "status": "Fixed",
      "fixed_version": "0:0.9.3-9.22.el7",
      "arch": "s390"
    },
    {
      "name": "openssh-askpass",
      "status": "Fixed",
      "fixed_version": "0:6.6.1p1-22.el7",
      "arch": "ppc64le"
    },
    {
      "name": "openssh-server",
      "status": "Fixed",
      "fixed_version": "0:6.6.1p1-22.el7",
      "arch": "ppc64"
    },
    {
      "name": "openssh-askpass",
      "status": "Fixed",
      "fixed_version": "0:6.6.1p1-22.el7",
      "arch": "s390x"
    },
    {
      "name": "openssh-server",
      "status": "Fixed",
      "fixed_version": "0:6.6.1p1-22.el7",
      "arch": "s390x"
    },
    {
      "name": "openssh",
      "status": "Fixed",
      "fixed_version": "0:6.6.1p1-22.el7",
      "arch": "ppc64le"
    },
    {
      "name": "pam_ssh_agent_auth",
      "status": "Fixed",
      "fixed_version": "0:0.9.3-9.22.el7",
      "arch": "aarch64"
    },
    {
      "name": "openssh-clients",
      "status": "Fixed",
      "fixed_version": "0:6.6.1p1-22.el7",
      "arch": "ppc64le"
    },
    {
      "name": "openssh-keycat",
      "status": "Fixed",
      "fixed_version": "0:6.6.1p1-22.el7",
      "arch": "ppc64"
    },
    {
      "name": "openssh",
      "status": "Fixed",
      "fixed_version": "0:6.6.1p1-22.el7",
      "arch": "ppc64"
    },
    {
      "name": "openssh-askpass",
      "status": "Fixed",
      "fixed_version": "0:6.6.1p1-22.el7",
      "arch": "aarch64"
    },
    {
      "name": "openssh-clients",
      "status": "Fixed",
      "fixed_version": "0:6.6.1p1-22.el7",
      "arch": "ppc64"
    },
    {
      "name": "pam_ssh_agent_auth",
      "status": "Fixed",
      "fixed_version": "0:0.9.3-9.22.el7",
      "arch": "ppc"
    },
    {
      "name": "openssh-keycat",
      "status": "Fixed",
      "fixed_version": "0:6.6.1p1-22.el7",
      "arch": "ppc64le"
    },
    {
      "name": "openssh-keycat",
      "status": "Fixed",
      "fixed_version": "0:6.6.1p1-22.el7",
      "arch": "s390x"
    },
    {
      "name": "openssh",
      "status": "Fixed",
      "fixed_version": "0:6.6.1p1-22.el7",
      "arch": "s390x"
    },
    {
      "name": "openssh-server-sysvinit",
      "status": "Fixed",
      "fixed_version": "0:6.6.1p1-22.el7",
      "arch": "ppc64le"
    },
    {
      "name": "openssh-clients",
      "status": "Fixed",
      "fixed_version": "0:6.6.1p1-22.el7",
      "arch": "aarch64"
    }
  ],
  "references": [
    {
      "id": "RHSA-2015:2088",
      "source": "RHSA",
      "url": "https://access.redhat.com/errata/RHSA-2015:2088"
    },
    {
      "id": "CVE-2015-5600",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2015-5600"
    },
    {
      "id": "CVE-2015-6563",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2015-6563"
    },
    {
      "id": "CVE-2015-6564",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2015-6564"
    },
    {
      "id": "CVE-2015-5600 openssh: MaxAuthTries limit bypass via duplicates in KbdInteractiveDevices",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1245969"
    },
    {
      "id": "CVE-2015-6563 openssh: Privilege separation weakness related to PAM support",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1252844"
    },
    {
      "id": "CVE-2015-6564 openssh: Use-after-free bug related to PAM support",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1252852"
    }
  ],
  "public": "2015-08-11T00:00:00Z",
  "issued": "2015-11-19T00:00:00Z",
  "updated": "2015-11-19T00:00:00Z"
}
