{
  "id": "CVE-2018-18397",
  "rhsa_id": "RHSA-2019:0324",
  "definition_id": "oval:com.redhat.rhsa:def:20190324",
  "title": "RHSA-2019:0324: kernel security and bug fix update (Moderate)",
  "description": "The kernel packages contain the Linux kernel, the core of any Linux operating system.\n\nSecurity Fix(es):\n\n* kernel: userfaultfd bypasses tmpfs file permissions (CVE-2018-18397)\n\nFor more details about the security issue(s), including the impact, a CVSS score, and other related information, refer to the CVE page(s) listed in the References section.\n\nBug Fix(es):\n\n* The timeout handling in the libfc.ko kernel module did not work correctly. This was happening during certain steps of the Fibre Channel login procedure, when the timeout handling was not synchronized with the state of a partially offloaded Fibre Channel over Ethernet (FCoE) in the lower-level driver. Consequently, the offloaded FCoE state was incorrect, which led to I/O timeout errors until the SCSI error recovery issued a host reset. This update fixes the bug by improving the libfc.ko error handling during the fabric login. As a result, the fabric login errors are addressed in time, without the I/O timeouts in the described scenario. (BZ#1655042)\n\n* Symmetric Multi-Processing (SMP) or Non-Uniform Memory Access (NUMA) systems in some cases experienced deadlocks during a task migration and task wakeup operations. Consequently, the systems terminated unexpectedly with the following message:\n\n    NMI watchdog: Watchdog detected hard LOCKUP on \u003csome CPU #\u003e\n\nThis update fixes the bug by queueing the stopper thread to run after locks are released. As a result, the deadlocks and the system crashes no longer occur in the described scenario. (BZ#1667326)\n\nUsers of kernel are advised to upgrade to these updated packages, which fix these bugs.",
  "cvss3": "6.1/CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:H/A:N",
  "cwe": "CWE-20",
  "severity": "Moderate",
  "impact": "moderate",
  "affected": {
    "family": "unix",
    "platforms": [
      "Red Hat Enterprise Linux 7.4 Extended Update Support"
    ],
    "cpes": [
      {
        "cpe": "cpe:/a:redhat:rhel_extras_sap_e4s:7.4",
        "repository": [
          "rhel-sap-for-rhel-7-for-power-le-e4s-rpms__7_DOT_4__ppc64le",
          "rhel-sap-for-rhel-7-server-e4s-rpms",
          "rhel-sap-for-rhel-7-for-power-le-e4s-rpms",
          "rhel-sap-for-rhel-7-server-e4s-debug-rpms__7_DOT_4__x86_64",
          "rhel-sap-for-rhel-7-server-e4s-source-rpms__7_DOT_4__x86_64",
          "rhel-sap-for-rhel-7-for-power-le-e4s-debug-rpms",
          "rhel-sap-for-rhel-7-server-e4s-source-rpms",
          "rhel-sap-for-rhel-7-for-power-le-e4s-debug-rpms__7_DOT_4__ppc64le",
          "rhel-sap-for-rhel-7-for-power-le-e4s-source-rpms",
          "rhel-sap-for-rhel-7-for-power-le-e4s-source-rpms__7_DOT_4__ppc64le",
          "rhel-sap-for-rhel-7-server-e4s-rpms__7_DOT_4__x86_64",
          "rhel-sap-for-rhel-7-server-e4s-debug-rpms"
        ]
      },
      {
        "cpe": "cpe:/a:redhat:rhel_extras_sap_hana_e4s:7.4",
        "repository": [
          "rhel-sap-hana-for-rhel-7-server-e4s-debug-rpms",
          "rhel-sap-hana-for-rhel-7-server-e4s-rpms",
          "rhel-sap-hana-for-rhel-7-server-e4s-debug-rpms__7_DOT_4__x86_64",
          "rhel-sap-hana-for-rhel-7-for-power-le-e4s-rpms",
          "rhel-sap-hana-for-rhel-7-server-e4s-source-rpms",
          "rhel-sap-hana-for-rhel-7-for-power-le-e4s-debug-rpms__7_DOT_4__ppc64le",
          "rhel-sap-hana-for-rhel-7-for-power-le-e4s-rpms__7_DOT_4__ppc64le",
          "rhel-sap-hana-for-rhel-7-server-e4s-source-rpms__7_DOT_4__x86_64",
          "rhel-sap-hana-for-rhel-7-for-power-le-e4s-source-rpms",
          "rhel-sap-hana-for-rhel-7-for-power-le-e4s-source-rpms__7_DOT_4__ppc64le",
          "rhel-sap-hana-for-rhel-7-for-power-le-e4s-debug-rpms",
          "rhel-sap-hana-for-rhel-7-server-e4s-rpms__7_DOT_4__x86_64"
        ]
      },
      {
        "cpe": "cpe:/o:redhat:rhel_e4s:7.4"
      },
      {
        "cpe": "cpe:/o:redhat:rhel_e4s:7.4::server",
        "repository": [
          "rhel-7-server-aus-rpms",
          "rhel-ha-for-rhel-7-server-e4s-debug-rpms__7_DOT_4__x86_64",
          "rhel-7-server-e4s-optional-rpms",
          "rhel-7-for-power-le-e4s-optional-source-rpms",
          "rhel-7-for-power-le-e4s-source-rpms",
          "rhel-7-server-e4s-rpms",
          "rhel-7-server-aus-optional-rpms",
          "rhel-7-server-e4s-debug-rpms",
          "rhel-7-server-e4s-optional-source-rpms__7_DOT_4__x86_64",
          "rhel-7-server-aus-source-rpms",
          "rhel-7-server-e4s-source-rpms__7_DOT_4__x86_64",
          "rhel-ha-for-rhel-7-server-for-power-le-e4s-source-rpms__7_DOT_4__ppc64le",
          "rhel-7-server-aus-optional-debug-rpms",
          "rhel-ha-for-rhel-7-server-for-power-le-e4s-debug-rpms__7_DOT_4__ppc64le",
          "rhel-7-server-tus-optional-debug-rpms",
          "rhel-7-for-power-le-e4s-debug-rpms__7_DOT_4__ppc64le",
          "rhel-7-server-e4s-optional-debug-rpms__7_DOT_4__x86_64",
          "rhel-7-for-power-le-e4s-optional-source-rpms__7_DOT_4__ppc64le",
          "rhel-7-server-e4s-source-rpms",
          "rhel-7-server-e4s-optional-source-rpms",
          "rhel-ha-for-rhel-7-server-e4s-source-rpms",
          "rhel-7-for-power-le-e4s-rpms",
          "rhel-7-for-power-le-e4s-optional-debug-rpms",
          "rhel-7-server-tus-rpms",
          "rhel-ha-for-rhel-7-server-e4s-debug-rpms",
          "rhel-7-for-power-le-e4s-optional-rpms__7_DOT_4__ppc64le",
          "rhel-7-server-tus-source-rpms",
          "rhel-7-for-power-le-e4s-optional-rpms",
          "rhel-7-for-power-le-e4s-source-rpms__7_DOT_4__ppc64le",
          "rhel-7-server-e4s-rpms__7_DOT_4__x86_64",
          "rhel-ha-for-rhel-7-server-for-power-le-e4s-rpms__7_DOT_4__ppc64le",
          "rhel-7-server-e4s-optional-rpms__7_DOT_4__x86_64",
          "rhel-ha-for-rhel-7-server-for-power-le-e4s-rpms",
          "rhel-ha-for-rhel-7-server-e4s-source-rpms__7_DOT_4__x86_64",
          "rhel-ha-for-rhel-7-server-for-power-le-e4s-source-rpms",
          "rhel-ha-for-rhel-7-server-e4s-rpms__7_DOT_4__x86_64",
          "rhel-ha-for-rhel-7-server-for-power-le-e4s-debug-rpms",
          "rhel-7-server-e4s-optional-debug-rpms",
          "rhel-7-server-aus-optional-source-rpms",
          "rhel-7-server-e4s-debug-rpms__7_DOT_4__x86_64",
          "rhel-7-server-tus-optional-rpms",
          "rhel-7-for-power-le-e4s-optional-debug-rpms__7_DOT_4__ppc64le",
          "rhel-7-server-tus-debug-rpms",
          "rhel-ha-for-rhel-7-server-e4s-rpms",
          "rhel-7-for-power-le-e4s-debug-rpms",
          "rhel-7-server-aus-debug-rpms",
          "rhel-7-for-power-le-e4s-rpms__7_DOT_4__ppc64le",
          "rhel-7-server-tus-optional-source-rpms"
        ]
      }
    ]
  },
  "packages": [
    {
      "name": "kernel-tools-libs",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-693.44.1.el7",
      "arch": "x86_64"
    },
    {
      "name": "kernel-debug",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-693.44.1.el7",
      "arch": "ppc64"
    },
    {
      "name": "kernel-devel",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-693.44.1.el7",
      "arch": "x86_64"
    },
    {
      "name": "kernel-devel",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-693.44.1.el7",
      "arch": "s390x"
    },
    {
      "name": "kernel-kdump-devel",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-693.44.1.el7",
      "arch": "s390x"
    },
    {
      "name": "kernel-tools-libs",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-693.44.1.el7",
      "arch": "ppc64le"
    },
    {
      "name": "kernel-tools",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-693.44.1.el7",
      "arch": "ppc64"
    },
    {
      "name": "kernel-doc",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-693.44.1.el7"
    },
    {
      "name": "kernel-debug-devel",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-693.44.1.el7",
      "arch": "ppc64le"
    },
    {
      "name": "kernel-abi-whitelists",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-693.44.1.el7"
    },
    {
      "name": "kernel-kdump",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-693.44.1.el7",
      "arch": "s390x"
    },
    {
      "name": "python-perf",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-693.44.1.el7",
      "arch": "x86_64"
    },
    {
      "name": "kernel-tools-libs-devel",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-693.44.1.el7",
      "arch": "ppc64le"
    },
    {
      "name": "kernel-debug",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-693.44.1.el7",
      "arch": "ppc64le"
    },
    {
      "name": "kernel-bootwrapper",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-693.44.1.el7",
      "arch": "ppc64"
    },
    {
      "name": "python-perf",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-693.44.1.el7",
      "arch": "s390x"
    },
    {
      "name": "kernel",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-693.44.1.el7",
      "arch": "ppc64le"
    },
    {
      "name": "kernel-devel",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-693.44.1.el7",
      "arch": "ppc64"
    },
    {
      "name": "kernel",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-693.44.1.el7",
      "arch": "x86_64"
    },
    {
      "name": "kernel-tools-libs-devel",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-693.44.1.el7",
      "arch": "x86_64"
    },
    {
      "name": "perf",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-693.44.1.el7",
      "arch": "s390x"
    },
    {
      "name": "kernel-devel",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-693.44.1.el7",
      "arch": "ppc64le"
    },
    {
      "name": "python-perf",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-693.44.1.el7",
      "arch": "ppc64"
    },
    {
      "name": "perf",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-693.44.1.el7",
      "arch": "x86_64"
    },
    {
      "name": "perf",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-693.44.1.el7",
      "arch": "ppc64"
    },
    {
      "name": "kernel-debug",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-693.44.1.el7",
      "arch": "s390x"
    },
    {
      "name": "kernel-debug-devel",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-693.44.1.el7",
      "arch": "ppc64"
    },
    {
      "name": "kernel-debug-devel",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-693.44.1.el7",
      "arch": "x86_64"
    },
    {
      "name": "perf",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-693.44.1.el7",
      "arch": "ppc64le"
    },
    {
      "name": "kernel-headers",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-693.44.1.el7",
      "arch": "ppc64"
    },
    {
      "name": "kernel-headers",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-693.44.1.el7",
      "arch": "ppc64le"
    },
    {
      "name": "kernel-tools-libs-devel",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-693.44.1.el7",
      "arch": "ppc64"
    },
    {
      "name": "python-perf",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-693.44.1.el7",
      "arch": "ppc64le"
    },
    {
      "name": "kernel-tools",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-693.44.1.el7",
      "arch": "x86_64"
    },
    {
      "name": "kernel-tools-libs",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-693.44.1.el7",
      "arch": "ppc64"
    },
    {
      "name": "kernel-debug-devel",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-693.44.1.el7",
      "arch": "s390x"
    },
    {
      "name": "kernel",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-693.44.1.el7",
      "arch": "s390x"
    },
    {
      "name": "kernel-headers",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-693.44.1.el7",
      "arch": "s390x"
    },
    {
      "name": "kernel-debug",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-693.44.1.el7",
      "arch": "x86_64"
    },
    {
      "name": "kernel-bootwrapper",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-693.44.1.el7",
      "arch": "ppc64le"
    },
    {
      "name": "kernel-tools",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-693.44.1.el7",
      "arch": "ppc64le"
    },
    {
      "name": "kernel-headers",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-693.44.1.el7",
      "arch": "x86_64"
    },
    {
      "name": "kernel",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-693.44.1.el7",
      "arch": "ppc64"
    }
  ],
  "references": [
    {
      "id": "RHSA-2019:0324",
      "source": "RHSA",
      "url": "https://access.redhat.com/errata/RHSA-2019:0324"
    },
    {
      "id": "CVE-2018-18397",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2018-18397"
    },
    {
      "id": "CVE-2018-18397 kernel: userfaultfd bypasses tmpfs file permissions",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1641548"
    }
  ],
  "public": "2018-11-26T00:00:00Z",
  "issued": "2019-02-12T00:00:00Z",
  "updated": "2019-02-12T00:00:00Z"
}
