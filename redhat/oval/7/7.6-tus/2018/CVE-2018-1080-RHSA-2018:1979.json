{
  "id": "CVE-2018-1080",
  "rhsa_id": "RHSA-2018:1979",
  "definition_id": "oval:com.redhat.rhsa:def:20181979",
  "title": "RHSA-2018:1979: pki-core security, bug fix, and enhancement update (Moderate)",
  "description": "The Public Key Infrastructure (PKI) Core contains fundamental packages required by Red Hat Certificate System.\n\nSecurity Fix(es):\n\n* pki-core: Mishandled ACL configuration in AAclAuthz.java reverses rules that allow and deny access (CVE-2018-1080)\n\nFor more details about the security issue(s), including the impact, a CVSS score, and other related information, refer to the CVE page(s) listed in the References section.\n\nThis issue was discovered by Fraser Tweedale (Red Hat).\n\nBug Fix(es):\n\n* Previously, when ECC keys were enrolled, Certificate Management over CMS (CMC) authentication failed with a \"TokenException: Unable to insert certificate into temporary database\" error. As a consequence, the enrollment failed. This update fixes the problem. As a result, the mentioned bug no longer occurs. (BZ#1550581)\n\n* Previously, Certificate System used the same enrollment profiles for issuing RSA and ECC certificates. As a consequence, the key usage extension in issued certificates did not meet the Common Criteria standard. This update adds ECC-specific enrollment profiles where the key usage extension for TLS server and client certificates are different as described in RFC 6960. Additionally, the update changes existing profiles to issue only RSA certificates. As a result, the key usage extension in ECC certificates now meets the Common Criteria standard. (BZ#1554726)\n\n* The Certificate System server rejects saving invalid access control lists (ACL). As a consequence, when saving an ACL with an empty expression, the server rejected the update and the pkiconsole utility displayed an StringIndexOutOfBoundsException error. With this update, the utility rejects empty ACL expressions. As a result, invalid ACLs cannot be saved and the error is no longer displayed. (BZ#1557883)\n\n* Previously, due to a bug in the Certificate System installation procedure, installing a Key Recovery Authority (KRA) with ECC keys failed. To fix the problem, the installation process has been updated to handle both RSA and ECC subsystems automatically. As a result, installing subsystems with ECC keys no longer fail. (BZ#1581134)\n\n* Previously, during verification, Certificate System encoded the ECC public key incorrectly in CMC Certificate Request Message Format (CRMF) requests. As a consequence, requesting an ECC certificate with Certificate Management over CMS (CMC) in CRMF failed. The problem has been fixed, and as a result, CMC CRMF requests using ECC keys work as expected. (BZ#1585945)\n\nEnhancement(s):\n\n* The pkispawn man page has been updated and now describes the --skip-configuration and --skip-installation parameters. (BZ#1551067)\n\n* With this update, Certificate System adds the Subject Alternative Name (SAN) extension by default to server certificates and sets it to the Common Name (CN) of the certificate. (BZ#1581135)\n\n* With this enhancement, users can create Certificate Request Message Format (CRMF) requests without the key archival option when using the CRMFPopClient utility. This feature increases flexibility because a Key Recovery Authority (KRA) certificate is no longer required. Previously, if the user did not pass the \"-b transport_certificate_file\" option to CRMFPopClient, the utility automatically used the KRA transport certificate stored in the transport.txt file. With this update, if \"-b transport_certificate_file\" is not specified, Certificate System creates a request without using key archival. (BZ#1588945)",
  "cvss3": "7.5/CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H",
  "cwe": "CWE-284",
  "severity": "Moderate",
  "impact": "moderate",
  "affected": {
    "family": "unix",
    "platforms": [
      "Red Hat Enterprise Linux 7"
    ],
    "cpes": [
      {
        "cpe": "cpe:/o:redhat:rhel_tus:7.6"
      },
      {
        "cpe": "cpe:/o:redhat:rhel_tus:7.6::server",
        "repository": [
          "rhel-7-server-tus-optional-rpms__7_DOT_6__x86_64",
          "rhel-7-server-tus-optional-rpms",
          "rhel-7-server-tus-optional-source-rpms",
          "rhel-7-server-tus-source-rpms",
          "rhel-7-server-tus-debug-rpms__7_DOT_6__x86_64",
          "rhel-ha-for-rhel-7-server-tus-source-rpms__7_DOT_6__x86_64",
          "rhel-7-server-tus-optional-source-rpms__7_DOT_6__x86_64",
          "rhel-ha-for-rhel-7-server-tus-rpms",
          "rhel-ha-for-rhel-7-server-tus-debug-rpms__7_DOT_6__x86_64",
          "rhel-ha-for-rhel-7-server-tus-source-rpms",
          "rhel-7-server-tus-rpms",
          "rhel-7-server-tus-optional-debug-rpms",
          "rhel-7-server-tus-debug-rpms",
          "rhel-ha-for-rhel-7-server-tus-rpms__7_DOT_6__x86_64",
          "rhel-7-server-tus-rpms__7_DOT_6__x86_64",
          "rhel-7-server-tus-optional-debug-rpms__7_DOT_6__x86_64",
          "rhel-7-server-tus-source-rpms__7_DOT_6__x86_64",
          "rhel-ha-for-rhel-7-server-tus-debug-rpms"
        ]
      }
    ]
  },
  "packages": [
    {
      "name": "pki-tools",
      "status": "Fixed",
      "fixed_version": "0:10.5.1-13.1.el7_5",
      "arch": "ppc64"
    },
    {
      "name": "pki-symkey",
      "status": "Fixed",
      "fixed_version": "0:10.5.1-13.1.el7_5",
      "arch": "ppc64"
    },
    {
      "name": "pki-tools",
      "status": "Fixed",
      "fixed_version": "0:10.5.1-13.1.el7_5",
      "arch": "aarch64"
    },
    {
      "name": "pki-server",
      "status": "Fixed",
      "fixed_version": "0:10.5.1-13.1.el7_5"
    },
    {
      "name": "pki-symkey",
      "status": "Fixed",
      "fixed_version": "0:10.5.1-13.1.el7_5",
      "arch": "s390x"
    },
    {
      "name": "pki-tools",
      "status": "Fixed",
      "fixed_version": "0:10.5.1-13.1.el7_5",
      "arch": "ppc64le"
    },
    {
      "name": "pki-base-java",
      "status": "Fixed",
      "fixed_version": "0:10.5.1-13.1.el7_5"
    },
    {
      "name": "pki-kra",
      "status": "Fixed",
      "fixed_version": "0:10.5.1-13.1.el7_5"
    },
    {
      "name": "pki-tools",
      "status": "Fixed",
      "fixed_version": "0:10.5.1-13.1.el7_5",
      "arch": "s390x"
    },
    {
      "name": "pki-symkey",
      "status": "Fixed",
      "fixed_version": "0:10.5.1-13.1.el7_5",
      "arch": "aarch64"
    },
    {
      "name": "pki-base",
      "status": "Fixed",
      "fixed_version": "0:10.5.1-13.1.el7_5"
    },
    {
      "name": "pki-symkey",
      "status": "Fixed",
      "fixed_version": "0:10.5.1-13.1.el7_5",
      "arch": "ppc64le"
    },
    {
      "name": "pki-symkey",
      "status": "Fixed",
      "fixed_version": "0:10.5.1-13.1.el7_5",
      "arch": "x86_64"
    },
    {
      "name": "pki-ca",
      "status": "Fixed",
      "fixed_version": "0:10.5.1-13.1.el7_5"
    },
    {
      "name": "pki-javadoc",
      "status": "Fixed",
      "fixed_version": "0:10.5.1-13.1.el7_5"
    },
    {
      "name": "pki-tools",
      "status": "Fixed",
      "fixed_version": "0:10.5.1-13.1.el7_5",
      "arch": "x86_64"
    }
  ],
  "references": [
    {
      "id": "RHSA-2018:1979",
      "source": "RHSA",
      "url": "https://access.redhat.com/errata/RHSA-2018:1979"
    },
    {
      "id": "CVE-2018-1080",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2018-1080"
    },
    {
      "id": "CVE-2018-1080 pki-core: Mishandled ACL configuration in AAclAuthz.java reverses rules that allow and deny access",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1556657"
    }
  ],
  "public": "2018-03-15T00:00:00Z",
  "issued": "2018-06-26T00:00:00Z",
  "updated": "2018-06-26T00:00:00Z"
}
