{
  "id": "CVE-2014-8136",
  "rhsa_id": "RHSA-2015:0323",
  "definition_id": "oval:com.redhat.rhsa:def:20150323",
  "title": "RHSA-2015:0323: libvirt security, bug fix, and enhancement update (Low)",
  "description": "The libvirt library is a C API for managing and interacting with the virtualization capabilities of Linux and other operating systems.\n\nIt was found that QEMU's qemuDomainMigratePerform() and qemuDomainMigrateFinish2() functions did not correctly perform a domain unlock on a failed ACL check. A remote attacker able to establish a connection to libvirtd could use this flaw to lock a domain of a more privileged user, causing a denial of service. (CVE-2014-8136)\n\nIt was discovered that the virDomainSnapshotGetXMLDesc() and virDomainSaveImageGetXMLDesc() functions did not sufficiently limit the usage of the VIR_DOMAIN_XML_SECURE flag when fine-grained ACLs were enabled. A remote attacker able to establish a connection to libvirtd could use this flaw to obtain certain sensitive information from the domain XML file. (CVE-2015-0236)\n\nThe CVE-2015-0236 issue was found by Luyao Huang of Red Hat.\n\nBug fixes:\n\n* The libvirtd daemon previously attempted to search for SELinux contexts even when SELinux was disabled on the host. Consequently, libvirtd logged \"Unable to lookup SELinux process context\" error messages every time a client connected to libvirtd and SELinux was disabled. libvirtd now verifies whether SELinux is enabled before searching for SELinux contexts, and no longer logs the error messages on a host with SELinux disabled. (BZ#1135155)\n\n* The libvirt utility passed incomplete PCI addresses to QEMU. Consequently, assigning a PCI device that had a PCI address with a non-zero domain to a guest failed. Now, libvirt properly passes PCI domain to QEMU when assigning PCI devices, which prevents the described problem. (BZ#1127080)\n\n* Because the virDomainSetMaxMemory API did not allow changing the current memory in the LXC driver, the \"virsh setmaxmem\" command failed when attempting to set the maximum memory to be lower than the current memory. Now, \"virsh setmaxmem\" sets the current memory to the intended value of the maximum memory, which avoids the mentioned problem. (BZ#1091132)\n\n* Attempting to start a non-existent domain caused network filters to stay locked for read-only access. Because of this, subsequent attempts to gain read-write access to network filters triggered a deadlock. Network filters are now properly unlocked in the described scenario, and the deadlock no longer occurs. (BZ#1088864)\n\n* If a guest configuration had an active nwfilter using the DHCP snooping feature and an attempt was made to terminate libvirtd before the associated nwfilter rule snooped the guest IP address from DHCP packets, libvirtd became unresponsive. This problem has been fixed by setting a longer wait time for snooping the guest IP address. (BZ#1075543)\n\nEnhancements:\n\n* A new \"migrate_host\" option is now available in /etc/libvirt/qemu.conf, which allows users to set a custom IP address to be used for incoming migrations. (BZ#1087671)\n\n* With this update, libvirt is able to create a compressed memory-only crash dump of a QEMU domain. This type of crash dump is directly readable by the GNU Debugger and requires significantly less hard disk space than the standard crash dump. (BZ#1035158)\n\n* Support for reporting the NUMA node distance of the host has been added to libvirt. This enhances the current libvirt capabilities for reporting NUMA topology of the host, and allows for easier optimization of new domains. (BZ#1086331)\n\n* The XML file of guest and host capabilities generated by the \"virsh capabilities\" command has been enhanced to list the following information, where relevant: the interface speed and link status of the host, the PCI Express (PCIe) details, the host's hardware support for I/O virtualization, and a report on the huge memory pages. (BZ#1076960, BZ#1076957, BZ#1076959, BZ#1076962)\n\nThese packages also include a number of other bug fixes and enhancements. For additional details, see the \"Bugs Fixed\" section below.",
  "cvss2": "1.8/AV:A/AC:H/Au:N/C:N/I:N/A:P",
  "severity": "Low",
  "impact": "low",
  "affected": {
    "family": "unix",
    "platforms": [
      "Red Hat Enterprise Linux 7"
    ],
    "cpes": [
      {
        "cpe": "cpe:/o:redhat:rhel_aus:7.7"
      },
      {
        "cpe": "cpe:/o:redhat:rhel_aus:7.7::server",
        "repository": [
          "rhel-7-server-aus-rpms__7_DOT_7__x86_64",
          "rhel-7-server-aus-debug-rpms__7_DOT_7__x86_64",
          "rhel-7-server-aus-debug-rpms",
          "rhel-7-server-aus-optional-rpms__7_DOT_7__x86_64",
          "rhel-7-server-aus-rpms",
          "rhel-7-server-aus-optional-debug-rpms",
          "rhel-7-server-aus-optional-rpms",
          "rhel-7-server-aus-optional-debug-rpms__7_DOT_7__x86_64",
          "rhel-7-server-aus-source-rpms__7_DOT_7__x86_64",
          "rhel-7-server-aus-optional-source-rpms__7_DOT_7__x86_64",
          "rhel-7-server-aus-optional-source-rpms",
          "rhel-7-server-aus-source-rpms"
        ]
      }
    ]
  },
  "packages": [
    {
      "name": "libvirt",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "s390x"
    },
    {
      "name": "libvirt-lock-sanlock",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "x86_64"
    },
    {
      "name": "libvirt-daemon-driver-network",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "x86_64"
    },
    {
      "name": "libvirt",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "ppc64"
    },
    {
      "name": "libvirt-devel",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "ppc"
    },
    {
      "name": "libvirt-daemon-driver-nodedev",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "ppc64"
    },
    {
      "name": "libvirt-daemon-driver-interface",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "s390x"
    },
    {
      "name": "libvirt-daemon-driver-secret",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "ppc64"
    },
    {
      "name": "libvirt-daemon-driver-interface",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "ppc64"
    },
    {
      "name": "libvirt-daemon-driver-nodedev",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "x86_64"
    },
    {
      "name": "libvirt-daemon-lxc",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "s390x"
    },
    {
      "name": "libvirt-daemon-driver-secret",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "x86_64"
    },
    {
      "name": "libvirt-client",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "x86_64"
    },
    {
      "name": "libvirt-daemon",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "x86_64"
    },
    {
      "name": "libvirt-daemon-driver-nodedev",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "s390x"
    },
    {
      "name": "libvirt-client",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "ppc"
    },
    {
      "name": "libvirt-daemon-lxc",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "x86_64"
    },
    {
      "name": "libvirt-daemon-driver-qemu",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "x86_64"
    },
    {
      "name": "libvirt-docs",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "ppc64"
    },
    {
      "name": "libvirt-daemon-driver-network",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "ppc64"
    },
    {
      "name": "libvirt-daemon-driver-secret",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "s390x"
    },
    {
      "name": "libvirt-daemon",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "ppc64"
    },
    {
      "name": "libvirt-daemon-driver-lxc",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "ppc64"
    },
    {
      "name": "libvirt-login-shell",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "ppc64"
    },
    {
      "name": "libvirt-devel",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "ppc64"
    },
    {
      "name": "libvirt-daemon-config-nwfilter",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "ppc64"
    },
    {
      "name": "libvirt-daemon-driver-nwfilter",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "ppc64"
    },
    {
      "name": "libvirt-lock-sanlock",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "ppc64"
    },
    {
      "name": "libvirt-client",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "s390x"
    },
    {
      "name": "libvirt-client",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "s390"
    },
    {
      "name": "libvirt-daemon-driver-storage",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "x86_64"
    },
    {
      "name": "libvirt-daemon-config-network",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "x86_64"
    },
    {
      "name": "libvirt-daemon-config-nwfilter",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "x86_64"
    },
    {
      "name": "libvirt-login-shell",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "s390x"
    },
    {
      "name": "libvirt-daemon-driver-lxc",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "s390x"
    },
    {
      "name": "libvirt-daemon-driver-network",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "s390x"
    },
    {
      "name": "libvirt-client",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "ppc64"
    },
    {
      "name": "libvirt-devel",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "i686"
    },
    {
      "name": "libvirt-daemon-driver-lxc",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "x86_64"
    },
    {
      "name": "libvirt-daemon-config-nwfilter",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "s390x"
    },
    {
      "name": "libvirt-login-shell",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "x86_64"
    },
    {
      "name": "libvirt-daemon-driver-interface",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "x86_64"
    },
    {
      "name": "libvirt-daemon-driver-qemu",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "ppc64"
    },
    {
      "name": "libvirt-daemon-driver-nwfilter",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "s390x"
    },
    {
      "name": "libvirt-daemon-driver-nwfilter",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "x86_64"
    },
    {
      "name": "libvirt-client",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "i686"
    },
    {
      "name": "libvirt-daemon-driver-storage",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "ppc64"
    },
    {
      "name": "libvirt-devel",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "x86_64"
    },
    {
      "name": "libvirt-devel",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "s390x"
    },
    {
      "name": "libvirt-docs",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "x86_64"
    },
    {
      "name": "libvirt-daemon-lxc",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "ppc64"
    },
    {
      "name": "libvirt-daemon-config-network",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "s390x"
    },
    {
      "name": "libvirt-daemon",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "s390x"
    },
    {
      "name": "libvirt-daemon-driver-storage",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "s390x"
    },
    {
      "name": "libvirt-daemon-kvm",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "x86_64"
    },
    {
      "name": "libvirt-devel",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "s390"
    },
    {
      "name": "libvirt-docs",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "s390x"
    },
    {
      "name": "libvirt-daemon-config-network",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "ppc64"
    },
    {
      "name": "libvirt",
      "status": "Fixed",
      "fixed_version": "0:1.2.8-16.el7",
      "arch": "x86_64"
    }
  ],
  "references": [
    {
      "id": "RHSA-2015:0323",
      "source": "RHSA",
      "url": "https://access.redhat.com/errata/RHSA-2015:0323"
    },
    {
      "id": "CVE-2014-8136",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2014-8136"
    },
    {
      "id": "CVE-2015-0236",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2015-0236"
    },
    {
      "id": "CVE-2014-8136 libvirt: local denial of service in qemu/qemu_driver.c",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1176176"
    },
    {
      "id": "CVE-2015-0236 libvirt: missing ACL check for the VIR_DOMAIN_XML_SECURE flag in save images and snapshots objects",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1184431"
    }
  ],
  "public": "2014-12-17T00:00:00Z",
  "issued": "2015-03-05T00:00:00Z",
  "updated": "2015-03-05T00:00:00Z"
}
