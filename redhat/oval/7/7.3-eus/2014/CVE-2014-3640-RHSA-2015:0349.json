{
  "id": "CVE-2014-3640",
  "rhsa_id": "RHSA-2015:0349",
  "definition_id": "oval:com.redhat.rhsa:def:20150349",
  "title": "RHSA-2015:0349: qemu-kvm security, bug fix, and enhancement update (Important)",
  "description": "KVM (Kernel-based Virtual Machine) is a full virtualization solution for Linux on AMD64 and Intel 64 systems. The qemu-kvm packages provide the user-space component for running virtual machines using KVM.\n\nIt was found that the Cirrus blit region checks were insufficient. A privileged guest user could use this flaw to write outside of VRAM-allocated buffer boundaries in the host's QEMU process address space with attacker-provided data. (CVE-2014-8106)\n\nAn uninitialized data structure use flaw was found in the way the set_pixel_format() function sanitized the value of bits_per_pixel. An attacker able to access a guest's VNC console could use this flaw to crash the guest. (CVE-2014-7815)\n\nIt was found that certain values that were read when loading RAM during migration were not validated. A user able to alter the savevm data (either on the disk or over the wire during migration) could use either of these flaws to corrupt QEMU process memory on the (destination) host, which could potentially result in arbitrary code execution on the host with the privileges of the QEMU process. (CVE-2014-7840)\n\nA NULL pointer dereference flaw was found in the way QEMU handled UDP packets with a source port and address of 0 when QEMU's user networking was in use. A local guest user could use this flaw to crash the guest. (CVE-2014-3640)\n\nRed Hat would like to thank James Spadaro of Cisco for reporting CVE-2014-7815, and Xavier Mehrenberger and Stephane Duverger of Airbus for reporting CVE-2014-3640. The CVE-2014-8106 issue was found by Paolo Bonzini of Red Hat, and the CVE-2014-7840 issue was discovered by Michael S. Tsirkin of Red Hat.\n\nBug fixes:\n\n* The KVM utility executed demanding routing update system calls every time it performed an MSI vector mask/unmask operation. Consequently, guests running legacy systems such as Red Hat Enterprise Linux 5 could, under certain circumstances, experience significant slowdown. Now, the routing system calls during mask/unmask operations are skipped, and the performance of legacy guests is now more consistent. (BZ#1098976)\n\n* Due to a bug in the Internet Small Computer System Interface (iSCSI) driver, a qemu-kvm process terminated unexpectedly with a segmentation fault when the \"write same\" command was executed in guest mode under the iSCSI protocol. This update fixes the bug, and the \"write same\" command now functions in guest mode under iSCSI as intended. (BZ#1083413)\n\n* The QEMU command interface did not properly handle resizing of cache memory during guest migration, causing QEMU to terminate unexpectedly with a segmentation fault. This update fixes the related code, and QEMU no longer crashes in the described situation. (BZ#1066338)\n\nEnhancements:\n\n* The maximum number of supported virtual CPUs (vCPUs) in a KVM guest has been increased to 240. This increases the number of virtual processing units that the user can assign to the guest, and therefore improves its performance potential. (BZ#1134408)\n\n* Support for the 5th Generation Intel Core processors has been added to the QEMU hypervisor, the KVM kernel code, and the libvirt API. This allows KVM guests to use the following instructions and features: ADCX, ADOX, RDSFEED, PREFETCHW, and supervisor mode access prevention (SMAP). (BZ#1116117)\n\n* The \"dump-guest-memory\" command now supports crash dump compression. This makes it possible for users who cannot use the \"virsh dump\" command to require less hard disk space for guest crash dumps. In addition, saving a compressed guest crash dump frequently takes less time than saving a non-compressed one. (BZ#1157798)\n\n* This update introduces support for flight recorder tracing, which uses SystemTap to automatically capture qemu-kvm data while the guest machine is running. For detailed instructions on how to configure and use flight recorder tracing, see the Virtualization Deployment and Administration Guide, linked to in the References section below. (BZ#1088112)",
  "cvss2": "4.4/AV:L/AC:M/Au:S/C:N/I:N/A:C",
  "cwe": "CWE-476",
  "severity": "Important",
  "impact": "low",
  "affected": {
    "family": "unix",
    "platforms": [
      "Red Hat Enterprise Linux 7"
    ],
    "cpes": [
      {
        "cpe": "cpe:/a:redhat:rhel_extras_sap_eus:7.3",
        "repository": [
          "rhel-sap-for-rhel-7-for-power-eus-source-rpms",
          "rhel-sap-for-rhel-7-server-eus-debug-rpms",
          "rhel-sap-for-rhel-7-for-power-eus-debug-rpms__7_DOT_3__ppc64",
          "rhel-sap-for-rhel-7-for-power-eus-debug-rpms",
          "rhel-sap-for-rhel-7-for-system-z-eus-rpms",
          "rhel-sap-for-rhel-7-server-eus-rpms__7_DOT_3__x86_64",
          "rhel-sap-for-rhel-7-server-e4s-rpms",
          "rhel-sap-for-rhel-7-for-power-le-eus-source-rpms__7_DOT_3__ppc64le",
          "rhel-sap-for-rhel-7-server-eus-rpms",
          "rhel-sap-for-rhel-7-for-system-z-eus-source-rpms__7_DOT_3__s390x",
          "rhel-sap-for-rhel-7-for-power-le-eus-source-rpms",
          "rhel-sap-for-rhel-7-for-power-le-e4s-source-rpms",
          "rhel-sap-for-rhel-7-for-system-z-eus-debug-rpms",
          "rhel-sap-for-rhel-7-for-power-eus-source-rpms__7_DOT_3__ppc64",
          "rhel-sap-for-rhel-7-for-power-le-eus-debug-rpms",
          "rhel-sap-for-rhel-7-for-power-le-eus-debug-rpms__7_DOT_3__ppc64le",
          "rhel-sap-for-rhel-7-server-eus-source-rpms__7_DOT_3__x86_64",
          "rhel-sap-for-rhel-7-for-system-z-eus-debug-rpms__7_DOT_3__s390x",
          "rhel-sap-for-rhel-7-for-power-le-e4s-debug-rpms",
          "rhel-sap-for-rhel-7-for-power-le-eus-rpms",
          "rhel-sap-for-rhel-7-for-system-z-eus-source-rpms",
          "rhel-sap-for-rhel-7-for-system-z-eus-rpms__7_DOT_3__s390x",
          "rhel-sap-for-rhel-7-for-power-le-e4s-rpms",
          "rhel-sap-for-rhel-7-for-power-le-eus-rpms__7_DOT_3__ppc64le",
          "rhel-sap-for-rhel-7-server-eus-debug-rpms__7_DOT_3__x86_64",
          "rhel-sap-for-rhel-7-server-eus-source-rpms",
          "rhel-sap-for-rhel-7-for-power-eus-rpms__7_DOT_3__ppc64",
          "rhel-sap-for-rhel-7-server-e4s-debug-rpms",
          "rhel-sap-for-rhel-7-server-e4s-source-rpms",
          "rhel-sap-for-rhel-7-for-power-eus-rpms"
        ]
      },
      {
        "cpe": "cpe:/a:redhat:rhel_extras_sap_hana_eus:7.3",
        "repository": [
          "rhel-sap-hana-for-rhel-7-server-eus-debug-rpms__7_DOT_3__x86_64",
          "rhel-sap-hana-for-rhel-7-server-e4s-source-rpms",
          "rhel-sap-hana-for-rhel-7-for-power-le-e4s-source-rpms",
          "rhel-sap-hana-for-rhel-7-for-power-le-eus-rpms__7_DOT_3__ppc64le",
          "rhel-sap-hana-for-rhel-7-for-power-le-eus-debug-rpms__7_DOT_3__ppc64le",
          "rhel-sap-hana-for-rhel-7-server-eus-rpms",
          "rhel-sap-hana-for-rhel-7-server-eus-source-rpms",
          "rhel-sap-hana-for-rhel-7-for-power-le-eus-debug-rpms",
          "rhel-sap-hana-for-rhel-7-server-e4s-rpms",
          "rhel-sap-hana-for-rhel-7-for-power-le-e4s-rpms",
          "rhel-sap-hana-for-rhel-7-for-power-le-eus-source-rpms__7_DOT_3__ppc64le",
          "rhel-sap-hana-for-rhel-7-server-eus-rpms__7_DOT_3__x86_64",
          "rhel-sap-hana-for-rhel-7-server-e4s-debug-rpms",
          "rhel-sap-hana-for-rhel-7-server-eus-debug-rpms",
          "rhel-sap-hana-for-rhel-7-server-eus-source-rpms__7_DOT_3__x86_64",
          "rhel-sap-hana-for-rhel-7-for-power-le-eus-source-rpms",
          "rhel-sap-hana-for-rhel-7-for-power-le-eus-rpms",
          "rhel-sap-hana-for-rhel-7-for-power-le-e4s-debug-rpms"
        ]
      },
      {
        "cpe": "cpe:/o:redhat:rhel_eus:7.3"
      },
      {
        "cpe": "cpe:/o:redhat:rhel_eus:7.3::computenode",
        "repository": [
          "rhel-7-hpc-node-eus-optional-source-rpms",
          "rhel-7-hpc-node-eus-optional-debug-rpms",
          "rhel-7-hpc-node-eus-debug-rpms",
          "rhel-7-hpc-node-eus-optional-source-rpms__7_DOT_3__x86_64",
          "rhel-7-hpc-node-eus-rpms__7_DOT_3__x86_64",
          "rhel-7-hpc-node-eus-optional-rpms",
          "rhel-7-hpc-node-eus-source-rpms__7_DOT_3__x86_64",
          "rhel-7-hpc-node-eus-source-rpms",
          "rhel-7-hpc-node-eus-optional-debug-rpms__7_DOT_3__x86_64",
          "rhel-7-hpc-node-eus-debug-rpms__7_DOT_3__x86_64",
          "rhel-7-hpc-node-eus-rpms",
          "rhel-7-hpc-node-eus-optional-rpms__7_DOT_3__x86_64"
        ]
      },
      {
        "cpe": "cpe:/o:redhat:rhel_eus:7.3::server",
        "repository": [
          "rhel-7-server-eus-source-rpms__7_DOT_3__x86_64",
          "rhel-7-server-eus-rpms__7_DOT_3__x86_64",
          "rhel-7-for-power-eus-optional-source-rpms",
          "rhel-7-for-system-z-eus-optional-source-rpms__7_DOT_3__s390x",
          "rhel-7-for-system-z-eus-rpms",
          "rhel-7-server-aus-source-rpms",
          "rhel-7-server-aus-debug-rpms",
          "rhel-7-server-tus-optional-debug-rpms",
          "rhel-7-for-power-le-eus-debug-rpms",
          "rhel-7-for-system-z-eus-optional-source-rpms",
          "rhel-7-for-power-le-eus-optional-source-rpms",
          "rhel-7-server-e4s-optional-rpms",
          "rhel-ha-for-rhel-7-server-e4s-rpms",
          "rhel-7-for-power-eus-debug-rpms",
          "rhel-7-for-power-eus-debug-rpms__7_DOT_3__ppc64",
          "rhel-7-for-system-z-eus-debug-rpms",
          "rhel-7-server-e4s-optional-debug-rpms",
          "rhel-7-for-power-le-e4s-source-rpms",
          "rhel-7-for-power-le-eus-source-rpms__7_DOT_3__ppc64le",
          "rhel-ha-for-rhel-7-server-e4s-source-rpms",
          "rhel-7-server-tus-rpms",
          "rhel-7-for-power-le-e4s-optional-rpms",
          "rhel-7-for-system-z-eus-optional-debug-rpms",
          "rhel-ha-for-rhel-7-server-eus-debug-rpms",
          "rhel-7-server-eus-optional-rpms",
          "rhel-ha-for-rhel-7-server-eus-rpms__7_DOT_3__x86_64",
          "rhel-7-for-power-le-e4s-optional-debug-rpms",
          "rhel-7-for-power-eus-optional-debug-rpms",
          "rhel-7-server-eus-rpms",
          "rhel-7-server-eus-optional-debug-rpms",
          "rhel-7-server-eus-optional-rpms__7_DOT_3__x86_64",
          "rhel-7-server-eus-optional-debug-rpms__7_DOT_3__x86_64",
          "rhel-7-server-eus-optional-source-rpms",
          "rhel-7-for-power-eus-optional-source-rpms__7_DOT_3__ppc64",
          "rhel-7-for-power-eus-optional-rpms__7_DOT_3__ppc64",
          "rhel-7-for-power-le-e4s-optional-source-rpms",
          "rhel-7-for-power-le-eus-optional-rpms__7_DOT_3__ppc64le",
          "rhel-7-server-aus-optional-debug-rpms",
          "rhel-rs-for-rhel-7-server-eus-source-rpms",
          "rhel-7-for-power-le-eus-source-rpms",
          "rhel-7-for-power-eus-optional-rpms",
          "rhel-7-server-e4s-optional-source-rpms",
          "rhel-7-server-eus-source-rpms",
          "rhel-7-server-tus-optional-source-rpms",
          "rhel-7-server-aus-optional-source-rpms",
          "rhel-7-for-system-z-eus-source-rpms",
          "rhel-7-for-power-le-eus-optional-source-rpms__7_DOT_3__ppc64le",
          "rhel-7-for-power-eus-source-rpms__7_DOT_3__ppc64",
          "rhel-7-for-power-le-eus-optional-rpms",
          "rhel-7-server-e4s-rpms",
          "rhel-7-server-tus-debug-rpms",
          "rhel-7-for-system-z-eus-source-rpms__7_DOT_3__s390x",
          "rhel-ha-for-rhel-7-server-eus-debug-rpms__7_DOT_3__x86_64",
          "rhel-7-for-power-eus-rpms__7_DOT_3__ppc64",
          "rhel-7-server-eus-debug-rpms",
          "rhel-ha-for-rhel-7-server-e4s-debug-rpms",
          "rhel-7-server-e4s-debug-rpms",
          "rhel-7-for-power-le-e4s-debug-rpms",
          "rhel-7-for-power-le-eus-rpms__7_DOT_3__ppc64le",
          "rhel-rs-for-rhel-7-server-eus-source-rpms__7_DOT_3__x86_64",
          "rhel-ha-for-rhel-7-server-eus-source-rpms__7_DOT_3__x86_64",
          "rhel-7-server-eus-debug-rpms__7_DOT_3__x86_64",
          "rhel-7-for-power-eus-optional-debug-rpms__7_DOT_3__ppc64",
          "rhel-rs-for-rhel-7-server-eus-rpms__7_DOT_3__x86_64",
          "rhel-7-for-power-le-e4s-rpms",
          "rhel-7-for-system-z-eus-optional-rpms__7_DOT_3__s390x",
          "rhel-7-server-aus-optional-rpms",
          "rhel-rs-for-rhel-7-server-eus-debug-rpms",
          "rhel-7-server-tus-source-rpms",
          "rhel-7-for-power-le-eus-debug-rpms__7_DOT_3__ppc64le",
          "rhel-ha-for-rhel-7-server-eus-source-rpms",
          "rhel-7-for-system-z-eus-optional-debug-rpms__7_DOT_3__s390x",
          "rhel-rs-for-rhel-7-server-eus-rpms",
          "rhel-rs-for-rhel-7-server-eus-debug-rpms__7_DOT_3__x86_64",
          "rhel-7-for-power-eus-rpms",
          "rhel-7-server-tus-optional-rpms",
          "rhel-7-for-power-le-eus-optional-debug-rpms",
          "rhel-7-server-e4s-source-rpms",
          "rhel-7-for-power-le-eus-optional-debug-rpms__7_DOT_3__ppc64le",
          "rhel-7-for-system-z-eus-optional-rpms",
          "rhel-7-server-eus-optional-source-rpms__7_DOT_3__x86_64",
          "rhel-7-for-system-z-eus-debug-rpms__7_DOT_3__s390x",
          "rhel-7-for-power-eus-source-rpms",
          "rhel-7-server-aus-rpms",
          "rhel-ha-for-rhel-7-server-eus-rpms",
          "rhel-7-for-power-le-eus-rpms",
          "rhel-7-for-system-z-eus-rpms__7_DOT_3__s390x"
        ]
      }
    ]
  },
  "packages": [
    {
      "name": "libcacard",
      "status": "Fixed",
      "fixed_version": "10:1.5.3-86.el7",
      "arch": "ppc"
    },
    {
      "name": "libcacard",
      "status": "Fixed",
      "fixed_version": "10:1.5.3-86.el7",
      "arch": "x86_64"
    },
    {
      "name": "libcacard-devel",
      "status": "Fixed",
      "fixed_version": "10:1.5.3-86.el7",
      "arch": "ppc64"
    },
    {
      "name": "libcacard",
      "status": "Fixed",
      "fixed_version": "10:1.5.3-86.el7",
      "arch": "ppc64"
    },
    {
      "name": "qemu-img",
      "status": "Fixed",
      "fixed_version": "10:1.5.3-86.el7",
      "arch": "ppc64"
    },
    {
      "name": "qemu-img",
      "status": "Fixed",
      "fixed_version": "10:1.5.3-86.el7",
      "arch": "x86_64"
    },
    {
      "name": "libcacard-devel",
      "status": "Fixed",
      "fixed_version": "10:1.5.3-86.el7",
      "arch": "x86_64"
    },
    {
      "name": "qemu-kvm",
      "status": "Fixed",
      "fixed_version": "10:1.5.3-86.el7",
      "arch": "x86_64"
    },
    {
      "name": "libcacard-tools",
      "status": "Fixed",
      "fixed_version": "10:1.5.3-86.el7",
      "arch": "ppc64"
    },
    {
      "name": "qemu-kvm-common",
      "status": "Fixed",
      "fixed_version": "10:1.5.3-86.el7",
      "arch": "x86_64"
    },
    {
      "name": "libcacard",
      "status": "Fixed",
      "fixed_version": "10:1.5.3-86.el7",
      "arch": "i686"
    },
    {
      "name": "qemu-kvm-tools",
      "status": "Fixed",
      "fixed_version": "10:1.5.3-86.el7",
      "arch": "x86_64"
    },
    {
      "name": "libcacard-devel",
      "status": "Fixed",
      "fixed_version": "10:1.5.3-86.el7",
      "arch": "ppc"
    },
    {
      "name": "libcacard-tools",
      "status": "Fixed",
      "fixed_version": "10:1.5.3-86.el7",
      "arch": "x86_64"
    },
    {
      "name": "libcacard-devel",
      "status": "Fixed",
      "fixed_version": "10:1.5.3-86.el7",
      "arch": "i686"
    }
  ],
  "references": [
    {
      "id": "RHSA-2015:0349",
      "source": "RHSA",
      "url": "https://access.redhat.com/errata/RHSA-2015:0349"
    },
    {
      "id": "CVE-2014-3640",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2014-3640"
    },
    {
      "id": "CVE-2014-7815",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2014-7815"
    },
    {
      "id": "CVE-2014-7840",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2014-7840"
    },
    {
      "id": "CVE-2014-8106",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2014-8106"
    },
    {
      "id": "CVE-2014-3640 qemu: slirp: NULL pointer deref in sosendto()",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1144818"
    },
    {
      "id": "CVE-2014-7815 qemu: vnc: insufficient bits_per_pixel from the client sanitization",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1157641"
    },
    {
      "id": "CVE-2014-7840 qemu: insufficient parameter validation during ram load",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1163075"
    },
    {
      "id": "CVE-2014-8106 qemu: cirrus: insufficient blit region checks",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1169454"
    }
  ],
  "public": "2014-09-17T00:00:00Z",
  "issued": "2015-03-05T00:00:00Z",
  "updated": "2015-03-05T00:00:00Z"
}
