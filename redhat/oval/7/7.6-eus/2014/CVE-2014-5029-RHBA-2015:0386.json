{
  "id": "CVE-2014-5029",
  "rhsa_id": "RHBA-2015:0386",
  "definition_id": "oval:com.redhat.rhba:def:20150386",
  "title": "RHBA-2015:0386: cups bug fix and enhancement update (Moderate)",
  "description": "CUPS provides a portable printing layer for Linux, UNIX, and similar operating systems. \n\nThis update fixes the following bugs:\n\n* When using the cupsEnumDests() API call, the libcups utility failed to take note of the client callback function. As a consequence, applications using this API could terminate unexpectedly. The cupsEnumDests() implementation has been fixed and callbacks now function as expected. (BZ#1072954) \n\n* Previously, the CUPS scheduler used an incorrect D-Bus interface when trying to add a colord profile, which led to colord profiles not working correctly. With this update, the correct D-Bus interface is used, and colord profiles now function as expected. (BZ#1087323)\n\n* When handling an incoming Internet Printing Protocol (IPP) request with an associated document to follow, the CUPS scheduler did not check whether the client connection had data available to read before starting to handle the document data. Consequently, in some instances, a 10-second timeout could occur. The scheduler now checks for data availability before reading the document data, thus fixing this bug. (BZ#1110259) \n\n* When the CUPS scheduler read data from a client, it did not check for data availability in between reading the HTTP headers and the Internet Printing Protocol (IPP) request. This led to a race condition causing client requests to fail depending on the timing of the data packets. With this update, the scheduler checks for data availability, preventing the race condition from occurring. (BZ#1113045) \n\n* Previously, the manual page for the cupsd.conf(5) configuration file did not mention the ErrorPolicy directive. Text describing this directive has now been added to the manual page. (BZ#1120591) \n\n* Prior to this update, the cups utility was started before networking, and therefore it was not available in some configurations. A patch has been applied to fix this bug, and CUPS is now available throughout the network. (BZ#1144780) \n\n* A prior security update changed the /etc/cups/ppd/ directory not to be world-readable. However, the cupsGetPPD() function still assumed the files in the directory were world-readable. As a consequence, cupsGetPPD() returned a symbolic link to a file in /etc/cups/ppd/ to the caller even though the caller was not able to read it, which caused a variety of failures when printing. This update fixes cupsGetPPD3() to check for readability, and these failures thus no longer occur. (BZ#1153708)\n\n* A prior fix for setting the value of the FINAL_CONTENT_TYPE variable caused unintended problems: the back end could not reliably determine the format of the input data and forced FINAL_CONTENT_TYPE to always be \"printer/[queue name]\". The incorrect fix has been reverted. Nevertheless, users who have files configured on both the local and remote ends of their queues will still encounter this problem, and thus need to make the local ends of their queues \"raw\". (BZ#1149245)\n\nIn addition, this update adds the following enhancement:\n\n* Prior to this update, the commands required by the redhat-lsb-core package were provided by the cups packages, which itself has other requirements on other packages. To prevent redhat-lsb-core causing a larger dependency chain than needed, the CUPS client commands required by redhat-lsb-core have been moved into a new sub-package, cups-clients. (BZ#1115057) \n\nUsers of cups are advised to upgrade to these updated packages, which fix these bugs and add this enhancement. After installing this update, the cupsd daemon will be restarted automatically.",
  "cvss2": "5.0/AV:L/AC:M/Au:S/C:C/I:P/A:N",
  "cwe": "CWE-59",
  "severity": "Moderate",
  "impact": "moderate",
  "affected": {
    "family": "unix",
    "platforms": [
      "Red Hat Enterprise Linux 7"
    ],
    "cpes": [
      {
        "cpe": "cpe:/a:redhat:rhel_extras_sap_eus:7.6",
        "repository": [
          "rhel-sap-for-rhel-7-server-eus-source-rpms__7_DOT_6__x86_64",
          "rhel-sap-for-rhel-7-for-system-z-eus-rpms",
          "rhel-sap-for-rhel-7-for-power-eus-debug-rpms__7_DOT_6__ppc64",
          "rhel-sap-for-rhel-7-for-power-eus-source-rpms",
          "rhel-sap-for-rhel-7-server-eus-debug-rpms__7_DOT_6__x86_64",
          "rhel-sap-for-rhel-7-server-e4s-source-rpms",
          "rhel-sap-for-rhel-7-for-system-z-eus-debug-rpms",
          "rhel-sap-for-rhel-7-for-system-z-eus-debug-rpms__7_DOT_6__s390x",
          "rhel-sap-for-rhel-7-for-system-z-eus-source-rpms__7_DOT_6__s390x",
          "rhel-sap-for-rhel-7-server-eus-debug-rpms",
          "rhel-sap-for-rhel-7-server-eus-rpms",
          "rhel-sap-for-rhel-7-for-power-le-eus-rpms",
          "rhel-sap-for-rhel-7-for-power-le-eus-debug-rpms",
          "rhel-sap-for-rhel-7-for-power-eus-debug-rpms",
          "rhel-sap-for-rhel-7-for-power-le-e4s-debug-rpms",
          "rhel-sap-for-rhel-7-for-power-eus-source-rpms__7_DOT_6__ppc64",
          "rhel-sap-for-rhel-7-for-power-le-eus-source-rpms",
          "rhel-sap-for-rhel-7-for-system-z-eus-rpms__7_DOT_6__s390x",
          "rhel-sap-for-rhel-7-for-power-le-eus-debug-rpms__7_DOT_6__ppc64le",
          "rhel-sap-for-rhel-7-for-system-z-eus-source-rpms",
          "rhel-sap-for-rhel-7-server-eus-source-rpms",
          "rhel-sap-for-rhel-7-for-power-le-eus-rpms__7_DOT_6__ppc64le",
          "rhel-sap-for-rhel-7-server-e4s-debug-rpms",
          "rhel-sap-for-rhel-7-for-power-eus-rpms__7_DOT_6__ppc64",
          "rhel-sap-for-rhel-7-server-eus-rpms__7_DOT_6__x86_64",
          "rhel-sap-for-rhel-7-for-power-le-e4s-source-rpms",
          "rhel-sap-for-rhel-7-server-e4s-rpms",
          "rhel-sap-for-rhel-7-for-power-le-e4s-rpms",
          "rhel-sap-for-rhel-7-for-power-le-eus-source-rpms__7_DOT_6__ppc64le",
          "rhel-sap-for-rhel-7-for-power-eus-rpms"
        ]
      },
      {
        "cpe": "cpe:/a:redhat:rhel_extras_sap_hana_eus:7.6",
        "repository": [
          "rhel-sap-hana-for-rhel-7-for-power-le-e4s-source-rpms",
          "rhel-sap-hana-for-rhel-7-server-eus-rpms",
          "rhel-sap-hana-for-rhel-7-for-power-le-eus-rpms",
          "rhel-sap-hana-for-rhel-7-server-eus-debug-rpms",
          "rhel-sap-hana-for-rhel-7-server-e4s-source-rpms",
          "rhel-sap-hana-for-rhel-7-for-power-le-eus-source-rpms",
          "rhel-sap-hana-for-rhel-7-for-power-le-e4s-rpms",
          "rhel-sap-hana-for-rhel-7-for-power-le-e4s-debug-rpms",
          "rhel-sap-hana-for-rhel-7-server-eus-source-rpms",
          "rhel-sap-hana-for-rhel-7-server-eus-source-rpms__7_DOT_6__x86_64",
          "rhel-sap-hana-for-rhel-7-for-power-le-eus-debug-rpms__7_DOT_6__ppc64le",
          "rhel-sap-hana-for-rhel-7-server-eus-debug-rpms__7_DOT_6__x86_64",
          "rhel-sap-hana-for-rhel-7-server-e4s-debug-rpms",
          "rhel-sap-hana-for-rhel-7-for-power-le-eus-debug-rpms",
          "rhel-sap-hana-for-rhel-7-server-eus-rpms__7_DOT_6__x86_64",
          "rhel-sap-hana-for-rhel-7-for-power-le-eus-rpms__7_DOT_6__ppc64le",
          "rhel-sap-hana-for-rhel-7-server-e4s-rpms",
          "rhel-sap-hana-for-rhel-7-for-power-le-eus-source-rpms__7_DOT_6__ppc64le"
        ]
      },
      {
        "cpe": "cpe:/o:redhat:rhel_eus:7.6"
      },
      {
        "cpe": "cpe:/o:redhat:rhel_eus:7.6::computenode",
        "repository": [
          "rhel-7-hpc-node-eus-source-rpms",
          "rhel-7-hpc-node-eus-rpms",
          "rhel-7-hpc-node-eus-optional-debug-rpms",
          "rhel-7-hpc-node-eus-optional-source-rpms",
          "rhel-7-hpc-node-eus-optional-rpms__7_DOT_6__x86_64",
          "rhel-7-hpc-node-eus-optional-rpms",
          "rhel-7-hpc-node-eus-source-rpms__7_DOT_6__x86_64",
          "rhel-7-hpc-node-eus-debug-rpms__7_DOT_6__x86_64",
          "rhel-7-hpc-node-eus-optional-debug-rpms__7_DOT_6__x86_64",
          "rhel-7-hpc-node-eus-debug-rpms",
          "rhel-7-hpc-node-eus-rpms__7_DOT_6__x86_64",
          "rhel-7-hpc-node-eus-optional-source-rpms__7_DOT_6__x86_64"
        ]
      },
      {
        "cpe": "cpe:/o:redhat:rhel_eus:7.6::server",
        "repository": [
          "rhel-ha-for-rhel-7-server-tus-source-rpms",
          "rhel-7-server-eus-rpms",
          "rhel-7-for-power-le-eus-debug-rpms",
          "rhel-7-server-aus-optional-debug-rpms",
          "rhel-ha-for-rhel-7-server-eus-debug-rpms__7_DOT_6__x86_64",
          "rhel-7-for-power-le-e4s-optional-debug-rpms",
          "rhel-7-for-power-le-eus-source-rpms",
          "rhel-7-for-system-z-a-optional-source-rpms",
          "rhel-7-for-power-le-eus-debug-rpms__7_DOT_6__ppc64le",
          "rhel-rs-for-rhel-7-server-for-power-le-eus-source-rpms__7_DOT_6__ppc64le",
          "rhel-7-server-aus-optional-rpms",
          "rhel-7-for-system-z-eus-optional-debug-rpms__7_DOT_6__s390x",
          "rhel-7-server-tus-optional-source-rpms",
          "rhel-7-server-tus-optional-debug-rpms",
          "rhel-7-server-tus-source-rpms",
          "rhel-7-server-eus-optional-source-rpms",
          "rhel-7-for-system-z-eus-source-rpms__7_DOT_6__s390x",
          "rhel-7-for-power-eus-optional-debug-rpms__7_DOT_6__ppc64",
          "rhel-ha-for-rhel-7-server-tus-rpms",
          "rhel-7-server-aus-rpms",
          "rhel-rs-for-rhel-7-server-for-power-le-eus-rpms",
          "rhel-7-server-eus-debug-rpms__7_DOT_6__x86_64",
          "rhel-7-for-power-le-e4s-rpms",
          "rhel-7-for-power-eus-optional-rpms__7_DOT_6__ppc64",
          "rhel-rs-for-rhel-7-server-for-power-le-eus-source-rpms",
          "rhel-7-for-power-9-debug-rpms",
          "rhel-7-for-power-9-source-rpms",
          "rhel-ha-for-rhel-7-server-eus-source-rpms__7_DOT_6__x86_64",
          "rhel-7-server-e4s-debug-rpms",
          "rhel-7-for-power-le-eus-optional-source-rpms",
          "rhel-7-server-eus-optional-debug-rpms__7_DOT_6__x86_64",
          "rhel-rs-for-rhel-7-server-eus-debug-rpms__7_DOT_6__x86_64",
          "rhel-7-server-eus-optional-rpms__7_DOT_6__x86_64",
          "rhel-rs-for-rhel-7-server-eus-rpms",
          "rhel-7-for-power-eus-optional-source-rpms",
          "rhel-ha-for-rhel-7-server-eus-source-rpms",
          "rhel-7-for-power-eus-optional-debug-rpms",
          "rhel-7-server-e4s-optional-debug-rpms",
          "rhel-ha-for-rhel-7-server-for-power-le-eus-debug-rpms__7_DOT_6__ppc64le",
          "rhel-7-server-aus-debug-rpms",
          "rhel-7-for-system-z-eus-optional-source-rpms",
          "rhel-7-for-power-eus-debug-rpms",
          "rhel-7-for-power-le-eus-optional-debug-rpms",
          "rhel-ha-for-rhel-7-server-eus-debug-rpms",
          "rhel-7-for-power-9-optional-debug-rpms",
          "rhel-7-for-system-z-a-debug-rpms",
          "rhel-7-for-system-z-eus-debug-rpms__7_DOT_6__s390x",
          "rhel-7-for-system-z-eus-source-rpms",
          "rhel-7-server-eus-rpms__7_DOT_6__x86_64",
          "rhel-7-for-power-le-e4s-debug-rpms",
          "rhel-ha-for-rhel-7-server-tus-debug-rpms",
          "rhel-7-server-eus-debug-rpms",
          "rhel-ha-for-rhel-7-server-for-power-le-eus-source-rpms",
          "rhel-7-for-power-eus-source-rpms",
          "rhel-rs-for-rhel-7-server-eus-debug-rpms",
          "rhel-ha-for-rhel-7-server-e4s-debug-rpms",
          "rhel-7-server-eus-source-rpms",
          "rhel-7-for-power-eus-optional-rpms",
          "rhel-7-for-power-le-eus-optional-rpms__7_DOT_6__ppc64le",
          "rhel-7-for-system-z-eus-optional-source-rpms__7_DOT_6__s390x",
          "rhel-7-for-system-z-eus-optional-debug-rpms",
          "rhel-7-for-system-z-eus-debug-rpms",
          "rhel-7-for-power-le-e4s-optional-rpms",
          "rhel-7-for-power-le-eus-optional-rpms",
          "rhel-7-server-aus-optional-source-rpms",
          "rhel-ha-for-rhel-7-server-for-power-le-eus-source-rpms__7_DOT_6__ppc64le",
          "rhel-7-for-power-eus-optional-source-rpms__7_DOT_6__ppc64",
          "rhel-rs-for-rhel-7-server-for-power-le-eus-debug-rpms__7_DOT_6__ppc64le",
          "rhel-7-for-power-le-eus-optional-source-rpms__7_DOT_6__ppc64le",
          "rhel-7-for-system-z-a-optional-debug-rpms",
          "rhel-ha-for-rhel-7-server-for-power-le-e4s-source-rpms",
          "rhel-ha-for-rhel-7-server-for-power-le-eus-rpms",
          "rhel-rs-for-rhel-7-server-for-power-le-eus-debug-rpms",
          "rhel-ha-for-rhel-7-server-for-power-le-eus-debug-rpms",
          "rhel-ha-for-rhel-7-server-eus-rpms",
          "rhel-7-server-e4s-optional-source-rpms",
          "rhel-7-for-power-le-eus-optional-debug-rpms__7_DOT_6__ppc64le",
          "rhel-7-server-e4s-rpms",
          "rhel-rs-for-rhel-7-server-eus-source-rpms",
          "rhel-7-server-eus-optional-rpms",
          "rhel-ha-for-rhel-7-server-for-power-le-e4s-debug-rpms",
          "rhel-7-server-eus-optional-source-rpms__7_DOT_6__x86_64",
          "rhel-ha-for-rhel-7-server-e4s-rpms",
          "rhel-7-for-power-le-eus-rpms",
          "rhel-ha-for-rhel-7-server-for-power-le-e4s-rpms",
          "rhel-7-for-power-le-e4s-optional-source-rpms",
          "rhel-7-for-system-z-eus-rpms__7_DOT_6__s390x",
          "rhel-7-server-tus-rpms",
          "rhel-rs-for-rhel-7-server-eus-rpms__7_DOT_6__x86_64",
          "rhel-ha-for-rhel-7-server-eus-rpms__7_DOT_6__x86_64",
          "rhel-7-for-system-z-eus-rpms",
          "rhel-ha-for-rhel-7-server-for-power-le-eus-rpms__7_DOT_6__ppc64le",
          "rhel-7-for-system-z-a-optional-rpms",
          "rhel-7-for-power-eus-rpms",
          "rhel-7-for-power-9-optional-rpms",
          "rhel-7-server-tus-optional-rpms",
          "rhel-rs-for-rhel-7-server-eus-source-rpms__7_DOT_6__x86_64",
          "rhel-7-server-eus-optional-debug-rpms",
          "rhel-7-server-eus-source-rpms__7_DOT_6__x86_64",
          "rhel-ha-for-rhel-7-server-e4s-source-rpms",
          "rhel-7-for-power-eus-rpms__7_DOT_6__ppc64",
          "rhel-7-for-system-z-a-rpms",
          "rhel-7-for-power-le-eus-source-rpms__7_DOT_6__ppc64le",
          "rhel-7-for-power-9-optional-source-rpms",
          "rhel-7-for-power-le-eus-rpms__7_DOT_6__ppc64le",
          "rhel-7-server-tus-debug-rpms",
          "rhel-7-for-power-eus-debug-rpms__7_DOT_6__ppc64",
          "rhel-7-for-system-z-eus-optional-rpms__7_DOT_6__s390x",
          "rhel-7-server-e4s-optional-rpms",
          "rhel-7-server-aus-source-rpms",
          "rhel-7-for-power-eus-source-rpms__7_DOT_6__ppc64",
          "rhel-7-for-power-9-rpms",
          "rhel-7-for-power-le-e4s-source-rpms",
          "rhel-7-for-system-z-eus-optional-rpms",
          "rhel-rs-for-rhel-7-server-for-power-le-eus-rpms__7_DOT_6__ppc64le",
          "rhel-7-server-e4s-source-rpms",
          "rhel-7-for-system-z-a-source-rpms"
        ]
      }
    ]
  },
  "packages": [
    {
      "name": "cups-ipptool",
      "status": "Fixed",
      "fixed_version": "1:1.6.3-17.el7",
      "arch": "x86_64"
    },
    {
      "name": "cups",
      "status": "Fixed",
      "fixed_version": "1:1.6.3-17.el7",
      "arch": "s390x"
    },
    {
      "name": "cups-libs",
      "status": "Fixed",
      "fixed_version": "1:1.6.3-17.el7",
      "arch": "ppc"
    },
    {
      "name": "cups-client",
      "status": "Fixed",
      "fixed_version": "1:1.6.3-17.el7",
      "arch": "s390x"
    },
    {
      "name": "cups-devel",
      "status": "Fixed",
      "fixed_version": "1:1.6.3-17.el7",
      "arch": "s390x"
    },
    {
      "name": "cups-client",
      "status": "Fixed",
      "fixed_version": "1:1.6.3-17.el7",
      "arch": "ppc64"
    },
    {
      "name": "cups-lpd",
      "status": "Fixed",
      "fixed_version": "1:1.6.3-17.el7",
      "arch": "ppc64"
    },
    {
      "name": "cups-libs",
      "status": "Fixed",
      "fixed_version": "1:1.6.3-17.el7",
      "arch": "ppc64"
    },
    {
      "name": "cups-libs",
      "status": "Fixed",
      "fixed_version": "1:1.6.3-17.el7",
      "arch": "x86_64"
    },
    {
      "name": "cups-devel",
      "status": "Fixed",
      "fixed_version": "1:1.6.3-17.el7",
      "arch": "i686"
    },
    {
      "name": "cups-devel",
      "status": "Fixed",
      "fixed_version": "1:1.6.3-17.el7",
      "arch": "s390"
    },
    {
      "name": "cups-devel",
      "status": "Fixed",
      "fixed_version": "1:1.6.3-17.el7",
      "arch": "ppc"
    },
    {
      "name": "cups-devel",
      "status": "Fixed",
      "fixed_version": "1:1.6.3-17.el7",
      "arch": "ppc64"
    },
    {
      "name": "cups",
      "status": "Fixed",
      "fixed_version": "1:1.6.3-17.el7",
      "arch": "ppc64"
    },
    {
      "name": "cups-libs",
      "status": "Fixed",
      "fixed_version": "1:1.6.3-17.el7",
      "arch": "s390x"
    },
    {
      "name": "cups-ipptool",
      "status": "Fixed",
      "fixed_version": "1:1.6.3-17.el7",
      "arch": "ppc64"
    },
    {
      "name": "cups-filesystem",
      "status": "Fixed",
      "fixed_version": "1:1.6.3-17.el7"
    },
    {
      "name": "cups-lpd",
      "status": "Fixed",
      "fixed_version": "1:1.6.3-17.el7",
      "arch": "s390x"
    },
    {
      "name": "cups-devel",
      "status": "Fixed",
      "fixed_version": "1:1.6.3-17.el7",
      "arch": "x86_64"
    },
    {
      "name": "cups-ipptool",
      "status": "Fixed",
      "fixed_version": "1:1.6.3-17.el7",
      "arch": "s390x"
    },
    {
      "name": "cups",
      "status": "Fixed",
      "fixed_version": "1:1.6.3-17.el7",
      "arch": "x86_64"
    },
    {
      "name": "cups-client",
      "status": "Fixed",
      "fixed_version": "1:1.6.3-17.el7",
      "arch": "x86_64"
    },
    {
      "name": "cups-libs",
      "status": "Fixed",
      "fixed_version": "1:1.6.3-17.el7",
      "arch": "s390"
    },
    {
      "name": "cups-libs",
      "status": "Fixed",
      "fixed_version": "1:1.6.3-17.el7",
      "arch": "i686"
    },
    {
      "name": "cups-lpd",
      "status": "Fixed",
      "fixed_version": "1:1.6.3-17.el7",
      "arch": "x86_64"
    }
  ],
  "references": [
    {
      "id": "RHBA-2015:0386",
      "source": "RHSA",
      "url": "https://access.redhat.com/errata/RHBA-2015:0386"
    },
    {
      "id": "CVE-2014-2856",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2014-2856"
    },
    {
      "id": "CVE-2014-3537",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2014-3537"
    },
    {
      "id": "CVE-2014-5029",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2014-5029"
    },
    {
      "id": "CVE-2014-5030",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2014-5030"
    },
    {
      "id": "CVE-2014-5031",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2014-5031"
    },
    {
      "id": "CVE-2014-2856 cups: cross-site scripting flaw fixed in the 1.7.2 release",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1087122"
    },
    {
      "id": "CVE-2014-3537 cups: insufficient checking leads to privilege escalation",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1115576"
    },
    {
      "id": "CVE-2014-5029 cups: Incomplete fix for CVE-2014-3537",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1122600"
    },
    {
      "id": "CVE-2014-5030 cups: allows local users to read arbitrary files via a symlink attack",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1128764"
    },
    {
      "id": "CVE-2014-5031 cups: world-readable permissions",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1128767"
    }
  ],
  "public": "2014-07-22T00:00:00Z",
  "issued": "2015-03-05T00:00:00Z",
  "updated": "2015-03-05T00:00:00Z"
}
