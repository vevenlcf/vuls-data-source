{
  "id": "CVE-2014-9422",
  "rhsa_id": "RHSA-2015:0439",
  "definition_id": "oval:com.redhat.rhsa:def:20150439",
  "title": "RHSA-2015:0439: krb5 security, bug fix and enhancement update (Moderate)",
  "description": "A NULL pointer dereference flaw was found in the MIT Kerberos SPNEGO acceptor for continuation tokens. A remote, unauthenticated attacker could use this flaw to crash a GSSAPI-enabled server application. (CVE-2014-4344)\n\nA buffer overflow was found in the KADM5 administration server (kadmind) when it was used with an LDAP back end for the KDC database. A remote, authenticated attacker could potentially use this flaw to execute arbitrary code on the system running kadmind. (CVE-2014-4345)\n\nA use-after-free flaw was found in the way the MIT Kerberos libgssapi_krb5 library processed valid context deletion tokens. An attacker able to make an application using the GSS-API library (libgssapi) call the gss_process_context_token() function could use this flaw to crash that application. (CVE-2014-5352)\n\nIf kadmind were used with an LDAP back end for the KDC database, a remote, authenticated attacker with the permissions to set the password policy could crash kadmind by attempting to use a named ticket policy object as a password policy for a principal. (CVE-2014-5353)\n\nA double-free flaw was found in the way MIT Kerberos handled invalid External Data Representation (XDR) data. An authenticated user could use this flaw to crash the MIT Kerberos administration server (kadmind), or other applications using Kerberos libraries, using specially crafted XDR packets. (CVE-2014-9421)\n\nIt was found that the MIT Kerberos administration server (kadmind) incorrectly accepted certain authentication requests for two-component server principal names. A remote attacker able to acquire a key with a particularly named principal (such as \"kad/x\") could use this flaw to impersonate any user to kadmind, and perform administrative actions as that user. (CVE-2014-9422)\n\nAn information disclosure flaw was found in the way MIT Kerberos RPCSEC_GSS implementation (libgssrpc) handled certain requests. An attacker could send a specially crafted request to an application using libgssrpc to disclose a limited portion of uninitialized memory used by that application. (CVE-2014-9423)\n\nTwo buffer over-read flaws were found in the way MIT Kerberos handled certain requests. A remote, unauthenticated attacker able to inject packets into a client or server application's GSSAPI session could use either of these flaws to crash the application. (CVE-2014-4341, CVE-2014-4342)\n\nA double-free flaw was found in the MIT Kerberos SPNEGO initiators. An attacker able to spoof packets to appear as though they are from an GSSAPI acceptor could use this flaw to crash a client application that uses MIT Kerberos. (CVE-2014-4343)\n\nRed Hat would like to thank the MIT Kerberos project for reporting the CVE-2014-5352, CVE-2014-9421, CVE-2014-9422, and CVE-2014-9423 issues. MIT Kerberos project acknowledges Nico Williams for helping with the analysis of CVE-2014-5352.\n\nThe krb5 packages have been upgraded to upstream version 1.12, which provides a number of bug fixes and enhancements, including:\n\n* Added plug-in interfaces for principal-to-username mapping and verifying authorization to user accounts.\n\n* When communicating with a KDC over a connected TCP or HTTPS socket, the client gives the KDC more time to reply before it transmits the request to another server. (BZ#1049709, BZ#1127995)\n\nThis update also fixes multiple bugs, for example:\n\n* The Kerberos client library did not recognize certain exit statuses that the resolver libraries could return when looking up the addresses of servers configured in the /etc/krb5.conf file or locating Kerberos servers using DNS service location. The library could treat non-fatal return codes as fatal errors. Now, the library interprets the specific return codes correctly. (BZ#1084068, BZ#1109102)\n\nIn addition, this update adds various enhancements. Among others:\n\n* Added support for contacting KDCs and kpasswd servers through HTTPS proxies implementing the Kerberos KDC Proxy (KKDCP) protocol. (BZ#1109919)",
  "cvss2": "4.6/AV:N/AC:H/Au:S/C:P/I:P/A:P",
  "cwe": "CWE-697-\u003eCWE-305",
  "severity": "Moderate",
  "impact": "moderate",
  "affected": {
    "family": "unix",
    "platforms": [
      "Red Hat Enterprise Linux 7"
    ],
    "cpes": [
      {
        "cpe": "cpe:/o:redhat:rhel_tus:7.2"
      },
      {
        "cpe": "cpe:/o:redhat:rhel_tus:7.2::server",
        "repository": [
          "rhel-7-server-tus-optional-source-rpms__7_DOT_2__x86_64",
          "rhel-7-server-tus-rpms",
          "rhel-7-server-tus-source-rpms__7_DOT_2__x86_64",
          "rhel-7-server-tus-optional-rpms",
          "rhel-7-server-tus-optional-debug-rpms",
          "rhel-7-server-tus-optional-source-rpms",
          "rhel-7-server-tus-source-rpms",
          "rhel-7-server-tus-optional-debug-rpms__7_DOT_2__x86_64",
          "rhel-7-server-tus-debug-rpms__7_DOT_2__x86_64",
          "rhel-7-server-tus-debug-rpms",
          "rhel-7-server-tus-optional-rpms__7_DOT_2__x86_64",
          "rhel-7-server-tus-rpms__7_DOT_2__x86_64"
        ]
      }
    ]
  },
  "packages": [
    {
      "name": "krb5-pkinit",
      "status": "Fixed",
      "fixed_version": "0:1.12.2-14.el7",
      "arch": "ppc64"
    },
    {
      "name": "krb5-devel",
      "status": "Fixed",
      "fixed_version": "0:1.12.2-14.el7",
      "arch": "ppc64"
    },
    {
      "name": "krb5-server-ldap",
      "status": "Fixed",
      "fixed_version": "0:1.12.2-14.el7",
      "arch": "x86_64"
    },
    {
      "name": "krb5-server-ldap",
      "status": "Fixed",
      "fixed_version": "0:1.12.2-14.el7",
      "arch": "ppc64"
    },
    {
      "name": "krb5-devel",
      "status": "Fixed",
      "fixed_version": "0:1.12.2-14.el7",
      "arch": "i686"
    },
    {
      "name": "krb5-server",
      "status": "Fixed",
      "fixed_version": "0:1.12.2-14.el7",
      "arch": "s390x"
    },
    {
      "name": "krb5-libs",
      "status": "Fixed",
      "fixed_version": "0:1.12.2-14.el7",
      "arch": "s390"
    },
    {
      "name": "krb5-server",
      "status": "Fixed",
      "fixed_version": "0:1.12.2-14.el7",
      "arch": "x86_64"
    },
    {
      "name": "krb5-server-ldap",
      "status": "Fixed",
      "fixed_version": "0:1.12.2-14.el7",
      "arch": "s390x"
    },
    {
      "name": "krb5-pkinit",
      "status": "Fixed",
      "fixed_version": "0:1.12.2-14.el7",
      "arch": "s390x"
    },
    {
      "name": "krb5-libs",
      "status": "Fixed",
      "fixed_version": "0:1.12.2-14.el7",
      "arch": "ppc"
    },
    {
      "name": "krb5-workstation",
      "status": "Fixed",
      "fixed_version": "0:1.12.2-14.el7",
      "arch": "x86_64"
    },
    {
      "name": "krb5-libs",
      "status": "Fixed",
      "fixed_version": "0:1.12.2-14.el7",
      "arch": "i686"
    },
    {
      "name": "krb5-workstation",
      "status": "Fixed",
      "fixed_version": "0:1.12.2-14.el7",
      "arch": "s390x"
    },
    {
      "name": "krb5-libs",
      "status": "Fixed",
      "fixed_version": "0:1.12.2-14.el7",
      "arch": "s390x"
    },
    {
      "name": "krb5-libs",
      "status": "Fixed",
      "fixed_version": "0:1.12.2-14.el7",
      "arch": "ppc64"
    },
    {
      "name": "krb5-libs",
      "status": "Fixed",
      "fixed_version": "0:1.12.2-14.el7",
      "arch": "x86_64"
    },
    {
      "name": "krb5-workstation",
      "status": "Fixed",
      "fixed_version": "0:1.12.2-14.el7",
      "arch": "ppc64"
    },
    {
      "name": "krb5-devel",
      "status": "Fixed",
      "fixed_version": "0:1.12.2-14.el7",
      "arch": "s390x"
    },
    {
      "name": "krb5-devel",
      "status": "Fixed",
      "fixed_version": "0:1.12.2-14.el7",
      "arch": "ppc"
    },
    {
      "name": "krb5-devel",
      "status": "Fixed",
      "fixed_version": "0:1.12.2-14.el7",
      "arch": "x86_64"
    },
    {
      "name": "krb5-pkinit",
      "status": "Fixed",
      "fixed_version": "0:1.12.2-14.el7",
      "arch": "x86_64"
    },
    {
      "name": "krb5-devel",
      "status": "Fixed",
      "fixed_version": "0:1.12.2-14.el7",
      "arch": "s390"
    },
    {
      "name": "krb5-server",
      "status": "Fixed",
      "fixed_version": "0:1.12.2-14.el7",
      "arch": "ppc64"
    }
  ],
  "references": [
    {
      "id": "RHSA-2015:0439",
      "source": "RHSA",
      "url": "https://access.redhat.com/errata/RHSA-2015:0439"
    },
    {
      "id": "CVE-2014-4341",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2014-4341"
    },
    {
      "id": "CVE-2014-4342",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2014-4342"
    },
    {
      "id": "CVE-2014-4343",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2014-4343"
    },
    {
      "id": "CVE-2014-4344",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2014-4344"
    },
    {
      "id": "CVE-2014-4345",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2014-4345"
    },
    {
      "id": "CVE-2014-5352",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2014-5352"
    },
    {
      "id": "CVE-2014-5353",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2014-5353"
    },
    {
      "id": "CVE-2014-9421",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2014-9421"
    },
    {
      "id": "CVE-2014-9422",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2014-9422"
    },
    {
      "id": "CVE-2014-9423",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2014-9423"
    },
    {
      "id": "CVE-2014-4341 krb5: denial of service flaws when handling padding length longer than the plaintext",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1116180"
    },
    {
      "id": "CVE-2014-4342 krb5: denial of service flaws when handling RFC 1964 tokens",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1120581"
    },
    {
      "id": "CVE-2014-4343 krb5: double-free flaw in SPNEGO initiators",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1121876"
    },
    {
      "id": "CVE-2014-4344 krb5: NULL pointer dereference flaw in SPNEGO acceptor for continuation tokens",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1121877"
    },
    {
      "id": "CVE-2014-4345 krb5: buffer overrun in kadmind with LDAP backend (MITKRB5-SA-2014-001)",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1128157"
    },
    {
      "id": "CVE-2014-5353 krb5: NULL pointer dereference when using a ticket policy name as a password policy name",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1174543"
    },
    {
      "id": "CVE-2014-5352 krb5: gss_process_context_token() incorrectly frees context (MITKRB5-SA-2015-001)",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1179856"
    },
    {
      "id": "CVE-2014-9421 krb5: kadmind doubly frees partial deserialization results (MITKRB5-SA-2015-001)",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1179857"
    },
    {
      "id": "CVE-2014-9422 krb5: kadmind incorrectly validates server principal name (MITKRB5-SA-2015-001)",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1179861"
    },
    {
      "id": "CVE-2014-9423 krb5: libgssrpc server applications leak uninitialized bytes (MITKRB5-SA-2015-001)",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1179863"
    }
  ],
  "public": "2015-02-03T00:00:00Z",
  "issued": "2015-03-05T00:00:00Z",
  "updated": "2015-03-05T00:00:00Z"
}
