{
  "id": "CVE-2015-2704",
  "rhsa_id": "RHSA-2015:2184",
  "definition_id": "oval:com.redhat.rhsa:def:20152184",
  "title": "RHSA-2015:2184: realmd security, bug fix, and enhancement update (Moderate)",
  "description": "The realmd DBus system service manages discovery of and enrollment in\nrealms and domains, such as Active Directory or Identity Management (IdM).\nThe realmd service detects available domains, automatically configures the\nsystem, and joins it as an account to a domain.\n\nA flaw was found in the way realmd parsed certain input when writing\nconfiguration into the sssd.conf or smb.conf file. A remote attacker could\nuse this flaw to inject arbitrary configurations into these files via a\nnewline character in an LDAP response. (CVE-2015-2704)\n\nIt was found that the realm client would try to automatically join an\nactive directory domain without authentication, which could potentially\nlead to privilege escalation within a specified domain. (BZ#1205751)\n\nThe realmd packages have been upgraded to upstream version 0.16.1, which\nprovides a number of bug fixes and enhancements over the previous version.\n(BZ#1174911)\n\nThis update also fixes the following bugs:\n\n* Joining a Red Hat Enterprise Linux machine to a domain using the realm\nutility creates /home/domainname/[username]/ directories for domain users.\nPreviously, SELinux labeled the domain users' directories incorrectly. As a\nconsequence, the domain users sometimes experienced problems with SELinux\npolicy. This update modifies the realmd service default behavior so that\nthe domain users' directories are compatible with the standard SELinux\npolicy. (BZ#1241832)\n\n* Previously, the realm utility was unable to join or discover domains with\ndomain names containing underscore (_). The realmd service has been\nmodified to process underscores in domain names correctly, which fixes the\ndescribed bug. (BZ#1243771)\n\nIn addition, this update adds the following enhancement:\n\n* The realmd utility now allows the user to disable automatic ID mapping\nfrom the command line. To disable the mapping, pass the\n\"--automatic-id-mapping=no\" option to the realmd utility. (BZ#1230941)\n\nAll realmd users are advised to upgrade to these updated packages, which\ncorrect these issues and add these enhancements.",
  "cvss2": "4.3/AV:A/AC:H/Au:N/C:P/I:P/A:P",
  "cwe": "CWE-345",
  "severity": "Moderate",
  "impact": "moderate",
  "affected": {
    "family": "unix",
    "platforms": [
      "Red Hat Enterprise Linux 7"
    ],
    "cpes": [
      {
        "cpe": "cpe:/o:redhat:rhel_aus:7.2"
      },
      {
        "cpe": "cpe:/o:redhat:rhel_aus:7.2::server",
        "repository": [
          "rhel-7-server-aus-debug-rpms__7_DOT_2__x86_64",
          "rhel-7-server-aus-source-rpms",
          "rhel-7-server-aus-optional-rpms",
          "rhel-7-server-aus-source-rpms__7_DOT_2__x86_64",
          "rhel-7-server-aus-optional-debug-rpms__7_DOT_2__x86_64",
          "rhel-7-server-aus-optional-source-rpms__7_DOT_2__x86_64",
          "rhel-7-server-aus-rpms__7_DOT_2__x86_64",
          "rhel-7-server-aus-rpms",
          "rhel-7-server-aus-optional-rpms__7_DOT_2__x86_64",
          "rhel-7-server-aus-optional-debug-rpms",
          "rhel-7-server-aus-debug-rpms",
          "rhel-7-server-aus-optional-source-rpms"
        ]
      }
    ]
  },
  "packages": [
    {
      "name": "realmd",
      "status": "Fixed",
      "fixed_version": "0:0.16.1-5.el7",
      "arch": "x86_64"
    },
    {
      "name": "realmd",
      "status": "Fixed",
      "fixed_version": "0:0.16.1-5.el7",
      "arch": "aarch64"
    },
    {
      "name": "realmd-devel-docs",
      "status": "Fixed",
      "fixed_version": "0:0.16.1-5.el7",
      "arch": "aarch64"
    },
    {
      "name": "realmd",
      "status": "Fixed",
      "fixed_version": "0:0.16.1-5.el7",
      "arch": "s390x"
    },
    {
      "name": "realmd-devel-docs",
      "status": "Fixed",
      "fixed_version": "0:0.16.1-5.el7",
      "arch": "x86_64"
    },
    {
      "name": "realmd",
      "status": "Fixed",
      "fixed_version": "0:0.16.1-5.el7",
      "arch": "ppc64le"
    },
    {
      "name": "realmd-devel-docs",
      "status": "Fixed",
      "fixed_version": "0:0.16.1-5.el7",
      "arch": "ppc64le"
    },
    {
      "name": "realmd-devel-docs",
      "status": "Fixed",
      "fixed_version": "0:0.16.1-5.el7",
      "arch": "s390x"
    },
    {
      "name": "realmd-devel-docs",
      "status": "Fixed",
      "fixed_version": "0:0.16.1-5.el7",
      "arch": "ppc64"
    },
    {
      "name": "realmd",
      "status": "Fixed",
      "fixed_version": "0:0.16.1-5.el7",
      "arch": "ppc64"
    }
  ],
  "references": [
    {
      "id": "RHSA-2015:2184",
      "source": "RHSA",
      "url": "https://access.redhat.com/errata/RHSA-2015:2184"
    },
    {
      "id": "CVE-2015-2704",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2015-2704"
    },
    {
      "id": "CVE-2015-2704 realmd: untrusted data is used when configuring sssd.conf and/or smb.conf",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1205752"
    }
  ],
  "public": "2015-02-18T00:00:00Z",
  "issued": "2015-11-19T00:00:00Z",
  "updated": "2015-11-19T00:00:00Z"
}
