{
  "id": "CVE-2014-3707",
  "rhsa_id": "RHSA-2015:2159",
  "definition_id": "oval:com.redhat.rhsa:def:20152159",
  "title": "RHSA-2015:2159: curl security, bug fix, and enhancement update (Moderate)",
  "description": "The curl packages provide the libcurl library and the curl utility for\ndownloading files from servers using various protocols, including HTTP,\nFTP, and LDAP.\n\nIt was found that the libcurl library did not correctly handle partial\nliteral IP addresses when parsing received HTTP cookies. An attacker able\nto trick a user into connecting to a malicious server could use this flaw\nto set the user's cookie to a crafted domain, making other cookie-related\nissues easier to exploit. (CVE-2014-3613)\n\nA flaw was found in the way the libcurl library performed the duplication\nof connection handles. If an application set the CURLOPT_COPYPOSTFIELDS\noption for a handle, using the handle's duplicate could cause the\napplication to crash or disclose a portion of its memory. (CVE-2014-3707)\n\nIt was discovered that the libcurl library failed to properly handle URLs\nwith embedded end-of-line characters. An attacker able to make an\napplication using libcurl access a specially crafted URL via an HTTP proxy\ncould use this flaw to inject additional headers to the request or\nconstruct additional requests. (CVE-2014-8150)\n\nIt was discovered that libcurl implemented aspects of the NTLM and\nNegotatiate authentication incorrectly. If an application uses libcurl\nand the affected mechanisms in a specifc way, certain requests to a\npreviously NTLM-authenticated server could appears as sent by the wrong\nauthenticated user. Additionally, the initial set of credentials for HTTP\nNegotiate-authenticated requests could be reused in subsequent requests,\nalthough a different set of credentials was specified. (CVE-2015-3143,\nCVE-2015-3148)\n\nRed Hat would like to thank the cURL project for reporting these issues.\n\nBug fixes:\n\n* An out-of-protocol fallback to SSL 3.0 was available with libcurl.\nAttackers could abuse the fallback to force downgrade of the SSL version.\nThe fallback has been removed from libcurl. Users requiring this\nfunctionality can explicitly enable SSL 3.0 through the libcurl API.\n(BZ#1154060)\n\n* TLS 1.1 and TLS 1.2 are no longer disabled by default in libcurl. You can\nexplicitly disable them through the libcurl API. (BZ#1170339)\n\n* FTP operations such as downloading files took a significantly long time\nto complete. Now, the FTP implementation in libcurl correctly sets blocking\ndirection and estimated timeout for connections, resulting in faster FTP\ntransfers. (BZ#1218272)\n\nEnhancements:\n\n* With the updated packages, it is possible to explicitly enable or disable\nnew Advanced Encryption Standard (AES) cipher suites to be used for the TLS\nprotocol. (BZ#1066065)\n\n* The libcurl library did not implement a non-blocking SSL handshake, which\nnegatively affected performance of applications based on the libcurl multi\nAPI. The non-blocking SSL handshake has been implemented in libcurl, and\nthe libcurl multi API now immediately returns the control back to the\napplication whenever it cannot read or write data from or to the underlying\nnetwork socket. (BZ#1091429)\n\n* The libcurl library used an unnecessarily long blocking delay for actions\nwith no active file descriptors, even for short operations. Some actions,\nsuch as resolving a host name using /etc/hosts, took a long time to\ncomplete. The blocking code in libcurl has been modified so that the\ninitial delay is short and gradually increases until an event occurs.\n(BZ#1130239)\n\nAll curl users are advised to upgrade to these updated packages, which\ncontain backported patches to correct these issues and add these\nenhancements.",
  "cvss2": "4.0/AV:N/AC:H/Au:N/C:P/I:N/A:P",
  "cwe": "(CWE-125|CWE-416)",
  "severity": "Moderate",
  "impact": "moderate",
  "affected": {
    "family": "unix",
    "platforms": [
      "Red Hat Enterprise Linux 7"
    ],
    "cpes": [
      {
        "cpe": "cpe:/a:redhat:rhel_extras_sap_e4s:7.6",
        "repository": [
          "rhel-sap-for-rhel-7-server-e4s-debug-rpms__7_DOT_6__x86_64",
          "rhel-sap-for-rhel-7-for-power-le-e4s-debug-rpms",
          "rhel-sap-for-rhel-7-server-e4s-source-rpms__7_DOT_6__x86_64",
          "rhel-sap-for-rhel-7-for-power-le-e4s-rpms__7_DOT_6__ppc64le",
          "rhel-sap-for-rhel-7-for-power-le-e4s-debug-rpms__7_DOT_6__ppc64le",
          "rhel-sap-for-rhel-7-server-e4s-rpms__7_DOT_6__x86_64",
          "rhel-sap-for-rhel-7-for-power-le-e4s-source-rpms",
          "rhel-sap-for-rhel-7-server-e4s-source-rpms",
          "rhel-sap-for-rhel-7-server-e4s-debug-rpms",
          "rhel-sap-for-rhel-7-server-e4s-rpms",
          "rhel-sap-for-rhel-7-for-power-le-e4s-source-rpms__7_DOT_6__ppc64le",
          "rhel-sap-for-rhel-7-for-power-le-e4s-rpms"
        ]
      },
      {
        "cpe": "cpe:/a:redhat:rhel_extras_sap_hana_e4s:7.6",
        "repository": [
          "rhel-sap-hana-for-rhel-7-server-e4s-rpms__7_DOT_6__x86_64",
          "rhel-sap-hana-for-rhel-7-for-power-le-e4s-rpms",
          "rhel-sap-hana-for-rhel-7-for-power-le-e4s-rpms__7_DOT_6__ppc64le",
          "rhel-sap-hana-for-rhel-7-for-power-le-e4s-source-rpms__7_DOT_6__ppc64le",
          "rhel-sap-hana-for-rhel-7-for-power-le-e4s-source-rpms",
          "rhel-sap-hana-for-rhel-7-server-e4s-debug-rpms",
          "rhel-sap-hana-for-rhel-7-server-e4s-debug-rpms__7_DOT_6__x86_64",
          "rhel-sap-hana-for-rhel-7-for-power-le-e4s-debug-rpms__7_DOT_6__ppc64le",
          "rhel-sap-hana-for-rhel-7-server-e4s-source-rpms__7_DOT_6__x86_64",
          "rhel-sap-hana-for-rhel-7-for-power-le-e4s-debug-rpms",
          "rhel-sap-hana-for-rhel-7-server-e4s-rpms",
          "rhel-sap-hana-for-rhel-7-server-e4s-source-rpms"
        ]
      },
      {
        "cpe": "cpe:/o:redhat:rhel_e4s:7.6"
      },
      {
        "cpe": "cpe:/o:redhat:rhel_e4s:7.6::server",
        "repository": [
          "rhel-ha-for-rhel-7-server-for-power-le-e4s-debug-rpms__7_DOT_6__ppc64le",
          "rhel-7-server-tus-optional-rpms",
          "rhel-7-for-power-le-e4s-rpms__7_DOT_6__ppc64le",
          "rhel-7-server-e4s-source-rpms__7_DOT_6__x86_64",
          "rhel-7-server-tus-optional-source-rpms",
          "rhel-7-server-aus-source-rpms",
          "rhel-7-server-aus-optional-rpms",
          "rhel-7-server-e4s-debug-rpms",
          "rhel-7-server-tus-source-rpms",
          "rhel-7-for-power-le-e4s-optional-debug-rpms__7_DOT_6__ppc64le",
          "rhel-ha-for-rhel-7-server-for-power-le-e4s-source-rpms__7_DOT_6__ppc64le",
          "rhel-ha-for-rhel-7-server-e4s-source-rpms__7_DOT_6__x86_64",
          "rhel-7-server-e4s-source-rpms",
          "rhel-7-for-power-le-e4s-optional-rpms__7_DOT_6__ppc64le",
          "rhel-ha-for-rhel-7-server-for-power-le-e4s-rpms",
          "rhel-7-server-e4s-optional-debug-rpms__7_DOT_6__x86_64",
          "rhel-ha-for-rhel-7-server-for-power-le-e4s-rpms__7_DOT_6__ppc64le",
          "rhel-7-server-e4s-optional-source-rpms__7_DOT_6__x86_64",
          "rhel-7-for-power-le-e4s-debug-rpms__7_DOT_6__ppc64le",
          "rhel-7-server-aus-rpms",
          "rhel-7-server-e4s-optional-debug-rpms",
          "rhel-7-for-power-le-e4s-debug-rpms",
          "rhel-7-for-power-le-e4s-optional-rpms",
          "rhel-ha-for-rhel-7-server-e4s-rpms__7_DOT_6__x86_64",
          "rhel-7-for-power-le-e4s-optional-debug-rpms",
          "rhel-7-server-e4s-rpms",
          "rhel-7-server-e4s-optional-rpms",
          "rhel-7-server-e4s-debug-rpms__7_DOT_6__x86_64",
          "rhel-7-server-e4s-optional-source-rpms",
          "rhel-7-server-aus-optional-debug-rpms",
          "rhel-7-server-aus-debug-rpms",
          "rhel-ha-for-rhel-7-server-e4s-rpms",
          "rhel-7-server-tus-optional-debug-rpms",
          "rhel-7-for-power-le-e4s-source-rpms__7_DOT_6__ppc64le",
          "rhel-7-server-tus-debug-rpms",
          "rhel-ha-for-rhel-7-server-for-power-le-e4s-source-rpms",
          "rhel-7-for-power-le-e4s-optional-source-rpms",
          "rhel-7-server-e4s-optional-rpms__7_DOT_6__x86_64",
          "rhel-ha-for-rhel-7-server-e4s-debug-rpms",
          "rhel-ha-for-rhel-7-server-e4s-debug-rpms__7_DOT_6__x86_64",
          "rhel-7-for-power-le-e4s-rpms",
          "rhel-7-server-e4s-rpms__7_DOT_6__x86_64",
          "rhel-7-for-power-le-e4s-source-rpms",
          "rhel-ha-for-rhel-7-server-e4s-source-rpms",
          "rhel-ha-for-rhel-7-server-for-power-le-e4s-debug-rpms",
          "rhel-7-server-aus-optional-source-rpms",
          "rhel-7-for-power-le-e4s-optional-source-rpms__7_DOT_6__ppc64le"
        ]
      }
    ]
  },
  "packages": [
    {
      "name": "libcurl",
      "status": "Fixed",
      "fixed_version": "0:7.29.0-25.el7",
      "arch": "i686"
    },
    {
      "name": "libcurl-devel",
      "status": "Fixed",
      "fixed_version": "0:7.29.0-25.el7",
      "arch": "i686"
    },
    {
      "name": "libcurl",
      "status": "Fixed",
      "fixed_version": "0:7.29.0-25.el7",
      "arch": "s390x"
    },
    {
      "name": "libcurl",
      "status": "Fixed",
      "fixed_version": "0:7.29.0-25.el7",
      "arch": "x86_64"
    },
    {
      "name": "libcurl",
      "status": "Fixed",
      "fixed_version": "0:7.29.0-25.el7",
      "arch": "ppc"
    },
    {
      "name": "curl",
      "status": "Fixed",
      "fixed_version": "0:7.29.0-25.el7",
      "arch": "x86_64"
    },
    {
      "name": "libcurl-devel",
      "status": "Fixed",
      "fixed_version": "0:7.29.0-25.el7",
      "arch": "aarch64"
    },
    {
      "name": "libcurl-devel",
      "status": "Fixed",
      "fixed_version": "0:7.29.0-25.el7",
      "arch": "ppc64le"
    },
    {
      "name": "libcurl",
      "status": "Fixed",
      "fixed_version": "0:7.29.0-25.el7",
      "arch": "s390"
    },
    {
      "name": "libcurl-devel",
      "status": "Fixed",
      "fixed_version": "0:7.29.0-25.el7",
      "arch": "ppc64"
    },
    {
      "name": "libcurl-devel",
      "status": "Fixed",
      "fixed_version": "0:7.29.0-25.el7",
      "arch": "x86_64"
    },
    {
      "name": "curl",
      "status": "Fixed",
      "fixed_version": "0:7.29.0-25.el7",
      "arch": "s390x"
    },
    {
      "name": "libcurl-devel",
      "status": "Fixed",
      "fixed_version": "0:7.29.0-25.el7",
      "arch": "ppc"
    },
    {
      "name": "curl",
      "status": "Fixed",
      "fixed_version": "0:7.29.0-25.el7",
      "arch": "ppc64le"
    },
    {
      "name": "curl",
      "status": "Fixed",
      "fixed_version": "0:7.29.0-25.el7",
      "arch": "aarch64"
    },
    {
      "name": "libcurl",
      "status": "Fixed",
      "fixed_version": "0:7.29.0-25.el7",
      "arch": "ppc64"
    },
    {
      "name": "curl",
      "status": "Fixed",
      "fixed_version": "0:7.29.0-25.el7",
      "arch": "ppc64"
    },
    {
      "name": "libcurl-devel",
      "status": "Fixed",
      "fixed_version": "0:7.29.0-25.el7",
      "arch": "s390x"
    },
    {
      "name": "libcurl-devel",
      "status": "Fixed",
      "fixed_version": "0:7.29.0-25.el7",
      "arch": "s390"
    },
    {
      "name": "libcurl",
      "status": "Fixed",
      "fixed_version": "0:7.29.0-25.el7",
      "arch": "ppc64le"
    },
    {
      "name": "libcurl",
      "status": "Fixed",
      "fixed_version": "0:7.29.0-25.el7",
      "arch": "aarch64"
    }
  ],
  "references": [
    {
      "id": "RHSA-2015:2159",
      "source": "RHSA",
      "url": "https://access.redhat.com/errata/RHSA-2015:2159"
    },
    {
      "id": "CVE-2014-3613",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2014-3613"
    },
    {
      "id": "CVE-2014-3707",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2014-3707"
    },
    {
      "id": "CVE-2014-8150",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2014-8150"
    },
    {
      "id": "CVE-2015-3143",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2015-3143"
    },
    {
      "id": "CVE-2015-3148",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2015-3148"
    },
    {
      "id": "CVE-2014-3613 curl: incorrect handling of IP addresses in cookie domain",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1136154"
    },
    {
      "id": "CVE-2014-3707 curl: incorrect handle duplication after COPYPOSTFIELDS",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1154941"
    },
    {
      "id": "CVE-2014-8150 curl: URL request injection vulnerability in parseurlandfillconn()",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1178692"
    },
    {
      "id": "CVE-2015-3143 curl: re-using authenticated connection when unauthenticated",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1213306"
    },
    {
      "id": "CVE-2015-3148 curl: Negotiate not treated as connection-oriented",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1213351"
    }
  ],
  "public": "2014-11-05T00:00:00Z",
  "issued": "2015-11-19T00:00:00Z",
  "updated": "2015-11-19T00:00:00Z"
}
