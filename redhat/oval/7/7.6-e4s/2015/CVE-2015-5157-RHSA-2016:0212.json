{
  "id": "CVE-2015-5157",
  "rhsa_id": "RHSA-2016:0212",
  "definition_id": "oval:com.redhat.rhsa:def:20160212",
  "title": "RHSA-2016:0212: kernel-rt security, bug fix, and enhancement update (Important)",
  "description": "The kernel-rt packages contain the Linux kernel, the core of any Linux\noperating system.\n\n* It was found that the Linux kernel's keys subsystem did not correctly\ngarbage collect uninstantiated keyrings. A local attacker could use this\nflaw to crash the system or, potentially, escalate their privileges on the\nsystem. (CVE-2015-7872, Important)\n\n* A flaw was found in the way the Linux kernel handled IRET faults during\nthe processing of NMIs. An unprivileged, local user could use this flaw to\ncrash the system or, potentially (although highly unlikely), escalate their\nprivileges on the system. (CVE-2015-5157, Moderate)\n\nThe kernel-rt packages have been upgraded to version 3.10.0-327.10.1, which\nprovides a number of bug fixes and enhancements, including:\n\n* [md] dm: fix AB-BA deadlock in __dm_destroy() \n\n* [md] revert \"dm-mpath: fix stalls when handling invalid ioctl\n\n* [cpufreq] intel_pstate: Fix limits-\u003emax_perf and limits-\u003emax_policy_pct\nrounding errors\n\n* [cpufreq] revert \"intel_pstate: fix rounding error in max_freq_pct\"\n\n* [crypto] nx: 842 - Add CRC and validation support\n\n* [of] return NUMA_NO_NODE from fallback of_node_to_nid()\n\n(BZ#1282591)\n\nThis update also fixes the following bugs:\n\n* Because the realtime kernel replaces most of the spinlocks with\nrtmutexes, the locking scheme used in both NAPI polling and busy polling\ncould become out of synchronization with the State Machine they protected.\nThis could cause system performance degradation or even a livelock\nsituation when a machine with faster NICs (10g or 40g) was subject to a\nheavy pressure receiving network packets. The locking schemes on NAPI\npolling and busy polling routines have been hardened to enforce the State\nmachine sanity to help ensure the system continues to function properly\nunder pressure. (BZ#1293230)\n\n* A possible livelock in the NAPI polling and busy polling routines could\nlead the system to a livelock on threads running at high, realtime,\npriorities. The threads running at priorities lower than the ones of the\nthreads involved in the livelock were prevented from running on the CPUs\naffected by the livelock. Among those lower priority threads are the rcuc/\nthreads. With this update, right before (4 jiffies) a RCU stall is\ndetected, the rcuc/ threads on the CPUs facing the livelock have their\npriorities boosted above the priority of the threads involved in the\nlivelock. The softirq code has also been updated to be more robust.\nThese modifications allow the rcuc/ threads to execute even under system\npressure, mitigating the RCU stalls. (BZ#1293229)\n\n* Multiple CPUs trying to take an rq lock previously caused large latencies\non machines with many CPUs. On systems with more than 32 cores, this update\nuses the \"push\" rather than \"pull\" approach and provides multiple changes\nto the scheduling of rq locks. As a result, machines no longer suffer from\nmultiplied latencies on large CPU systems. (BZ#1282597)\n\n* Previously, the SFC driver for 10 GB cards executed polling in NAPI mode,\nusing a locking mechanism similar to a \"trylock\". Consequently, when\nrunning on a Realtime kernel, a livelock could occur. This update modifies\nthe locking mechanism so that once the lock is taken it is not released\nuntil the operation is complete. (BZ#1282609)\n\nAll kernel-rt users are advised to upgrade to these updated packages, which\ncorrect these issues and add these enhancements. The system must be\nrebooted for this update to take effect.",
  "cvss2": "6.2/AV:L/AC:H/Au:N/C:C/I:C/A:C",
  "cwe": "CWE-435",
  "severity": "Important",
  "impact": "moderate",
  "affected": {
    "family": "unix",
    "platforms": [
      "Red Hat Enterprise Linux 7"
    ],
    "cpes": [
      {
        "cpe": "cpe:/a:redhat:rhel_extras_sap_e4s:7.6",
        "repository": [
          "rhel-sap-for-rhel-7-server-e4s-debug-rpms__7_DOT_6__x86_64",
          "rhel-sap-for-rhel-7-for-power-le-e4s-debug-rpms",
          "rhel-sap-for-rhel-7-server-e4s-source-rpms__7_DOT_6__x86_64",
          "rhel-sap-for-rhel-7-for-power-le-e4s-rpms__7_DOT_6__ppc64le",
          "rhel-sap-for-rhel-7-for-power-le-e4s-debug-rpms__7_DOT_6__ppc64le",
          "rhel-sap-for-rhel-7-server-e4s-rpms__7_DOT_6__x86_64",
          "rhel-sap-for-rhel-7-for-power-le-e4s-source-rpms",
          "rhel-sap-for-rhel-7-server-e4s-source-rpms",
          "rhel-sap-for-rhel-7-server-e4s-debug-rpms",
          "rhel-sap-for-rhel-7-server-e4s-rpms",
          "rhel-sap-for-rhel-7-for-power-le-e4s-source-rpms__7_DOT_6__ppc64le",
          "rhel-sap-for-rhel-7-for-power-le-e4s-rpms"
        ]
      },
      {
        "cpe": "cpe:/a:redhat:rhel_extras_sap_hana_e4s:7.6",
        "repository": [
          "rhel-sap-hana-for-rhel-7-server-e4s-rpms__7_DOT_6__x86_64",
          "rhel-sap-hana-for-rhel-7-for-power-le-e4s-rpms",
          "rhel-sap-hana-for-rhel-7-for-power-le-e4s-rpms__7_DOT_6__ppc64le",
          "rhel-sap-hana-for-rhel-7-for-power-le-e4s-source-rpms__7_DOT_6__ppc64le",
          "rhel-sap-hana-for-rhel-7-for-power-le-e4s-source-rpms",
          "rhel-sap-hana-for-rhel-7-server-e4s-debug-rpms",
          "rhel-sap-hana-for-rhel-7-server-e4s-debug-rpms__7_DOT_6__x86_64",
          "rhel-sap-hana-for-rhel-7-for-power-le-e4s-debug-rpms__7_DOT_6__ppc64le",
          "rhel-sap-hana-for-rhel-7-server-e4s-source-rpms__7_DOT_6__x86_64",
          "rhel-sap-hana-for-rhel-7-for-power-le-e4s-debug-rpms",
          "rhel-sap-hana-for-rhel-7-server-e4s-rpms",
          "rhel-sap-hana-for-rhel-7-server-e4s-source-rpms"
        ]
      },
      {
        "cpe": "cpe:/o:redhat:rhel_e4s:7.6"
      },
      {
        "cpe": "cpe:/o:redhat:rhel_e4s:7.6::server",
        "repository": [
          "rhel-ha-for-rhel-7-server-for-power-le-e4s-debug-rpms__7_DOT_6__ppc64le",
          "rhel-7-server-tus-optional-rpms",
          "rhel-7-for-power-le-e4s-rpms__7_DOT_6__ppc64le",
          "rhel-7-server-e4s-source-rpms__7_DOT_6__x86_64",
          "rhel-7-server-tus-optional-source-rpms",
          "rhel-7-server-aus-source-rpms",
          "rhel-7-server-aus-optional-rpms",
          "rhel-7-server-e4s-debug-rpms",
          "rhel-7-server-tus-source-rpms",
          "rhel-7-for-power-le-e4s-optional-debug-rpms__7_DOT_6__ppc64le",
          "rhel-ha-for-rhel-7-server-for-power-le-e4s-source-rpms__7_DOT_6__ppc64le",
          "rhel-ha-for-rhel-7-server-e4s-source-rpms__7_DOT_6__x86_64",
          "rhel-7-server-e4s-source-rpms",
          "rhel-7-for-power-le-e4s-optional-rpms__7_DOT_6__ppc64le",
          "rhel-ha-for-rhel-7-server-for-power-le-e4s-rpms",
          "rhel-7-server-e4s-optional-debug-rpms__7_DOT_6__x86_64",
          "rhel-ha-for-rhel-7-server-for-power-le-e4s-rpms__7_DOT_6__ppc64le",
          "rhel-7-server-e4s-optional-source-rpms__7_DOT_6__x86_64",
          "rhel-7-for-power-le-e4s-debug-rpms__7_DOT_6__ppc64le",
          "rhel-7-server-aus-rpms",
          "rhel-7-server-e4s-optional-debug-rpms",
          "rhel-7-for-power-le-e4s-debug-rpms",
          "rhel-7-for-power-le-e4s-optional-rpms",
          "rhel-ha-for-rhel-7-server-e4s-rpms__7_DOT_6__x86_64",
          "rhel-7-for-power-le-e4s-optional-debug-rpms",
          "rhel-7-server-e4s-rpms",
          "rhel-7-server-e4s-optional-rpms",
          "rhel-7-server-e4s-debug-rpms__7_DOT_6__x86_64",
          "rhel-7-server-e4s-optional-source-rpms",
          "rhel-7-server-aus-optional-debug-rpms",
          "rhel-7-server-aus-debug-rpms",
          "rhel-ha-for-rhel-7-server-e4s-rpms",
          "rhel-7-server-tus-optional-debug-rpms",
          "rhel-7-for-power-le-e4s-source-rpms__7_DOT_6__ppc64le",
          "rhel-7-server-tus-debug-rpms",
          "rhel-ha-for-rhel-7-server-for-power-le-e4s-source-rpms",
          "rhel-7-for-power-le-e4s-optional-source-rpms",
          "rhel-7-server-e4s-optional-rpms__7_DOT_6__x86_64",
          "rhel-ha-for-rhel-7-server-e4s-debug-rpms",
          "rhel-ha-for-rhel-7-server-e4s-debug-rpms__7_DOT_6__x86_64",
          "rhel-7-for-power-le-e4s-rpms",
          "rhel-7-server-e4s-rpms__7_DOT_6__x86_64",
          "rhel-7-for-power-le-e4s-source-rpms",
          "rhel-ha-for-rhel-7-server-e4s-source-rpms",
          "rhel-ha-for-rhel-7-server-for-power-le-e4s-debug-rpms",
          "rhel-7-server-aus-optional-source-rpms",
          "rhel-7-for-power-le-e4s-optional-source-rpms__7_DOT_6__ppc64le"
        ]
      }
    ]
  },
  "packages": [
    {
      "name": "kernel-rt-trace-kvm",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-327.10.1.rt56.211.el7_2",
      "arch": "x86_64"
    },
    {
      "name": "kernel-rt-debug-kvm",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-327.10.1.rt56.211.el7_2",
      "arch": "x86_64"
    },
    {
      "name": "kernel-rt-debug",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-327.10.1.rt56.211.el7_2",
      "arch": "x86_64"
    },
    {
      "name": "kernel-rt-debug-devel",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-327.10.1.rt56.211.el7_2",
      "arch": "x86_64"
    },
    {
      "name": "kernel-rt-doc",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-327.10.1.rt56.211.el7_2"
    },
    {
      "name": "kernel-rt-devel",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-327.10.1.rt56.211.el7_2",
      "arch": "x86_64"
    },
    {
      "name": "kernel-rt-kvm",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-327.10.1.rt56.211.el7_2",
      "arch": "x86_64"
    },
    {
      "name": "kernel-rt-trace-devel",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-327.10.1.rt56.211.el7_2",
      "arch": "x86_64"
    },
    {
      "name": "kernel-rt-trace",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-327.10.1.rt56.211.el7_2",
      "arch": "x86_64"
    },
    {
      "name": "kernel-rt",
      "status": "Fixed",
      "fixed_version": "0:3.10.0-327.10.1.rt56.211.el7_2",
      "arch": "x86_64"
    }
  ],
  "references": [
    {
      "id": "RHSA-2016:0212",
      "source": "RHSA",
      "url": "https://access.redhat.com/errata/RHSA-2016:0212"
    },
    {
      "id": "CVE-2015-5157",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2015-5157"
    },
    {
      "id": "CVE-2015-7872",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2015-7872"
    },
    {
      "id": "CVE-2015-5157 kernel: x86-64: IRET faults during NMIs processing",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1259577"
    },
    {
      "id": "CVE-2015-7872 kernel: Keyrings crash triggerable by unprivileged user",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1272371"
    }
  ],
  "public": "2015-07-22T00:00:00Z",
  "issued": "2016-02-16T00:00:00Z",
  "updated": "2016-02-16T00:00:00Z"
}
