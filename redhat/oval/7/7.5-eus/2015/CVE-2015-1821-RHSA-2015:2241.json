{
  "id": "CVE-2015-1821",
  "rhsa_id": "RHSA-2015:2241",
  "definition_id": "oval:com.redhat.rhsa:def:20152241",
  "title": "RHSA-2015:2241: chrony security, bug fix, and enhancement update (Moderate)",
  "description": "The chrony suite, chronyd and chronyc, is an advanced implementation of the\nNetwork Time Protocol (NTP), specially designed to support systems with\nintermittent connections. It can synchronize the system clock with NTP\nservers, hardware reference clocks, and manual input. It can also operate\nas an NTPv4 (RFC 5905) server or peer to provide a time service to other\ncomputers in the network.\n\nAn out-of-bounds write flaw was found in the way chrony stored certain\naddresses when configuring NTP or cmdmon access. An attacker that has the\ncommand key and is allowed to access cmdmon (only localhost is allowed by\ndefault) could use this flaw to crash chronyd or, possibly, execute\narbitrary code with the privileges of the chronyd process. (CVE-2015-1821)\n\nAn uninitialized pointer use flaw was found when allocating memory to save\nunacknowledged replies to authenticated command requests. An attacker that\nhas the command key and is allowed to access cmdmon (only localhost is\nallowed by default) could use this flaw to crash chronyd or, possibly,\nexecute arbitrary code with the privileges of the chronyd process.\n(CVE-2015-1822)\n\nA denial of service flaw was found in the way chrony hosts that were\npeering with each other authenticated themselves before updating their\ninternal state variables. An attacker could send packets to one peer host,\nwhich could cascade to other peers, and stop the synchronization process\namong the reached peers. (CVE-2015-1853)\n\nThese issues were discovered by Miroslav Lichv√°r of Red Hat.\n\nThe chrony packages have been upgraded to upstream version 2.1.1, which\nprovides a number of bug fixes and enhancements over the previous version.\nNotable enhancements include:\n\n* Updated to NTP version 4 (RFC 5905)\n\n* Added pool directive to specify pool of NTP servers\n\n* Added leapsecmode directive to select how to correct clock for leap\nsecond\n\n* Added smoothtime directive to smooth served time and enable leap smear\n\n* Added asynchronous name resolving with POSIX threads\n\n* Ready for year 2036 (next NTP era)\n\n* Improved clock control\n\n* Networking code reworked to open separate client sockets for each NTP\nserver\n\n(BZ#1117882)\n\nThis update also fixes the following bug:\n\n* The chronyd service previously assumed that network interfaces specified\nwith the \"bindaddress\" directive were ready when the service was started.\nThis could cause chronyd to fail to bind an NTP server socket to the\ninterface if the interface was not ready. With this update, chronyd uses\nthe IP_FREEBIND socket option, enabling it to bind to an interface later,\nnot only when the service starts. (BZ#1169353)\n\nIn addition, this update adds the following enhancement:\n\n* The chronyd service now supports four modes of handling leap seconds,\nconfigured using the \"leapsecmode\" option. The clock can be either stepped\nby the kernel (the default \"system\" mode), stepped by chronyd (\"step\"\nmode), slowly adjusted by slewing (\"slew\" mode), or the leap second can be\nignored and corrected later in normal operation (\"ignore\" mode). If you\nselect slewing, the correction will always start at 00:00:00 UTC and will\nbe applied at a rate specified in the \"maxslewrate\" option. (BZ#1206504)\n\nAll chrony users are advised to upgrade to these updated packages, which\ncorrect these issues and add these enhancements.",
  "cvss2": "6.0/AV:N/AC:M/Au:S/C:P/I:P/A:P",
  "cwe": "(CWE-122|CWE-787)",
  "severity": "Moderate",
  "impact": "moderate",
  "affected": {
    "family": "unix",
    "platforms": [
      "Red Hat Enterprise Linux 7"
    ],
    "cpes": [
      {
        "cpe": "cpe:/a:redhat:rhel_extras_sap_eus:7.5",
        "repository": [
          "rhel-sap-for-rhel-7-server-eus-source-rpms__7_DOT_5__x86_64",
          "rhel-sap-for-rhel-7-for-system-z-eus-rpms__7_DOT_5__s390x",
          "rhel-sap-for-rhel-7-for-system-z-eus-source-rpms__7_DOT_5__s390x",
          "rhel-sap-for-rhel-7-for-power-le-eus-rpms__7_DOT_5__ppc64le",
          "rhel-sap-for-rhel-7-for-system-z-eus-source-rpms",
          "rhel-sap-for-rhel-7-for-power-eus-rpms",
          "rhel-sap-for-rhel-7-for-power-eus-rpms__7_DOT_5__ppc64",
          "rhel-sap-for-rhel-7-for-power-eus-source-rpms__7_DOT_5__ppc64",
          "rhel-sap-for-rhel-7-for-system-z-eus-debug-rpms__7_DOT_5__s390x",
          "rhel-sap-for-rhel-7-for-power-le-eus-source-rpms",
          "rhel-sap-for-rhel-7-for-system-z-eus-rpms",
          "rhel-sap-for-rhel-7-for-power-eus-debug-rpms__7_DOT_5__ppc64",
          "rhel-sap-for-rhel-7-for-power-eus-debug-rpms",
          "rhel-sap-for-rhel-7-server-eus-rpms",
          "rhel-sap-for-rhel-7-server-eus-debug-rpms__7_DOT_5__x86_64",
          "rhel-sap-for-rhel-7-for-power-le-eus-rpms",
          "rhel-sap-for-rhel-7-for-power-le-eus-source-rpms__7_DOT_5__ppc64le",
          "rhel-sap-for-rhel-7-server-eus-rpms__7_DOT_5__x86_64",
          "rhel-sap-for-rhel-7-for-power-le-eus-debug-rpms__7_DOT_5__ppc64le",
          "rhel-sap-for-rhel-7-for-power-le-eus-debug-rpms",
          "rhel-sap-for-rhel-7-for-system-z-eus-debug-rpms",
          "rhel-sap-for-rhel-7-for-power-eus-source-rpms",
          "rhel-sap-for-rhel-7-server-eus-debug-rpms",
          "rhel-sap-for-rhel-7-server-eus-source-rpms"
        ]
      },
      {
        "cpe": "cpe:/a:redhat:rhel_extras_sap_hana_eus:7.5",
        "repository": [
          "rhel-sap-hana-for-rhel-7-server-eus-rpms",
          "rhel-sap-hana-for-rhel-7-server-eus-debug-rpms",
          "rhel-sap-hana-for-rhel-7-server-eus-source-rpms",
          "rhel-sap-hana-for-rhel-7-for-power-le-eus-rpms__7_DOT_5__ppc64le",
          "rhel-sap-hana-for-rhel-7-server-eus-rpms__7_DOT_5__x86_64",
          "rhel-sap-hana-for-rhel-7-for-power-le-eus-debug-rpms",
          "rhel-sap-hana-for-rhel-7-server-eus-debug-rpms__7_DOT_5__x86_64",
          "rhel-sap-hana-for-rhel-7-for-power-le-eus-source-rpms__7_DOT_5__ppc64le",
          "rhel-sap-hana-for-rhel-7-for-power-le-eus-rpms",
          "rhel-sap-hana-for-rhel-7-server-eus-source-rpms__7_DOT_5__x86_64",
          "rhel-sap-hana-for-rhel-7-for-power-le-eus-debug-rpms__7_DOT_5__ppc64le",
          "rhel-sap-hana-for-rhel-7-for-power-le-eus-source-rpms"
        ]
      },
      {
        "cpe": "cpe:/o:redhat:rhel_eus:7.5"
      },
      {
        "cpe": "cpe:/o:redhat:rhel_eus:7.5::computenode",
        "repository": [
          "rhel-7-hpc-node-eus-optional-debug-rpms",
          "rhel-7-hpc-node-eus-rpms",
          "rhel-7-hpc-node-eus-optional-source-rpms",
          "rhel-7-hpc-node-eus-debug-rpms",
          "rhel-7-hpc-node-eus-debug-rpms__7_DOT_5__x86_64",
          "rhel-7-hpc-node-eus-source-rpms",
          "rhel-7-hpc-node-eus-optional-source-rpms__7_DOT_5__x86_64",
          "rhel-7-hpc-node-eus-source-rpms__7_DOT_5__x86_64",
          "rhel-7-hpc-node-eus-optional-rpms",
          "rhel-7-hpc-node-eus-rpms__7_DOT_5__x86_64",
          "rhel-7-hpc-node-eus-optional-debug-rpms__7_DOT_5__x86_64",
          "rhel-7-hpc-node-eus-optional-rpms__7_DOT_5__x86_64"
        ]
      },
      {
        "cpe": "cpe:/o:redhat:rhel_eus:7.5::server",
        "repository": [
          "rhel-7-for-system-z-eus-optional-debug-rpms__7_DOT_5__s390x",
          "rhel-7-for-power-le-eus-rpms",
          "rhel-7-for-system-z-eus-source-rpms__7_DOT_5__s390x",
          "rhel-ha-for-rhel-7-server-for-power-le-eus-rpms__7_DOT_5__ppc64le",
          "rhel-7-for-power-le-eus-optional-rpms__7_DOT_5__ppc64le",
          "rhel-7-server-eus-optional-source-rpms",
          "rhel-7-for-system-z-eus-source-rpms",
          "rhel-ha-for-rhel-7-server-eus-source-rpms__7_DOT_5__x86_64",
          "rhel-7-server-eus-debug-rpms__7_DOT_5__x86_64",
          "rhel-7-for-power-eus-source-rpms",
          "rhel-rs-for-rhel-7-server-eus-debug-rpms",
          "rhel-rs-for-rhel-7-server-eus-debug-rpms__7_DOT_5__x86_64",
          "rhel-rs-for-rhel-7-server-eus-rpms__7_DOT_5__x86_64",
          "rhel-7-for-system-z-eus-rpms__7_DOT_5__s390x",
          "rhel-7-for-system-z-eus-rpms",
          "rhel-7-for-power-le-eus-optional-rpms",
          "rhel-ha-for-rhel-7-server-eus-debug-rpms__7_DOT_5__x86_64",
          "rhel-7-server-eus-optional-debug-rpms",
          "rhel-7-for-system-z-eus-debug-rpms__7_DOT_5__s390x",
          "rhel-ha-for-rhel-7-server-for-power-le-eus-source-rpms",
          "rhel-7-for-power-eus-optional-source-rpms",
          "rhel-ha-for-rhel-7-server-eus-source-rpms",
          "rhel-7-for-power-le-eus-source-rpms__7_DOT_5__ppc64le",
          "rhel-7-server-eus-optional-rpms__7_DOT_5__x86_64",
          "rhel-7-server-eus-optional-source-rpms__7_DOT_5__x86_64",
          "rhel-7-for-power-eus-optional-rpms",
          "rhel-ha-for-rhel-7-server-eus-rpms",
          "rhel-ha-for-rhel-7-server-eus-rpms__7_DOT_5__x86_64",
          "rhel-7-for-power-eus-debug-rpms__7_DOT_5__ppc64",
          "rhel-rs-for-rhel-7-server-eus-source-rpms",
          "rhel-7-for-power-eus-rpms",
          "rhel-7-server-eus-rpms__7_DOT_5__x86_64",
          "rhel-7-for-system-z-eus-optional-rpms",
          "rhel-7-for-system-z-eus-optional-rpms__7_DOT_5__s390x",
          "rhel-7-for-system-z-eus-debug-rpms",
          "rhel-rs-for-rhel-7-server-for-power-le-eus-debug-rpms__7_DOT_5__ppc64le",
          "rhel-7-server-eus-debug-rpms",
          "rhel-7-for-power-le-eus-debug-rpms__7_DOT_5__ppc64le",
          "rhel-7-for-power-eus-optional-source-rpms__7_DOT_5__ppc64",
          "rhel-7-for-system-z-eus-optional-debug-rpms",
          "rhel-rs-for-rhel-7-server-for-power-le-eus-rpms",
          "rhel-rs-for-rhel-7-server-for-power-le-eus-source-rpms__7_DOT_5__ppc64le",
          "rhel-7-server-eus-source-rpms__7_DOT_5__x86_64",
          "rhel-ha-for-rhel-7-server-for-power-le-eus-source-rpms__7_DOT_5__ppc64le",
          "rhel-7-for-power-le-eus-debug-rpms",
          "rhel-7-for-power-eus-optional-debug-rpms__7_DOT_5__ppc64",
          "rhel-7-for-power-le-eus-source-rpms",
          "rhel-7-for-power-le-eus-optional-source-rpms",
          "rhel-ha-for-rhel-7-server-for-power-le-eus-rpms",
          "rhel-ha-for-rhel-7-server-eus-debug-rpms",
          "rhel-rs-for-rhel-7-server-eus-source-rpms__7_DOT_5__x86_64",
          "rhel-ha-for-rhel-7-server-for-power-le-eus-debug-rpms__7_DOT_5__ppc64le",
          "rhel-7-for-power-eus-debug-rpms",
          "rhel-rs-for-rhel-7-server-for-power-le-eus-rpms__7_DOT_5__ppc64le",
          "rhel-7-for-power-le-eus-rpms__7_DOT_5__ppc64le",
          "rhel-7-for-system-z-eus-optional-source-rpms",
          "rhel-7-server-eus-source-rpms",
          "rhel-rs-for-rhel-7-server-for-power-le-eus-source-rpms",
          "rhel-7-for-system-z-eus-optional-source-rpms__7_DOT_5__s390x",
          "rhel-ha-for-rhel-7-server-for-power-le-eus-debug-rpms",
          "rhel-7-for-power-eus-optional-debug-rpms",
          "rhel-7-server-eus-optional-rpms",
          "rhel-7-for-power-eus-rpms__7_DOT_5__ppc64",
          "rhel-7-for-power-le-eus-optional-source-rpms__7_DOT_5__ppc64le",
          "rhel-7-server-eus-optional-debug-rpms__7_DOT_5__x86_64",
          "rhel-7-for-power-eus-optional-rpms__7_DOT_5__ppc64",
          "rhel-rs-for-rhel-7-server-eus-rpms",
          "rhel-7-for-power-le-eus-optional-debug-rpms",
          "rhel-7-for-power-le-eus-optional-debug-rpms__7_DOT_5__ppc64le",
          "rhel-rs-for-rhel-7-server-for-power-le-eus-debug-rpms",
          "rhel-7-server-eus-rpms",
          "rhel-7-for-power-eus-source-rpms__7_DOT_5__ppc64"
        ]
      }
    ]
  },
  "packages": [
    {
      "name": "chrony",
      "status": "Fixed",
      "fixed_version": "0:2.1.1-1.el7",
      "arch": "x86_64"
    },
    {
      "name": "chrony",
      "status": "Fixed",
      "fixed_version": "0:2.1.1-1.el7",
      "arch": "aarch64"
    },
    {
      "name": "chrony",
      "status": "Fixed",
      "fixed_version": "0:2.1.1-1.el7",
      "arch": "ppc64"
    },
    {
      "name": "chrony",
      "status": "Fixed",
      "fixed_version": "0:2.1.1-1.el7",
      "arch": "ppc64le"
    },
    {
      "name": "chrony",
      "status": "Fixed",
      "fixed_version": "0:2.1.1-1.el7",
      "arch": "s390x"
    }
  ],
  "references": [
    {
      "id": "RHSA-2015:2241",
      "source": "RHSA",
      "url": "https://access.redhat.com/errata/RHSA-2015:2241"
    },
    {
      "id": "CVE-2015-1821",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2015-1821"
    },
    {
      "id": "CVE-2015-1822",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2015-1822"
    },
    {
      "id": "CVE-2015-1853",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2015-1853"
    },
    {
      "id": "CVE-2015-1853 chrony: authentication doesn't protect symmetric associations against DoS attacks",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1209572"
    },
    {
      "id": "CVE-2015-1821 chrony: Heap out of bound write in address filter",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1209631"
    },
    {
      "id": "CVE-2015-1822 chrony: uninitialized pointer in cmdmon reply slots",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1209632"
    }
  ],
  "public": "2015-04-07T00:00:00Z",
  "issued": "2015-11-19T00:00:00Z",
  "updated": "2015-11-19T00:00:00Z"
}
