{
  "id": "CVE-2011-2511",
  "rhsa_id": "RHSA-2011:1197",
  "definition_id": "oval:com.redhat.rhsa:def:20111197",
  "title": "RHSA-2011:1197: libvirt security and bug fix update (Moderate)",
  "description": "The libvirt library is a C API for managing and interacting with the\nvirtualization capabilities of Linux and other operating systems. In\naddition, libvirt provides tools for remotely managing virtualized systems.\n\nAn integer overflow flaw was found in libvirtd's RPC call handling. An\nattacker able to establish read-only connections to libvirtd could trigger\nthis flaw by calling virDomainGetVcpus() with specially-crafted parameters,\ncausing libvirtd to crash. (CVE-2011-2511)\n\nThis update also fixes the following bugs:\n\n* Previously, when the \"virsh vol-create-from\" command was run on an LVM\n(Logical Volume Manager) storage pool, performance of the command was very\nlow and the operation consumed an excessive amount of time. This bug has\nbeen fixed in the virStorageVolCreateXMLFrom() function, and the\nperformance problem of the command no longer occurs.\n\n* Due to a regression, libvirt used undocumented command line options,\ninstead of the recommended ones. Consequently, the qemu-img utility used an\ninvalid argument while creating an encrypted volume, and the process\neventually failed. With this update, the bug in the backing format of the\nstorage back end has been fixed, and encrypted volumes can now be created\nas expected. (BZ#726617)\n\n* Due to a bug in the qemuAuditDisk() function, hot unplug failures were\nnever audited, and a hot unplug success was audited as a failure. This bug\nhas been fixed, and auditing of disk hot unplug operations now works as\nexpected. (BZ#728516)\n\n* Previously, when a debug process was being activated, the act of\npreparing a debug message ended up with dereferencing a UUID (universally\nunique identifier) prior to the NULL argument check. Consequently, an API\nrunning the debug process sometimes terminated with a segmentation fault.\nWith this update, a patch has been provided to address this issue, and the\ncrashes no longer occur in the described scenario. (BZ#728546)\n\n* The libvirt library uses the \"boot=on\" option to mark which disk is\nbootable but it only uses that option if Qemu advertises its support. The\nqemu-kvm utility in Red Hat Enterprise Linux 6.1 removed support for that\noption and libvirt could not use it. As a consequence, when an IDE disk was\nadded as the second storage with a virtio disk being set up as the first\none by default, the operating system tried to boot from the IDE disk rather\nthan the virtio disk and either failed to boot with the \"No bootable disk\"\nerror message returned, or the system booted whatever operating system was\non the IDE disk. With this update, the boot configuration is translated\ninto bootindex, which provides control over which device is used for\nbooting a guest operating system, thus fixing this bug.\n\nAll users of libvirt are advised to upgrade to these updated packages,\nwhich contain backported patches to correct these issues. After installing\nthe updated packages, libvirtd must be restarted (\"service libvirtd\nrestart\") for this update to take effect.",
  "cvss2": "3.3/AV:A/AC:L/Au:N/C:N/I:N/A:P",
  "cwe": "CWE-190",
  "severity": "Moderate",
  "impact": "moderate",
  "affected": {
    "family": "unix",
    "platforms": [
      "Red Hat Enterprise Linux 6"
    ],
    "cpes": [
      {
        "cpe": "cpe:/o:redhat:rhel_aus:6.6"
      },
      {
        "cpe": "cpe:/o:redhat:rhel_aus:6.6::server",
        "repository": [
          "rhel-6-server-aus-rpms__6_DOT_6__x86_64",
          "rhel-6-server-aus-debug-rpms",
          "rhel-6-server-aus-source-rpms__6_DOT_6__x86_64",
          "rhel-6-server-aus-rpms",
          "rhel-6-server-aus-source-rpms",
          "rhel-6-server-aus-optional-debug-rpms__6_DOT_6__x86_64",
          "rhel-6-server-aus-optional-rpms",
          "rhel-6-server-aus-optional-source-rpms__6_DOT_6__x86_64",
          "rhel-6-server-aus-debug-rpms__6_DOT_6__x86_64",
          "rhel-6-server-aus-optional-debug-rpms",
          "rhel-6-server-aus-optional-source-rpms",
          "rhel-6-server-aus-optional-rpms__6_DOT_6__x86_64"
        ]
      }
    ]
  },
  "packages": [
    {
      "name": "libvirt-devel",
      "status": "Fixed",
      "fixed_version": "0:0.8.7-18.el6_1.1",
      "arch": "s390x"
    },
    {
      "name": "libvirt-client",
      "status": "Fixed",
      "fixed_version": "0:0.8.7-18.el6_1.1",
      "arch": "x86_64"
    },
    {
      "name": "libvirt",
      "status": "Fixed",
      "fixed_version": "0:0.8.7-18.el6_1.1",
      "arch": "x86_64"
    },
    {
      "name": "libvirt-devel",
      "status": "Fixed",
      "fixed_version": "0:0.8.7-18.el6_1.1",
      "arch": "x86_64"
    },
    {
      "name": "libvirt-python",
      "status": "Fixed",
      "fixed_version": "0:0.8.7-18.el6_1.1",
      "arch": "x86_64"
    },
    {
      "name": "libvirt-python",
      "status": "Fixed",
      "fixed_version": "0:0.8.7-18.el6_1.1",
      "arch": "ppc64"
    },
    {
      "name": "libvirt-devel",
      "status": "Fixed",
      "fixed_version": "0:0.8.7-18.el6_1.1",
      "arch": "s390"
    },
    {
      "name": "libvirt",
      "status": "Fixed",
      "fixed_version": "0:0.8.7-18.el6_1.1",
      "arch": "ppc64"
    },
    {
      "name": "libvirt-client",
      "status": "Fixed",
      "fixed_version": "0:0.8.7-18.el6_1.1",
      "arch": "s390x"
    },
    {
      "name": "libvirt-devel",
      "status": "Fixed",
      "fixed_version": "0:0.8.7-18.el6_1.1",
      "arch": "ppc"
    },
    {
      "name": "libvirt-python",
      "status": "Fixed",
      "fixed_version": "0:0.8.7-18.el6_1.1",
      "arch": "s390x"
    },
    {
      "name": "libvirt",
      "status": "Fixed",
      "fixed_version": "0:0.8.7-18.el6_1.1",
      "arch": "s390x"
    },
    {
      "name": "libvirt-client",
      "status": "Fixed",
      "fixed_version": "0:0.8.7-18.el6_1.1",
      "arch": "ppc64"
    },
    {
      "name": "libvirt-client",
      "status": "Fixed",
      "fixed_version": "0:0.8.7-18.el6_1.1",
      "arch": "ppc"
    },
    {
      "name": "libvirt-client",
      "status": "Fixed",
      "fixed_version": "0:0.8.7-18.el6_1.1",
      "arch": "s390"
    },
    {
      "name": "libvirt",
      "status": "Fixed",
      "fixed_version": "0:0.8.7-18.el6_1.1",
      "arch": "i686"
    },
    {
      "name": "libvirt-devel",
      "status": "Fixed",
      "fixed_version": "0:0.8.7-18.el6_1.1",
      "arch": "ppc64"
    },
    {
      "name": "libvirt-devel",
      "status": "Fixed",
      "fixed_version": "0:0.8.7-18.el6_1.1",
      "arch": "i686"
    },
    {
      "name": "libvirt-client",
      "status": "Fixed",
      "fixed_version": "0:0.8.7-18.el6_1.1",
      "arch": "i686"
    },
    {
      "name": "libvirt-python",
      "status": "Fixed",
      "fixed_version": "0:0.8.7-18.el6_1.1",
      "arch": "i686"
    }
  ],
  "references": [
    {
      "id": "RHSA-2011:1197",
      "source": "RHSA",
      "url": "https://access.redhat.com/errata/RHSA-2011:1197"
    },
    {
      "id": "CVE-2011-2511",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2011-2511"
    },
    {
      "id": "CVE-2011-2511 libvirt: integer overflow in VirDomainGetVcpus",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/717199"
    }
  ],
  "public": "2011-06-24T00:00:00Z",
  "issued": "2011-08-23T00:00:00Z",
  "updated": "2011-08-23T00:00:00Z"
}
