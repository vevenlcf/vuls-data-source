{
  "id": "CVE-2013-4151",
  "rhsa_id": "RHSA-2014:0743",
  "definition_id": "oval:com.redhat.rhsa:def:20140743",
  "title": "RHSA-2014:0743: qemu-kvm security and bug fix update (Moderate)",
  "description": "KVM (Kernel-based Virtual Machine) is a full virtualization solution for\nLinux on AMD64 and Intel 64 systems. The qemu-kvm package provides the\nuser-space component for running virtual machines using KVM.\n\nMultiple buffer overflow, input validation, and out-of-bounds write flaws\nwere found in the way the virtio, virtio-net, virtio-scsi, and usb drivers\nof QEMU handled state loading after migration. A user able to alter the\nsavevm data (either on the disk or over the wire during migration) could\nuse either of these flaws to corrupt QEMU process memory on the\n(destination) host, which could potentially result in arbitrary code\nexecution on the host with the privileges of the QEMU process.\n(CVE-2013-4148, CVE-2013-4151, CVE-2013-4535, CVE-2013-4536, CVE-2013-4541,\nCVE-2013-4542, CVE-2013-6399, CVE-2014-0182, CVE-2014-3461)\n\nAn out-of-bounds memory access flaw was found in the way QEMU's IDE device\ndriver handled the execution of SMART EXECUTE OFFLINE commands.\nA privileged guest user could use this flaw to corrupt QEMU process memory\non the host, which could potentially result in arbitrary code execution on\nthe host with the privileges of the QEMU process. (CVE-2014-2894)\n\nThe CVE-2013-4148, CVE-2013-4151, CVE-2013-4535, CVE-2013-4536,\nCVE-2013-4541, CVE-2013-4542, CVE-2013-6399, CVE-2014-0182, and\nCVE-2014-3461 issues were discovered by Michael S. Tsirkin of Red Hat,\nAnthony Liguori, and Michael Roth.\n\nThis update also fixes the following bugs:\n\n* Previously, under certain circumstances, libvirt failed to start guests\nwhich used a non-zero PCI domain and SR-IOV Virtual Functions (VFs), and\nreturned the following error message:\n\nCan't assign device inside non-zero PCI segment as this KVM module doesn't\nsupport it.\n\nThis update fixes this issue and guests using the aforementioned\nconfiguration no longer fail to start. (BZ#1099941)\n\n* Due to an incorrect initialization of the cpus_sts bitmap, which holds\nthe enablement status of a vCPU, libvirt could fail to start a guest with\nan unusual vCPU topology (for example, a guest with three cores and two\nsockets). With this update, the initialization of cpus_sts has been\ncorrected, and libvirt no longer fails to start the aforementioned guests.\n(BZ#1100575)\n\nAll qemu-kvm users are advised to upgrade to these updated packages, which\ncontain backported patches to correct these issues. After installing this\nupdate, shut down all running virtual machines. Once all virtual machines\nhave shut down, start them again for this update to take effect.",
  "cvss2": "3.7/AV:L/AC:H/Au:N/C:P/I:P/A:P",
  "cwe": "CWE-787",
  "severity": "Moderate",
  "impact": "moderate",
  "affected": {
    "family": "unix",
    "platforms": [
      "Red Hat Enterprise Linux 6"
    ],
    "cpes": [
      {
        "cpe": "cpe:/a:redhat:rhel_extras:6",
        "repository": [
          "rhel-6-for-hpc-node-supplementary-rpms",
          "rhel-6-workstation-supplementary-source-rpms",
          "rhel-6-for-system-z-eus-supplementary-source-rpms",
          "rhel-6-server-eus-supplementary-rpms",
          "rhel-6-desktop-supplementary-rpms",
          "rhel-6-server-aus-supplementary-rpms",
          "rhel-6-for-power-eus-supplementary-debuginfo",
          "rhel-6-for-system-z-eus-supplementary-debuginfo",
          "rhel-6-for-system-z-supplementary-rpms",
          "rhel-6-for-hpc-node-supplementary-debuginfo",
          "rhel-6-server-supplementary-rpms",
          "rhel-6-server-aus-supplementary-debuginfo",
          "rhel-hpc-node-6-eus-supplementary-debug-rpms",
          "rhel-6-server-aus-supplementary-source-rpms",
          "rhel-6-for-power-eus-supplementary-rpms",
          "rhel-6-for-power-supplementary-rpms",
          "rhel-6-server-supplementary-source-rpms",
          "rhel-6-workstation-supplementary-debuginfo",
          "rhel-6-server-eus-supplementary-debuginfo",
          "rhel-6-desktop-supplementary-source-rpms",
          "rhel-6-server-supplementary-debuginfo",
          "rhel-hpc-node-6-eus-supplementary-source-rpms",
          "rhel-hpc-node-6-eus-supplementary-rpms",
          "rhel-6-workstation-supplementary-rpms",
          "rhel-6-for-power-eus-supplementary-source-rpms",
          "rhel-6-for-system-z-eus-supplementary-rpms",
          "rhel-6-for-hpc-node-supplementary-source-rpms",
          "rhel-6-server-eus-supplementary-source-rpms",
          "rhel-6-for-system-z-supplementary-source-rpms",
          "rhel-6-desktop-supplementary-debuginfo",
          "rhel-6-for-power-supplementary-source-rpms"
        ]
      },
      {
        "cpe": "cpe:/a:redhat:rhel_extras_hpn:6",
        "repository": [
          "rhel-hpn-for-rhel-6-for-power-rpms",
          "rhel-hpn-for-rhel-6-hpc-node-rpms",
          "rhel-hpn-for-rhel-6-server-rpms"
        ]
      },
      {
        "cpe": "cpe:/a:redhat:rhel_extras_oracle_java:6",
        "repository": [
          "rhel-6-server-aus-restricted-maintenance-oracle-java-rpms",
          "rhel-6-server-restricted-maintenance-oracle-java-rpms",
          "rhel-6-desktop-restricted-maintenance-oracle-java-rpms",
          "rhel-6-for-hpc-node-restricted-maintenance-oracle-java-rpms",
          "rhel-6-workstation-restricted-maintenance-oracle-java-rpms",
          "rhel-hpc-node-6-eus-restricted-maintenance-oracle-java-rpms",
          "rhel-6-server-eus-restricted-maintenance-oracle-java-rpms"
        ]
      },
      {
        "cpe": "cpe:/a:redhat:rhel_extras_sap:6",
        "repository": [
          "rhel-sap-for-rhel-6-for-system-z-debug-rpms",
          "rhel-sap-for-rhel-6-for-system-z-rpms",
          "rhel-sap-for-rhel-6-server-rpms",
          "rhel-sap-for-rhel-6-for-power-source-rpms",
          "rhel-sap-for-rhel-6-server-eus-debug-rpms",
          "rhel-sap-for-rhel-6-for-power-rpms",
          "rhel-sap-for-rhel-6-server-source-rpms",
          "rhel-sap-for-rhel-6-server-eus-source-rpms",
          "rhel-sap-for-rhel-6-for-system-z-source-rpms",
          "rhel-sap-for-rhel-6-for-power-debug-rpms",
          "rhel-sap-for-rhel-6-server-eus-rpms",
          "rhel-sap-for-rhel-6-server-debug-rpms"
        ]
      },
      {
        "cpe": "cpe:/a:redhat:rhel_extras_sap_hana:6",
        "repository": [
          "rhel-sap-hana-for-rhel-6-server-eus-debug-rpms",
          "rhel-sap-hana-for-rhel-6-server-eus-rpms",
          "rhel-sap-hana-for-rhel-6-server-debug-rpms",
          "rhel-sap-hana-for-rhel-6-server-rpms",
          "rhel-sap-hana-for-rhel-6-server-source-rpms"
        ]
      },
      {
        "cpe": "cpe:/o:redhat:enterprise_linux:6"
      },
      {
        "cpe": "cpe:/o:redhat:enterprise_linux:6::client",
        "repository": [
          "rhel-6-desktop-optional-source-rpms",
          "rhel-6-desktop-source-rpms",
          "rhel-6-desktop-debug-rpms",
          "rhel-6-desktop-optional-fastrack-debug-rpms",
          "rhel-6-desktop-optional-fastrack-source-rpms",
          "rhel-6-desktop-optional-fastrack-rpms",
          "rhel-6-desktop-fastrack-source-rpms",
          "rhel-6-desktop-rpms",
          "rhel-6-desktop-optional-rpms",
          "rhel-6-desktop-optional-debug-rpms",
          "rhel-6-desktop-fastrack-rpms",
          "rhel-6-desktop-fastrack-debug-rpms"
        ]
      },
      {
        "cpe": "cpe:/o:redhat:enterprise_linux:6::computenode",
        "repository": [
          "rhel-hpc-node-6-eus-optional-rpms",
          "rhel-hpc-node-6-eus-sfs-source-rpms",
          "rhel-6-for-hpc-node-fastrack-debug-rpms",
          "rhel-6-hpc-node-source-rpms",
          "rhel-6-for-hpc-node-fastrack-rpms",
          "rhel-6-for-hpc-node-optional-fastrack-rpms",
          "rhel-hpc-node-6-eus-rpms",
          "rhel-hpc-node-6-eus-optional-debug-rpms",
          "rhel-6-for-hpc-node-optional-fastrack-source-rpms",
          "rhel-hpc-node-6-eus-debug-rpms",
          "rhel-hpc-node-6-eus-optional-source-rpms",
          "rhel-6-hpc-node-optional-rpms",
          "rhel-6-hpc-node-optional-debug-rpms",
          "rhel-6-hpc-node-optional-source-rpms",
          "rhel-scalefs-for-rhel-6-hpc-node-rpms",
          "rhel-hpc-node-6-eus-sfs-rpms",
          "rhel-scalefs-for-rhel-6-hpc-node-source-rpms",
          "rhel-6-hpc-node-rpms",
          "rhel-hpc-node-6-eus-sfs-debug-rpms",
          "rhel-6-for-hpc-node-fastrack-source-rpms",
          "rhel-6-hpc-node-debug-rpms",
          "rhel-hpc-node-6-eus-source-rpms",
          "rhel-6-for-hpc-node-optional-fastrack-debug-rpms",
          "rhel-scalefs-for-rhel-6-hpc-node-debug-rpms"
        ]
      },
      {
        "cpe": "cpe:/o:redhat:enterprise_linux:6::server",
        "repository": [
          "rhel-sfs-for-rhel-6-server-eus-source-rpms",
          "rhel-6-for-system-z-eus-optional-source-rpms",
          "rhel-6-for-power-optional-rpms",
          "rhel-6-server-optional-rpms",
          "rhel-6-for-power-fastrack-debug-rpms",
          "rhel-lb-for-rhel-6-server-rpms",
          "rhel-6-for-power-eus-optional-source-rpms",
          "rhel-6-for-system-z-optional-fastrack-source-rpms",
          "rhel-ha-for-rhel-6-server-eus-rpms",
          "rhel-6-server-debug-rpms",
          "rhel-6-for-system-z-optional-fastrack-rpms",
          "rhel-6-server-aus-optional-source-rpms",
          "rhel-6-for-power-rpms",
          "rhel-6-server-aus-debug-rpms",
          "rhel-sfs-for-rhel-6-server-eus-debug-rpms",
          "rhel-6-for-power-optional-source-rpms",
          "rhel-lb-for-rhel-6-server-eus-rpms",
          "rhel-6-for-power-optional-debug-rpms",
          "rhel-6-server-eus-rpms",
          "rhel-6-for-system-z-optional-fastrack-debug-rpms",
          "rhel-6-for-system-z-rpms",
          "rhel-lb-for-rhel-6-server-debug-rpms",
          "rhel-rs-for-rhel-6-server-rpms",
          "rhel-6-for-power-eus-debug-rpms",
          "rhel-6-server-eus-optional-rpms",
          "rhel-6-for-system-z-fastrack-debug-rpms",
          "rhel-6-for-power-eus-source-rpms",
          "rhel-6-for-power-eus-optional-rpms",
          "rhel-6-server-eus-optional-source-rpms",
          "rhel-6-server-eus-optional-debug-rpms",
          "rhel-rs-for-rhel-6-server-eus-source-rpms",
          "rhel-6-for-system-z-eus-debug-rpms",
          "rhel-6-for-power-optional-fastrack-rpms",
          "rhel-6-for-system-z-optional-source-rpms",
          "rhel-6-for-power-eus-optional-debug-rpms",
          "rhel-scalefs-for-rhel-6-server-rpms",
          "rhel-6-for-system-z-debug-rpms",
          "rhel-rs-for-rhel-6-server-debug-rpms",
          "rhel-6-for-power-source-rpms",
          "rhel-6-for-system-z-fastrack-rpms",
          "rhel-6-server-optional-fastrack-rpms",
          "rhel-6-server-optional-debug-rpms",
          "rhel-scalefs-for-rhel-6-server-debug-rpms",
          "rhel-6-server-fastrack-debug-rpms",
          "rhel-6-for-system-z-eus-optional-debug-rpms",
          "rhel-6-server-fastrack-source-rpms",
          "rhel-6-for-system-z-eus-source-rpms",
          "rhel-ha-for-rhel-6-server-debug-rpms",
          "rhel-6-for-system-z-eus-optional-rpms",
          "rhel-scalefs-for-rhel-6-server-source-rpms",
          "rhel-rs-for-rhel-6-server-eus-debug-rpms",
          "rhel-sfs-for-rhel-6-server-eus-rpms",
          "rhel-ha-for-rhel-6-server-eus-source-rpms",
          "rhel-ha-for-rhel-6-server-eus-debug-rpms",
          "rhel-rs-for-rhel-6-server-source-rpms",
          "rhel-lb-for-rhel-6-server-eus-source-rpms",
          "rhel-6-for-power-optional-fastrack-source-rpms",
          "rhel-6-for-power-fastrack-rpms",
          "rhel-6-server-optional-fastrack-source-rpms",
          "rhel-6-for-power-eus-rpms",
          "rhel-6-for-system-z-optional-rpms",
          "rhel-6-server-aus-optional-debug-rpms",
          "rhel-6-server-source-rpms",
          "rhel-6-server-eus-source-rpms",
          "rhel-6-for-system-z-source-rpms",
          "rhel-lb-for-rhel-6-server-source-rpms",
          "rhel-lb-for-rhel-6-server-eus-debug-rpms",
          "rhel-6-server-eus-debug-rpms",
          "rhel-6-for-power-fastrack-source-rpms",
          "rhel-rs-for-rhel-6-server-eus-rpms",
          "rhel-6-for-system-z-optional-debug-rpms",
          "rhel-6-for-power-optional-fastrack-debug-rpms",
          "rhel-6-server-aus-optional-rpms",
          "rhel-6-server-fastrack-rpms",
          "rhel-6-server-optional-source-rpms",
          "rhel-6-server-optional-fastrack-debug-rpms",
          "rhel-6-server-aus-source-rpms",
          "rhel-6-for-system-z-fastrack-source-rpms",
          "rhel-6-server-rpms",
          "rhel-ha-for-rhel-6-server-source-rpms",
          "rhel-ha-for-rhel-6-server-rpms",
          "rhel-6-for-power-debug-rpms",
          "rhel-6-for-system-z-eus-rpms",
          "rhel-6-server-aus-rpms"
        ]
      },
      {
        "cpe": "cpe:/o:redhat:enterprise_linux:6::workstation",
        "repository": [
          "rhel-6-workstation-optional-rpms",
          "rhel-6-workstation-optional-fastrack-rpms",
          "rhel-6-workstation-optional-fastrack-source-rpms",
          "rhel-6-workstation-optional-fastrack-debug-rpms",
          "rhel-6-workstation-fastrack-source-rpms",
          "rhel-6-workstation-optional-source-rpms",
          "rhel-6-workstation-rpms",
          "rhel-scalefs-for-rhel-6-workstation-debug-rpms",
          "rhel-6-workstation-optional-debug-rpms",
          "rhel-6-workstation-debug-rpms",
          "rhel-scalefs-for-rhel-6-workstation-rpms",
          "rhel-6-workstation-fastrack-debug-rpms",
          "rhel-6-workstation-source-rpms",
          "rhel-6-workstation-fastrack-rpms",
          "rhel-scalefs-for-rhel-6-workstation-source-rpms"
        ]
      },
      {
        "cpe": "cpe:/o:redhat:rhel_eus:6.0"
      }
    ]
  },
  "packages": [
    {
      "name": "qemu-guest-agent",
      "status": "Fixed",
      "fixed_version": "2:0.12.1.2-2.415.el6_5.10",
      "arch": "i686"
    },
    {
      "name": "qemu-guest-agent",
      "status": "Fixed",
      "fixed_version": "2:0.12.1.2-2.415.el6_5.10",
      "arch": "x86_64"
    },
    {
      "name": "qemu-img",
      "status": "Fixed",
      "fixed_version": "2:0.12.1.2-2.415.el6_5.10",
      "arch": "x86_64"
    },
    {
      "name": "qemu-kvm",
      "status": "Fixed",
      "fixed_version": "2:0.12.1.2-2.415.el6_5.10",
      "arch": "x86_64"
    },
    {
      "name": "qemu-kvm-tools",
      "status": "Fixed",
      "fixed_version": "2:0.12.1.2-2.415.el6_5.10",
      "arch": "x86_64"
    }
  ],
  "references": [
    {
      "id": "RHSA-2014:0743",
      "source": "RHSA",
      "url": "https://access.redhat.com/errata/RHSA-2014:0743"
    },
    {
      "id": "CVE-2013-4148",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2013-4148"
    },
    {
      "id": "CVE-2013-4151",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2013-4151"
    },
    {
      "id": "CVE-2013-4535",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2013-4535"
    },
    {
      "id": "CVE-2013-4536",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2013-4536"
    },
    {
      "id": "CVE-2013-4541",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2013-4541"
    },
    {
      "id": "CVE-2013-4542",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2013-4542"
    },
    {
      "id": "CVE-2013-6399",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2013-6399"
    },
    {
      "id": "CVE-2014-0182",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2014-0182"
    },
    {
      "id": "CVE-2014-2894",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2014-2894"
    },
    {
      "id": "CVE-2014-3461",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2014-3461"
    },
    {
      "id": "CVE-2013-4148 qemu: virtio-net: buffer overflow on invalid state load",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1066334"
    },
    {
      "id": "CVE-2013-4151 qemu: virtio: out-of-bounds buffer write on invalid state load",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1066342"
    },
    {
      "id": "CVE-2013-6399 qemu: virtio: buffer overrun on incoming migration",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1066361"
    },
    {
      "id": "CVE-2013-4542 qemu: virtio-scsi: buffer overrun on invalid state load",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1066382"
    },
    {
      "id": "CVE-2013-4541 qemu: usb: insufficient sanity checking of setup_index+setup_len in post_load",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1066384"
    },
    {
      "id": "CVE-2013-4535 CVE-2013-4536 qemu: virtio: insufficient validation of num_sg when mapping",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1066401"
    },
    {
      "id": "CVE-2014-2894 QEMU: out of bounds buffer accesses, guest triggerable via IDE SMART",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1087971"
    },
    {
      "id": "CVE-2014-0182 qemu: virtio: out-of-bounds buffer write on state load with invalid config_len",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1088986"
    },
    {
      "id": "CVE-2014-3461 Qemu: usb: fix up post load checks",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1096821"
    }
  ],
  "public": "2013-12-03T00:00:00Z",
  "issued": "2014-06-10T00:00:00Z",
  "updated": "2014-06-10T00:00:00Z"
}
