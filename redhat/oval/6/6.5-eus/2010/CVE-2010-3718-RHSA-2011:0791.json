{
  "id": "CVE-2010-3718",
  "rhsa_id": "RHSA-2011:0791",
  "definition_id": "oval:com.redhat.rhsa:def:20110791",
  "title": "RHSA-2011:0791: tomcat6 security and bug fix update (Moderate)",
  "description": "Apache Tomcat is a servlet container for the Java Servlet and JavaServer\nPages (JSP) technologies.\n\nIt was found that web applications could modify the location of the Tomcat\nhost's work directory. As web applications deployed on Tomcat have read and\nwrite access to this directory, a malicious web application could use this\nflaw to trick Tomcat into giving it read and write access to an arbitrary\ndirectory on the file system. (CVE-2010-3718)\n\nA cross-site scripting (XSS) flaw was found in the Manager application,\nused for managing web applications on Tomcat. If a remote attacker could\ntrick a user who is logged into the Manager application into visiting a\nspecially-crafted URL, the attacker could perform Manager application tasks\nwith the privileges of the logged in user. (CVE-2010-4172)\n\nA second cross-site scripting (XSS) flaw was found in the Manager\napplication. A malicious web application could use this flaw to conduct an\nXSS attack, leading to arbitrary web script execution with the privileges\nof victims who are logged into and viewing Manager application web pages.\n(CVE-2011-0013)\n\nThis update also fixes the following bugs:\n\n* A bug in the \"tomcat6\" init script prevented additional Tomcat instances\nfrom starting. As well, running \"service tomcat6 start\" caused\nconfiguration options applied from \"/etc/sysconfig/tomcat6\" to be\noverwritten with those from \"/etc/tomcat6/tomcat6.conf\". With this update,\nmultiple instances of Tomcat run as expected. (BZ#636997)\n\n* The \"/usr/share/java/\" directory was missing a symbolic link to the\n\"/usr/share/tomcat6/bin/tomcat-juli.jar\" library. Because this library was\nmandatory for certain operations (such as running the Jasper JSP\nprecompiler), the \"build-jar-repository\" command was unable to compose a\nvalid classpath. With this update, the missing symbolic link has been\nadded. (BZ#661244)\n\n* Previously, the \"tomcat6\" init script failed to start Tomcat with a \"This\naccount is currently not available.\" message when Tomcat was configured to\nrun under a user that did not have a valid shell configured as a login\nshell. This update modifies the init script to work correctly regardless of\nthe daemon user's login shell. Additionally, these new tomcat6 packages now\nset \"/sbin/nologin\" as the login shell for the \"tomcat\" user upon\ninstallation, as recommended by deployment best practices. (BZ#678671)\n\n* Some standard Tomcat directories were missing write permissions for the\n\"tomcat\" group, which could cause certain applications to fail with errors\nsuch as \"No output folder\". This update adds write permissions for the\n\"tomcat\" group to the affected directories. (BZ#643809)\n\n* The \"/usr/sbin/tomcat6\" wrapper script used a hard-coded path to the\n\"catalina.out\" file, which may have caused problems (such as for logging\ninit script output) if Tomcat was being run with a user other than \"tomcat\"\nand with CATALINA_BASE set to a directory other than the default.\n(BZ#695284, BZ#697504)\n\n* Stopping Tomcat could have resulted in traceback errors being logged to\n\"catalina.out\" when certain web applications were deployed. (BZ#698624)\n\nUsers of Tomcat should upgrade to these updated packages, which contain\nbackported patches to correct these issues. Tomcat must be restarted for\nthis update to take effect.",
  "cvss2": "4.0/AV:N/AC:H/Au:N/C:P/I:P/A:N",
  "severity": "Moderate",
  "impact": "moderate",
  "affected": {
    "family": "unix",
    "platforms": [
      "Red Hat Enterprise Linux 6"
    ],
    "cpes": [
      {
        "cpe": "cpe:/o:redhat:rhel_eus:6.5"
      },
      {
        "cpe": "cpe:/o:redhat:rhel_eus:6.5::computenode",
        "repository": [
          "rhel-hpc-node-6-eus-optional-rpms__6_DOT_5__x86_64",
          "rhel-hpc-node-6-eus-source-rpms",
          "rhel-hpc-node-6-eus-rpms",
          "rhel-hpc-node-6-eus-optional-source-rpms",
          "rhel-hpc-node-6-eus-debug-rpms",
          "rhel-hpc-node-6-eus-rpms__6_DOT_5__x86_64",
          "rhel-hpc-node-6-eus-optional-rpms",
          "rhel-hpc-node-6-eus-optional-source-rpms__6_DOT_5__x86_64",
          "rhel-hpc-node-6-eus-optional-debug-rpms",
          "rhel-hpc-node-6-eus-debug-rpms__6_DOT_5__x86_64",
          "rhel-hpc-node-6-eus-optional-debug-rpms__6_DOT_5__x86_64",
          "rhel-hpc-node-6-eus-source-rpms__6_DOT_5__x86_64"
        ]
      },
      {
        "cpe": "cpe:/o:redhat:rhel_eus:6.5::server",
        "repository": [
          "rhel-6-server-eus-optional-debug-rpms__6_DOT_5__x86_64",
          "rhel-6-server-eus-rpms",
          "rhel-6-server-eus-source-rpms",
          "rhel-lb-for-rhel-6-server-eus-rpms__6_DOT_5__i386",
          "rhel-6-for-power-eus-optional-source-rpms__6_DOT_5__ppc64",
          "rhel-6-server-aus-optional-source-rpms",
          "rhel-6-server-aus-rpms",
          "rhel-6-for-power-eus-optional-debug-rpms__6_DOT_5__ppc64",
          "rhel-6-for-system-z-eus-optional-source-rpms__6_DOT_5__s390x",
          "rhel-6-for-power-eus-optional-rpms",
          "rhel-rs-for-rhel-6-server-eus-rpms__6_DOT_5__i386",
          "rhel-6-server-eus-optional-debug-rpms__6_DOT_5__i386",
          "rhel-ha-for-rhel-6-server-eus-rpms__6_DOT_5__i386",
          "rhel-6-server-eus-optional-rpms__6_DOT_5__i386",
          "rhel-6-for-power-eus-debug-rpms",
          "rhel-6-server-eus-source-rpms__6_DOT_5__x86_64",
          "rhel-6-for-power-eus-rpms__6_DOT_5__ppc64",
          "rhel-6-for-power-eus-optional-debug-rpms",
          "rhel-6-for-system-z-eus-debug-rpms__6_DOT_5__s390x",
          "rhel-6-server-aus-optional-debug-rpms",
          "rhel-6-for-system-z-eus-optional-rpms",
          "rhel-6-for-system-z-eus-source-rpms__6_DOT_5__s390x",
          "rhel-6-server-eus-optional-source-rpms",
          "rhel-6-server-eus-debug-rpms",
          "rhel-6-for-power-eus-source-rpms__6_DOT_5__ppc64",
          "rhel-6-server-aus-debug-rpms",
          "rhel-6-for-system-z-eus-rpms",
          "rhel-6-server-eus-optional-debug-rpms",
          "rhel-6-for-system-z-eus-debug-rpms",
          "rhel-6-for-power-eus-optional-rpms__6_DOT_5__ppc64",
          "rhel-6-server-aus-optional-rpms",
          "rhel-6-for-power-eus-optional-source-rpms",
          "rhel-sfs-for-rhel-6-server-eus-rpms",
          "rhel-6-server-aus-source-rpms",
          "rhel-6-server-eus-source-rpms__6_DOT_5__i386",
          "rhel-6-for-system-z-eus-optional-rpms__6_DOT_5__s390x",
          "rhel-lb-for-rhel-6-server-eus-rpms",
          "rhel-6-server-eus-optional-rpms__6_DOT_5__x86_64",
          "rhel-rs-for-rhel-6-server-eus-rpms__6_DOT_5__x86_64",
          "rhel-6-server-eus-optional-rpms",
          "rhel-6-for-power-eus-source-rpms",
          "rhel-6-server-eus-optional-source-rpms__6_DOT_5__x86_64",
          "rhel-sfs-for-rhel-6-server-eus-rpms__6_DOT_5__x86_64",
          "rhel-6-server-eus-debug-rpms__6_DOT_5__i386",
          "rhel-6-for-power-eus-debug-rpms__6_DOT_5__ppc64",
          "rhel-ha-for-rhel-6-server-eus-rpms",
          "rhel-6-server-eus-rpms__6_DOT_5__i386",
          "rhel-6-for-system-z-eus-optional-source-rpms",
          "rhel-6-for-system-z-eus-rpms__6_DOT_5__s390x",
          "rhel-6-server-eus-optional-source-rpms__6_DOT_5__i386",
          "rhel-rs-for-rhel-6-server-eus-rpms",
          "rhel-lb-for-rhel-6-server-eus-rpms__6_DOT_5__x86_64",
          "rhel-6-for-system-z-eus-source-rpms",
          "rhel-6-for-system-z-eus-optional-debug-rpms__6_DOT_5__s390x",
          "rhel-ha-for-rhel-6-server-eus-rpms__6_DOT_5__x86_64",
          "rhel-6-server-eus-debug-rpms__6_DOT_5__x86_64",
          "rhel-6-server-eus-rpms__6_DOT_5__x86_64",
          "rhel-6-for-system-z-eus-optional-debug-rpms",
          "rhel-6-for-power-eus-rpms"
        ]
      }
    ]
  },
  "packages": [
    {
      "name": "tomcat6-jsp-2.1-api",
      "status": "Fixed",
      "fixed_version": "0:6.0.24-33.el6"
    },
    {
      "name": "tomcat6-el-2.1-api",
      "status": "Fixed",
      "fixed_version": "0:6.0.24-33.el6"
    },
    {
      "name": "tomcat6-lib",
      "status": "Fixed",
      "fixed_version": "0:6.0.24-33.el6"
    },
    {
      "name": "tomcat6-javadoc",
      "status": "Fixed",
      "fixed_version": "0:6.0.24-33.el6"
    },
    {
      "name": "tomcat6",
      "status": "Fixed",
      "fixed_version": "0:6.0.24-33.el6"
    },
    {
      "name": "tomcat6-servlet-2.5-api",
      "status": "Fixed",
      "fixed_version": "0:6.0.24-33.el6"
    },
    {
      "name": "tomcat6-admin-webapps",
      "status": "Fixed",
      "fixed_version": "0:6.0.24-33.el6"
    },
    {
      "name": "tomcat6-docs-webapp",
      "status": "Fixed",
      "fixed_version": "0:6.0.24-33.el6"
    },
    {
      "name": "tomcat6-webapps",
      "status": "Fixed",
      "fixed_version": "0:6.0.24-33.el6"
    }
  ],
  "references": [
    {
      "id": "RHSA-2011:0791",
      "source": "RHSA",
      "url": "https://access.redhat.com/errata/RHSA-2011:0791"
    },
    {
      "id": "CVE-2010-3718",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2010-3718"
    },
    {
      "id": "CVE-2010-4172",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2010-4172"
    },
    {
      "id": "CVE-2011-0013",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2011-0013"
    },
    {
      "id": "CVE-2010-4172 tomcat: cross-site-scripting vulnerability in the manager application",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/656246"
    },
    {
      "id": "CVE-2011-0013 tomcat: XSS vulnerability in HTML Manager interface",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/675786"
    },
    {
      "id": "CVE-2010-3718 tomcat: file permission bypass flaw",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/675792"
    }
  ],
  "public": "2011-02-05T00:00:00Z",
  "issued": "2011-05-19T00:00:00Z",
  "updated": "2011-05-19T00:00:00Z"
}
