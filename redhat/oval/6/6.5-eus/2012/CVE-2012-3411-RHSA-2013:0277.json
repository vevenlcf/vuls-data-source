{
  "id": "CVE-2012-3411",
  "rhsa_id": "RHSA-2013:0277",
  "definition_id": "oval:com.redhat.rhsa:def:20130277",
  "title": "RHSA-2013:0277: dnsmasq security, bug fix and enhancement update (Moderate)",
  "description": "The dnsmasq packages contain Dnsmasq, a lightweight DNS (Domain Name\nServer) forwarder and DHCP (Dynamic Host Configuration Protocol) server.\n\nIt was discovered that dnsmasq, when used in combination with certain\nlibvirtd configurations, could incorrectly process network packets from\nnetwork interfaces that were intended to be prohibited. A remote,\nunauthenticated attacker could exploit this flaw to cause a denial of\nservice via DNS amplification attacks. (CVE-2012-3411)\n\nIn order to fully address this issue, libvirt package users are advised to\ninstall updated libvirt packages. Refer to RHSA-2013:0276 for additional\ninformation.\n\nThis update also fixes the following bug:\n\n* Due to a regression, the lease change script was disabled. Consequently,\nthe \"dhcp-script\" option in the /etc/dnsmasq.conf configuration file did\nnot work. This update corrects the problem and the \"dhcp-script\" option now\nworks as expected. (BZ#815819)\n\nThis update also adds the following enhancements:\n\n* Prior to this update, dnsmasq did not validate that the tftp directory\ngiven actually existed and was a directory. Consequently, configuration\nerrors were not immediately reported on startup. This update improves the\ncode to validate the tftp root directory option. As a result, fault finding\nis simplified especially when dnsmasq is called by external processes such\nas libvirt. (BZ#824214)\n\n* The dnsmasq init script used an incorrect Process Identifier (PID) in the\n\"stop\", \"restart\", and \"condrestart\" commands. Consequently, if there were\nsome dnsmasq instances running besides the system one started by the init\nscript, then repeated calling of \"service dnsmasq\" with \"stop\" or \"restart\"\nwould kill all running dnsmasq instances, including ones not started with\nthe init script. The dnsmasq init script code has been corrected to obtain\nthe correct PID when calling the \"stop\", \"restart\", and \"condrestart\"\ncommands. As a result, if there are dnsmasq instances running in addition\nto the system one started by the init script, then by calling \"service\ndnsmasq\" with \"stop\" or \"restart\" only the system one is stopped or\nrestarted. (BZ#850944)\n\n* When two or more dnsmasq processes were running with DHCP enabled on one\ninterface, DHCP RELEASE packets were sometimes lost. Consequently, when two\nor more dnsmasq processes were running with DHCP enabled on one interface,\nreleasing IP addresses sometimes failed. This update sets the\nSO_BINDTODEVICE socket option on DHCP sockets if running dnsmasq with DHCP\nenabled on one interface. As a result, when two or more dnsmasq processes\nare running with DHCP enabled on one interface, they can release IP\naddresses as expected. (BZ#887156)\n\nAll users of dnsmasq are advised to upgrade to these updated packages,\nwhich fix these issues and add these enhancements.",
  "cvss2": "5.0/AV:N/AC:L/Au:N/C:N/I:N/A:P",
  "severity": "Moderate",
  "impact": "moderate",
  "affected": {
    "family": "unix",
    "platforms": [
      "Red Hat Enterprise Linux 6"
    ],
    "cpes": [
      {
        "cpe": "cpe:/o:redhat:rhel_eus:6.5"
      },
      {
        "cpe": "cpe:/o:redhat:rhel_eus:6.5::computenode",
        "repository": [
          "rhel-hpc-node-6-eus-optional-debug-rpms__6_DOT_5__x86_64",
          "rhel-hpc-node-6-eus-debug-rpms",
          "rhel-hpc-node-6-eus-source-rpms__6_DOT_5__x86_64",
          "rhel-hpc-node-6-eus-optional-source-rpms",
          "rhel-hpc-node-6-eus-source-rpms",
          "rhel-hpc-node-6-eus-rpms__6_DOT_5__x86_64",
          "rhel-hpc-node-6-eus-rpms",
          "rhel-hpc-node-6-eus-optional-rpms",
          "rhel-hpc-node-6-eus-optional-debug-rpms",
          "rhel-hpc-node-6-eus-optional-source-rpms__6_DOT_5__x86_64",
          "rhel-hpc-node-6-eus-optional-rpms__6_DOT_5__x86_64",
          "rhel-hpc-node-6-eus-debug-rpms__6_DOT_5__x86_64"
        ]
      },
      {
        "cpe": "cpe:/o:redhat:rhel_eus:6.5::server",
        "repository": [
          "rhel-6-for-power-eus-source-rpms__6_DOT_5__ppc64",
          "rhel-6-for-power-eus-optional-source-rpms",
          "rhel-6-for-system-z-eus-source-rpms",
          "rhel-6-for-system-z-eus-rpms__6_DOT_5__s390x",
          "rhel-6-server-eus-debug-rpms__6_DOT_5__i386",
          "rhel-sfs-for-rhel-6-server-eus-rpms__6_DOT_5__x86_64",
          "rhel-6-server-eus-rpms__6_DOT_5__x86_64",
          "rhel-6-server-aus-debug-rpms",
          "rhel-6-server-eus-optional-rpms__6_DOT_5__x86_64",
          "rhel-6-for-system-z-eus-rpms",
          "rhel-6-for-power-eus-optional-debug-rpms__6_DOT_5__ppc64",
          "rhel-6-for-power-eus-optional-debug-rpms",
          "rhel-6-for-power-eus-rpms__6_DOT_5__ppc64",
          "rhel-6-for-power-eus-source-rpms",
          "rhel-6-server-aus-rpms",
          "rhel-6-server-eus-optional-debug-rpms__6_DOT_5__x86_64",
          "rhel-6-for-power-eus-optional-source-rpms__6_DOT_5__ppc64",
          "rhel-6-server-aus-source-rpms",
          "rhel-rs-for-rhel-6-server-eus-rpms__6_DOT_5__x86_64",
          "rhel-6-for-power-eus-debug-rpms",
          "rhel-6-for-system-z-eus-optional-rpms__6_DOT_5__s390x",
          "rhel-6-server-eus-optional-rpms",
          "rhel-6-for-system-z-eus-optional-debug-rpms__6_DOT_5__s390x",
          "rhel-6-for-system-z-eus-source-rpms__6_DOT_5__s390x",
          "rhel-rs-for-rhel-6-server-eus-rpms",
          "rhel-ha-for-rhel-6-server-eus-rpms__6_DOT_5__i386",
          "rhel-6-server-eus-optional-source-rpms",
          "rhel-lb-for-rhel-6-server-eus-rpms",
          "rhel-6-server-eus-optional-debug-rpms__6_DOT_5__i386",
          "rhel-sfs-for-rhel-6-server-eus-rpms",
          "rhel-6-for-system-z-eus-debug-rpms",
          "rhel-6-for-system-z-eus-optional-rpms",
          "rhel-6-server-eus-source-rpms__6_DOT_5__x86_64",
          "rhel-6-server-eus-optional-rpms__6_DOT_5__i386",
          "rhel-6-server-eus-optional-source-rpms__6_DOT_5__x86_64",
          "rhel-6-server-eus-optional-debug-rpms",
          "rhel-6-for-power-eus-debug-rpms__6_DOT_5__ppc64",
          "rhel-rs-for-rhel-6-server-eus-rpms__6_DOT_5__i386",
          "rhel-6-for-power-eus-optional-rpms",
          "rhel-6-server-eus-optional-source-rpms__6_DOT_5__i386",
          "rhel-6-server-eus-source-rpms",
          "rhel-lb-for-rhel-6-server-eus-rpms__6_DOT_5__x86_64",
          "rhel-6-server-aus-optional-rpms",
          "rhel-6-server-eus-rpms",
          "rhel-6-server-eus-rpms__6_DOT_5__i386",
          "rhel-6-server-eus-source-rpms__6_DOT_5__i386",
          "rhel-6-for-system-z-eus-debug-rpms__6_DOT_5__s390x",
          "rhel-6-for-system-z-eus-optional-debug-rpms",
          "rhel-6-server-aus-optional-source-rpms",
          "rhel-6-server-eus-debug-rpms__6_DOT_5__x86_64",
          "rhel-6-for-power-eus-rpms",
          "rhel-6-for-system-z-eus-optional-source-rpms__6_DOT_5__s390x",
          "rhel-6-for-system-z-eus-optional-source-rpms",
          "rhel-ha-for-rhel-6-server-eus-rpms",
          "rhel-6-server-aus-optional-debug-rpms",
          "rhel-6-server-eus-debug-rpms",
          "rhel-6-for-power-eus-optional-rpms__6_DOT_5__ppc64",
          "rhel-lb-for-rhel-6-server-eus-rpms__6_DOT_5__i386",
          "rhel-ha-for-rhel-6-server-eus-rpms__6_DOT_5__x86_64"
        ]
      }
    ]
  },
  "packages": [
    {
      "name": "dnsmasq",
      "status": "Fixed",
      "fixed_version": "0:2.48-13.el6",
      "arch": "ppc64"
    },
    {
      "name": "dnsmasq",
      "status": "Fixed",
      "fixed_version": "0:2.48-13.el6",
      "arch": "s390x"
    },
    {
      "name": "dnsmasq-utils",
      "status": "Fixed",
      "fixed_version": "0:2.48-13.el6",
      "arch": "ppc64"
    },
    {
      "name": "dnsmasq-utils",
      "status": "Fixed",
      "fixed_version": "0:2.48-13.el6",
      "arch": "s390x"
    },
    {
      "name": "dnsmasq-utils",
      "status": "Fixed",
      "fixed_version": "0:2.48-13.el6",
      "arch": "x86_64"
    },
    {
      "name": "dnsmasq-utils",
      "status": "Fixed",
      "fixed_version": "0:2.48-13.el6",
      "arch": "i686"
    },
    {
      "name": "dnsmasq",
      "status": "Fixed",
      "fixed_version": "0:2.48-13.el6",
      "arch": "x86_64"
    },
    {
      "name": "dnsmasq",
      "status": "Fixed",
      "fixed_version": "0:2.48-13.el6",
      "arch": "i686"
    }
  ],
  "references": [
    {
      "id": "RHSA-2013:0277",
      "source": "RHSA",
      "url": "https://access.redhat.com/errata/RHSA-2013:0277"
    },
    {
      "id": "CVE-2012-3411",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2012-3411"
    },
    {
      "id": "CVE-2012-3411 libvirt+dnsmasq: DNS configured to answer DNS queries from non-virtual networks",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/833033"
    }
  ],
  "public": "2012-07-09T00:00:00Z",
  "issued": "2013-02-20T00:00:00Z",
  "updated": "2013-02-21T00:00:00Z"
}
