{
  "id": "CVE-2015-3148",
  "rhsa_id": "RHSA-2015:1254",
  "definition_id": "oval:com.redhat.rhsa:def:20151254",
  "title": "RHSA-2015:1254: curl security, bug fix, and enhancement update (Moderate)",
  "description": "The curl packages provide the libcurl library and the curl utility for\ndownloading files from servers using various protocols, including HTTP,\nFTP, and LDAP.\n\nIt was found that the libcurl library did not correctly handle partial\nliteral IP addresses when parsing received HTTP cookies. An attacker able\nto trick a user into connecting to a malicious server could use this flaw\nto set the user's cookie to a crafted domain, making other cookie-related\nissues easier to exploit. (CVE-2014-3613)\n\nA flaw was found in the way the libcurl library performed the duplication\nof connection handles. If an application set the CURLOPT_COPYPOSTFIELDS\noption for a handle, using the handle's duplicate could cause the\napplication to crash or disclose a portion of its memory. (CVE-2014-3707)\n\nIt was discovered that the libcurl library failed to properly handle URLs\nwith embedded end-of-line characters. An attacker able to make an\napplication using libcurl to access a specially crafted URL via an HTTP\nproxy could use this flaw to inject additional headers to the request or\nconstruct additional requests. (CVE-2014-8150)\n\nIt was discovered that libcurl implemented aspects of the NTLM and\nNegotatiate authentication incorrectly. If an application uses libcurl\nand the affected mechanisms in a specifc way, certain requests to a\npreviously NTLM-authenticated server could appears as sent by the wrong\nauthenticated user. Additionally, the initial set of credentials for HTTP\nNegotiate-authenticated requests could be reused in subsequent requests,\nalthough a different set of credentials was specified. (CVE-2015-3143,\nCVE-2015-3148)\n\nRed Hat would like to thank the cURL project for reporting these issues.\n\nBug fixes:\n\n* An out-of-protocol fallback to SSL version 3.0 (SSLv3.0) was available\nwith libcurl. Attackers could abuse the fallback to force downgrade of the\nSSL version. The fallback has been removed from libcurl. Users requiring\nthis functionality can explicitly enable SSLv3.0 through the libcurl API.\n(BZ#1154059)\n\n* A single upload transfer through the FILE protocol opened the destination\nfile twice. If the inotify kernel subsystem monitored the file, two events\nwere produced unnecessarily. The file is now opened only once per upload.\n(BZ#883002)\n\n* Utilities using libcurl for SCP/SFTP transfers could terminate\nunexpectedly when the system was running in FIPS mode. (BZ#1008178)\n\n* Using the \"--retry\" option with the curl utility could cause curl to\nterminate unexpectedly with a segmentation fault. Now, adding \"--retry\" no\nlonger causes curl to crash. (BZ#1009455)\n\n* The \"curl --trace-time\" command did not use the correct local time when\nprinting timestamps. Now, \"curl --trace-time\" works as expected.\n(BZ#1120196)\n\n* The valgrind utility could report dynamically allocated memory leaks on\ncurl exit. Now, curl performs a global shutdown of the NetScape Portable\nRuntime (NSPR) library on exit, and valgrind no longer reports the memory\nleaks. (BZ#1146528)\n\n* Previously, libcurl returned an incorrect value of the\nCURLINFO_HEADER_SIZE field when a proxy server appended its own headers to\nthe HTTP response. Now, the returned value is valid. (BZ#1161163)\n\nEnhancements:\n\n* The \"--tlsv1.0\", \"--tlsv1.1\", and \"--tlsv1.2\" options are available for\nspecifying the minor version of the TLS protocol to be negotiated by NSS.\nThe \"--tlsv1\" option now negotiates the highest version of the TLS protocol\nsupported by both the client and the server. (BZ#1012136)\n\n* It is now possible to explicitly enable or disable the ECC and the new\nAES cipher suites to be used for TLS. (BZ#1058767, BZ#1156422)\n\nAll curl users are advised to upgrade to these updated packages, which\ncontain backported patches to correct these issues and add these\nenhancements.",
  "cvss2": "4.0/AV:N/AC:H/Au:N/C:P/I:P/A:N",
  "cwe": "CWE-287",
  "severity": "Moderate",
  "impact": "moderate",
  "affected": {
    "family": "unix",
    "platforms": [
      "Red Hat Enterprise Linux 6"
    ],
    "cpes": [
      {
        "cpe": "cpe:/o:redhat:rhel_eus:6.5"
      },
      {
        "cpe": "cpe:/o:redhat:rhel_eus:6.5::computenode",
        "repository": [
          "rhel-hpc-node-6-eus-optional-debug-rpms__6_DOT_5__x86_64",
          "rhel-hpc-node-6-eus-rpms",
          "rhel-hpc-node-6-eus-source-rpms",
          "rhel-hpc-node-6-eus-optional-rpms",
          "rhel-hpc-node-6-eus-debug-rpms",
          "rhel-hpc-node-6-eus-optional-source-rpms__6_DOT_5__x86_64",
          "rhel-hpc-node-6-eus-optional-source-rpms",
          "rhel-hpc-node-6-eus-debug-rpms__6_DOT_5__x86_64",
          "rhel-hpc-node-6-eus-source-rpms__6_DOT_5__x86_64",
          "rhel-hpc-node-6-eus-rpms__6_DOT_5__x86_64",
          "rhel-hpc-node-6-eus-optional-debug-rpms",
          "rhel-hpc-node-6-eus-optional-rpms__6_DOT_5__x86_64"
        ]
      },
      {
        "cpe": "cpe:/o:redhat:rhel_eus:6.5::server",
        "repository": [
          "rhel-6-for-system-z-eus-debug-rpms",
          "rhel-6-for-system-z-eus-source-rpms",
          "rhel-6-server-eus-optional-source-rpms",
          "rhel-6-for-power-eus-optional-debug-rpms",
          "rhel-6-for-system-z-eus-optional-source-rpms",
          "rhel-6-for-system-z-eus-optional-debug-rpms__6_DOT_5__s390x",
          "rhel-6-server-eus-optional-debug-rpms",
          "rhel-6-server-eus-debug-rpms__6_DOT_5__x86_64",
          "rhel-6-server-eus-rpms__6_DOT_5__x86_64",
          "rhel-6-server-eus-source-rpms__6_DOT_5__i386",
          "rhel-6-server-aus-rpms",
          "rhel-lb-for-rhel-6-server-eus-rpms",
          "rhel-6-for-system-z-eus-optional-rpms",
          "rhel-6-for-system-z-eus-optional-source-rpms__6_DOT_5__s390x",
          "rhel-6-for-system-z-eus-optional-rpms__6_DOT_5__s390x",
          "rhel-6-server-eus-debug-rpms__6_DOT_5__i386",
          "rhel-6-for-power-eus-rpms",
          "rhel-6-server-eus-source-rpms__6_DOT_5__x86_64",
          "rhel-lb-for-rhel-6-server-eus-rpms__6_DOT_5__x86_64",
          "rhel-6-for-power-eus-optional-rpms",
          "rhel-sfs-for-rhel-6-server-eus-rpms",
          "rhel-6-for-power-eus-source-rpms",
          "rhel-6-server-eus-optional-debug-rpms__6_DOT_5__x86_64",
          "rhel-ha-for-rhel-6-server-eus-rpms",
          "rhel-6-server-aus-debug-rpms",
          "rhel-rs-for-rhel-6-server-eus-rpms",
          "rhel-sfs-for-rhel-6-server-eus-rpms__6_DOT_5__x86_64",
          "rhel-6-for-power-eus-debug-rpms__6_DOT_5__ppc64",
          "rhel-6-for-power-eus-optional-rpms__6_DOT_5__ppc64",
          "rhel-ha-for-rhel-6-server-eus-rpms__6_DOT_5__x86_64",
          "rhel-6-server-eus-source-rpms",
          "rhel-6-for-power-eus-optional-debug-rpms__6_DOT_5__ppc64",
          "rhel-6-for-power-eus-source-rpms__6_DOT_5__ppc64",
          "rhel-6-for-power-eus-optional-source-rpms__6_DOT_5__ppc64",
          "rhel-6-for-system-z-eus-rpms",
          "rhel-6-for-system-z-eus-optional-debug-rpms",
          "rhel-6-for-system-z-eus-source-rpms__6_DOT_5__s390x",
          "rhel-ha-for-rhel-6-server-eus-rpms__6_DOT_5__i386",
          "rhel-6-for-power-eus-rpms__6_DOT_5__ppc64",
          "rhel-6-server-eus-optional-rpms",
          "rhel-6-for-power-eus-optional-source-rpms",
          "rhel-6-server-eus-rpms__6_DOT_5__i386",
          "rhel-lb-for-rhel-6-server-eus-rpms__6_DOT_5__i386",
          "rhel-6-server-aus-source-rpms",
          "rhel-rs-for-rhel-6-server-eus-rpms__6_DOT_5__i386",
          "rhel-6-for-system-z-eus-debug-rpms__6_DOT_5__s390x",
          "rhel-6-server-eus-optional-source-rpms__6_DOT_5__x86_64",
          "rhel-6-server-eus-optional-rpms__6_DOT_5__i386",
          "rhel-6-server-eus-rpms",
          "rhel-6-server-eus-debug-rpms",
          "rhel-6-server-eus-optional-rpms__6_DOT_5__x86_64",
          "rhel-6-server-aus-optional-debug-rpms",
          "rhel-6-server-aus-optional-rpms",
          "rhel-rs-for-rhel-6-server-eus-rpms__6_DOT_5__x86_64",
          "rhel-6-for-power-eus-debug-rpms",
          "rhel-6-server-eus-optional-debug-rpms__6_DOT_5__i386",
          "rhel-6-server-eus-optional-source-rpms__6_DOT_5__i386",
          "rhel-6-for-system-z-eus-rpms__6_DOT_5__s390x",
          "rhel-6-server-aus-optional-source-rpms"
        ]
      }
    ]
  },
  "packages": [
    {
      "name": "libcurl-devel",
      "status": "Fixed",
      "fixed_version": "0:7.19.7-46.el6",
      "arch": "ppc"
    },
    {
      "name": "libcurl",
      "status": "Fixed",
      "fixed_version": "0:7.19.7-46.el6",
      "arch": "ppc"
    },
    {
      "name": "curl",
      "status": "Fixed",
      "fixed_version": "0:7.19.7-46.el6",
      "arch": "i686"
    },
    {
      "name": "curl",
      "status": "Fixed",
      "fixed_version": "0:7.19.7-46.el6",
      "arch": "x86_64"
    },
    {
      "name": "curl",
      "status": "Fixed",
      "fixed_version": "0:7.19.7-46.el6",
      "arch": "ppc64"
    },
    {
      "name": "libcurl-devel",
      "status": "Fixed",
      "fixed_version": "0:7.19.7-46.el6",
      "arch": "i686"
    },
    {
      "name": "libcurl",
      "status": "Fixed",
      "fixed_version": "0:7.19.7-46.el6",
      "arch": "x86_64"
    },
    {
      "name": "libcurl",
      "status": "Fixed",
      "fixed_version": "0:7.19.7-46.el6",
      "arch": "i686"
    },
    {
      "name": "libcurl-devel",
      "status": "Fixed",
      "fixed_version": "0:7.19.7-46.el6",
      "arch": "ppc64"
    },
    {
      "name": "libcurl-devel",
      "status": "Fixed",
      "fixed_version": "0:7.19.7-46.el6",
      "arch": "s390x"
    },
    {
      "name": "curl",
      "status": "Fixed",
      "fixed_version": "0:7.19.7-46.el6",
      "arch": "s390x"
    },
    {
      "name": "libcurl-devel",
      "status": "Fixed",
      "fixed_version": "0:7.19.7-46.el6",
      "arch": "s390"
    },
    {
      "name": "libcurl",
      "status": "Fixed",
      "fixed_version": "0:7.19.7-46.el6",
      "arch": "s390x"
    },
    {
      "name": "libcurl",
      "status": "Fixed",
      "fixed_version": "0:7.19.7-46.el6",
      "arch": "ppc64"
    },
    {
      "name": "libcurl",
      "status": "Fixed",
      "fixed_version": "0:7.19.7-46.el6",
      "arch": "s390"
    },
    {
      "name": "libcurl-devel",
      "status": "Fixed",
      "fixed_version": "0:7.19.7-46.el6",
      "arch": "x86_64"
    }
  ],
  "references": [
    {
      "id": "RHSA-2015:1254",
      "source": "RHSA",
      "url": "https://access.redhat.com/errata/RHSA-2015:1254"
    },
    {
      "id": "CVE-2014-3613",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2014-3613"
    },
    {
      "id": "CVE-2014-3707",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2014-3707"
    },
    {
      "id": "CVE-2014-8150",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2014-8150"
    },
    {
      "id": "CVE-2015-3143",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2015-3143"
    },
    {
      "id": "CVE-2015-3148",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2015-3148"
    },
    {
      "id": "CVE-2014-3613 curl: incorrect handling of IP addresses in cookie domain",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1136154"
    },
    {
      "id": "CVE-2014-3707 curl: incorrect handle duplication after COPYPOSTFIELDS",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1154941"
    },
    {
      "id": "CVE-2014-8150 curl: URL request injection vulnerability in parseurlandfillconn()",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1178692"
    },
    {
      "id": "CVE-2015-3143 curl: re-using authenticated connection when unauthenticated",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1213306"
    },
    {
      "id": "CVE-2015-3148 curl: Negotiate not treated as connection-oriented",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1213351"
    }
  ],
  "public": "2015-04-22T00:00:00Z",
  "issued": "2015-07-20T00:00:00Z",
  "updated": "2015-07-22T00:00:00Z"
}
