{
  "id": "CVE-2013-5704",
  "rhsa_id": "RHSA-2015:1249",
  "definition_id": "oval:com.redhat.rhsa:def:20151249",
  "title": "RHSA-2015:1249: httpd security, bug fix, and enhancement update (Low)",
  "description": "The httpd packages provide the Apache HTTP Server, a powerful, efficient,\nand extensible web server.\n\nA flaw was found in the way httpd handled HTTP Trailer headers when\nprocessing requests using chunked encoding. A malicious client could use\nTrailer headers to set additional HTTP headers after header processing was\nperformed by other modules. This could, for example, lead to a bypass of\nheader restrictions defined with mod_headers. (CVE-2013-5704)\n\nThis update also fixes the following bugs:\n\n* The order of mod_proxy workers was not checked when httpd configuration\nwas reloaded. When mod_proxy workers were removed, added, or their order\nwas changed, their parameters and scores could become mixed. The order of\nmod_proxy workers has been made internally consistent during configuration\nreload. (BZ#1149906)\n\n* The local host certificate created during firstboot contained CA\nextensions, which caused the httpd service to return warning messages.\nThis has been addressed by local host certificates being generated with the\n\"-extensions v3_req\" option. (BZ#906476)\n\n* The default mod_ssl configuration no longer enables support for SSL\ncipher suites using the single DES, IDEA, or SEED encryption algorithms.\n(BZ#1086771)\n\n* The apachectl script did not take into account the HTTPD_LANG variable\nset in the /etc/sysconfig/httpd file during graceful restarts.\nConsequently, httpd did not use a changed value of HTTPD_LANG when the\ndaemon was restarted gracefully. The script has been fixed to handle the\nHTTPD_LANG variable correctly. (BZ#963146)\n\n* The mod_deflate module failed to check the original file size while\nextracting files larger than 4 GB, making it impossible to extract large\nfiles. Now, mod_deflate checks the original file size properly according to\nRFC1952, and it is able to decompress files larger than 4 GB. (BZ#1057695)\n\n* The httpd service did not check configuration before restart. When a\nconfiguration contained an error, an attempt to restart httpd gracefully\nfailed. Now, httpd checks configuration before restart and if the\nconfiguration is in an inconsistent state, an error message is printed,\nhttpd is not stopped and a restart is not performed. (BZ#1146194)\n\n* The SSL_CLIENT_VERIFY environment variable was incorrectly handled when\nthe \"SSLVerifyClient optional_no_ca\" and \"SSLSessionCache\" options were\nused. When an SSL session was resumed, the SSL_CLIENT_VERIFY value was set\nto \"SUCCESS\" instead of the previously set \"GENEROUS\". SSL_CLIENT_VERIFY is\nnow correctly set to GENEROUS in this scenario. (BZ#1149703)\n\n* The ab utility did not correctly handle situations when an SSL connection\nwas closed after some data had already been read. As a consequence, ab did\nnot work correctly with SSL servers and printed \"SSL read failed\" error\nmessages. With this update, ab works as expected with HTTPS servers.\n(BZ#1045477)\n\n* When a client presented a revoked certificate, log entries were created\nonly at the debug level. The log level of messages regarding a revoked\ncertificate has been increased to INFO, and administrators are now properly\ninformed of this situation. (BZ#1161328)\n\nIn addition, this update adds the following enhancement:\n\n* A mod_proxy worker can now be set into drain mode (N) using the\nbalancer-manager web interface or using the httpd configuration file.\nA worker in drain mode accepts only existing sticky sessions destined for\nitself and ignores all other requests. The worker waits until all clients\ncurrently connected to this worker complete their work before the worker is\nstopped. As a result, drain mode enables to perform maintenance on a worker\nwithout affecting clients. (BZ#767130)\n\nUsers of httpd are advised to upgrade to these updated packages, which\ncontain backported patches to correct these issues and add this\nenhancement. After installing the updated packages, the httpd service will\nbe restarted automatically.",
  "cvss2": "4.3/AV:N/AC:M/Au:N/C:N/I:P/A:N",
  "cwe": "CWE-287",
  "severity": "Low",
  "impact": "low",
  "affected": {
    "family": "unix",
    "platforms": [
      "Red Hat Enterprise Linux 6"
    ],
    "cpes": [
      {
        "cpe": "cpe:/a:redhat:rhel_extras_sap:6",
        "repository": [
          "rhel-sap-for-rhel-6-for-system-z-source-rpms",
          "rhel-sap-for-rhel-6-server-eus-source-rpms",
          "rhel-sap-for-rhel-6-server-rpms",
          "rhel-sap-for-rhel-6-for-power-debug-rpms",
          "rhel-sap-for-rhel-6-for-power-rpms",
          "rhel-sap-for-rhel-6-server-debug-rpms",
          "rhel-sap-for-rhel-6-server-eus-rpms",
          "rhel-sap-for-rhel-6-for-power-source-rpms",
          "rhel-sap-for-rhel-6-for-system-z-rpms",
          "rhel-sap-for-rhel-6-for-system-z-debug-rpms",
          "rhel-sap-for-rhel-6-server-source-rpms",
          "rhel-sap-for-rhel-6-server-eus-debug-rpms"
        ]
      },
      {
        "cpe": "cpe:/o:redhat:rhel_eus:6.4"
      },
      {
        "cpe": "cpe:/o:redhat:rhel_eus:6.4::computenode"
      },
      {
        "cpe": "cpe:/o:redhat:rhel_eus:6.4::server",
        "repository": [
          "rhel-6-server-eus-optional-rpms__6_DOT_4__i386",
          "rhel-6-server-eus-rpms",
          "rhel-6-server-aus-optional-source-rpms",
          "rhel-6-server-aus-rpms",
          "rhel-6-server-eus-rpms__6_DOT_4__x86_64",
          "rhel-6-for-system-z-eus-rpms__6_DOT_4__s390x",
          "rhel-6-for-power-eus-optional-rpms",
          "rhel-6-server-aus-optional-debug-rpms",
          "rhel-6-for-system-z-eus-optional-rpms",
          "rhel-6-server-eus-rpms__6_DOT_4__i386",
          "rhel-6-server-aus-debug-rpms",
          "rhel-rs-for-rhel-6-server-eus-rpms__6_DOT_4__i386",
          "rhel-6-server-eus-optional-rpms__6_DOT_4__x86_64",
          "rhel-6-for-system-z-eus-rpms",
          "rhel-6-server-aus-optional-rpms",
          "rhel-6-for-power-eus-optional-rpms__6_DOT_4__ppc64",
          "rhel-lb-for-rhel-6-server-eus-rpms__6_DOT_4__i386",
          "rhel-sfs-for-rhel-6-server-eus-rpms",
          "rhel-6-server-aus-source-rpms",
          "rhel-lb-for-rhel-6-server-eus-rpms",
          "rhel-6-server-eus-optional-rpms",
          "rhel-rs-for-rhel-6-server-eus-rpms__6_DOT_4__x86_64",
          "rhel-sfs-for-rhel-6-server-eus-rpms__6_DOT_4__x86_64",
          "rhel-ha-for-rhel-6-server-eus-rpms",
          "rhel-lb-for-rhel-6-server-eus-rpms__6_DOT_4__x86_64",
          "rhel-6-for-system-z-eus-optional-rpms__6_DOT_4__s390x",
          "rhel-rs-for-rhel-6-server-eus-rpms",
          "rhel-ha-for-rhel-6-server-eus-rpms__6_DOT_4__x86_64",
          "rhel-ha-for-rhel-6-server-eus-rpms__6_DOT_4__i386",
          "rhel-6-for-power-eus-rpms__6_DOT_4__ppc64",
          "rhel-6-for-power-eus-rpms"
        ]
      }
    ]
  },
  "packages": [
    {
      "name": "httpd-devel",
      "status": "Fixed",
      "fixed_version": "0:2.2.15-45.el6",
      "arch": "ppc64"
    },
    {
      "name": "mod_ssl",
      "status": "Fixed",
      "fixed_version": "1:2.2.15-45.el6",
      "arch": "x86_64"
    },
    {
      "name": "httpd-devel",
      "status": "Fixed",
      "fixed_version": "0:2.2.15-45.el6",
      "arch": "s390x"
    },
    {
      "name": "httpd-tools",
      "status": "Fixed",
      "fixed_version": "0:2.2.15-45.el6",
      "arch": "s390x"
    },
    {
      "name": "mod_ssl",
      "status": "Fixed",
      "fixed_version": "1:2.2.15-45.el6",
      "arch": "s390x"
    },
    {
      "name": "httpd",
      "status": "Fixed",
      "fixed_version": "0:2.2.15-45.el6",
      "arch": "s390x"
    },
    {
      "name": "httpd",
      "status": "Fixed",
      "fixed_version": "0:2.2.15-45.el6",
      "arch": "i686"
    },
    {
      "name": "mod_ssl",
      "status": "Fixed",
      "fixed_version": "1:2.2.15-45.el6",
      "arch": "ppc64"
    },
    {
      "name": "httpd",
      "status": "Fixed",
      "fixed_version": "0:2.2.15-45.el6",
      "arch": "ppc64"
    },
    {
      "name": "httpd-devel",
      "status": "Fixed",
      "fixed_version": "0:2.2.15-45.el6",
      "arch": "i686"
    },
    {
      "name": "httpd-tools",
      "status": "Fixed",
      "fixed_version": "0:2.2.15-45.el6",
      "arch": "x86_64"
    },
    {
      "name": "httpd-tools",
      "status": "Fixed",
      "fixed_version": "0:2.2.15-45.el6",
      "arch": "i686"
    },
    {
      "name": "httpd-devel",
      "status": "Fixed",
      "fixed_version": "0:2.2.15-45.el6",
      "arch": "x86_64"
    },
    {
      "name": "mod_ssl",
      "status": "Fixed",
      "fixed_version": "1:2.2.15-45.el6",
      "arch": "i686"
    },
    {
      "name": "httpd-devel",
      "status": "Fixed",
      "fixed_version": "0:2.2.15-45.el6",
      "arch": "ppc"
    },
    {
      "name": "httpd",
      "status": "Fixed",
      "fixed_version": "0:2.2.15-45.el6",
      "arch": "x86_64"
    },
    {
      "name": "httpd-devel",
      "status": "Fixed",
      "fixed_version": "0:2.2.15-45.el6",
      "arch": "s390"
    },
    {
      "name": "httpd-manual",
      "status": "Fixed",
      "fixed_version": "0:2.2.15-45.el6"
    },
    {
      "name": "httpd-tools",
      "status": "Fixed",
      "fixed_version": "0:2.2.15-45.el6",
      "arch": "ppc64"
    }
  ],
  "references": [
    {
      "id": "RHSA-2015:1249",
      "source": "RHSA",
      "url": "https://access.redhat.com/errata/RHSA-2015:1249"
    },
    {
      "id": "CVE-2013-5704",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2013-5704"
    },
    {
      "id": "CVE-2013-5704 httpd: bypass of mod_headers rules via chunked requests",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/1082903"
    }
  ],
  "public": "2013-10-19T00:00:00Z",
  "issued": "2015-07-20T00:00:00Z",
  "updated": "2015-07-22T00:00:00Z"
}
