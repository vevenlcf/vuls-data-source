{
  "id": "CVE-2010-4170",
  "rhsa_id": "RHSA-2010:0894",
  "definition_id": "oval:com.redhat.rhsa:def:20100894",
  "title": "RHSA-2010:0894: systemtap security update (Important)",
  "description": "SystemTap is an instrumentation system for systems running the Linux\nkernel, version 2.6. Developers can write scripts to collect data on the\noperation of the system. staprun, the SystemTap runtime tool, is used for\nmanaging SystemTap kernel modules (for example, loading them).\n\nIt was discovered that staprun did not properly sanitize the environment\nbefore executing the modprobe command to load an additional kernel module.\nA local, unprivileged user could use this flaw to escalate their\nprivileges. (CVE-2010-4170)\n\nIt was discovered that staprun did not check if the module to be unloaded\nwas previously loaded by SystemTap. A local, unprivileged user could use\nthis flaw to unload an arbitrary kernel module that was not in use.\n(CVE-2010-4171)\n\nNote: After installing this update, users already in the stapdev group must\nbe added to the stapusr group in order to be able to run the staprun tool.\n\nRed Hat would like to thank Tavis Ormandy for reporting these issues.\n\nSystemTap users should upgrade to these updated packages, which contain\nbackported patches to correct these issues.",
  "cvss2": "7.2/AV:L/AC:L/Au:N/C:C/I:C/A:C",
  "cwe": "CWE-284",
  "severity": "Important",
  "impact": "important",
  "affected": {
    "family": "unix",
    "platforms": [
      "Red Hat Enterprise Linux 6"
    ],
    "cpes": [
      {
        "cpe": "cpe:/a:redhat:rhel_extras_sap:6",
        "repository": [
          "rhel-sap-for-rhel-6-server-rpms",
          "rhel-sap-for-rhel-6-server-source-rpms",
          "rhel-sap-for-rhel-6-for-power-source-rpms",
          "rhel-sap-for-rhel-6-for-system-z-debug-rpms",
          "rhel-sap-for-rhel-6-server-eus-rpms",
          "rhel-sap-for-rhel-6-server-eus-source-rpms",
          "rhel-sap-for-rhel-6-for-power-debug-rpms",
          "rhel-sap-for-rhel-6-server-eus-debug-rpms",
          "rhel-sap-for-rhel-6-server-debug-rpms",
          "rhel-sap-for-rhel-6-for-system-z-rpms",
          "rhel-sap-for-rhel-6-for-system-z-source-rpms",
          "rhel-sap-for-rhel-6-for-power-rpms"
        ]
      },
      {
        "cpe": "cpe:/o:redhat:rhel_eus:6.4"
      },
      {
        "cpe": "cpe:/o:redhat:rhel_eus:6.4::computenode"
      },
      {
        "cpe": "cpe:/o:redhat:rhel_eus:6.4::server",
        "repository": [
          "rhel-6-server-aus-source-rpms",
          "rhel-6-server-eus-optional-rpms__6_DOT_4__i386",
          "rhel-rs-for-rhel-6-server-eus-rpms",
          "rhel-ha-for-rhel-6-server-eus-rpms__6_DOT_4__x86_64",
          "rhel-6-for-power-eus-optional-rpms__6_DOT_4__ppc64",
          "rhel-lb-for-rhel-6-server-eus-rpms__6_DOT_4__i386",
          "rhel-6-server-eus-optional-rpms",
          "rhel-6-server-eus-rpms",
          "rhel-sfs-for-rhel-6-server-eus-rpms__6_DOT_4__x86_64",
          "rhel-lb-for-rhel-6-server-eus-rpms",
          "rhel-6-for-system-z-eus-rpms",
          "rhel-6-for-system-z-eus-optional-rpms",
          "rhel-6-server-eus-optional-rpms__6_DOT_4__x86_64",
          "rhel-sfs-for-rhel-6-server-eus-rpms",
          "rhel-6-for-power-eus-rpms",
          "rhel-6-server-aus-optional-debug-rpms",
          "rhel-6-server-aus-rpms",
          "rhel-6-server-aus-optional-rpms",
          "rhel-ha-for-rhel-6-server-eus-rpms",
          "rhel-ha-for-rhel-6-server-eus-rpms__6_DOT_4__i386",
          "rhel-rs-for-rhel-6-server-eus-rpms__6_DOT_4__i386",
          "rhel-6-server-eus-rpms__6_DOT_4__i386",
          "rhel-rs-for-rhel-6-server-eus-rpms__6_DOT_4__x86_64",
          "rhel-6-for-system-z-eus-rpms__6_DOT_4__s390x",
          "rhel-6-server-eus-rpms__6_DOT_4__x86_64",
          "rhel-6-for-system-z-eus-optional-rpms__6_DOT_4__s390x",
          "rhel-lb-for-rhel-6-server-eus-rpms__6_DOT_4__x86_64",
          "rhel-6-for-power-eus-optional-rpms",
          "rhel-6-server-aus-debug-rpms",
          "rhel-6-for-power-eus-rpms__6_DOT_4__ppc64",
          "rhel-6-server-aus-optional-source-rpms"
        ]
      }
    ]
  },
  "packages": [
    {
      "name": "systemtap-testsuite",
      "status": "Fixed",
      "fixed_version": "0:1.2-11.el6_0",
      "arch": "ppc64"
    },
    {
      "name": "systemtap",
      "status": "Fixed",
      "fixed_version": "0:1.2-11.el6_0",
      "arch": "i686"
    },
    {
      "name": "systemtap-initscript",
      "status": "Fixed",
      "fixed_version": "0:1.2-11.el6_0",
      "arch": "i686"
    },
    {
      "name": "systemtap-server",
      "status": "Fixed",
      "fixed_version": "0:1.2-11.el6_0",
      "arch": "s390x"
    },
    {
      "name": "systemtap-client",
      "status": "Fixed",
      "fixed_version": "0:1.2-11.el6_0",
      "arch": "ppc64"
    },
    {
      "name": "systemtap-grapher",
      "status": "Fixed",
      "fixed_version": "0:1.2-11.el6_0",
      "arch": "ppc64"
    },
    {
      "name": "systemtap-server",
      "status": "Fixed",
      "fixed_version": "0:1.2-11.el6_0",
      "arch": "x86_64"
    },
    {
      "name": "systemtap-sdt-devel",
      "status": "Fixed",
      "fixed_version": "0:1.2-11.el6_0",
      "arch": "i686"
    },
    {
      "name": "systemtap-client",
      "status": "Fixed",
      "fixed_version": "0:1.2-11.el6_0",
      "arch": "x86_64"
    },
    {
      "name": "systemtap",
      "status": "Fixed",
      "fixed_version": "0:1.2-11.el6_0",
      "arch": "x86_64"
    },
    {
      "name": "systemtap-sdt-devel",
      "status": "Fixed",
      "fixed_version": "0:1.2-11.el6_0",
      "arch": "s390"
    },
    {
      "name": "systemtap-testsuite",
      "status": "Fixed",
      "fixed_version": "0:1.2-11.el6_0",
      "arch": "x86_64"
    },
    {
      "name": "systemtap-runtime",
      "status": "Fixed",
      "fixed_version": "0:1.2-11.el6_0",
      "arch": "x86_64"
    },
    {
      "name": "systemtap-sdt-devel",
      "status": "Fixed",
      "fixed_version": "0:1.2-11.el6_0",
      "arch": "x86_64"
    },
    {
      "name": "systemtap-testsuite",
      "status": "Fixed",
      "fixed_version": "0:1.2-11.el6_0",
      "arch": "i686"
    },
    {
      "name": "systemtap-runtime",
      "status": "Fixed",
      "fixed_version": "0:1.2-11.el6_0",
      "arch": "i686"
    },
    {
      "name": "systemtap-initscript",
      "status": "Fixed",
      "fixed_version": "0:1.2-11.el6_0",
      "arch": "x86_64"
    },
    {
      "name": "systemtap-initscript",
      "status": "Fixed",
      "fixed_version": "0:1.2-11.el6_0",
      "arch": "s390x"
    },
    {
      "name": "systemtap-testsuite",
      "status": "Fixed",
      "fixed_version": "0:1.2-11.el6_0",
      "arch": "s390x"
    },
    {
      "name": "systemtap-server",
      "status": "Fixed",
      "fixed_version": "0:1.2-11.el6_0",
      "arch": "i686"
    },
    {
      "name": "systemtap-sdt-devel",
      "status": "Fixed",
      "fixed_version": "0:1.2-11.el6_0",
      "arch": "ppc64"
    },
    {
      "name": "systemtap-sdt-devel",
      "status": "Fixed",
      "fixed_version": "0:1.2-11.el6_0",
      "arch": "ppc"
    },
    {
      "name": "systemtap-grapher",
      "status": "Fixed",
      "fixed_version": "0:1.2-11.el6_0",
      "arch": "x86_64"
    },
    {
      "name": "systemtap-grapher",
      "status": "Fixed",
      "fixed_version": "0:1.2-11.el6_0",
      "arch": "s390x"
    },
    {
      "name": "systemtap-runtime",
      "status": "Fixed",
      "fixed_version": "0:1.2-11.el6_0",
      "arch": "s390x"
    },
    {
      "name": "systemtap",
      "status": "Fixed",
      "fixed_version": "0:1.2-11.el6_0",
      "arch": "ppc64"
    },
    {
      "name": "systemtap-server",
      "status": "Fixed",
      "fixed_version": "0:1.2-11.el6_0",
      "arch": "ppc64"
    },
    {
      "name": "systemtap",
      "status": "Fixed",
      "fixed_version": "0:1.2-11.el6_0",
      "arch": "s390x"
    },
    {
      "name": "systemtap-grapher",
      "status": "Fixed",
      "fixed_version": "0:1.2-11.el6_0",
      "arch": "i686"
    },
    {
      "name": "systemtap-client",
      "status": "Fixed",
      "fixed_version": "0:1.2-11.el6_0",
      "arch": "i686"
    },
    {
      "name": "systemtap-runtime",
      "status": "Fixed",
      "fixed_version": "0:1.2-11.el6_0",
      "arch": "ppc64"
    },
    {
      "name": "systemtap-sdt-devel",
      "status": "Fixed",
      "fixed_version": "0:1.2-11.el6_0",
      "arch": "s390x"
    },
    {
      "name": "systemtap-client",
      "status": "Fixed",
      "fixed_version": "0:1.2-11.el6_0",
      "arch": "s390x"
    },
    {
      "name": "systemtap-initscript",
      "status": "Fixed",
      "fixed_version": "0:1.2-11.el6_0",
      "arch": "ppc64"
    }
  ],
  "references": [
    {
      "id": "RHSA-2010:0894",
      "source": "RHSA",
      "url": "https://access.redhat.com/errata/RHSA-2010:0894"
    },
    {
      "id": "CVE-2010-4170",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2010-4170"
    },
    {
      "id": "CVE-2010-4171",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2010-4171"
    },
    {
      "id": "CVE-2010-4170 Systemtap: Insecure loading of modules",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/653604"
    },
    {
      "id": "CVE-2010-4171 Systemtap: Ability to remove unused modules by unprivileged user",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/653606"
    }
  ],
  "public": "2010-11-17T00:00:00Z",
  "issued": "2010-11-17T00:00:00Z",
  "updated": "2010-11-17T00:00:00Z"
}
