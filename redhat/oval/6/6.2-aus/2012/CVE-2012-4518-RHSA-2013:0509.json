{
  "id": "CVE-2012-4518",
  "rhsa_id": "RHSA-2013:0509",
  "definition_id": "oval:com.redhat.rhsa:def:20130509",
  "title": "RHSA-2013:0509: rdma security, bug fix and enhancement update (Low)",
  "description": "Red Hat Enterprise Linux includes a collection of InfiniBand and iWARP\nutilities, libraries and development packages for writing applications\nthat use Remote Direct Memory Access (RDMA) technology.\n\nA denial of service flaw was found in the way ibacm managed reference\ncounts for multicast connections. An attacker could send specially-crafted\nmulticast packets that would cause the ibacm daemon to crash.\n(CVE-2012-4517)\n\nIt was found that the ibacm daemon created some files with world-writable\npermissions. A local attacker could use this flaw to overwrite the\ncontents of the ibacm.log or ibacm.port file, allowing them to mask\ncertain actions from the log or cause ibacm to run on a non-default port.\n(CVE-2012-4518)\n\nCVE-2012-4518 was discovered by Florian Weimer of the Red Hat Product\nSecurity Team and Kurt Seifried of the Red Hat Security Response Team.\n\nThe InfiniBand/iWARP/RDMA stack components have been upgraded to more\nrecent upstream versions.\n\nThis update also fixes the following bugs:\n\n* Previously, the \"ibnodes -h\" command did not show a proper usage message.\nWith this update the problem is fixed and \"ibnodes -h\" now shows the\ncorrect usage message. (BZ#818606)\n\n* Previously, the ibv_devinfo utility erroneously showed iWARP cxgb3\nhardware's physical state as invalid even when the device was working. For\niWARP hardware, the phys_state field has no meaning. This update patches\nthe utility to not print out anything for this field when the hardware is\niWARP hardware. (BZ#822781)\n\n* Prior to the release of Red Hat Enterprise Linux 6.3, the kernel created\nthe InfiniBand device files in the wrong place and a udev rules file was\nused to force the devices to be created in the proper place. With the\nupdate to 6.3, the kernel was fixed to create the InfiniBand device files\nin the proper place, and so the udev rules file was removed as no longer\nbeing necessary. However, a bug in the kernel device creation meant that,\nalthough the devices were now being created in the right place, they had\nincorrect permissions. Consequently, when users attempted to run an RDMA\napplication as a non-root user, the application failed to get the necessary\npermissions to use the RDMA device and the application terminated. This\nupdate puts a new udev rules file in place. It no longer attempts to create\nthe InfiniBand devices since they already exist, but it does correct the\ndevice permissions on the files. (BZ#834428)\n\n* Previously, using the \"perfquery -C\" command with a host name caused the\nperfquery utility to become unresponsive. The list of controllers to\nprocess was never cleared and the process looped infinitely on a single\ncontroller. A patch has been applied to make sure that in the case where\nthe user passes in the -C option, the controller list is cleared out once\nthat controller has been processed. As a result, perfquery now works as\nexpected in the scenario described. (BZ#847129)\n\n* The OpenSM init script did not handle the case where there were no\nconfiguration files under \"/etc/rdma/opensm.conf.*\". With this update, the\nscript as been patched and the InfiniBand Subnet Manager, OpenSM, now\nstarts as expected in the scenario described. (BZ#862857)\n\nThis update also adds the following enhancement:\n\n* This update provides an updated mlx4_ib Mellanox driver which includes\nSingle Root I/O Virtualization (SR-IOV) support. (BZ#869737)\n\nAll users of RDMA are advised to upgrade to these updated packages, which\nfix these issues and add this enhancement.",
  "cvss2": "2.1/AV:L/AC:L/Au:N/C:N/I:N/A:P",
  "severity": "Low",
  "impact": "low",
  "affected": {
    "family": "unix",
    "platforms": [
      "Red Hat Enterprise Linux 6"
    ],
    "cpes": [
      {
        "cpe": "cpe:/o:redhat:rhel_mission_critical:6.2"
      },
      {
        "cpe": "cpe:/o:redhat:rhel_mission_critical:6.2::server",
        "repository": [
          "rhel-6-server-aus-source-rpms",
          "rhel-6-server-aus-optional-debug-rpms",
          "rhel-6-server-aus-rpms",
          "rhel-6-server-aus-optional-rpms",
          "rhel-6-server-aus-debug-rpms",
          "rhel-6-server-aus-optional-source-rpms"
        ]
      }
    ]
  },
  "packages": [
    {
      "name": "ibutils-devel",
      "status": "Fixed",
      "fixed_version": "0:1.5.7-7.el6",
      "arch": "ppc64"
    },
    {
      "name": "ibacm",
      "status": "Fixed",
      "fixed_version": "0:1.0.8-0.git7a3adb7.el6",
      "arch": "ppc64"
    },
    {
      "name": "libibverbs-devel",
      "status": "Fixed",
      "fixed_version": "0:1.1.6-5.el6",
      "arch": "x86_64"
    },
    {
      "name": "libibverbs-devel-static",
      "status": "Fixed",
      "fixed_version": "0:1.1.6-5.el6",
      "arch": "x86_64"
    },
    {
      "name": "librdmacm",
      "status": "Fixed",
      "fixed_version": "0:1.0.17-0.git4b5c1aa.el6",
      "arch": "i686"
    },
    {
      "name": "infinipath-psm-devel",
      "status": "Fixed",
      "fixed_version": "0:3.0.1-115.1015_open.1.el6",
      "arch": "x86_64"
    },
    {
      "name": "librdmacm-utils",
      "status": "Fixed",
      "fixed_version": "0:1.0.17-0.git4b5c1aa.el6",
      "arch": "ppc64"
    },
    {
      "name": "rdma",
      "status": "Fixed",
      "fixed_version": "0:3.6-1.el6"
    },
    {
      "name": "ibacm-devel",
      "status": "Fixed",
      "fixed_version": "0:1.0.8-0.git7a3adb7.el6",
      "arch": "ppc64"
    },
    {
      "name": "libibmad-devel",
      "status": "Fixed",
      "fixed_version": "0:1.3.9-1.el6",
      "arch": "x86_64"
    },
    {
      "name": "libmlx4",
      "status": "Fixed",
      "fixed_version": "0:1.0.4-1.el6",
      "arch": "ppc64"
    },
    {
      "name": "librdmacm-utils",
      "status": "Fixed",
      "fixed_version": "0:1.0.17-0.git4b5c1aa.el6",
      "arch": "x86_64"
    },
    {
      "name": "libibumad-static",
      "status": "Fixed",
      "fixed_version": "0:1.3.8-1.el6",
      "arch": "ppc64"
    },
    {
      "name": "librdmacm",
      "status": "Fixed",
      "fixed_version": "0:1.0.17-0.git4b5c1aa.el6",
      "arch": "x86_64"
    },
    {
      "name": "infiniband-diags-devel",
      "status": "Fixed",
      "fixed_version": "0:1.5.12-5.el6",
      "arch": "i686"
    },
    {
      "name": "ibutils-libs",
      "status": "Fixed",
      "fixed_version": "0:1.5.7-7.el6",
      "arch": "ppc64"
    },
    {
      "name": "libibumad",
      "status": "Fixed",
      "fixed_version": "0:1.3.8-1.el6",
      "arch": "ppc64"
    },
    {
      "name": "libmlx4",
      "status": "Fixed",
      "fixed_version": "0:1.0.4-1.el6",
      "arch": "ppc"
    },
    {
      "name": "opensm",
      "status": "Fixed",
      "fixed_version": "0:3.3.15-1.el6",
      "arch": "x86_64"
    },
    {
      "name": "infiniband-diags",
      "status": "Fixed",
      "fixed_version": "0:1.5.12-5.el6",
      "arch": "ppc"
    },
    {
      "name": "librdmacm-devel",
      "status": "Fixed",
      "fixed_version": "0:1.0.17-0.git4b5c1aa.el6",
      "arch": "x86_64"
    },
    {
      "name": "libibverbs-utils",
      "status": "Fixed",
      "fixed_version": "0:1.1.6-5.el6",
      "arch": "x86_64"
    },
    {
      "name": "ibsim",
      "status": "Fixed",
      "fixed_version": "0:0.5-7.el6",
      "arch": "x86_64"
    },
    {
      "name": "librdmacm",
      "status": "Fixed",
      "fixed_version": "0:1.0.17-0.git4b5c1aa.el6",
      "arch": "ppc"
    },
    {
      "name": "libibmad-devel",
      "status": "Fixed",
      "fixed_version": "0:1.3.9-1.el6",
      "arch": "ppc"
    },
    {
      "name": "librdmacm-devel",
      "status": "Fixed",
      "fixed_version": "0:1.0.17-0.git4b5c1aa.el6",
      "arch": "i686"
    },
    {
      "name": "libibverbs-devel-static",
      "status": "Fixed",
      "fixed_version": "0:1.1.6-5.el6",
      "arch": "i686"
    },
    {
      "name": "libibmad-devel",
      "status": "Fixed",
      "fixed_version": "0:1.3.9-1.el6",
      "arch": "ppc64"
    },
    {
      "name": "librdmacm-devel",
      "status": "Fixed",
      "fixed_version": "0:1.0.17-0.git4b5c1aa.el6",
      "arch": "ppc"
    },
    {
      "name": "libibumad",
      "status": "Fixed",
      "fixed_version": "0:1.3.8-1.el6",
      "arch": "ppc"
    },
    {
      "name": "libibverbs-devel-static",
      "status": "Fixed",
      "fixed_version": "0:1.1.6-5.el6",
      "arch": "ppc64"
    },
    {
      "name": "ibsim",
      "status": "Fixed",
      "fixed_version": "0:0.5-7.el6",
      "arch": "ppc64"
    },
    {
      "name": "opensm",
      "status": "Fixed",
      "fixed_version": "0:3.3.15-1.el6",
      "arch": "ppc64"
    },
    {
      "name": "libibverbs-devel",
      "status": "Fixed",
      "fixed_version": "0:1.1.6-5.el6",
      "arch": "ppc64"
    },
    {
      "name": "opensm-libs",
      "status": "Fixed",
      "fixed_version": "0:3.3.15-1.el6",
      "arch": "ppc"
    },
    {
      "name": "ibutils-libs",
      "status": "Fixed",
      "fixed_version": "0:1.5.7-7.el6",
      "arch": "x86_64"
    },
    {
      "name": "libibmad",
      "status": "Fixed",
      "fixed_version": "0:1.3.9-1.el6",
      "arch": "ppc64"
    },
    {
      "name": "opensm-static",
      "status": "Fixed",
      "fixed_version": "0:3.3.15-1.el6",
      "arch": "i686"
    },
    {
      "name": "librdmacm-utils",
      "status": "Fixed",
      "fixed_version": "0:1.0.17-0.git4b5c1aa.el6",
      "arch": "i686"
    },
    {
      "name": "libibmad",
      "status": "Fixed",
      "fixed_version": "0:1.3.9-1.el6",
      "arch": "i686"
    },
    {
      "name": "libmlx4",
      "status": "Fixed",
      "fixed_version": "0:1.0.4-1.el6",
      "arch": "i686"
    },
    {
      "name": "libibverbs-devel",
      "status": "Fixed",
      "fixed_version": "0:1.1.6-5.el6",
      "arch": "i686"
    },
    {
      "name": "infiniband-diags",
      "status": "Fixed",
      "fixed_version": "0:1.5.12-5.el6",
      "arch": "ppc64"
    },
    {
      "name": "librdmacm-devel",
      "status": "Fixed",
      "fixed_version": "0:1.0.17-0.git4b5c1aa.el6",
      "arch": "ppc64"
    },
    {
      "name": "infiniband-diags-devel-static",
      "status": "Fixed",
      "fixed_version": "0:1.5.12-5.el6",
      "arch": "i686"
    },
    {
      "name": "libmlx4-static",
      "status": "Fixed",
      "fixed_version": "0:1.0.4-1.el6",
      "arch": "ppc64"
    },
    {
      "name": "infinipath-psm",
      "status": "Fixed",
      "fixed_version": "0:3.0.1-115.1015_open.1.el6",
      "arch": "x86_64"
    },
    {
      "name": "ibutils-libs",
      "status": "Fixed",
      "fixed_version": "0:1.5.7-7.el6",
      "arch": "i686"
    },
    {
      "name": "libibverbs",
      "status": "Fixed",
      "fixed_version": "0:1.1.6-5.el6",
      "arch": "x86_64"
    },
    {
      "name": "libibverbs",
      "status": "Fixed",
      "fixed_version": "0:1.1.6-5.el6",
      "arch": "ppc"
    },
    {
      "name": "opensm-libs",
      "status": "Fixed",
      "fixed_version": "0:3.3.15-1.el6",
      "arch": "i686"
    },
    {
      "name": "libibmad",
      "status": "Fixed",
      "fixed_version": "0:1.3.9-1.el6",
      "arch": "x86_64"
    },
    {
      "name": "libibmad-static",
      "status": "Fixed",
      "fixed_version": "0:1.3.9-1.el6",
      "arch": "i686"
    },
    {
      "name": "librdmacm-static",
      "status": "Fixed",
      "fixed_version": "0:1.0.17-0.git4b5c1aa.el6",
      "arch": "ppc64"
    },
    {
      "name": "ibutils-devel",
      "status": "Fixed",
      "fixed_version": "0:1.5.7-7.el6",
      "arch": "ppc"
    },
    {
      "name": "infiniband-diags-devel",
      "status": "Fixed",
      "fixed_version": "0:1.5.12-5.el6",
      "arch": "x86_64"
    },
    {
      "name": "librdmacm",
      "status": "Fixed",
      "fixed_version": "0:1.0.17-0.git4b5c1aa.el6",
      "arch": "ppc64"
    },
    {
      "name": "ibutils-devel",
      "status": "Fixed",
      "fixed_version": "0:1.5.7-7.el6",
      "arch": "x86_64"
    },
    {
      "name": "librdmacm-static",
      "status": "Fixed",
      "fixed_version": "0:1.0.17-0.git4b5c1aa.el6",
      "arch": "i686"
    },
    {
      "name": "libmlx4-static",
      "status": "Fixed",
      "fixed_version": "0:1.0.4-1.el6",
      "arch": "x86_64"
    },
    {
      "name": "ibutils-libs",
      "status": "Fixed",
      "fixed_version": "0:1.5.7-7.el6",
      "arch": "ppc"
    },
    {
      "name": "libibmad",
      "status": "Fixed",
      "fixed_version": "0:1.3.9-1.el6",
      "arch": "ppc"
    },
    {
      "name": "libibumad-devel",
      "status": "Fixed",
      "fixed_version": "0:1.3.8-1.el6",
      "arch": "ppc"
    },
    {
      "name": "opensm-devel",
      "status": "Fixed",
      "fixed_version": "0:3.3.15-1.el6",
      "arch": "i686"
    },
    {
      "name": "libmlx4",
      "status": "Fixed",
      "fixed_version": "0:1.0.4-1.el6",
      "arch": "x86_64"
    },
    {
      "name": "libibumad-static",
      "status": "Fixed",
      "fixed_version": "0:1.3.8-1.el6",
      "arch": "x86_64"
    },
    {
      "name": "ibacm",
      "status": "Fixed",
      "fixed_version": "0:1.0.8-0.git7a3adb7.el6",
      "arch": "i686"
    },
    {
      "name": "opensm-libs",
      "status": "Fixed",
      "fixed_version": "0:3.3.15-1.el6",
      "arch": "x86_64"
    },
    {
      "name": "opensm-libs",
      "status": "Fixed",
      "fixed_version": "0:3.3.15-1.el6",
      "arch": "ppc64"
    },
    {
      "name": "opensm-devel",
      "status": "Fixed",
      "fixed_version": "0:3.3.15-1.el6",
      "arch": "ppc64"
    },
    {
      "name": "libibverbs",
      "status": "Fixed",
      "fixed_version": "0:1.1.6-5.el6",
      "arch": "i686"
    },
    {
      "name": "ibutils",
      "status": "Fixed",
      "fixed_version": "0:1.5.7-7.el6",
      "arch": "x86_64"
    },
    {
      "name": "infiniband-diags",
      "status": "Fixed",
      "fixed_version": "0:1.5.12-5.el6",
      "arch": "x86_64"
    },
    {
      "name": "libibumad",
      "status": "Fixed",
      "fixed_version": "0:1.3.8-1.el6",
      "arch": "x86_64"
    },
    {
      "name": "ibacm-devel",
      "status": "Fixed",
      "fixed_version": "0:1.0.8-0.git7a3adb7.el6",
      "arch": "i686"
    },
    {
      "name": "ibacm-devel",
      "status": "Fixed",
      "fixed_version": "0:1.0.8-0.git7a3adb7.el6",
      "arch": "ppc"
    },
    {
      "name": "libibumad",
      "status": "Fixed",
      "fixed_version": "0:1.3.8-1.el6",
      "arch": "i686"
    },
    {
      "name": "ibutils",
      "status": "Fixed",
      "fixed_version": "0:1.5.7-7.el6",
      "arch": "ppc64"
    },
    {
      "name": "libibverbs-devel",
      "status": "Fixed",
      "fixed_version": "0:1.1.6-5.el6",
      "arch": "ppc"
    },
    {
      "name": "infiniband-diags",
      "status": "Fixed",
      "fixed_version": "0:1.5.12-5.el6",
      "arch": "i686"
    },
    {
      "name": "libibverbs-utils",
      "status": "Fixed",
      "fixed_version": "0:1.1.6-5.el6",
      "arch": "ppc64"
    },
    {
      "name": "libibumad-devel",
      "status": "Fixed",
      "fixed_version": "0:1.3.8-1.el6",
      "arch": "i686"
    },
    {
      "name": "libibmad-devel",
      "status": "Fixed",
      "fixed_version": "0:1.3.9-1.el6",
      "arch": "i686"
    },
    {
      "name": "infiniband-diags-devel",
      "status": "Fixed",
      "fixed_version": "0:1.5.12-5.el6",
      "arch": "ppc"
    },
    {
      "name": "infiniband-diags-devel-static",
      "status": "Fixed",
      "fixed_version": "0:1.5.12-5.el6",
      "arch": "x86_64"
    },
    {
      "name": "opensm-devel",
      "status": "Fixed",
      "fixed_version": "0:3.3.15-1.el6",
      "arch": "ppc"
    },
    {
      "name": "ibacm-devel",
      "status": "Fixed",
      "fixed_version": "0:1.0.8-0.git7a3adb7.el6",
      "arch": "x86_64"
    },
    {
      "name": "libibverbs",
      "status": "Fixed",
      "fixed_version": "0:1.1.6-5.el6",
      "arch": "ppc64"
    },
    {
      "name": "libibverbs-utils",
      "status": "Fixed",
      "fixed_version": "0:1.1.6-5.el6",
      "arch": "i686"
    },
    {
      "name": "libibumad-static",
      "status": "Fixed",
      "fixed_version": "0:1.3.8-1.el6",
      "arch": "i686"
    },
    {
      "name": "opensm-static",
      "status": "Fixed",
      "fixed_version": "0:3.3.15-1.el6",
      "arch": "ppc64"
    },
    {
      "name": "opensm-static",
      "status": "Fixed",
      "fixed_version": "0:3.3.15-1.el6",
      "arch": "x86_64"
    },
    {
      "name": "libibmad-static",
      "status": "Fixed",
      "fixed_version": "0:1.3.9-1.el6",
      "arch": "x86_64"
    },
    {
      "name": "libibumad-devel",
      "status": "Fixed",
      "fixed_version": "0:1.3.8-1.el6",
      "arch": "ppc64"
    },
    {
      "name": "infiniband-diags-devel-static",
      "status": "Fixed",
      "fixed_version": "0:1.5.12-5.el6",
      "arch": "ppc64"
    },
    {
      "name": "infiniband-diags-devel",
      "status": "Fixed",
      "fixed_version": "0:1.5.12-5.el6",
      "arch": "ppc64"
    },
    {
      "name": "ibutils-devel",
      "status": "Fixed",
      "fixed_version": "0:1.5.7-7.el6",
      "arch": "i686"
    },
    {
      "name": "ibutils",
      "status": "Fixed",
      "fixed_version": "0:1.5.7-7.el6",
      "arch": "i686"
    },
    {
      "name": "opensm-devel",
      "status": "Fixed",
      "fixed_version": "0:3.3.15-1.el6",
      "arch": "x86_64"
    },
    {
      "name": "libibumad-devel",
      "status": "Fixed",
      "fixed_version": "0:1.3.8-1.el6",
      "arch": "x86_64"
    },
    {
      "name": "libibmad-static",
      "status": "Fixed",
      "fixed_version": "0:1.3.9-1.el6",
      "arch": "ppc64"
    },
    {
      "name": "ibsim",
      "status": "Fixed",
      "fixed_version": "0:0.5-7.el6",
      "arch": "i686"
    },
    {
      "name": "libmlx4-static",
      "status": "Fixed",
      "fixed_version": "0:1.0.4-1.el6",
      "arch": "i686"
    },
    {
      "name": "ibacm",
      "status": "Fixed",
      "fixed_version": "0:1.0.8-0.git7a3adb7.el6",
      "arch": "x86_64"
    },
    {
      "name": "opensm",
      "status": "Fixed",
      "fixed_version": "0:3.3.15-1.el6",
      "arch": "i686"
    },
    {
      "name": "librdmacm-static",
      "status": "Fixed",
      "fixed_version": "0:1.0.17-0.git4b5c1aa.el6",
      "arch": "x86_64"
    }
  ],
  "references": [
    {
      "id": "RHSA-2013:0509",
      "source": "RHSA",
      "url": "https://access.redhat.com/errata/RHSA-2013:0509"
    },
    {
      "id": "CVE-2012-4517",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2012-4517"
    },
    {
      "id": "CVE-2012-4518",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2012-4518"
    },
    {
      "id": "CVE-2012-4517 ibacm: DoS (ibacm deamon crash) by joining responses for multicast destinations",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/865492"
    },
    {
      "id": "CVE-2012-4518 ibacm: ibacm service files created with world writable permissions (DoS)",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/865499"
    }
  ],
  "public": "2012-10-09T00:00:00Z",
  "issued": "2013-02-20T00:00:00Z",
  "updated": "2013-02-21T00:00:00Z"
}
