{
  "id": "CVE-2012-3412",
  "rhsa_id": "RHSA-2012:1401",
  "definition_id": "oval:com.redhat.rhsa:def:20121401",
  "title": "RHSA-2012:1401: kernel security and bug fix update (Important)",
  "description": "The kernel packages contain the Linux kernel, the core of any Linux\noperating system.\n\nThis update fixes the following security issue:\n\n* A flaw was found in the way socket buffers (skb) requiring TSO (TCP\nsegment offloading) were handled by the sfc driver. If the skb did not fit\nwithin the minimum-size of the transmission queue, the network card could\nrepeatedly reset itself. A remote attacker could use this flaw to cause a\ndenial of service. (CVE-2012-3412, Important)\n\nRed Hat would like to thank Ben Hutchings of Solarflare (tm) for reporting\nCVE-2012-3412.\n\nThis update also fixes the following bugs:\n\n* Previously, when a server attempted to shut down a socket, the\nsvc_tcp_sendto() function set the XPT_CLOSE variable if the entire reply\nfailed to be transmitted. However, before XPT_CLOSE could be acted upon,\nother threads could send further replies before the socket was really shut\ndown. Consequently, data corruption could occur in the RPC record marker.\nWith this update, send operations on a closed socket are stopped\nimmediately, thus preventing this bug. (BZ#853256)\n\n* When a PIT (Programmable Interval Timer) MSB (Most Significant Byte)\ntransition occurred very close to an SMI (System Management Interrupt)\nexecution, the pit_verify_msb() function did not see the MSB transition.\nConsequently, the pit_expect_msb() function returned success incorrectly,\neventually causing a large clock drift in the quick_pit_calibrate()\nfunction. As a result, the TSC (Time Stamp Counter) calibration on some\nsystems was off by Â± 20 MHz, which led to inaccurate timekeeping or ntp\nsynchronization failures. This update fixes pit_expect_msb() and the clock\ndrift no longer occurs in the described scenario. (BZ#853952)\n\n* Sometimes, the crypto allocation code could become unresponsive for 60\nseconds or multiples thereof due to an incorrect notification mechanism.\nThis could cause applications, like Openswan, to become unresponsive. The\nnotification mechanism has been improved to avoid such hangs. (BZ#854475)\n\n* Traffic to the NFS server could trigger a kernel oops in the\nsvc_tcp_clear_pages() function. The source code has been modified, and the\nkernel oops no longer occurs in this scenario. (BZ#856105)\n\n* Under certain circumstances, a system crash could result in data loss on\nXFS file systems. If files were created immediately before the file system\nwas left to idle for a long period of time and then the system crashed,\nthose files could appear as zero-length once the file system was remounted.\nThis occurred even if a sync or fsync was run on the files. This was\nbecause XFS was not correctly idling the journal, and therefore it\nincorrectly replayed the inode allocation transactions upon mounting after\nthe system crash, which zeroed the file size. This problem has been fixed\nby re-instating the periodic journal idling logic to ensure that all\nmetadata is flushed within 30 seconds of modification, and the journal is\nupdated to prevent incorrect recovery operations from occurring.\n(BZ#856685)\n\n* On architectures with the 64-bit cputime_t type, it was possible to\ntrigger the \"divide by zero\" error, namely, on long-lived processes. A\npatch has been applied to address this problem, and the \"divide by zero\"\nerror no longer occurs under these circumstances. (BZ#856702)\n\nUsers should upgrade to these updated packages, which contain backported\npatches to resolve these issues. The system must be rebooted for this\nupdate to take effect.",
  "cvss2": "7.1/AV:N/AC:M/Au:N/C:N/I:N/A:C",
  "cwe": "CWE-400",
  "severity": "Important",
  "impact": "important",
  "affected": {
    "family": "unix",
    "platforms": [
      "Red Hat Enterprise Linux 6.2 EUS - Server and Compute Node Only"
    ],
    "cpes": [
      {
        "cpe": "cpe:/o:redhat:rhel_eus:6.2"
      },
      {
        "cpe": "cpe:/o:redhat:rhel_eus:6.2::computenode"
      },
      {
        "cpe": "cpe:/o:redhat:rhel_eus:6.2::server",
        "repository": [
          "rhel-6-server-eus-optional-rpms__6_DOT_2__i386",
          "rhel-6-for-power-eus-optional-rpms__6_DOT_2__ppc64",
          "rhel-6-server-aus-rpms",
          "rhel-lb-for-rhel-6-server-eus-rpms",
          "rhel-6-for-system-z-eus-optional-rpms",
          "rhel-ha-for-rhel-6-server-eus-rpms__6_DOT_2__i386",
          "rhel-6-server-eus-optional-rpms__6_DOT_2__x86_64",
          "rhel-rs-for-rhel-6-server-eus-rpms__6_DOT_2__i386",
          "rhel-6-for-power-eus-rpms",
          "rhel-6-for-power-eus-optional-rpms",
          "rhel-6-for-system-z-eus-optional-rpms__6_DOT_2__s390x",
          "rhel-sfs-for-rhel-6-server-eus-rpms",
          "rhel-ha-for-rhel-6-server-eus-rpms",
          "rhel-6-server-aus-debug-rpms",
          "rhel-rs-for-rhel-6-server-eus-rpms",
          "rhel-rs-for-rhel-6-server-eus-rpms__6_DOT_2__x86_64",
          "rhel-6-server-eus-rpms__6_DOT_2__i386",
          "rhel-6-for-system-z-eus-rpms",
          "rhel-6-server-eus-optional-rpms",
          "rhel-6-server-aus-source-rpms",
          "rhel-6-for-system-z-eus-rpms__6_DOT_2__s390x",
          "rhel-6-for-power-eus-rpms__6_DOT_2__ppc64",
          "rhel-6-server-eus-rpms__6_DOT_2__x86_64",
          "rhel-6-server-eus-rpms",
          "rhel-6-server-aus-optional-debug-rpms",
          "rhel-6-server-aus-optional-rpms",
          "rhel-ha-for-rhel-6-server-eus-rpms__6_DOT_2__x86_64",
          "rhel-6-server-aus-optional-source-rpms",
          "rhel-lb-for-rhel-6-server-eus-rpms__6_DOT_2__x86_64",
          "rhel-sfs-for-rhel-6-server-eus-rpms__6_DOT_2__x86_64"
        ]
      }
    ]
  },
  "packages": [
    {
      "name": "kernel-debug",
      "status": "Fixed",
      "fixed_version": "0:2.6.32-220.28.1.el6",
      "arch": "s390x"
    },
    {
      "name": "kernel-devel",
      "status": "Fixed",
      "fixed_version": "0:2.6.32-220.28.1.el6",
      "arch": "ppc64"
    },
    {
      "name": "kernel-doc",
      "status": "Fixed",
      "fixed_version": "0:2.6.32-220.28.1.el6"
    },
    {
      "name": "kernel-debug",
      "status": "Fixed",
      "fixed_version": "0:2.6.32-220.28.1.el6",
      "arch": "i686"
    },
    {
      "name": "kernel",
      "status": "Fixed",
      "fixed_version": "0:2.6.32-220.28.1.el6",
      "arch": "ppc64"
    },
    {
      "name": "python-perf",
      "status": "Fixed",
      "fixed_version": "0:2.6.32-220.28.1.el6",
      "arch": "x86_64"
    },
    {
      "name": "kernel-debug-devel",
      "status": "Fixed",
      "fixed_version": "0:2.6.32-220.28.1.el6",
      "arch": "s390x"
    },
    {
      "name": "kernel-debug",
      "status": "Fixed",
      "fixed_version": "0:2.6.32-220.28.1.el6",
      "arch": "ppc64"
    },
    {
      "name": "kernel-headers",
      "status": "Fixed",
      "fixed_version": "0:2.6.32-220.28.1.el6",
      "arch": "ppc64"
    },
    {
      "name": "python-perf",
      "status": "Fixed",
      "fixed_version": "0:2.6.32-220.28.1.el6",
      "arch": "i686"
    },
    {
      "name": "python-perf",
      "status": "Fixed",
      "fixed_version": "0:2.6.32-220.28.1.el6",
      "arch": "s390x"
    },
    {
      "name": "kernel-devel",
      "status": "Fixed",
      "fixed_version": "0:2.6.32-220.28.1.el6",
      "arch": "x86_64"
    },
    {
      "name": "kernel",
      "status": "Fixed",
      "fixed_version": "0:2.6.32-220.28.1.el6",
      "arch": "i686"
    },
    {
      "name": "kernel-headers",
      "status": "Fixed",
      "fixed_version": "0:2.6.32-220.28.1.el6",
      "arch": "x86_64"
    },
    {
      "name": "kernel-devel",
      "status": "Fixed",
      "fixed_version": "0:2.6.32-220.28.1.el6",
      "arch": "i686"
    },
    {
      "name": "perf",
      "status": "Fixed",
      "fixed_version": "0:2.6.32-220.28.1.el6",
      "arch": "x86_64"
    },
    {
      "name": "perf",
      "status": "Fixed",
      "fixed_version": "0:2.6.32-220.28.1.el6",
      "arch": "ppc64"
    },
    {
      "name": "perf",
      "status": "Fixed",
      "fixed_version": "0:2.6.32-220.28.1.el6",
      "arch": "i686"
    },
    {
      "name": "kernel-devel",
      "status": "Fixed",
      "fixed_version": "0:2.6.32-220.28.1.el6",
      "arch": "s390x"
    },
    {
      "name": "kernel-bootwrapper",
      "status": "Fixed",
      "fixed_version": "0:2.6.32-220.28.1.el6",
      "arch": "ppc64"
    },
    {
      "name": "kernel-debug-devel",
      "status": "Fixed",
      "fixed_version": "0:2.6.32-220.28.1.el6",
      "arch": "x86_64"
    },
    {
      "name": "kernel-firmware",
      "status": "Fixed",
      "fixed_version": "0:2.6.32-220.28.1.el6"
    },
    {
      "name": "kernel",
      "status": "Fixed",
      "fixed_version": "0:2.6.32-220.28.1.el6",
      "arch": "x86_64"
    },
    {
      "name": "kernel",
      "status": "Fixed",
      "fixed_version": "0:2.6.32-220.28.1.el6",
      "arch": "s390x"
    },
    {
      "name": "python-perf",
      "status": "Fixed",
      "fixed_version": "0:2.6.32-220.28.1.el6",
      "arch": "ppc64"
    },
    {
      "name": "kernel-headers",
      "status": "Fixed",
      "fixed_version": "0:2.6.32-220.28.1.el6",
      "arch": "i686"
    },
    {
      "name": "kernel-debug-devel",
      "status": "Fixed",
      "fixed_version": "0:2.6.32-220.28.1.el6",
      "arch": "ppc64"
    },
    {
      "name": "kernel-debug-devel",
      "status": "Fixed",
      "fixed_version": "0:2.6.32-220.28.1.el6",
      "arch": "i686"
    },
    {
      "name": "kernel-kdump-devel",
      "status": "Fixed",
      "fixed_version": "0:2.6.32-220.28.1.el6",
      "arch": "s390x"
    },
    {
      "name": "kernel-headers",
      "status": "Fixed",
      "fixed_version": "0:2.6.32-220.28.1.el6",
      "arch": "s390x"
    },
    {
      "name": "kernel-debug",
      "status": "Fixed",
      "fixed_version": "0:2.6.32-220.28.1.el6",
      "arch": "x86_64"
    },
    {
      "name": "perf",
      "status": "Fixed",
      "fixed_version": "0:2.6.32-220.28.1.el6",
      "arch": "s390x"
    },
    {
      "name": "kernel-kdump",
      "status": "Fixed",
      "fixed_version": "0:2.6.32-220.28.1.el6",
      "arch": "s390x"
    }
  ],
  "references": [
    {
      "id": "RHSA-2012:1401",
      "source": "RHSA",
      "url": "https://access.redhat.com/errata/RHSA-2012:1401"
    },
    {
      "id": "CVE-2012-3412",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2012-3412"
    },
    {
      "id": "CVE-2012-3412 kernel: sfc: potential remote denial of service through TCP MSS option",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/844714"
    }
  ],
  "public": "2012-07-30T00:00:00Z",
  "issued": "2012-10-23T00:00:00Z",
  "updated": "2012-10-23T00:00:00Z"
}
