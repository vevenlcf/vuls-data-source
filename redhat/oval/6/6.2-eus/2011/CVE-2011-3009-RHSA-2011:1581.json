{
  "id": "CVE-2011-3009",
  "rhsa_id": "RHSA-2011:1581",
  "definition_id": "oval:com.redhat.rhsa:def:20111581",
  "title": "RHSA-2011:1581: ruby security, bug fix, and enhancement update (Low)",
  "description": "Ruby is an extensible, interpreted, object-oriented, scripting language. It\nhas features to process text files and to do system management tasks.\n\nIt was found that Ruby did not reinitialize the PRNG (pseudorandom number\ngenerator) after forking a child process. This could eventually lead to the\nPRNG returning the same result twice. An attacker keeping track of the\nvalues returned by one child process could use this flaw to predict the\nvalues the PRNG would return in other child processes (as long as the\nparent process persisted). (CVE-2011-3009)\n\nA flaw was found in the Ruby SecureRandom module. When using the\nSecureRandom.random_bytes class, the PRNG state was not modified after\nforking a child process. This could eventually lead to\nSecureRandom.random_bytes returning the same string more than once. An\nattacker keeping track of the strings returned by one child process could\nuse this flaw to predict the strings SecureRandom.random_bytes would return\nin other child processes (as long as the parent process persisted).\n(CVE-2011-2705)\n\nThis update also fixes the following bugs:\n\n* The ruby package has been upgraded to upstream point release 1.8.7-p352,\nwhich provides a number of bug fixes over the previous version. (BZ#706332)\n\n* The MD5 message-digest algorithm is not a FIPS-approved algorithm.\nConsequently, when a Ruby script attempted to calculate an MD5 checksum in\nFIPS mode, the interpreter terminated unexpectedly. This bug has been fixed\nand an exception is now raised in the described scenario. (BZ#717709)\n\n* Due to inappropriately handled line continuations in the mkconfig.rb\nsource file, an attempt to build the ruby package resulted in unexpected\ntermination. An upstream patch has been applied to address this issue and\nthe ruby package can now be built properly. (BZ#730287)\n\n* When the 32-bit ruby-libs library was installed on a 64-bit machine, the\nmkmf library failed to load various modules necessary for building\nRuby-related packages. This bug has been fixed and mkmf now works properly\nin the described scenario. (BZ#674787)\n\n* Previously, the load paths for scripts and binary modules were duplicated\non the i386 architecture. Consequently, an ActiveSupport test failed. With\nthis update, the load paths are no longer stored in duplicates on the i386\narchitecture. (BZ#722887)\n\nThis update also adds the following enhancement:\n\n* With this update, SystemTap probes have been added to the ruby package.\n(BZ#673162)\n\nAll users of ruby are advised to upgrade to these updated packages, which\nresolve these issues and add this enhancement.",
  "cvss2": "2.1/AV:L/AC:L/Au:N/C:P/I:N/A:N",
  "severity": "Low",
  "impact": "low",
  "affected": {
    "family": "unix",
    "platforms": [
      "Red Hat Enterprise Linux 6"
    ],
    "cpes": [
      {
        "cpe": "cpe:/o:redhat:rhel_eus:6.2"
      },
      {
        "cpe": "cpe:/o:redhat:rhel_eus:6.2::computenode"
      },
      {
        "cpe": "cpe:/o:redhat:rhel_eus:6.2::server",
        "repository": [
          "rhel-rs-for-rhel-6-server-eus-rpms__6_DOT_2__x86_64",
          "rhel-6-server-aus-source-rpms",
          "rhel-rs-for-rhel-6-server-eus-rpms",
          "rhel-6-server-eus-optional-rpms",
          "rhel-sfs-for-rhel-6-server-eus-rpms__6_DOT_2__x86_64",
          "rhel-6-server-eus-rpms",
          "rhel-rs-for-rhel-6-server-eus-rpms__6_DOT_2__i386",
          "rhel-ha-for-rhel-6-server-eus-rpms__6_DOT_2__i386",
          "rhel-6-for-system-z-eus-optional-rpms__6_DOT_2__s390x",
          "rhel-lb-for-rhel-6-server-eus-rpms",
          "rhel-6-server-eus-rpms__6_DOT_2__i386",
          "rhel-6-server-eus-optional-rpms__6_DOT_2__x86_64",
          "rhel-6-for-system-z-eus-rpms",
          "rhel-6-for-system-z-eus-optional-rpms",
          "rhel-sfs-for-rhel-6-server-eus-rpms",
          "rhel-6-for-system-z-eus-rpms__6_DOT_2__s390x",
          "rhel-6-for-power-eus-rpms",
          "rhel-6-server-aus-optional-debug-rpms",
          "rhel-6-server-aus-rpms",
          "rhel-6-server-aus-optional-rpms",
          "rhel-ha-for-rhel-6-server-eus-rpms",
          "rhel-ha-for-rhel-6-server-eus-rpms__6_DOT_2__x86_64",
          "rhel-6-server-eus-optional-rpms__6_DOT_2__i386",
          "rhel-6-for-power-eus-optional-rpms",
          "rhel-6-server-aus-debug-rpms",
          "rhel-6-server-aus-optional-source-rpms",
          "rhel-6-server-eus-rpms__6_DOT_2__x86_64",
          "rhel-6-for-power-eus-optional-rpms__6_DOT_2__ppc64",
          "rhel-6-for-power-eus-rpms__6_DOT_2__ppc64",
          "rhel-lb-for-rhel-6-server-eus-rpms__6_DOT_2__x86_64"
        ]
      }
    ]
  },
  "packages": [
    {
      "name": "ruby-rdoc",
      "status": "Fixed",
      "fixed_version": "0:1.8.7.352-3.el6",
      "arch": "s390x"
    },
    {
      "name": "ruby-static",
      "status": "Fixed",
      "fixed_version": "0:1.8.7.352-3.el6",
      "arch": "i686"
    },
    {
      "name": "ruby-devel",
      "status": "Fixed",
      "fixed_version": "0:1.8.7.352-3.el6",
      "arch": "i686"
    },
    {
      "name": "ruby-rdoc",
      "status": "Fixed",
      "fixed_version": "0:1.8.7.352-3.el6",
      "arch": "ppc64"
    },
    {
      "name": "ruby-tcltk",
      "status": "Fixed",
      "fixed_version": "0:1.8.7.352-3.el6",
      "arch": "i686"
    },
    {
      "name": "ruby-ri",
      "status": "Fixed",
      "fixed_version": "0:1.8.7.352-3.el6",
      "arch": "i686"
    },
    {
      "name": "ruby",
      "status": "Fixed",
      "fixed_version": "0:1.8.7.352-3.el6",
      "arch": "s390x"
    },
    {
      "name": "ruby-docs",
      "status": "Fixed",
      "fixed_version": "0:1.8.7.352-3.el6",
      "arch": "s390x"
    },
    {
      "name": "ruby-devel",
      "status": "Fixed",
      "fixed_version": "0:1.8.7.352-3.el6",
      "arch": "ppc"
    },
    {
      "name": "ruby-libs",
      "status": "Fixed",
      "fixed_version": "0:1.8.7.352-3.el6",
      "arch": "s390x"
    },
    {
      "name": "ruby-libs",
      "status": "Fixed",
      "fixed_version": "0:1.8.7.352-3.el6",
      "arch": "s390"
    },
    {
      "name": "ruby-tcltk",
      "status": "Fixed",
      "fixed_version": "0:1.8.7.352-3.el6",
      "arch": "s390x"
    },
    {
      "name": "ruby-static",
      "status": "Fixed",
      "fixed_version": "0:1.8.7.352-3.el6",
      "arch": "ppc64"
    },
    {
      "name": "ruby-static",
      "status": "Fixed",
      "fixed_version": "0:1.8.7.352-3.el6",
      "arch": "x86_64"
    },
    {
      "name": "ruby-tcltk",
      "status": "Fixed",
      "fixed_version": "0:1.8.7.352-3.el6",
      "arch": "x86_64"
    },
    {
      "name": "ruby-libs",
      "status": "Fixed",
      "fixed_version": "0:1.8.7.352-3.el6",
      "arch": "i686"
    },
    {
      "name": "ruby-libs",
      "status": "Fixed",
      "fixed_version": "0:1.8.7.352-3.el6",
      "arch": "x86_64"
    },
    {
      "name": "ruby",
      "status": "Fixed",
      "fixed_version": "0:1.8.7.352-3.el6",
      "arch": "ppc64"
    },
    {
      "name": "ruby-irb",
      "status": "Fixed",
      "fixed_version": "0:1.8.7.352-3.el6",
      "arch": "x86_64"
    },
    {
      "name": "ruby-static",
      "status": "Fixed",
      "fixed_version": "0:1.8.7.352-3.el6",
      "arch": "s390x"
    },
    {
      "name": "ruby",
      "status": "Fixed",
      "fixed_version": "0:1.8.7.352-3.el6",
      "arch": "x86_64"
    },
    {
      "name": "ruby-tcltk",
      "status": "Fixed",
      "fixed_version": "0:1.8.7.352-3.el6",
      "arch": "ppc64"
    },
    {
      "name": "ruby-libs",
      "status": "Fixed",
      "fixed_version": "0:1.8.7.352-3.el6",
      "arch": "ppc64"
    },
    {
      "name": "ruby",
      "status": "Fixed",
      "fixed_version": "0:1.8.7.352-3.el6",
      "arch": "i686"
    },
    {
      "name": "ruby-devel",
      "status": "Fixed",
      "fixed_version": "0:1.8.7.352-3.el6",
      "arch": "s390"
    },
    {
      "name": "ruby-devel",
      "status": "Fixed",
      "fixed_version": "0:1.8.7.352-3.el6",
      "arch": "ppc64"
    },
    {
      "name": "ruby-docs",
      "status": "Fixed",
      "fixed_version": "0:1.8.7.352-3.el6",
      "arch": "i686"
    },
    {
      "name": "ruby-ri",
      "status": "Fixed",
      "fixed_version": "0:1.8.7.352-3.el6",
      "arch": "ppc64"
    },
    {
      "name": "ruby-rdoc",
      "status": "Fixed",
      "fixed_version": "0:1.8.7.352-3.el6",
      "arch": "x86_64"
    },
    {
      "name": "ruby-docs",
      "status": "Fixed",
      "fixed_version": "0:1.8.7.352-3.el6",
      "arch": "ppc64"
    },
    {
      "name": "ruby-irb",
      "status": "Fixed",
      "fixed_version": "0:1.8.7.352-3.el6",
      "arch": "ppc64"
    },
    {
      "name": "ruby-ri",
      "status": "Fixed",
      "fixed_version": "0:1.8.7.352-3.el6",
      "arch": "x86_64"
    },
    {
      "name": "ruby-devel",
      "status": "Fixed",
      "fixed_version": "0:1.8.7.352-3.el6",
      "arch": "x86_64"
    },
    {
      "name": "ruby-libs",
      "status": "Fixed",
      "fixed_version": "0:1.8.7.352-3.el6",
      "arch": "ppc"
    },
    {
      "name": "ruby-irb",
      "status": "Fixed",
      "fixed_version": "0:1.8.7.352-3.el6",
      "arch": "i686"
    },
    {
      "name": "ruby-docs",
      "status": "Fixed",
      "fixed_version": "0:1.8.7.352-3.el6",
      "arch": "x86_64"
    },
    {
      "name": "ruby-irb",
      "status": "Fixed",
      "fixed_version": "0:1.8.7.352-3.el6",
      "arch": "s390x"
    },
    {
      "name": "ruby-ri",
      "status": "Fixed",
      "fixed_version": "0:1.8.7.352-3.el6",
      "arch": "s390x"
    },
    {
      "name": "ruby-devel",
      "status": "Fixed",
      "fixed_version": "0:1.8.7.352-3.el6",
      "arch": "s390x"
    },
    {
      "name": "ruby-rdoc",
      "status": "Fixed",
      "fixed_version": "0:1.8.7.352-3.el6",
      "arch": "i686"
    }
  ],
  "references": [
    {
      "id": "RHSA-2011:1581",
      "source": "RHSA",
      "url": "https://access.redhat.com/errata/RHSA-2011:1581"
    },
    {
      "id": "CVE-2011-2705",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2011-2705"
    },
    {
      "id": "CVE-2011-3009",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2011-3009"
    },
    {
      "id": "CVE-2011-2686 CVE-2011-2705 CVE-2011-3009 ruby: Properly initialize the random number generator when forking new process",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/722415"
    }
  ],
  "public": "2011-07-02T00:00:00Z",
  "issued": "2011-12-05T00:00:00Z",
  "updated": "2011-12-06T00:00:00Z"
}
