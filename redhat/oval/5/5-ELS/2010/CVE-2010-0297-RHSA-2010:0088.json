{
  "id": "CVE-2010-0297",
  "rhsa_id": "RHSA-2010:0088",
  "definition_id": "oval:com.redhat.rhsa:def:20100088",
  "title": "RHSA-2010:0088: kvm security and bug fix update (Important)",
  "description": "KVM (Kernel-based Virtual Machine) is a full virtualization solution for\nLinux on AMD64 and Intel 64 systems. KVM is a Linux kernel module built for\nthe standard Red Hat Enterprise Linux kernel.\n\nThe x86 emulator implementation was missing a check for the Current\nPrivilege Level (CPL) and I/O Privilege Level (IOPL). A user in a guest\ncould leverage these flaws to cause a denial of service (guest crash) or\npossibly escalate their privileges within that guest. (CVE-2010-0298,\nCVE-2010-0306)\n\nA flaw was found in the Programmable Interval Timer (PIT) emulation. Access\nto the internal data structure pit_state, which represents the data state\nof the emulated PIT, was not properly validated in the pit_ioport_read()\nfunction. A privileged guest user could use this flaw to crash the host.\n(CVE-2010-0309)\n\nA flaw was found in the USB passthrough handling code. A specially-crafted\nUSB packet sent from inside a guest could be used to trigger a buffer\noverflow in the usb_host_handle_control() function, which runs under the\nQEMU-KVM context on the host. A user in a guest could leverage this flaw to\ncause a denial of service (guest hang or crash) or possibly escalate their\nprivileges within the host. (CVE-2010-0297)\n\nThis update also fixes the following bugs: \n\n* pvclock MSR values were not preserved during remote migration, causing\ntime drift for guests. (BZ#537028)\n\n* SMBIOS table 4 data is now generated for Windows guests. (BZ#545874)\n\n* if the qemu-kvm \"-net user\" option was used, unattended Windows XP\ninstallations did not receive an IP address after reboot. (BZ#546562)\n\n* when being restored from migration, a race condition caused Windows\nServer 2008 R2 guests to hang during shutdown. (BZ#546563)\n\n* the kernel symbol checking on the kvm-kmod build process has a safety\ncheck for ABI changes. (BZ#547293)\n\n* on hosts without high-res timers, Windows Server 2003 guests experienced\nsignificant time drift. (BZ#547625)\n\n* in some situations, installing Windows Server 2008 R2 from an ISO image\nresulted in a blue screen \"BAD_POOL_HEADER\" stop error. (BZ#548368)\n\n* a bug in the grow_refcount_table() error handling caused infinite\nrecursion in some cases. This caused the qemu-kvm process to hang and\neventually crash. (BZ#552159)\n\n* for Windows Server 2003 R2, Service Pack 2, 32-bit guests, an \"unhandled\nvm exit\" error could occur during reboot on some systems. (BZ#552518)\n\n* for Windows guests, QEMU could attempt to stop a stopped audio device,\nresulting in a \"snd_playback_stop: ASSERT playback_channel-\u003ebase.active\nfailed\" error. (BZ#552519)\n\n* the Hypercall driver did not reset the device on power-down. (BZ#552528)\n\n* mechanisms have been added to make older savevm versions to be emitted in\nsome cases. (BZ#552529)\n\n* an error in the Makefile prevented users from using the source RPM to\ninstall KVM. (BZ#552530)\n\n* guests became unresponsive and could use up to 100% CPU when running\ncertain benchmark tests with more than 7 guests running simultaneously.\n(BZ#553249)\n\n* QEMU could terminate randomly with virtio-net and SMP enabled.\n(BZ#561022)\n\nAll KVM users should upgrade to these updated packages, which contain\nbackported patches to resolve these issues. Note: The procedure in the\nSolution section must be performed before this update will take effect.",
  "cvss2": "6.0/AV:L/AC:H/Au:S/C:C/I:C/A:C",
  "severity": "Important",
  "impact": "moderate",
  "affected": {
    "family": "unix",
    "platforms": [
      "Red Hat Enterprise Linux 5"
    ],
    "cpes": [
      {
        "cpe": "cpe:/a:redhat:rhel_virtualization:5"
      },
      {
        "cpe": "cpe:/a:redhat:rhel_virtualization:5::client",
        "repository": [
          "rhel-5-workstation-vt-rpms",
          "rhel-5-workstation-vt-debug-rpms",
          "rhel-5-workstation-vt-source-rpms"
        ]
      },
      {
        "cpe": "cpe:/a:redhat:rhel_virtualization:5::server",
        "repository": [
          "rhel-5-server-vt-debug-rpms",
          "rhel-5-server-vt-source-rpms",
          "rhel-5-server-vt-rpms",
          "rhel-5-server-eus-vt-rpms"
        ]
      }
    ]
  },
  "packages": [
    {
      "name": "kvm-tools",
      "status": "Fixed",
      "fixed_version": "0:83-105.el5_4.22",
      "arch": "x86_64"
    },
    {
      "name": "kmod-kvm",
      "status": "Fixed",
      "fixed_version": "0:83-105.el5_4.22",
      "arch": "x86_64"
    },
    {
      "name": "kvm",
      "status": "Fixed",
      "fixed_version": "0:83-105.el5_4.22",
      "arch": "x86_64"
    },
    {
      "name": "kvm-qemu-img",
      "status": "Fixed",
      "fixed_version": "0:83-105.el5_4.22",
      "arch": "x86_64"
    }
  ],
  "references": [
    {
      "id": "RHSA-2010:0088",
      "source": "RHSA",
      "url": "https://access.redhat.com/errata/RHSA-2010:0088"
    },
    {
      "id": "CVE-2010-0297",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2010-0297"
    },
    {
      "id": "CVE-2010-0298",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2010-0298"
    },
    {
      "id": "CVE-2010-0306",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2010-0306"
    },
    {
      "id": "CVE-2010-0309",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2010-0309"
    },
    {
      "id": "CVE-2010-0297 kvm-userspace-rhel5: usb-linux.c: fix buffer overflow",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/557025"
    },
    {
      "id": "CVE-2010-0298 kvm: emulator privilege escalation",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/559091"
    },
    {
      "id": "CVE-2010-0306 kvm: emulator privilege escalation IOPL/CPL level check",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/560654"
    },
    {
      "id": "CVE-2010-0309 kvm: cat /dev/port in guest cause the host hang",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/560887"
    }
  ],
  "public": "2009-10-04T00:00:00Z",
  "issued": "2010-02-09T00:00:00Z",
  "updated": "2010-02-09T00:00:00Z"
}
