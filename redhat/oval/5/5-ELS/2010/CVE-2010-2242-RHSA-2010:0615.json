{
  "id": "CVE-2010-2242",
  "rhsa_id": "RHSA-2010:0615",
  "definition_id": "oval:com.redhat.rhsa:def:20100615",
  "title": "RHSA-2010:0615: libvirt security and bug fix update (Low)",
  "description": "The libvirt library is a C API for managing and interacting with the\nvirtualization capabilities of Linux and other operating systems. In\naddition, libvirt provides tools for remotely managing virtualized systems.\n\nIt was found that libvirt did not set the user-defined backing store format\nwhen creating a new image, possibly resulting in applications having to\nprobe the backing store to discover the format. A privileged guest user\ncould use this flaw to read arbitrary files on the host. (CVE-2010-2239)\n\nIt was found that libvirt created insecure iptables rules on the host when\na guest system was configured for IP masquerading, allowing the guest to\nuse privileged ports on the host when accessing network resources. A\nprivileged guest user could use this flaw to access network resources that\nwould otherwise not be accessible to the guest. (CVE-2010-2242)\n\nRed Hat would like to thank Jeremy Nickurak for reporting the CVE-2010-2242\nissue.\n\nThis update also fixes the following bugs:\n\n* a Linux software bridge assumes the MAC address of the enslaved interface\nwith the numerically lowest MAC address. When the bridge changes its MAC\naddress, for a period of time it does not relay packets across network\nsegments, resulting in a temporary network \"blackout\". The bridge should\nthus avoid changing its MAC address in order not to disrupt network\ncommunications.\n\nThe Linux kernel assigns network TAP devices a random MAC address.\nOccasionally, this random MAC address is lower than that of the physical\ninterface which is enslaved (for example, eth0 or eth1), which causes the\nbridge to change its MAC address, thereby disrupting network communications\nfor a period of time.\n\nWith this update, libvirt now sets an explicit MAC address for all TAP\ndevices created using the configured MAC address from the XML, but with the\nhigh bit set to 0xFE. The result is that TAP device MAC addresses are now\nnumerically greater than those for physical interfaces, and bridges should\nno longer attempt to switch their MAC address to that of the TAP device,\nthus avoiding potential spurious network disruptions. (BZ#617243)\n\n* a memory leak in the libvirt driver for the Xen hypervisor has been fixed\nwith this update. (BZ#619711)\n\n* the xm and virsh management user interfaces for virtual guests can be\ncalled on the command line to list the number of active guests. However,\nunder certain circumstances, running the \"virsh list\" command resulted in\nvirsh not listing all of the virtual guests that were active (that is,\nrunning) at the time. This update incorporates a fix that matches the logic\nused for determining active guests with that of \"xm list\", such that both\ncommands should now list the same number of active virtual guests under all\ncircumstances. (BZ#618200)\n\nAll users of libvirt are advised to upgrade to these updated packages,\nwhich contain backported patches to correct these issues. After installing\nthe updated packages, the system must be rebooted for the update to take\neffect.",
  "cvss2": "1.5/AV:L/AC:M/Au:S/C:N/I:P/A:N",
  "severity": "Low",
  "impact": "low",
  "affected": {
    "family": "unix",
    "platforms": [
      "Red Hat Enterprise Linux 5"
    ],
    "cpes": [
      {
        "cpe": "cpe:/a:redhat:rhel_virtualization:5"
      },
      {
        "cpe": "cpe:/a:redhat:rhel_virtualization:5::client",
        "repository": [
          "rhel-5-workstation-vt-rpms",
          "rhel-5-workstation-vt-source-rpms",
          "rhel-5-workstation-vt-debug-rpms"
        ]
      },
      {
        "cpe": "cpe:/a:redhat:rhel_virtualization:5::server",
        "repository": [
          "rhel-5-server-eus-vt-rpms",
          "rhel-5-server-vt-source-rpms",
          "rhel-5-server-vt-rpms",
          "rhel-5-server-vt-debug-rpms"
        ]
      }
    ]
  },
  "packages": [
    {
      "name": "libvirt",
      "status": "Fixed",
      "fixed_version": "0:0.6.3-33.el5_5.3",
      "arch": "x86_64"
    },
    {
      "name": "libvirt-python",
      "status": "Fixed",
      "fixed_version": "0:0.6.3-33.el5_5.3",
      "arch": "x86_64"
    },
    {
      "name": "libvirt",
      "status": "Fixed",
      "fixed_version": "0:0.6.3-33.el5_5.3",
      "arch": "ia64"
    },
    {
      "name": "libvirt",
      "status": "Fixed",
      "fixed_version": "0:0.6.3-33.el5_5.3",
      "arch": "i386"
    },
    {
      "name": "libvirt-devel",
      "status": "Fixed",
      "fixed_version": "0:0.6.3-33.el5_5.3",
      "arch": "x86_64"
    },
    {
      "name": "libvirt-python",
      "status": "Fixed",
      "fixed_version": "0:0.6.3-33.el5_5.3",
      "arch": "ia64"
    },
    {
      "name": "libvirt-python",
      "status": "Fixed",
      "fixed_version": "0:0.6.3-33.el5_5.3",
      "arch": "i386"
    },
    {
      "name": "libvirt-devel",
      "status": "Fixed",
      "fixed_version": "0:0.6.3-33.el5_5.3",
      "arch": "i386"
    },
    {
      "name": "libvirt-devel",
      "status": "Fixed",
      "fixed_version": "0:0.6.3-33.el5_5.3",
      "arch": "ia64"
    }
  ],
  "references": [
    {
      "id": "RHSA-2010:0615",
      "source": "RHSA",
      "url": "https://access.redhat.com/errata/RHSA-2010:0615"
    },
    {
      "id": "CVE-2010-2239",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2010-2239"
    },
    {
      "id": "CVE-2010-2242",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2010-2242"
    },
    {
      "id": "CVE-2010-2242 libvirt: improperly mapped source privileged ports may allow for obtaining privileged resources on the host",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/602455"
    },
    {
      "id": "CVE-2010-2239 libvirt: not setting user defined backing store format when creating new image",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/607812"
    }
  ],
  "public": "2010-07-12T00:00:00Z",
  "issued": "2010-08-10T00:00:00Z",
  "updated": "2010-08-10T00:00:00Z"
}
