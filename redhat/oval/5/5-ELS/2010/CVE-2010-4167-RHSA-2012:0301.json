{
  "id": "CVE-2010-4167",
  "rhsa_id": "RHSA-2012:0301",
  "definition_id": "oval:com.redhat.rhsa:def:20120301",
  "title": "RHSA-2012:0301: ImageMagick security and bug fix update (Low)",
  "description": "ImageMagick is an image display and manipulation tool for the X Window\nSystem that can read and write multiple image formats.\n\nIt was found that ImageMagick utilities tried to load ImageMagick\nconfiguration files from the current working directory. If a user ran an\nImageMagick utility in an attacker-controlled directory containing a\nspecially-crafted ImageMagick configuration file, it could cause the\nutility to execute arbitrary code. (CVE-2010-4167)\n\nThis update also fixes the following bugs:\n\n* Previously, the \"identify -verbose\" command failed with an assertion if\nthere was no image information available. An upstream patch has been\napplied, so that GetImageOption() is now called correctly. Now, the\n\"identify -verbose\" command works correctly even if no image information is\navailable. (BZ#502626)\n\n* Previously, an incorrect use of the semaphore data type led to a\ndeadlock. As a consequence, the ImageMagick utility could become\nunresponsive when converting JPEG files to PDF (Portable Document Format)\nfiles. A patch has been applied to address the deadlock issue, and JPEG\nfiles can now be properly converted to PDF files. (BZ#530592)\n\n* Previously, running the \"convert\" command with the \"-color\" option failed\nwith a memory allocation error. The source code has been modified to fix\nproblems with memory allocation. Now, using the \"convert\" command with the\n\"-color\" option works correctly. (BZ#616538)\n\n* Previously, ImageMagick could become unresponsive when using the\n\"display\" command on damaged GIF files. The source code has been revised to\nprevent the issue. ImageMagick now produces an error message in the\ndescribed scenario. A file selector is now opened so the user can choose\nanother image to display. (BZ#693989)\n\n* Prior to this update, the \"convert\" command did not handle rotated PDF\nfiles correctly. As a consequence, the output was rendered as a portrait\nwith the content being cropped. With this update, the PDF render geometry\nis modified, and the output produced by the \"convert\" command is properly\nrendered as a landscape. (BZ#694922)\n\nAll users of ImageMagick are advised to upgrade to these updated packages,\nwhich contain backported patches to correct these issues. All running\ninstances of ImageMagick must be restarted for this update to take effect.",
  "cvss2": "2.6/AV:L/AC:H/Au:N/C:P/I:P/A:N",
  "severity": "Low",
  "impact": "low",
  "affected": {
    "family": "unix",
    "platforms": [
      "Red Hat Enterprise Linux 5"
    ],
    "cpes": [
      {
        "cpe": "cpe:/o:redhat:enterprise_linux:5"
      },
      {
        "cpe": "cpe:/o:redhat:enterprise_linux:5::client",
        "repository": [
          "rhel-5-desktop-debug-rpms",
          "rhel-5-desktop-source-rpms",
          "rhel-5-workstation-desktop-rpms",
          "rhel-5-workstation-desktop-source-rpms",
          "rhel-5-desktop-rpms",
          "rhel-5-workstation-desktop-debug-rpms"
        ]
      },
      {
        "cpe": "cpe:/o:redhat:enterprise_linux:5::client_workstation",
        "repository": [
          "rhel-5-workstation-debug-rpms",
          "rhel-5-workstation-source-rpms",
          "rhel-5-workstation-rpms"
        ]
      },
      {
        "cpe": "cpe:/o:redhat:enterprise_linux:5::server",
        "repository": [
          "rhel-5-server-debug-rpms",
          "rhel-5-for-power-debug-rpms",
          "rhel-5-server-rpms",
          "rhel-5-server-source-rpms",
          "rhel-5-for-system-z-eus-source-rpms",
          "rhel-5-for-power-rpms",
          "rhel-5-server-aus-debug-rpms",
          "rhel-5-server-els-rpms",
          "rhel-5-server-aus-source-rpms",
          "rhel-5-for-system-z-els-debug-rpms",
          "rhel-5-server-eus-rpms",
          "rhel-5-server-eus-source-rpms",
          "rhel-5-server-els-debug-rpms",
          "rhel-5-for-power-source-rpms",
          "rhel-5-for-system-z-rpms",
          "rhel-5-for-system-z-source-rpms",
          "rhel-5-for-system-z-debug-rpms",
          "rhel-5-for-power-eus-rpms",
          "rhel-5-server-aus-rpms",
          "rhel-5-for-system-z-els-source-rpms",
          "rhel-5-for-system-z-eus-rpms",
          "rhel-5-server-els-source-rpms",
          "rhel-5-for-system-z-els-rpms",
          "rhel-5-for-power-eus-source-rpms"
        ]
      }
    ]
  },
  "packages": [
    {
      "name": "ImageMagick-devel",
      "status": "Fixed",
      "fixed_version": "0:6.2.8.0-12.el5",
      "arch": "s390x"
    },
    {
      "name": "ImageMagick",
      "status": "Fixed",
      "fixed_version": "0:6.2.8.0-12.el5",
      "arch": "i386"
    },
    {
      "name": "ImageMagick",
      "status": "Fixed",
      "fixed_version": "0:6.2.8.0-12.el5",
      "arch": "ppc"
    },
    {
      "name": "ImageMagick-perl",
      "status": "Fixed",
      "fixed_version": "0:6.2.8.0-12.el5",
      "arch": "i386"
    },
    {
      "name": "ImageMagick-perl",
      "status": "Fixed",
      "fixed_version": "0:6.2.8.0-12.el5",
      "arch": "ia64"
    },
    {
      "name": "ImageMagick-devel",
      "status": "Fixed",
      "fixed_version": "0:6.2.8.0-12.el5",
      "arch": "ppc"
    },
    {
      "name": "ImageMagick-devel",
      "status": "Fixed",
      "fixed_version": "0:6.2.8.0-12.el5",
      "arch": "x86_64"
    },
    {
      "name": "ImageMagick-perl",
      "status": "Fixed",
      "fixed_version": "0:6.2.8.0-12.el5",
      "arch": "ppc"
    },
    {
      "name": "ImageMagick-c++-devel",
      "status": "Fixed",
      "fixed_version": "0:6.2.8.0-12.el5",
      "arch": "ppc"
    },
    {
      "name": "ImageMagick-devel",
      "status": "Fixed",
      "fixed_version": "0:6.2.8.0-12.el5",
      "arch": "ppc64"
    },
    {
      "name": "ImageMagick-devel",
      "status": "Fixed",
      "fixed_version": "0:6.2.8.0-12.el5",
      "arch": "ia64"
    },
    {
      "name": "ImageMagick-c++-devel",
      "status": "Fixed",
      "fixed_version": "0:6.2.8.0-12.el5",
      "arch": "s390x"
    },
    {
      "name": "ImageMagick-c++",
      "status": "Fixed",
      "fixed_version": "0:6.2.8.0-12.el5",
      "arch": "ppc"
    },
    {
      "name": "ImageMagick",
      "status": "Fixed",
      "fixed_version": "0:6.2.8.0-12.el5",
      "arch": "x86_64"
    },
    {
      "name": "ImageMagick-c++",
      "status": "Fixed",
      "fixed_version": "0:6.2.8.0-12.el5",
      "arch": "ppc64"
    },
    {
      "name": "ImageMagick-c++",
      "status": "Fixed",
      "fixed_version": "0:6.2.8.0-12.el5",
      "arch": "x86_64"
    },
    {
      "name": "ImageMagick-devel",
      "status": "Fixed",
      "fixed_version": "0:6.2.8.0-12.el5",
      "arch": "i386"
    },
    {
      "name": "ImageMagick-c++-devel",
      "status": "Fixed",
      "fixed_version": "0:6.2.8.0-12.el5",
      "arch": "x86_64"
    },
    {
      "name": "ImageMagick-perl",
      "status": "Fixed",
      "fixed_version": "0:6.2.8.0-12.el5",
      "arch": "s390x"
    },
    {
      "name": "ImageMagick-c++",
      "status": "Fixed",
      "fixed_version": "0:6.2.8.0-12.el5",
      "arch": "i386"
    },
    {
      "name": "ImageMagick-c++-devel",
      "status": "Fixed",
      "fixed_version": "0:6.2.8.0-12.el5",
      "arch": "i386"
    },
    {
      "name": "ImageMagick-c++-devel",
      "status": "Fixed",
      "fixed_version": "0:6.2.8.0-12.el5",
      "arch": "ia64"
    },
    {
      "name": "ImageMagick-devel",
      "status": "Fixed",
      "fixed_version": "0:6.2.8.0-12.el5",
      "arch": "s390"
    },
    {
      "name": "ImageMagick-c++-devel",
      "status": "Fixed",
      "fixed_version": "0:6.2.8.0-12.el5",
      "arch": "ppc64"
    },
    {
      "name": "ImageMagick-perl",
      "status": "Fixed",
      "fixed_version": "0:6.2.8.0-12.el5",
      "arch": "x86_64"
    },
    {
      "name": "ImageMagick-c++",
      "status": "Fixed",
      "fixed_version": "0:6.2.8.0-12.el5",
      "arch": "ia64"
    },
    {
      "name": "ImageMagick-c++-devel",
      "status": "Fixed",
      "fixed_version": "0:6.2.8.0-12.el5",
      "arch": "s390"
    },
    {
      "name": "ImageMagick-c++",
      "status": "Fixed",
      "fixed_version": "0:6.2.8.0-12.el5",
      "arch": "s390"
    },
    {
      "name": "ImageMagick",
      "status": "Fixed",
      "fixed_version": "0:6.2.8.0-12.el5",
      "arch": "ia64"
    },
    {
      "name": "ImageMagick",
      "status": "Fixed",
      "fixed_version": "0:6.2.8.0-12.el5",
      "arch": "ppc64"
    },
    {
      "name": "ImageMagick-c++",
      "status": "Fixed",
      "fixed_version": "0:6.2.8.0-12.el5",
      "arch": "s390x"
    },
    {
      "name": "ImageMagick",
      "status": "Fixed",
      "fixed_version": "0:6.2.8.0-12.el5",
      "arch": "s390x"
    },
    {
      "name": "ImageMagick",
      "status": "Fixed",
      "fixed_version": "0:6.2.8.0-12.el5",
      "arch": "s390"
    }
  ],
  "references": [
    {
      "id": "RHSA-2012:0301",
      "source": "RHSA",
      "url": "https://access.redhat.com/errata/RHSA-2012:0301"
    },
    {
      "id": "CVE-2010-4167",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2010-4167"
    },
    {
      "id": "CVE-2010-4167 ImageMagick: configuration files read from $CWD may allow arbitrary code execution",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/652860"
    }
  ],
  "public": "2010-10-30T00:00:00Z",
  "issued": "2012-02-21T00:00:00Z",
  "updated": "2012-02-21T00:00:00Z"
}
