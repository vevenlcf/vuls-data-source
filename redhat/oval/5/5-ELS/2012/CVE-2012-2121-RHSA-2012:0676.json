{
  "id": "CVE-2012-2121",
  "rhsa_id": "RHSA-2012:0676",
  "definition_id": "oval:com.redhat.rhsa:def:20120676",
  "title": "RHSA-2012:0676: kvm security and bug fix update (Moderate)",
  "description": "KVM (Kernel-based Virtual Machine) is a full virtualization solution for\nLinux on AMD64 and Intel 64 systems. KVM is a Linux kernel module built for\nthe standard Red Hat Enterprise Linux kernel.\n\nA flaw was found in the way the KVM_CREATE_IRQCHIP ioctl was handled.\nCalling this ioctl when at least one virtual CPU (VCPU) already existed\ncould lead to a NULL pointer dereference later when the VCPU is scheduled\nto run. A malicious user in the kvm group on the host could use this flaw\nto crash the host. (CVE-2012-1601)\n\nA flaw was found in the way device memory was handled during guest device\nremoval. Upon successful device removal, memory used by the device was not\nproperly unmapped from the corresponding IOMMU or properly released from\nthe kernel, leading to a memory leak. A malicious user in the kvm group on\nthe host who has the ability to assign a device to a guest could use this\nflaw to crash the host. (CVE-2012-2121)\n\nThis update also fixes the following bug:\n\n* An off-by-one error in the QEMU guest's memory management could, in rare\ncases, cause QEMU-KVM to crash due to a segmentation fault in\ntb_invalidate_phys_page_range() if a device initiated DMA into a specific\nguest address. In a reported case, this issue presented on a system that\nhad a guest using the 8139cp network driver. (BZ#816207)\n\nAll users of kvm are advised to upgrade to these updated packages, which\ncontain backported patches to correct these issues. Note that the procedure\nin the Solution section must be performed before this update will take\neffect.",
  "cvss2": "4.7/AV:L/AC:M/Au:N/C:N/I:N/A:C",
  "severity": "Moderate",
  "impact": "moderate",
  "affected": {
    "family": "unix",
    "platforms": [
      "Red Hat Enterprise Linux 5"
    ],
    "cpes": [
      {
        "cpe": "cpe:/a:redhat:rhel_virtualization:5"
      },
      {
        "cpe": "cpe:/a:redhat:rhel_virtualization:5::client",
        "repository": [
          "rhel-5-workstation-vt-source-rpms",
          "rhel-5-workstation-vt-rpms",
          "rhel-5-workstation-vt-debug-rpms"
        ]
      },
      {
        "cpe": "cpe:/a:redhat:rhel_virtualization:5::server",
        "repository": [
          "rhel-5-server-eus-vt-rpms",
          "rhel-5-server-vt-source-rpms",
          "rhel-5-server-vt-rpms",
          "rhel-5-server-vt-debug-rpms"
        ]
      }
    ]
  },
  "packages": [
    {
      "name": "kmod-kvm",
      "status": "Fixed",
      "fixed_version": "0:83-249.el5_8.4",
      "arch": "x86_64"
    },
    {
      "name": "kmod-kvm-debug",
      "status": "Fixed",
      "fixed_version": "0:83-249.el5_8.4",
      "arch": "x86_64"
    },
    {
      "name": "kvm",
      "status": "Fixed",
      "fixed_version": "0:83-249.el5_8.4",
      "arch": "x86_64"
    },
    {
      "name": "kvm-qemu-img",
      "status": "Fixed",
      "fixed_version": "0:83-249.el5_8.4",
      "arch": "x86_64"
    },
    {
      "name": "kvm-tools",
      "status": "Fixed",
      "fixed_version": "0:83-249.el5_8.4",
      "arch": "x86_64"
    }
  ],
  "references": [
    {
      "id": "RHSA-2012:0676",
      "source": "RHSA",
      "url": "https://access.redhat.com/errata/RHSA-2012:0676"
    },
    {
      "id": "CVE-2012-1601",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2012-1601"
    },
    {
      "id": "CVE-2012-2121",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2012-2121"
    },
    {
      "id": "CVE-2012-1601 kernel: kvm: irqchip_in_kernel() and vcpu-\u003earch.apic inconsistency",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/808199"
    },
    {
      "id": "CVE-2012-2121 kvm: device assignment page leak",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/814149"
    }
  ],
  "public": "2012-03-29T00:00:00Z",
  "issued": "2012-05-21T00:00:00Z",
  "updated": "2012-05-21T00:00:00Z"
}
