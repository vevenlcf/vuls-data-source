{
  "id": "CVE-2009-3722",
  "rhsa_id": "RHSA-2010:0126",
  "definition_id": "oval:com.redhat.rhsa:def:20100126",
  "title": "RHSA-2010:0126: kvm security and bug fix update (Important)",
  "description": "KVM (Kernel-based Virtual Machine) is a full virtualization solution for\nLinux on AMD64 and Intel 64 systems. KVM is a Linux kernel module built for\nthe standard Red Hat Enterprise Linux kernel.\n\nA flaw was found in the way the x86 emulator loaded segment selectors (used\nfor memory segmentation and protection) into segment registers. In some\nguest system configurations, an unprivileged guest user could leverage this\nflaw to crash the guest or possibly escalate their privileges within the\nguest. (CVE-2010-0419)\n\nThe x86 emulator implementation was missing a check for the Current\nPrivilege Level (CPL) while accessing debug registers. An unprivileged\nuser in a guest could leverage this flaw to crash the guest.\n(CVE-2009-3722)\n\nThis update also fixes the following bugs:\n\nWith Red Hat Enterprise Virtualization, the virtio_blk_dma_restart_bh()\nfunction was previously used to handle write errors; however, a bug fix\nprovided by the RHSA-2009:1659 update meant that read errors would also\nhave to be handled by this function. The function was not updated for this,\ncausing read errors to be resubmitted as writes. This caused guest image\ncorruption in some cases.\n\nAdditionally, the return values of the bdrv_aio_write() and bdrv_aio_read()\nfunctions were ignored. If an immediate failure occurred in one of these\nfunctions, errors would be missed and the guest could hang or read\ncorrupted data. (BZ#562776)\n\nAll KVM users should upgrade to these updated packages, which contain\nbackported patches to resolve these issues. Note: The procedure in the\nSolution section must be performed before this update will take effect.",
  "cvss2": "4.9/AV:L/AC:L/Au:N/C:N/I:N/A:C",
  "severity": "Important",
  "impact": "moderate",
  "affected": {
    "family": "unix",
    "platforms": [
      "Red Hat Enterprise Linux 5"
    ],
    "cpes": [
      {
        "cpe": "cpe:/a:redhat:rhel_virtualization:5"
      },
      {
        "cpe": "cpe:/a:redhat:rhel_virtualization:5::client",
        "repository": [
          "rhel-5-workstation-vt-source-rpms",
          "rhel-5-workstation-vt-debug-rpms",
          "rhel-5-workstation-vt-rpms"
        ]
      },
      {
        "cpe": "cpe:/a:redhat:rhel_virtualization:5::server",
        "repository": [
          "rhel-5-server-eus-vt-rpms",
          "rhel-5-server-vt-rpms",
          "rhel-5-server-vt-source-rpms",
          "rhel-5-server-vt-debug-rpms"
        ]
      }
    ]
  },
  "packages": [
    {
      "name": "kmod-kvm",
      "status": "Fixed",
      "fixed_version": "0:83-105.el5_4.27",
      "arch": "x86_64"
    },
    {
      "name": "kvm",
      "status": "Fixed",
      "fixed_version": "0:83-105.el5_4.27",
      "arch": "x86_64"
    },
    {
      "name": "kvm-qemu-img",
      "status": "Fixed",
      "fixed_version": "0:83-105.el5_4.27",
      "arch": "x86_64"
    },
    {
      "name": "kvm-tools",
      "status": "Fixed",
      "fixed_version": "0:83-105.el5_4.27",
      "arch": "x86_64"
    }
  ],
  "references": [
    {
      "id": "RHSA-2010:0126",
      "source": "RHSA",
      "url": "https://access.redhat.com/errata/RHSA-2010:0126"
    },
    {
      "id": "CVE-2009-3722",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2009-3722"
    },
    {
      "id": "CVE-2010-0419",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2010-0419"
    },
    {
      "id": "CVE-2009-3722 KVM: Check cpl before emulating debug register access",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/531660"
    },
    {
      "id": "CVE-2010-0419 kvm: emulator privilege escalation segment selector check",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/563463"
    }
  ],
  "public": "2009-09-10T00:00:00Z",
  "issued": "2010-03-01T00:00:00Z",
  "updated": "2010-03-01T00:00:00Z"
}
