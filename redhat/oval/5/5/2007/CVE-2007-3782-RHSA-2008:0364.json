{
  "id": "CVE-2007-3782",
  "rhsa_id": "RHSA-2008:0364",
  "definition_id": "oval:com.redhat.rhsa:def:20080364",
  "title": "RHSA-2008:0364: mysql security and bug fix update (Low)",
  "description": "MySQL is a multi-user, multi-threaded SQL database server. MySQL is a\nclient/server implementation consisting of a server daemon (mysqld), and\nmany different client programs and libraries.\n\nMySQL did not require privileges such as \"SELECT\" for the source table in a\n\"CREATE TABLE LIKE\" statement. An authenticated user could obtain sensitive\ninformation, such as the table structure. (CVE-2007-3781)\n\nA flaw was discovered in MySQL that allowed an authenticated user to gain\nupdate privileges for a table in another database, via a view that refers\nto the external table. (CVE-2007-3782)\n\nMySQL did not require the \"DROP\" privilege for \"RENAME TABLE\" statements.\nAn authenticated user could use this flaw to rename arbitrary tables.\n(CVE-2007-2691)\n\nA flaw was discovered in the mysql_change_db function when returning from\nSQL SECURITY INVOKER stored routines. An authenticated user could use this\nflaw to gain database privileges. (CVE-2007-2692)\n\nMySQL allowed an authenticated user to bypass logging mechanisms via SQL\nqueries that contain the NULL character, which were not properly handled by\nthe mysql_real_query function. (CVE-2006-0903)\n\nMySQL allowed an authenticated user to access a table through a previously\ncreated MERGE table, even after the user's privileges were revoked from\nthe original table, which might violate intended security policy. This is\naddressed by allowing the MERGE storage engine to be disabled, which can\nbe done by running mysqld with the \"--skip-merge\" option. (CVE-2006-4031)\n\nMySQL evaluated arguments in the wrong security context, which allowed an\nauthenticated user to gain privileges through a routine that had been made\navailable using \"GRANT EXECUTE\". (CVE-2006-4227)\n\nMultiple flaws in MySQL allowed an authenticated user to cause the MySQL\ndaemon to crash via crafted SQL queries. This only caused a temporary\ndenial of service, as the MySQL daemon is automatically restarted after the\ncrash. (CVE-2006-7232, CVE-2007-1420, CVE-2007-2583)\n\nAs well, these updated packages fix the following bugs:\n\n* a separate counter was used for \"insert delayed\" statements, which caused\nrows to be discarded. In these updated packages, \"insert delayed\"\nstatements no longer use a separate counter, which resolves this issue.\n\n* due to a bug in the Native POSIX Thread Library, in certain situations,\n\"flush tables\" caused a deadlock on tables that had a read lock. The mysqld\ndaemon had to be killed forcefully. Now, \"COND_refresh\" has been replaced\nwith \"COND_global_read_lock\", which resolves this issue.\n\n* mysqld crashed if a query for an unsigned column type contained a\nnegative value for a \"WHERE [column] NOT IN\" subquery.\n\n* in master and slave server situations, specifying \"on duplicate key\nupdate\" for \"insert\" statements did not update slave servers.\n\n* in the mysql client, empty strings were displayed as \"NULL\". For\nexample, running \"insert into [table-name] values (' ');\" resulted in a\n\"NULL\" entry being displayed when querying the table using \"select * from\n[table-name];\".\n\n* a bug in the optimizer code resulted in certain queries executing much\nslower than expected.\n\n* on 64-bit PowerPC architectures, MySQL did not calculate the thread stack\nsize correctly, which could have caused MySQL to crash when overly-complex\nqueries were used.\n\nNote: these updated packages upgrade MySQL to version 5.0.45. For a full\nlist of bug fixes and enhancements, refer to the MySQL release notes:\nhttp://dev.mysql.com/doc/refman/5.0/en/releasenotes-cs-5-0.html\n\nAll mysql users are advised to upgrade to these updated packages, which\nresolve these issues.",
  "severity": "Low",
  "impact": "low",
  "affected": {
    "family": "unix",
    "platforms": [
      "Red Hat Enterprise Linux 5"
    ],
    "cpes": [
      {
        "cpe": "cpe:/o:redhat:enterprise_linux:5"
      },
      {
        "cpe": "cpe:/o:redhat:enterprise_linux:5::client",
        "repository": [
          "rhel-5-desktop-debug-rpms",
          "rhel-5-desktop-source-rpms",
          "rhel-5-workstation-desktop-rpms",
          "rhel-5-workstation-desktop-source-rpms",
          "rhel-5-desktop-rpms",
          "rhel-5-workstation-desktop-debug-rpms"
        ]
      },
      {
        "cpe": "cpe:/o:redhat:enterprise_linux:5::client_workstation",
        "repository": [
          "rhel-5-workstation-debug-rpms",
          "rhel-5-workstation-source-rpms",
          "rhel-5-workstation-rpms"
        ]
      },
      {
        "cpe": "cpe:/o:redhat:enterprise_linux:5::server",
        "repository": [
          "rhel-5-server-debug-rpms",
          "rhel-5-for-power-debug-rpms",
          "rhel-5-server-rpms",
          "rhel-5-server-source-rpms",
          "rhel-5-for-system-z-eus-source-rpms",
          "rhel-5-for-power-rpms",
          "rhel-5-server-aus-debug-rpms",
          "rhel-5-server-els-rpms",
          "rhel-5-server-aus-source-rpms",
          "rhel-5-for-system-z-els-debug-rpms",
          "rhel-5-server-eus-rpms",
          "rhel-5-server-eus-source-rpms",
          "rhel-5-server-els-debug-rpms",
          "rhel-5-for-power-source-rpms",
          "rhel-5-for-system-z-rpms",
          "rhel-5-for-system-z-source-rpms",
          "rhel-5-for-system-z-debug-rpms",
          "rhel-5-for-power-eus-rpms",
          "rhel-5-server-aus-rpms",
          "rhel-5-for-system-z-els-source-rpms",
          "rhel-5-for-system-z-eus-rpms",
          "rhel-5-server-els-source-rpms",
          "rhel-5-for-system-z-els-rpms",
          "rhel-5-for-power-eus-source-rpms"
        ]
      }
    ]
  },
  "packages": [
    {
      "name": "mysql-server",
      "status": "Fixed",
      "fixed_version": "0:5.0.45-7.el5",
      "arch": "i386"
    },
    {
      "name": "mysql-test",
      "status": "Fixed",
      "fixed_version": "0:5.0.45-7.el5",
      "arch": "x86_64"
    },
    {
      "name": "mysql-bench",
      "status": "Fixed",
      "fixed_version": "0:5.0.45-7.el5",
      "arch": "s390x"
    },
    {
      "name": "mysql-bench",
      "status": "Fixed",
      "fixed_version": "0:5.0.45-7.el5",
      "arch": "i386"
    },
    {
      "name": "mysql-bench",
      "status": "Fixed",
      "fixed_version": "0:5.0.45-7.el5",
      "arch": "ia64"
    },
    {
      "name": "mysql",
      "status": "Fixed",
      "fixed_version": "0:5.0.45-7.el5",
      "arch": "x86_64"
    },
    {
      "name": "mysql-bench",
      "status": "Fixed",
      "fixed_version": "0:5.0.45-7.el5",
      "arch": "ppc"
    },
    {
      "name": "mysql-test",
      "status": "Fixed",
      "fixed_version": "0:5.0.45-7.el5",
      "arch": "ppc"
    },
    {
      "name": "mysql",
      "status": "Fixed",
      "fixed_version": "0:5.0.45-7.el5",
      "arch": "ppc"
    },
    {
      "name": "mysql-server",
      "status": "Fixed",
      "fixed_version": "0:5.0.45-7.el5",
      "arch": "ppc"
    },
    {
      "name": "mysql-bench",
      "status": "Fixed",
      "fixed_version": "0:5.0.45-7.el5",
      "arch": "x86_64"
    },
    {
      "name": "mysql-test",
      "status": "Fixed",
      "fixed_version": "0:5.0.45-7.el5",
      "arch": "s390x"
    },
    {
      "name": "mysql-devel",
      "status": "Fixed",
      "fixed_version": "0:5.0.45-7.el5",
      "arch": "s390x"
    },
    {
      "name": "mysql",
      "status": "Fixed",
      "fixed_version": "0:5.0.45-7.el5",
      "arch": "ppc64"
    },
    {
      "name": "mysql",
      "status": "Fixed",
      "fixed_version": "0:5.0.45-7.el5",
      "arch": "ia64"
    },
    {
      "name": "mysql-devel",
      "status": "Fixed",
      "fixed_version": "0:5.0.45-7.el5",
      "arch": "ppc"
    },
    {
      "name": "mysql-devel",
      "status": "Fixed",
      "fixed_version": "0:5.0.45-7.el5",
      "arch": "s390"
    },
    {
      "name": "mysql",
      "status": "Fixed",
      "fixed_version": "0:5.0.45-7.el5",
      "arch": "i386"
    },
    {
      "name": "mysql",
      "status": "Fixed",
      "fixed_version": "0:5.0.45-7.el5",
      "arch": "s390"
    },
    {
      "name": "mysql-server",
      "status": "Fixed",
      "fixed_version": "0:5.0.45-7.el5",
      "arch": "s390x"
    },
    {
      "name": "mysql",
      "status": "Fixed",
      "fixed_version": "0:5.0.45-7.el5",
      "arch": "s390x"
    },
    {
      "name": "mysql-server",
      "status": "Fixed",
      "fixed_version": "0:5.0.45-7.el5",
      "arch": "x86_64"
    },
    {
      "name": "mysql-test",
      "status": "Fixed",
      "fixed_version": "0:5.0.45-7.el5",
      "arch": "ia64"
    },
    {
      "name": "mysql-devel",
      "status": "Fixed",
      "fixed_version": "0:5.0.45-7.el5",
      "arch": "ppc64"
    },
    {
      "name": "mysql-devel",
      "status": "Fixed",
      "fixed_version": "0:5.0.45-7.el5",
      "arch": "ia64"
    },
    {
      "name": "mysql-devel",
      "status": "Fixed",
      "fixed_version": "0:5.0.45-7.el5",
      "arch": "x86_64"
    },
    {
      "name": "mysql-devel",
      "status": "Fixed",
      "fixed_version": "0:5.0.45-7.el5",
      "arch": "i386"
    },
    {
      "name": "mysql-server",
      "status": "Fixed",
      "fixed_version": "0:5.0.45-7.el5",
      "arch": "ppc64"
    },
    {
      "name": "mysql-server",
      "status": "Fixed",
      "fixed_version": "0:5.0.45-7.el5",
      "arch": "ia64"
    },
    {
      "name": "mysql-test",
      "status": "Fixed",
      "fixed_version": "0:5.0.45-7.el5",
      "arch": "i386"
    }
  ],
  "references": [
    {
      "id": "RHSA-2008:0364",
      "source": "RHSA",
      "url": "https://access.redhat.com/errata/RHSA-2008:0364"
    },
    {
      "id": "CVE-2006-0903",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2006-0903"
    },
    {
      "id": "CVE-2006-4031",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2006-4031"
    },
    {
      "id": "CVE-2006-4227",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2006-4227"
    },
    {
      "id": "CVE-2006-7232",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2006-7232"
    },
    {
      "id": "CVE-2007-1420",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2007-1420"
    },
    {
      "id": "CVE-2007-2583",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2007-2583"
    },
    {
      "id": "CVE-2007-2691",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2007-2691"
    },
    {
      "id": "CVE-2007-2692",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2007-2692"
    },
    {
      "id": "CVE-2007-3781",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2007-3781"
    },
    {
      "id": "CVE-2007-3782",
      "source": "CVE",
      "url": "https://access.redhat.com/security/cve/CVE-2007-3782"
    },
    {
      "id": "CVE-2006-0903 Mysql log file obfuscation",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/194613"
    },
    {
      "id": "CVE-2006-4031 MySQL improper permission revocation",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/202246"
    },
    {
      "id": "CVE-2006-4227 mysql improper suid argument evaluation",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/216427"
    },
    {
      "id": "CVE-2007-1420 Single MySQL worker can be crashed (NULL deref) with certain SELECT statements",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/232603"
    },
    {
      "id": "CVE-2007-2583 mysql: DoS via statement with crafted IF clause",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/240813"
    },
    {
      "id": "CVE-2007-2691 mysql DROP privilege not enforced when renaming tables",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/241688"
    },
    {
      "id": "CVE-2007-2692 mysql SECURITY INVOKER functions do not drop privileges",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/241689"
    },
    {
      "id": "CVE-2007-3781 CVE-2007-3782 New release of MySQL fixes security bugs",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/248553"
    },
    {
      "id": "CVE-2006-7232 mysql: daemon crash via EXPLAIN on queries on information schema",
      "source": "BUG",
      "url": "https://bugzilla.redhat.com/434264"
    }
  ],
  "public": "2007-07-04T00:00:00Z",
  "issued": "2008-05-20T00:00:00Z",
  "updated": "2008-05-21T00:00:00Z"
}
